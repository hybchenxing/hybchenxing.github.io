
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1" theme-name="Stellar" theme-version="1.28.1">
  
  <meta name="generator" content="Hexo 7.2.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f9fafb">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  
  <title>THM-Nmap - hybcx's blog</title>

  
    <meta name="description" content="0x01 简介 对于黑客来说，知识就是力量。您对目标系统或网络的了解越多，可用的选项就越多。这使得在进行任何利用尝试之前必须进行适当的枚举。 假设我们已获得一个 IP（或多个 IP 地址）来执行安全审核。在我们做任何其他事情之前，我们需要了解我们正在攻击的“景观”。这意味着我们需要确定目标上正在运行哪些服务。 例如，也许其中一个正在运行 Web 服务器，另一个则充当 Windows Active">
<meta property="og:type" content="article">
<meta property="og:title" content="THM-Nmap">
<meta property="og:url" content="http://hybcx.xyz/2024/02/16/thm-nmap/index.html">
<meta property="og:site_name" content="hybcx&#39;s blog">
<meta property="og:description" content="0x01 简介 对于黑客来说，知识就是力量。您对目标系统或网络的了解越多，可用的选项就越多。这使得在进行任何利用尝试之前必须进行适当的枚举。 假设我们已获得一个 IP（或多个 IP 地址）来执行安全审核。在我们做任何其他事情之前，我们需要了解我们正在攻击的“景观”。这意味着我们需要确定目标上正在运行哪些服务。 例如，也许其中一个正在运行 Web 服务器，另一个则充当 Windows Active">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216175656420.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216180627248.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182551471.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182606759.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182616793.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182629146.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182935748.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183041765.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183218824.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183300156.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183522702.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184103251.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184306773.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184329439.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184406875.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184836853.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216185316277.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216185557080.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190408747.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190524152.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190540863.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190618291.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190644073.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216191029146.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216191046335.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216191652525.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193100002.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193418154.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193801089.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193832775.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310103247817.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310103252532.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310105353268.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310105431451.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310105636735.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110340479.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110620238.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110625843.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110745210.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310111013725.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310111020608.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310112055114.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310112105178.png">
<meta property="og:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310112045359.png">
<meta property="article:published_time" content="2024-02-16T09:45:21.092Z">
<meta property="article:modified_time" content="2024-03-10T03:24:19.015Z">
<meta property="article:author" content="hybcx">
<meta property="article:tag" content="TryHackMe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216175656420.png">
  
  
  
  <meta name="keywords" content="TryHackMe">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="hybcx's blog" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.28.1">

  
    <link rel="shortcut icon" href="/medias/logo.png">
  

  
    
<link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css">

  

  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/medias/avatar.jpg" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">hybcx's blog</div><div class="sub normal cap">人生当是精彩的</div><div class="sub hover cap" style="opacity:0"> 何必忧虑未来！</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item active" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="关于" href="/about/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="友链" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title" href="/2024/06/15/du-web-gong-fang-you-gan/"><span class="title">读web攻防有感</span></a><a class="item title" href="/2024/03/29/thm-jin-gong-xing-shen-tou-ce-shi/"><span class="title">THM-进攻性渗透测试</span></a><a class="item title" href="/2024/06/29/xuan-ji-ying-ji-xiang-ying-ba-chang/"><span class="title">玄机应急响应靶场</span></a><a class="item title" href="/2024/06/17/thm-corp/"><span class="title">THM-Corp</span></a><a class="item title" href="/2024/06/16/thm-hacking-with-powershell/"><span class="title">THM-Hacking_With_PowerShell</span></a><a class="item title" href="/2024/06/10/thm-exploiting-active-directory/"><span class="title">THM-Exploiting Active Directory</span></a><a class="item title" href="/2024/06/11/thinkphp5-dai-shen/"><span class="title">ThinkPHP5代码审计</span></a><a class="item title" href="/2024/06/01/seacms-dai-ma-shen-ji/"><span class="title">SeaCMS代码审计</span></a><a class="item title" href="/2024/06/09/thm-enumerating-active-directory/"><span class="title">THM-Enumerating Active Directory</span></a><a class="item title" href="/2024/02/19/thm-persisting-active-directory/"><span class="title">THM-Persisting Active Directory</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/hybchenxing/" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/github-logo2.png"/></a><a class="social" href="https://music.163.com/#/user/home?id=9895561810" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/neteasemusic-icon.png"/></a><a class="social" href="https://space.bilibili.com/1761635300" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/bilibili-icon.png"/></a><a class="social" href="https://muselink.cc/hybcx" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/weChat.png"/></a><a class="social" href="javaScript:void('永夜');" rel="noopener noreferrer"><img class="lazy" id="ThemeM" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/moon.svg"/></a><a class="social" href="javaScript:void('永昼');" rel="noopener noreferrer"><img class="lazy" id="ThemeL" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/sun.svg"/></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/TryHackMe/">TryHackMe</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2024-02-16T09:45:21.092Z">2024-02-16</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2024-03-10T03:24:19.015Z">2024-03-10</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>THM-Nmap</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h1 id="0x01-简介">0x01 简介</h1>
<p>对于黑客来说，知识就是力量。您对目标系统或网络的了解越多，可用的选项就越多。这使得在进行任何利用尝试之前必须进行适当的枚举。</p>
<p>假设我们已获得一个 IP（或多个 IP 地址）来执行安全审核。在我们做任何其他事情之前，我们需要了解我们正在攻击的“景观”。这意味着我们需要确定目标上正在运行哪些服务。</p>
<p>例如，也许其中一个正在运行 Web 服务器，另一个则充当 Windows Active Directory 域控制器。建立景观“地图”的第一个阶段是所谓的端口扫描。当计算机运行网络服务时，它会打开一个称为“端口”的网络结构来接收连接。端口对于发出多个网络请求或提供多个可用服务是必需的。</p>
<p>例如，当您在网络浏览器中同时加载多个网页时，程序必须有某种方法来确定哪个选项卡正在加载哪个网页。这是通过使用本地计算机上的不同端口建立与远程网络服务器的连接来完成的。同样，如果您希望一台服务器能够运行多个服务（例如，您可能希望您的 Web 服务器同时运行该站点的 HTTP 和 HTTPS 版本），那么您需要某种方法将流量引导至适当的服务。端口再次是解决这个问题的方法。网络连接是在两个端口之间建立的 - 一个在服务器上侦听的开放端口和一个在您自己的计算机上随机选择的端口。例如，当您连接到网页时，您的计算机可能会打开端口 49534 以连接到服务器的端口 443。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216175656420.png" alt="image-20240216175656420"></p>
<p>与前面的示例一样，该图显示了当您同时连接到多个网站时会发生什么情况。您的计算机打开一个不同的高编号端口（随机），用于与远程服务器的所有通信。</p>
<p>每台计算机共有65535个可用端口；然而，其中许多已注册为标准端口。例如，HTTP Web 服务几乎总是可以在服务器的端口 80 上找到。 HTTPS Web 服务可以在端口 443 上找到。Windows NETBIOS 可以在端口 139 上找到，SMB 可以在端口 445 上找到。需要注意的是；然而，特别是在 CTF 设置中，即使这些标准端口被更改也并非闻所未闻，这使得我们更有必要对目标执行适当的枚举。</p>
<p>如果我们不知道服务器打开了哪些端口，那么我们就没有成功攻击目标的希望；因此，我们从端口扫描开始任何攻击至关重要。这可以通过多种方式来完成——通常使用名为 nmap 的工具，这是本​​次会议的重点。 Nmap 可用于执行许多不同类型的端口扫描 - 其中最常见的将在接下来的任务中介绍；然而，基本理论是这样的：nmap 将依次连接到目标的每个端口。根据端口的响应方式，可以将其确定为开放、关闭或过滤（通常由防火墙）。一旦我们知道哪些端口是开放的，我们就可以查看每个端口上正在运行的服务——手动，或者更常见的是使用 nmap。</p>
<p>那么，为什么是 nmap？简而言之，它目前成为行业标准是有原因的：没有其他端口扫描工具能够接近其功能（尽管一些新来者现在在速度上与它相匹配）。它是一个非常强大的工具 - 其脚本引擎使其更加强大，可用于扫描漏洞，在某些情况下甚至可以直接执行漏洞利用！再次，这将在接下来的任务中更多地涉及。</p>
<p>现在，了解以下内容很重要：什么是端口扫描；为什么有必要； nmap 是任何类型初始枚举的首选工具。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216180627248.png" alt="image-20240216180627248"></p>
<h1 id="0x02-nmap选项">0x02 Nmap选项</h1>
<p>与大多数渗透测试工具一样，nmap 是从终端运行的。有适用于 Windows 和 Linux 的版本。对于这个房间，我们假设您使用的是 Linux；但是，开关应该是相同的。 Nmap 默认安装在 Kali Linux 和 TryHackMe Attack Box 中。</p>
<p>可以通过在终端命令行中输入 <code>nmap</code> 来访问 Nmap，然后输入我们将在下面介绍的一些“开关”（告诉程序执行不同操作的命令参数）。</p>
<p>为此，您所需要的只是 nmap 的帮助菜单（使用 <code>nmap -h</code> 访问）和/或 nmap 手册页（使用 <code>man nmap</code> 访问）。对于每个答案，除非另有说明，否则请包括开关的所有部分。这包括开头的连字符 ( <code>-</code> )。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182551471.png" alt="image-20240216182551471"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182606759.png" alt="image-20240216182606759"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182616793.png" alt="image-20240216182616793"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182629146.png" alt="image-20240216182629146"></p>
<h1 id="0x03-扫描类型概述">0x03 扫描类型概述</h1>
<p>使用Nmap进行端口扫描时，有三种基本扫描类型。这些都是：</p>
<ul>
<li>TCP 连接扫描 ( <code>-sT</code> )</li>
<li>SYN“半开”扫描 ( <code>-sS</code> )</li>
<li>UDP 扫描 ( <code>-sU</code> )</li>
</ul>
<p>此外，还有几种不太常见的端口扫描类型，我们还将介绍其中一些类型（尽管不太详细）。这些都是：</p>
<ul>
<li>TCP 空扫描 ( <code>-sN</code> )</li>
<li>TCP FIN 扫描 ( <code>-sF</code> )</li>
<li>TCP 圣诞节扫描 ( <code>-sX</code> )</li>
</ul>
<p>其中大多数（UDP 扫描除外）的用途非常相似，但是每次扫描的工作方式有所不同。这意味着，虽然在大多数情况下您可能会选择前三种扫描之一，但值得注意的是还存在其他扫描类型。</p>
<p>在网络扫描方面，我们还将简要介绍一下 ICMP（或“ping”）扫描。</p>
<h1 id="0x04-tcp-扫描">0x04 TCP 扫描</h1>
<p>要了解 TCP 连接扫描 ( <code>-sT</code> )，熟悉 TCP 三向握手非常重要。如果您对这个术语比较陌生，那么建议您先完成网络介绍，然后再继续。</p>
<p>简要回顾一下，三向握手由三个阶段组成。首先，连接终端（在本例中是我们的攻击机器）向目标服务器发送一个设置了 SYN 标志的 TCP 请求。然后，服务器使用包含 SYN 标志以及 ACK 标志的 TCP 响应来确认该数据包。最后，我们的终端通过发送设置了 ACK 标志的 TCP 请求来完成握手。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216182935748.png" alt="image-20240216182935748"></p>
<p>这是 TCP/IP 网络的基本原则之一，但它与 Nmap 有何关系？</p>
<p>顾名思义，TCP Connect 扫描的工作原理是依次与每个目标端口执行三向握手。换句话说，Nmap 尝试连接到每个指定的 TCP 端口，并通过收到的响应来确定服务是否打开。</p>
<p>例如，如果端口关闭，RFC 9293 指出：</p>
<p>“…如果连接不存在（关闭），则将发送重置以响应除另一个重置之外的任何传入分段。通过这种方式拒绝与现有连接不匹配的 SYN 分段。”</p>
<p>换句话说，如果Nmap向关闭的端口发送设置了SYN标志的TCP请求，目标服务器将使用设置了RST（重置）标志的TCP数据包进行响应。通过此响应，Nmap 可以确定端口已关闭。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183041765.png" alt="image-20240216183041765"></p>
<p>但是，如果请求发送到开放端口，目标将使用设置了 SYN/ACK 标志的 TCP 数据包进行响应。然后，Nmap 将此端口标记为打开（并通过发回设置了 ACK 的 TCP 数据包来完成握手）。</p>
<p>这一切都很好，但是，还有第三种可能性。</p>
<p>如果端口是开放的，但隐藏在防火墙后面怎么办？</p>
<p>许多防火墙配置为简单地丢弃传入数据包。 Nmap 发送 TCP SYN 请求，但没有收到任何回复。这表明该端口受到防火墙保护，因此该端口被视为被过滤。</p>
<p>也就是说，配置防火墙以响应 RST TCP 数据包非常容易。例如，在 Linux 的 IPtables 中，命令的简单版本如下：</p>
<pre><code class="hljs scss">iptables -<span class="hljs-selector-tag">I</span> <span class="hljs-selector-tag">INPUT</span> -<span class="hljs-selector-tag">p</span> tcp <span class="hljs-attr">--dport</span> &lt;port&gt; -j REJECT <span class="hljs-attr">--reject-with</span> tcp-reset</code></pre>
<p>这使得获得目标的准确读数变得极其困难（如果不是不可能的话）。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183218824.png" alt="image-20240216183218824"></p>
<h1 id="0x05-syn-扫描">0x05 SYN 扫描</h1>
<p>与 TCP 扫描一样，SYN 扫描 ( <code>-sS</code> ) 用于扫描一个或多个目标的 TCP 端口范围；然而，这两种扫描类型的工作方式略有不同。 SYN 扫描有时称为“半开放”扫描或“隐形”扫描。</p>
<p>TCP 扫描与目标执行完整的三向握手，SYN 扫描在从服务器接收到 SYN/ACK 后发回 RST TCP 数据包（这可以防止服务器重复尝试发出请求）。换句话说，扫描开放端口的顺序如下所示：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183300156.png" alt="image-20240216183300156"></p>
<p>这对于我们黑客来说有很多好处：</p>
<ul>
<li>它可用于绕过旧的入侵检测系统，因为它们正在寻找完整的三向握手。现代 IDS 解决方案通常不再出现这种情况；正是由于这个原因，SYN 扫描仍然经常被称为“隐形”扫描。</li>
<li>侦听开放端口的应用程序通常不会记录 SYN 扫描，因为标准做法是在完全建立连接后记录连接。这再次体现了 SYN 扫描的隐秘性。</li>
<li>无需费心为每个端口完成（和断开连接）三向握手，SYN 扫描比标准 TCP 连接扫描要快得多。</li>
</ul>
<p>然而，SYN 扫描有一些缺点，即：</p>
<ul>
<li>它们需要 sudo 权限 [1] 才能在 Linux 中正常工作。这是因为 SYN 扫描需要能够创建原始数据包（而不是完整的 TCP 握手），默认情况下只有 root 用户才拥有此权限。</li>
<li>不稳定的服务有时会因 SYN 扫描而中断，如果客户端提供了用于测试的生产环境，这可能会出现问题。</li>
</ul>
<p>总而言之，利大于弊。</p>
<p>因此，如果使用 sudo 权限运行，SYN 扫描是 Nmap 使用的默认扫描。如果在没有 sudo 权限的情况下运行，Nmap 默认进行我们在上一个任务中看到的 TCP 连接扫描。</p>
<p>当使用 SYN 扫描来识别关闭和过滤的端口时，适用与 TCP 连接扫描完全相同的规则。</p>
<p>如果端口关闭，则服务器会使用 RST TCP 数据包进行响应。如果端口被防火墙过滤，则 TCP SYN 数据包将被丢弃，或者通过 TCP 重置进行欺骗。</p>
<p>在这方面，两次扫描是相同的：最大的区别在于它们处理开放端口的方式。</p>
<p>[1] 还可以通过为 Nmap 提供 CAP_NET_RAW、CAP_NET_ADMIN 和 CAP_NET_BIND_SERVICE 功能来使 SYN 扫描发挥作用；但是，这可能无法让许多 NSE 脚本正常运行。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216183522702.png" alt="image-20240216183522702"></p>
<h1 id="0x06-udp-扫描">0x06 UDP 扫描</h1>
<p>与 TCP 不同，UDP 连接是无状态的。这意味着，UDP 连接不是通过来回“握手”来启动连接，而是依赖于将数据包发送到目标端口，并本质上希望它们能够成功。这使得 UDP 非常适合依赖速度而不是质量的连接（例如视频共享），但缺乏确认使得 UDP 扫描变得更加困难（并且速度慢得多）。 Nmap UDP 扫描的开关是 ( <code>-sU</code> )</p>
<p>当数据包发送到开放的 UDP 端口时，不应有响应。发生这种情况时，Nmap 将端口称为 <code>open|filtered</code> 。换句话说，它怀疑端口是开放的，但可能被防火墙阻止。如果它收到 UDP 响应（这是非常不寻常的），则该端口被标记为打开。更常见的是没有响应，在这种情况下，会再次发送请求以进行双重检查。如果仍然没有响应，则端口被标记为打开|已过滤并且 Nmap 继续前进。</p>
<p>当数据包发送到关闭的 UDP 端口时，目标应使用 ICMP (ping) 数据包进行响应，其中包含该端口无法访问的消息。这清楚地识别了关闭的端口，Nmap 将其标记为关闭的端口并继续前进。</p>
<p>由于难以识别 UDP 端口是否实际打开，因此与各种 TCP 扫描相比，UDP 扫描往往非常慢（在连接良好的情况下扫描前 1000 个端口大约需要 20 分钟）。因此，在启用 <code>--top-ports &lt;number&gt;</code> 的情况下运行 Nmap 扫描通常是一个好习惯。例如，使用 <code>nmap -sU --top-ports 20 &lt;target&gt;</code> 进行扫描。将扫描前 20 个最常用的 UDP 端口，从而获得更可接受的扫描时间。</p>
<p>当扫描 UDP 端口时，Nmap 通常发送完全空的请求——只是原始的 UDP 数据包。也就是说，对于通常被知名服务占用的端口，它将发送特定于协议的有效负载，该有效负载更有可能引发响应，从而得出更准确的结果。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184103251.png" alt="image-20240216184103251"></p>
<h1 id="0x07-null-fin-xmas扫描">0x07 NULL、FIN、Xmas扫描</h1>
<p>NULL、FIN 和 Xmas TCP 端口扫描比我们已经介绍过的其他端口扫描不太常用，因此我们不会在这里深入讨论。这三者都是相互关联的，之所以使用，主要是因为相对而言，它们比 SYN“隐形”扫描更加隐蔽。从 NULL 扫描开始：</p>
<ul>
<li>顾名思义，NULL 扫描 ( <code>-sN</code> ) 是指发送 TCP 请求时根本没有设置任何标志。根据 RFC，如果端口关闭，目标主机应使用 RST 进行响应。</li>
</ul>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184306773.png" alt="image-20240216184306773"></p>
<ul>
<li>FIN 扫描 ( <code>-sF</code> ) 的工作方式几乎相同；但是，不是发送完全空的数据包，而是发送带有 FIN 标志的请求（通常用于正常关闭活动连接）。如果端口关闭，Nmap 再次期望 RST。</li>
</ul>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184329439.png" alt="image-20240216184329439"></p>
<ul>
<li>与此类中的其他两个扫描一样，Xmas 扫描 ( <code>-sX</code> ) 发送格式错误的 TCP 数据包，并期望关闭端口的 RST 响应。它被称为圣诞扫描，因为当在 Wireshark 中将其视为数据包捕获时，它设置的标志（PSH、URG 和 FIN）使其看起来像一棵闪烁的圣诞树。</li>
</ul>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184406875.png" alt="image-20240216184406875"></p>
<p>这些扫描对开放端口的预期响应也是相同的，并且与 UDP 扫描的响应非常相似。如果端口打开，则不会对格式错误的数据包做出响应。不幸的是（与开放的 UDP 端口一样），如果端口受防火墙保护，这也是预期的行为，因此 NULL、FIN 和 Xmas 扫描将仅将端口识别为开放|过滤、关闭或过滤。如果某个端口被这些扫描之一识别为已过滤，则通常是因为目标已响应 ICMP 无法到达的数据包。</p>
<p>还值得注意的是，虽然 RFC 793 要求网络主机对关闭端口使用 RST TCP 数据包响应格式错误的数据包，而对开放端口根本不响应；实际情况并非总是如此。特别是，众所周知，Microsoft Windows（以及许多 Cisco 网络设备）会使用 RST 响应任何格式错误的 TCP 数据包 - 无论端口是否实际打开。这会导致所有端口显示为关闭。</p>
<p>也就是说，这里的目标当然是绕过防火墙。许多防火墙配置为将传入的 TCP 数据包丢弃到设置了 SYN 标志的阻止端口（从而阻止新的连接发起请求）。通过发送不包含 SYN 标志的请求，我们可以有效地绕过这种防火墙。虽然这在理论上很好，但大多数现代 IDS 解决方案都熟悉这些扫描类型，因此在处理现代系统时不要依赖它们 100% 有效。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216184836853.png" alt="image-20240216184836853"></p>
<h1 id="0x08-icmp-扫描">0x08 ICMP 扫描</h1>
<p>在黑盒分配中首次连接到目标网络时，我们的第一个目标是获取网络结构的“地图”，或者换句话说，我们希望查看哪些 IP 地址包含活动主机，哪些不包含活动主机。</p>
<p>实现此目的的一种方法是使用 Nmap 执行所谓的“ping 扫描”。顾名思义，Nmap 向指定网络的每个可能的 IP 地址发送 ICMP 数据包。当它收到响应时，它将响应的 IP 地址标记为活动的。由于我们将在后面的任务中看到的原因，这并不总是准确的；然而，它可以提供一些基线，因此值得讨论。</p>
<p>为了执行 ping 扫描，我们将 <code>-sn</code> 开关与 IP 范围结合使用，可以使用连字符 ( <code>-</code> ) 或 CIDR 表示法指定 IP 范围。即我们可以使用以下命令扫描 <code>192.168.0.x</code> 网络：</p>
<ul>
<li><code>nmap -sn 192.168.0.1-254</code>or <code>nmap -sn 192.168.0.0/24</code></li>
</ul>
<p><code>-sn</code> 开关告诉 Nmap 不要扫描任何端口——强制它主要依靠 ICMP 回显数据包（或本地网络上的 ARP 请求，如果使用 sudo 运行或直接以 root 用户身份运行）来识别目标。除了 ICMP 回显请求之外， <code>-sn</code> 开关还会导致 nmap 向目标的端口 443 发送 TCP SYN 数据包以及 TCP ACK（如果不以 root 身份运行，则发送 TCP SYN）数据包发送至目标的 80 端口。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216185316277.png" alt="image-20240216185316277"></p>
<p>这里图上去掉+符号</p>
<h1 id="0x09-nse-脚本概述">0x09 NSE 脚本概述</h1>
<p>Nmap 脚本引擎 (NSE) 是 Nmap 的一个非常强大的补充，相当大地扩展了它的功能。 NSE 脚本是用 Lua 编程语言编写的，可用于执行多种操作：从扫描漏洞到自动利用漏洞。 NSE 对于侦察特别有用，但是，值得注意的是脚本库的范围有多大。</p>
<p>有很多类别可供选择。一些有用的类别包括：</p>
<ul>
<li><code>safe</code> :- 不会影响目标</li>
<li><code>intrusive</code> ：- 不安全：可能影响目标</li>
<li><code>vuln</code> ：- 扫描漏洞</li>
<li><code>exploit</code> ：- 尝试利用漏洞</li>
<li><code>auth</code> ：- 尝试绕过正在运行的服务的身份验证（例如匿名登录 FTP 服务器）</li>
<li><code>brute</code> ：- 尝试暴力破解正在运行的服务的凭据</li>
<li><code>discovery</code> ：- 尝试查询正在运行的服务以获取有关网络的更多信息（例如查询 SNMP 服务器）。</li>
</ul>
<p>可以在此处找到更详尽的列表：<a target="_blank" rel="noopener" href="https://nmap.org/book/nse-usage.html">here</a></p>
<p>在下一个任务中，我们将了解如何与 NSE 交互并使用这些类别中的脚本。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216185557080.png" alt="image-20240216185557080"></p>
<h1 id="0x10-使用-nse-脚本">0x10 使用 NSE 脚本</h1>
<p>在任务 3 中，我们非常简要地了解了使用 <code>--script=vuln</code> 从 <code>vuln</code> 类别激活 NSE 脚本的 <code>--script</code> 开关。其他类别的工作方式完全相同也就不足为奇了。如果运行命令 <code>--script=safe</code> ，则将针对目标运行任何适用的安全脚本（注意：仅激活针对活动服务的脚本）。</p>
<p>要运行特定脚本，我们将使用 <code>--script=&lt;script-name&gt;</code> ，例如 <code>--script=http-fileupload-exploiter</code> 。</p>
<p>通过用逗号分隔多个脚本可以以这种方式同时运行。例如： <code>--script=smb-enum-users,smb-enum-shares</code> 。</p>
<p>某些脚本需要参数（例如，凭据，如果它们正在利用经过身份验证的漏洞）。这些可以通过 <code>--script-args</code> Nmap 开关给出。一个例子是 <code>http-put</code> 脚本（用于使用 PUT 方法上传文件）。这需要两个参数：将文件上传到的 URL 以及文件在磁盘上的位置。例如：</p>
<pre><code class="hljs scss">nmap -<span class="hljs-selector-tag">p</span> <span class="hljs-number">80</span> <span class="hljs-attr">--script</span> http-put <span class="hljs-attr">--script-args</span> http-put<span class="hljs-selector-class">.url</span>='/dav/shell<span class="hljs-selector-class">.php</span>',http-put<span class="hljs-selector-class">.file</span>='./shell<span class="hljs-selector-class">.php</span>'</code></pre>
<p>请注意，参数以逗号分隔，并用句点连接到相应的脚本（即 <code>&lt;script-name&gt;.&lt;argument&gt;</code> ）。</p>
<p>可以在此处找到脚本及其相应参数（以及示例用例）的完整列表：<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/">here</a></p>
<p>Nmap 脚本带有内置帮助菜单，可以使用 <code>nmap --script-help &lt;script-name&gt;</code> 访问。这往往不像上面给出的链接那么广泛，但是，在本地工作时它仍然很有用。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190408747.png" alt="image-20240216190408747"></p>
<h1 id="0x11-nse-搜索脚本">0x11 NSE 搜索脚本</h1>
<p>好的，我们知道了如何使用 Nmap 中的脚本，但我们还不知道如何找到这些脚本。</p>
<p>为此，我们有两种选择，最好将它们结合使用。第一个是 Nmap 网站上的页面（在上一个任务中提到），其中包含所有官方脚本的列表。第二个是攻击机器上的本地存储。 Nmap 将其脚本存储在 Linux 上的 <code>/usr/share/nmap/scripts</code> 处。默认情况下，所有 NSE 脚本都存储在该目录中——当您指定脚本时，Nmap 会在该目录中查找脚本。</p>
<p>有两种方法可以搜索已安装的脚本。一种是使用 <code>/usr/share/nmap/scripts/script.db</code> 文件。尽管有扩展名，但这实际上并不是一个数据库，而是一个包含每个可用脚本的文件名和类别的格式化文本文件。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190524152.png" alt="image-20240216190524152"></p>
<p>Nmap 使用此文件来跟踪（并利用）脚本引擎的脚本；但是，我们也可以通过 grep 来查找脚本。例如： <code>grep "ftp" /usr/share/nmap/scripts/script.db</code> 。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190540863.png" alt="image-20240216190540863"></p>
<p>搜索脚本的第二种方法非常简单，使用 <code>ls</code> 命令。例如，我们可以使用 <code>ls -l /usr/share/nmap/scripts/*ftp*</code> 获得与上一个屏幕截图相同的结果：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190618291.png" alt="image-20240216190618291"></p>
<p>请注意搜索词两侧使用星号 ( <code>*</code> )相同的技术也可用于搜索脚本类别。例如：<br>
<code>grep "safe" /usr/share/nmap/scripts/script.db</code></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216190644073.png" alt="image-20240216190644073"></p>
<p>我们之前提到过，Nmap 网站包含一系列脚本，那么，如果本地 <code>scripts</code> 目录中缺少其中一个脚本，会发生什么情况？标准 <code>sudo apt update &amp;&amp; sudo apt install nmap</code> 应该可以解决这个问题；但是，也可以通过从 Nmap ( <code>sudo wget -O /usr/share/nmap/scripts/&lt;script-name&gt;.nse https://svn.nmap.org/nmap/scripts/&lt;script-name&gt;.nse</code> ) 下载脚本来手动安装脚本。然后必须跟随着 <code>nmap --script-updatedb</code> ，它更新 <code>script.db</code> 文件以包含新下载的脚本。</p>
<p>值得注意的是，如果您要制作自己的 NSE 脚本并将其添加到 Nmap 中，则需要相同的“updatedb”命令——这是一项非常易于管理的任务，只需具备一些 Lua 基础知识即可！</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216191029146.png" alt="image-20240216191029146"></p>
<p>第二问题问的是依赖：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216191046335.png" alt="image-20240216191046335"></p>
<h1 id="0x12-防火墙规避">0x12 防火墙规避</h1>
<p>我们已经看到了一些绕过防火墙的技术（想想隐形扫描，以及 NULL、FIN 和 Xmas 扫描）；然而，还有另一种非常常见的防火墙配置，我们必须知道如何绕过它。</p>
<p>您的典型 Windows 主机将使用其默认防火墙阻止所有 ICMP 数据包。这就带来了一个问题：我们不仅经常使用 ping 来手动建立目标的活动，Nmap 默认情况下也会做同样的事情。这意味着 Nmap 会将具有此防火墙配置的主机注册为死亡主机，并且根本不扫描它。</p>
<p>因此，我们需要一种方法来绕过这个配置。幸运的是，Nmap 为此提供了一个选项： <code>-Pn</code> ，它告诉 Nmap 在扫描主机之前不必费心 ping 主机。这意味着 Nmap 将始终将目标主机视为活动的，从而有效地绕过 ICMP 块；然而，它的代价是可能需要很长时间才能完成扫描（如果主机确实死了，那么 Nmap 仍然会检查并仔细检查每个指定的端口）。</p>
<p>值得注意的是，如果您已经直接位于本地网络上，Nmap 还可以使用 ARP 请求来确定主机活动。</p>
<p>Nmap 认为还有多种其他开关可用于规避防火墙。我们不会详细介绍这些内容，但是可以在这里找到它们：<a target="_blank" rel="noopener" href="https://nmap.org/book/man-bypass-firewalls-ids.html">here</a></p>
<p>以下开关尤其值得注意：</p>
<ul>
<li><code>-f</code> ：- 用于对数据包进行分段（即将它们分成更小的部分），从而降低防火墙或 IDS 检测到数据包的可能性。</li>
<li><code>-f</code> 的替代方案，但提供对数据包大小的更多控制： <code>--mtu &lt;number&gt;</code> ，接受用于发送的数据包的最大传输单元大小。这必须是 8 的倍数。</li>
<li><code>--scan-delay &lt;time&gt;ms</code> ：- 用于在发送的数据包之间添加延迟。如果网络不稳定，这非常有用，而且还可以逃避任何可能存在的基于时间的防火墙/IDS 触发器。</li>
<li><code>--badsum</code> ：- 这用于生成数据包的无效校验和。任何真正的 TCP/IP 堆栈都会丢弃此数据包，但是，防火墙可能会自动响应，而无需检查数据包的校验和。因此，该开关可用于确定防火墙/IDS 的存在。</li>
</ul>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216191652525.png" alt="image-20240216191652525"></p>
<h1 id="0x13-实践">0x13 实践</h1>
<p>采用直接ping目标机或者nmap 的-PE选项确定ping请求</p>
<pre><code class="hljs scss">nmap -sX -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1</span>-<span class="hljs-number">999</span> -Pn <span class="hljs-number">10.10</span><span class="hljs-selector-class">.162</span><span class="hljs-selector-class">.155</span> -vv</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193100002.png" alt="image-20240216193100002"></p>
<p>这里说999个端口都是被过滤的</p>
<pre><code class="hljs scss">nmap -sS -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1</span>-<span class="hljs-number">5000</span> -Pn <span class="hljs-number">10.10</span><span class="hljs-selector-class">.162</span><span class="hljs-selector-class">.155</span> -vv</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193418154.png" alt="image-20240216193418154"></p>
<pre><code class="hljs scss">nmap -Pn <span class="hljs-attr">--script</span>=ftp-anon -<span class="hljs-selector-tag">p</span> <span class="hljs-number">21</span> <span class="hljs-number">10.10</span><span class="hljs-selector-class">.162</span><span class="hljs-selector-class">.155</span> -vv</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193801089.png" alt="image-20240216193801089"></p>
<p>可以看到允许登录21端口</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240216193832775.png" alt="image-20240216193832775"></p>
<h1 id="0x14-参考文章">0x14 参考文章</h1>
<p><a target="_blank" rel="noopener" href="https://grumpyghost1011.medium.com/nmap-room-tryhackme-walkthrough-%EF%B8%8F-4fdf25829f1d"><strong>Nmap Room Tryhackme Walkthrough</strong></a></p>
<h1 id="0x15-nmap-后端口扫描">0x15 Nmap 后端口扫描</h1>
<p>这里就当做nmap命令的笔记吧</p>
<p>本房间是 Nmap 系列的最后一个（网络安全简介模块的一部分）。在这个房间中，我们重点关注端口扫描之后的步骤：特别是服务检测、操作系统检测、Nmap 脚本引擎和保存扫描结果。</p>
<h2 id="服务检测">服务检测</h2>
<p>一旦 Nmap 发现开放端口，您就可以探测可用端口来检测正在运行的服务。对开放端口的进一步调查是重要的信息，因为渗透测试人员可以使用它来了解该服务是否存在任何已知的漏洞。加入<a target="_blank" rel="noopener" href="https://tryhackme.com/room/vulnerabilities101">漏洞 101</a> 了解有关搜索易受攻击服务的更多信息。</p>
<p>将 <code>-sV</code> 添加到 Nmap 命令将收集并确定开放端口的服务和版本信息。您可以使用 <code>--version-intensity LEVEL</code> 控制强度，其中级别范围为 0（最轻）和 9（最完整）。 <code>-sV --version-light</code> 的强度为 2，而 <code>-sV --version-all</code> 的强度为 9。</p>
<p>需要注意的是，使用 <code>-sV</code> 将强制 Nmap 继续进行 TCP 3 次握手并建立连接。连接建立是必要的，因为如果不完全建立连接并与监听服务通信，Nmap 就无法发现版本。换句话说，当选择 <code>-sV</code> 选项时，秘密SYN扫描 <code>-sS</code> 是不可能的。</p>
<p>下面的控制台输出显示了带有 <code>-sV</code> 选项的简单 Nmap 隐形 SYN 扫描。添加 <code>-sV</code> 选项会导致输出中出现一个新列，显示每个检测到的服务的版本。例如，在 TCP 端口 22 打开的情况下，我们获取的不是 <code>22/tcp open ssh</code> ，而是 <code>22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)</code> 。请注意，SSH 协议被猜测为服务，因为 TCP 端口 22 已打开； Nmap 不需要连接到端口 22 来确认。但是， <code>-sV</code> 需要连接到此开放端口以获取服务横幅及其可以获得的任何版本信息，例如 <code>nginx 1.6.2</code> 。因此，与服务列不同，版本列不是猜测。</p>
<p>请注意，许多 Nmap 选项需要 root 权限。除非您以 root 身份运行 Nmap，否则您需要使用 <code>sudo</code> 。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310103247817.png" alt="image-20240310103247817"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310103252532.png" alt="image-20240310103252532"></p>
<h2 id="操作系统检测和traceroute">操作系统检测和Traceroute</h2>
<h3 id="操作系统检测">操作系统检测</h3>
<p>Nmap 可以根据操作系统 (OS) 的行为及其响应中的任何迹象来检测操作系统 (OS)。可以使用 <code>-O</code> 启用操作系统检测；这是 OS 中的大写 O。在此示例中，我们在 AttackBox 上运行 <code>nmap -sS -O 10.10.212.228</code> 。 Nmap检测到操作系统是Linux 3.X，然后进一步猜测它运行的是内核3.13。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ sudo nmap -sS -O <span class="hljs-number">10.10</span>.<span class="hljs-number">212.228</span>

Starting Nmap <span class="hljs-number">7.60</span> ( <span class="hljs-attribute">https</span>://nmap.org ) at <span class="hljs-number">2021</span>-<span class="hljs-number">09</span>-<span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">04</span> BST
Nmap <span class="hljs-attribute">scan</span> report for <span class="hljs-number">10.10</span>.<span class="hljs-number">212.228</span>
Host is up (<span class="hljs-number">0.00099s</span> latency).
<span class="hljs-keyword">Not</span> <span class="hljs-attribute">shown</span>: <span class="hljs-number">994</span> closed ports
PORT    STATE SERVICE
<span class="hljs-number">22</span>/tcp  open  ssh
<span class="hljs-number">25</span>/tcp  open  smtp
<span class="hljs-number">80</span>/tcp  open  http
<span class="hljs-number">110</span>/tcp open  pop3
<span class="hljs-number">111</span>/tcp open  rpcbind
<span class="hljs-number">143</span>/tcp open  imap
MAC <span class="hljs-attribute">Address</span>: <span class="hljs-number">02</span>:A0:E7:B5:B6:C5 (Unknown)
Device <span class="hljs-attribute">type</span>: general purpose
<span class="hljs-attribute">Running</span>: Linux <span class="hljs-number">3</span>.X
OS <span class="hljs-attribute">CPE</span>: <span class="hljs-attribute">cpe</span>:/<span class="hljs-attribute">o</span>:<span class="hljs-attribute">linux</span>:linux_<span class="hljs-attribute">kernel</span>:<span class="hljs-number">3.13</span>
OS <span class="hljs-attribute">details</span>: Linux <span class="hljs-number">3.13</span>
Network <span class="hljs-attribute">Distance</span>: <span class="hljs-number">1</span> hop

OS detection performed. Please report any incorrect results at <span class="hljs-attribute">https</span>://nmap.org/submit/ .
Nmap <span class="hljs-attribute">done</span>: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">3.91</span> seconds</code></pre>
<p>我们扫描并尝试检测其操作系统版本的系统正在运行内核版本 3.16。 Nmap 能够在这种情况下做出接近的猜测。在另一个案例中，我们扫描了内核为5.13.14的Fedora Linux系统；然而，Nmap 检测到它是 Linux 2.6.X。好消息是 Nmap 正确检测到操作系统；不太好的消息是内核版本错误。</p>
<p>操作系统检测非常方便，但许多因素可能会影响其准确性。首先，Nmap需要在目标上找到至少一个开放端口和一个关闭端口才能进行可靠的猜测。此外，由于虚拟化和类似技术的广泛使用，客户操作系统的指纹可能会变得扭曲。因此，在使用操作系统版本信息时，要持有怀疑态度。</p>
<h3 id="路由追踪">路由追踪</h3>
<p>如果你想让 Nmap 找到你和目标之间的路由器，只需添加 <code>--traceroute</code> 。在以下示例中，Nmap 将跟踪路由附加到其扫描结果中。请注意，Nmap 的跟踪路由的工作方式与 Linux 和 macOS 上的 <code>traceroute</code> 命令或 MS Windows 上的 <code>tracert</code> 命令略有不同。标准 <code>traceroute</code> 以低 TTL（生存时间）数据包开始，并不断增加直至到达目标。 Nmap 的跟踪路由从高 TTL 的数据包开始，并不断减少它。</p>
<p>在下面的示例中，我们在 AttackBox 上执行了 <code>nmap -sS --traceroute 10.10.212.228</code> 。我们可以看到两者之间没有路由器/跃点，因为它们是直接连接的。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ sudo nmap -sS --traceroute <span class="hljs-number">10.10</span>.<span class="hljs-number">212.228</span>

Starting Nmap <span class="hljs-number">7.60</span> ( <span class="hljs-attribute">https</span>://nmap.org ) at <span class="hljs-number">2021</span>-<span class="hljs-number">09</span>-<span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">05</span> BST
Nmap <span class="hljs-attribute">scan</span> report for <span class="hljs-number">10.10</span>.<span class="hljs-number">212.228</span>
Host is up (<span class="hljs-number">0.0015s</span> latency).
<span class="hljs-keyword">Not</span> <span class="hljs-attribute">shown</span>: <span class="hljs-number">994</span> closed ports
PORT    STATE SERVICE
<span class="hljs-number">22</span>/tcp  open  ssh
<span class="hljs-number">25</span>/tcp  open  smtp
<span class="hljs-number">80</span>/tcp  open  http
<span class="hljs-number">110</span>/tcp open  pop3
<span class="hljs-number">111</span>/tcp open  rpcbind
<span class="hljs-number">143</span>/tcp open  imap
MAC <span class="hljs-attribute">Address</span>: <span class="hljs-number">02</span>:A0:E7:B5:B6:C5 (Unknown)

TRACEROUTE
HOP RTT     ADDRESS
<span class="hljs-number">1</span>   <span class="hljs-number">1.48</span> ms MACHINE_IP

Nmap <span class="hljs-attribute">done</span>: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">1.59</span> seconds</code></pre>
<p>值得一提的是，许多路由器都配置为不发送超出生存时间的 ICMP，这会阻止我们发现它们的 IP 地址。欲了解更多信息，请访问主动侦察室。</p>
<pre><code class="hljs scss">nmap -sS -O <span class="hljs-number">10.10</span><span class="hljs-selector-class">.212</span><span class="hljs-selector-class">.228</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310105353268.png" alt="image-20240310105353268"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310105431451.png" alt="image-20240310105431451"></p>
<h2 id="nmap-脚本-nse">Nmap 脚本 NSE</h2>
<p>脚本是一段不需要编译的代码。换句话说，它保持原来的人类可读形式，不需要转换为机器语言。许多程序通过脚本提供附加功能；此外，脚本可以添加通过内置命令不存在的自定义功能。同样，Nmap 也提供对使用 Lua 语言的脚本的支持。 Nmap 脚本引擎（NSE）是 Nmap 的一部分，是一个 Lua 解释器，允许 Nmap 执行用 Lua 语言编写的 Nmap 脚本。然而，我们不需要学习 Lua 来使用 Nmap 脚本。</p>
<p>您的 Nmap 默认安装可以轻松包含近 600 个脚本。查看 Nmap 安装文件夹。在 AttackBox 上，检查 <code>/usr/share/nmap/scripts</code> 处的文件，您会注意到有数百个脚本，以它们的目标协议开头，方便命名。我们在下面的控制台输出中列出了 AttackBox 上以 HTTP 开头的所有脚本；我们发现了大约 130 个以 http 开头的脚本。随着未来的更新，您只能期望安装的脚本数量会增加。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310105636735.png" alt="image-20240310105636735"></p>
<p>您可以指定使用这些已安装脚本中的任何一个或一组；此外，您可以安装其他用户的脚本并将其用于扫描。让我们从默认脚本开始。您可以选择使用 <code>--script=default</code> 或简单地添加 <code>-sC</code> 来运行默认类别中的脚本。除了默认之外，类别还包括身份验证、广播、暴力、默认、发现、dos、漏洞利用、外部、模糊器、侵入、恶意软件、安全、版本和漏洞。简要说明如下表所示。</p>
<table>
<thead>
<tr>
<th>Script Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>auth</code></td>
<td>认证相关脚本</td>
</tr>
<tr>
<td><code>broadcast</code></td>
<td>通过发送广播消息发现主机</td>
</tr>
<tr>
<td><code>brute</code></td>
<td>对登录执行暴力密码审核</td>
</tr>
<tr>
<td><code>default</code></td>
<td>默认脚本，与 <code>-sC</code> 相同</td>
</tr>
<tr>
<td><code>discovery</code></td>
<td>检索可访问的信息，例如数据库表和 DNS 名称</td>
</tr>
<tr>
<td><code>dos</code></td>
<td>检测易受拒绝服务 (DoS) 攻击的服务器</td>
</tr>
<tr>
<td><code>exploit</code></td>
<td>尝试利用各种易受攻击的服务</td>
</tr>
<tr>
<td><code>external</code></td>
<td>使用第三方服务进行检查，例如 Geoplugin 和 Virustotal</td>
</tr>
<tr>
<td><code>fuzzer</code></td>
<td>发起模糊攻击</td>
</tr>
<tr>
<td><code>intrusive</code></td>
<td>暴力攻击和利用等侵入性脚本</td>
</tr>
<tr>
<td><code>malware</code></td>
<td>扫描后门</td>
</tr>
<tr>
<td><code>safe</code></td>
<td>不会使目标崩溃的安全脚本</td>
</tr>
<tr>
<td><code>version</code></td>
<td>检索服务版本</td>
</tr>
<tr>
<td><code>vuln</code></td>
<td>检查漏洞或利用易受攻击的服务</td>
</tr>
</tbody>
</table>
<p>有些脚本属于多个类别。此外，一些脚本对服务发起暴力攻击，而另一些脚本则发起 DoS 攻击并利用系统。因此，如果您不想使服务崩溃或利用它们，那么在选择要运行的脚本时要小心，这一点至关重要。</p>
<p>我们使用 Nmap 对 <code>10.10.104.195</code> 运行 SYN 扫描，并在控制台中执行默认脚本，如下所示。该命令是 <code>sudo nmap -sS -sC 10.10.104.195</code> ，其中 <code>-sC</code> 将确保 Nmap 在 SYN 扫描之后执行默认脚本。下面出现了新的详细信息。查看22端口的SSH服务； Nmap 恢复了与正在运行的服务器相关的所有四个公钥。考虑另一个例子，端口 80 上的 HTTP 服务； Nmap 检索默认页面标题。我们可以看到该页面已保留为默认页面。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ sudo nmap -sS -sC <span class="hljs-number">10.10</span>.<span class="hljs-number">104.195</span>

Starting Nmap <span class="hljs-number">7.60</span> ( <span class="hljs-attribute">https</span>://nmap.org ) at <span class="hljs-number">2021</span>-<span class="hljs-number">09</span>-<span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">08</span> BST
Nmap <span class="hljs-attribute">scan</span> report for ip-<span class="hljs-number">10</span>-<span class="hljs-number">10</span>-<span class="hljs-number">161</span>-<span class="hljs-number">170</span>.eu-west-<span class="hljs-number">1</span>.compute.internal (<span class="hljs-number">10.10</span>.<span class="hljs-number">161.170</span>)
Host is up (<span class="hljs-number">0.0011s</span> latency).
<span class="hljs-keyword">Not</span> <span class="hljs-attribute">shown</span>: <span class="hljs-number">994</span> closed ports
PORT    STATE SERVICE
<span class="hljs-number">22</span>/tcp  open  ssh
| <span class="hljs-attribute">ssh-hostkey</span>: 
|   <span class="hljs-number">1024</span> d5:<span class="hljs-number">80</span>:<span class="hljs-number">97</span>:a3:a8:<span class="hljs-number">3</span><span class="hljs-attribute">b</span>:<span class="hljs-number">57</span>:<span class="hljs-number">78</span>:<span class="hljs-number">2</span><span class="hljs-attribute">f</span>:<span class="hljs-number">0</span><span class="hljs-attribute">a</span>:<span class="hljs-number">78</span>:<span class="hljs-attribute">ae</span>:<span class="hljs-attribute">ad</span>:<span class="hljs-number">34</span>:<span class="hljs-number">24</span>:f4 (DSA)
|   <span class="hljs-number">2048</span> <span class="hljs-attribute">aa</span>:<span class="hljs-number">66</span>:<span class="hljs-number">7</span><span class="hljs-attribute">a</span>:<span class="hljs-number">45</span>:<span class="hljs-attribute">eb</span>:d1:<span class="hljs-number">8</span><span class="hljs-attribute">c</span>:<span class="hljs-number">00</span>:e3:<span class="hljs-number">12</span>:<span class="hljs-number">31</span>:d8:<span class="hljs-number">76</span>:<span class="hljs-number">8</span><span class="hljs-attribute">e</span>:<span class="hljs-attribute">ed</span>:<span class="hljs-number">3</span>a (RSA)
|   <span class="hljs-number">256</span> <span class="hljs-number">3</span><span class="hljs-attribute">d</span>:<span class="hljs-number">82</span>:<span class="hljs-number">72</span>:a3:<span class="hljs-number">07</span>:<span class="hljs-number">49</span>:<span class="hljs-number">2</span><span class="hljs-attribute">e</span>:<span class="hljs-attribute">cb</span>:d9:<span class="hljs-number">87</span>:<span class="hljs-attribute">db</span>:<span class="hljs-number">08</span>:c6:<span class="hljs-number">90</span>:<span class="hljs-number">56</span>:<span class="hljs-number">65</span> (ECDSA)
|_  <span class="hljs-number">256</span> <span class="hljs-attribute">dc</span>:f0:<span class="hljs-number">0</span><span class="hljs-attribute">c</span>:<span class="hljs-number">89</span>:<span class="hljs-number">70</span>:<span class="hljs-number">87</span>:<span class="hljs-number">65</span>:<span class="hljs-attribute">ba</span>:<span class="hljs-number">52</span>:b1:e9:<span class="hljs-number">59</span>:f7:<span class="hljs-number">5</span><span class="hljs-attribute">d</span>:d2:<span class="hljs-number">6</span>a (EdDSA)
<span class="hljs-number">25</span>/tcp  open  smtp
|_<span class="hljs-attribute">smtp-commands</span>: debra2.thm.local, PIPELINING, SIZE <span class="hljs-number">10240000</span>, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, <span class="hljs-number">8</span>BITMIME, DSN, 
| <span class="hljs-attribute">ssl-cert</span>: <span class="hljs-attribute">Subject</span>: commonName=debra2.thm.local
| <span class="hljs-keyword">Not</span> valid <span class="hljs-attribute">before</span>: <span class="hljs-number">2021</span>-<span class="hljs-number">08</span>-<span class="hljs-number">10</span>T12:<span class="hljs-number">10</span>:<span class="hljs-number">58</span>
|_<span class="hljs-keyword">Not</span> valid <span class="hljs-attribute">after</span>:  <span class="hljs-number">2031</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span>T12:<span class="hljs-number">10</span>:<span class="hljs-number">58</span>
|_<span class="hljs-attribute">ssl-date</span>: TLS randomness does <span class="hljs-keyword">not</span> represent time
<span class="hljs-number">80</span>/tcp  open  http
|_<span class="hljs-attribute">http-title</span>: Welcome to nginx on Debian!
<span class="hljs-number">110</span>/tcp open  pop3
|_pop3<span class="hljs-attribute">-capabilities</span>: RESP-CODES CAPA TOP SASL UIDL PIPELINING AUTH-RESP-CODE
<span class="hljs-number">111</span>/tcp open  rpcbind
| <span class="hljs-attribute">rpcinfo</span>: 
|   program version   port/proto  service
|   <span class="hljs-number">100000</span>  <span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>        <span class="hljs-number">111</span>/tcp  rpcbind
|   <span class="hljs-number">100000</span>  <span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>        <span class="hljs-number">111</span>/udp  rpcbind
|   <span class="hljs-number">100024</span>  <span class="hljs-number">1</span>          <span class="hljs-number">38099</span>/tcp  status
|_  <span class="hljs-number">100024</span>  <span class="hljs-number">1</span>          <span class="hljs-number">54067</span>/udp  status
<span class="hljs-number">143</span>/tcp open  imap
|_<span class="hljs-attribute">imap-capabilities</span>: LITERAL+ capabilities IMAP4rev1 OK Pre-login ENABLE have LOGINDISABLEDA0001 listed SASL-IR ID more post-login LOGIN-REFERRALS IDLE
MAC <span class="hljs-attribute">Address</span>: <span class="hljs-number">02</span>:A0:E7:B5:B6:C5 (Unknown)

Nmap <span class="hljs-attribute">done</span>: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">2.21</span> seconds</code></pre>
<p>您还可以使用 <code>--script "SCRIPT-NAME"</code> 或 <code>--script "ftp*"</code> 等模式按名称指定脚本，其中包括 <code>ftp-brute</code> 。如果您不确定脚本的作用，可以使用文本阅读器（例如 <code>less</code> ）或文本编辑器打开脚本文件。对于 <code>ftp-brute</code> ，它指出：“对 FTP 服务器执行暴力密码审核。”您必须小心，因为某些脚本非常具有侵入性。此外，某些脚本可能适用于特定服务器，如果随机选择，则会浪费您的时间而没有任何好处。与往常一样，请确保您有权在目标服务器上启动此类测试。</p>
<p>让我们考虑一个良性脚本 <code>http-date</code> ，我们猜测它会检索 http 服务器日期和时间，这在其描述中确实得到了证实：“从类似 HTTP 的服务获取日期。此外，它还会打印日期与当地时间的差异……”在 AttackBox 上，我们执行 <code>sudo nmap -sS -n --script "http-date" 10.10.104.195</code> ，如下面的控制台所示。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ sudo nmap -sS -n --script <span class="hljs-string">"http-date"</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">104.195</span>

Starting Nmap <span class="hljs-number">7.60</span> ( <span class="hljs-attribute">https</span>://nmap.org ) at <span class="hljs-number">2021</span>-<span class="hljs-number">09</span>-<span class="hljs-number">10</span> <span class="hljs-number">08</span>:<span class="hljs-number">04</span> BST
Nmap <span class="hljs-attribute">scan</span> report for <span class="hljs-number">10.10</span>.<span class="hljs-number">104.195</span>
Host is up (<span class="hljs-number">0.0011s</span> latency).
<span class="hljs-keyword">Not</span> <span class="hljs-attribute">shown</span>: <span class="hljs-number">994</span> closed ports
PORT    STATE SERVICE
<span class="hljs-number">22</span>/tcp  open  ssh
<span class="hljs-number">25</span>/tcp  open  smtp
<span class="hljs-number">80</span>/tcp  open  http
|_<span class="hljs-attribute">http-date</span>: Fri, <span class="hljs-number">10</span> Sep <span class="hljs-number">2021</span> <span class="hljs-number">07</span>:<span class="hljs-number">04</span>:<span class="hljs-number">26</span> GMT; <span class="hljs-number">0s</span> from local <span class="hljs-selector-tag">time</span>.
<span class="hljs-number">110</span>/tcp open  pop3
<span class="hljs-number">111</span>/tcp open  rpcbind
<span class="hljs-number">143</span>/tcp open  imap
MAC <span class="hljs-selector-tag">Address</span>: <span class="hljs-number">02</span>:<span class="hljs-number">44</span>:<span class="hljs-number">87</span>:<span class="hljs-number">82</span>:AC:<span class="hljs-number">83</span> (Unknown)

Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">1.78</span> seconds</code></pre>
<p>最后，您可以将 Nmap 的功能扩展到官方 Nmap 脚本之外；您可以编写脚本或从 Internet 下载 Nmap 脚本。从 Internet 下载和使用 Nmap 脚本存在一定程度的风险。因此，最好不要运行您不信任的作者的脚本。</p>
<p>知道 Nmap 脚本保存在 AttackBox 上的 <code>/usr/share/nmap/scripts</code> 中。脚本 <code>http-robots.txt</code> 检查什么？</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110340479.png" alt="image-20240310110340479"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110620238.png" alt="image-20240310110620238"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110625843.png" alt="image-20240310110625843"></p>
<p>如果尚未启动 AttackBox，请启动它。确保已从任务 2 终止 VM 后，启动此任务的目标计算机。在 AttackBox 上，使用默认脚本 <code>-sC</code> 针对 <code>10.10.104.195</code> 运行 Nmap。您会注意到有一个服务正在侦听端口 53。它的完整版本值是多少？</p>
<pre><code class="hljs scss">nmap -sC -sS -T4 <span class="hljs-number">10.10</span><span class="hljs-selector-class">.104</span><span class="hljs-selector-class">.195</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310110745210.png" alt="image-20240310110745210"></p>
<p>根据其描述，脚本 <code>ssh2-enum-algos</code> “报告目标 SSH2 服务器提供的算法数量（用于加密、压缩等）。”依赖于“sha1”并受 <code>10.10.104.195</code> 支持的密钥交换算法 (kex_algorithms) 的名称是什么？</p>
<pre><code class="hljs scss">nmap -sS <span class="hljs-attr">--script</span> "ssh2-enum-algos" <span class="hljs-number">10.10</span><span class="hljs-selector-class">.104</span><span class="hljs-selector-class">.195</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310111013725.png" alt="image-20240310111013725"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310111020608.png" alt="image-20240310111020608"></p>
<h2 id="保存输出">保存输出</h2>
<p>每当您运行Nmap扫描时，将结果保存在文件中是合理的。选择和采用良好的命名约定对于文件名至关重要。文件数量可能会快速增长，并且可能妨碍您查找先前的扫描结果。主要的三种格式有：</p>
<ol>
<li>Normal</li>
<li>Grepable (<code>grep</code>able)</li>
<li>XML</li>
</ol>
<p>我们不推荐第四种：Script Kiddie 脚本小子</p>
<h3 id="normal-普通的">Normal 普通的</h3>
<p>顾名思义，正常格式类似于扫描目标时在屏幕上获得的输出。您可以使用 <code>-oN FILENAME</code> 以正常格式保存扫描结果； N代表正常。这是结果的示例。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ cat <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span>.nmap 
# Nmap <span class="hljs-number">7.60</span> <span class="hljs-attribute">scan</span> initiated Fri Sep <span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">14</span>:<span class="hljs-number">19</span> <span class="hljs-number">2021</span> <span class="hljs-attribute">as</span>: nmap -sS -sV -O -oN <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span> MACHINE_IP
Nmap <span class="hljs-attribute">scan</span> report for <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>
Host is up (<span class="hljs-number">0.00086s</span> latency).
<span class="hljs-keyword">Not</span> <span class="hljs-attribute">shown</span>: <span class="hljs-number">994</span> closed ports
PORT    STATE SERVICE VERSION
<span class="hljs-number">22</span>/tcp  open  ssh     OpenSSH <span class="hljs-number">6.7</span>p1 Debian <span class="hljs-number">5</span>+deb8u8 (protocol <span class="hljs-number">2.0</span>)
<span class="hljs-number">25</span>/tcp  open  smtp    Postfix smtpd
<span class="hljs-number">80</span>/tcp  open  http    nginx <span class="hljs-number">1.6</span>.<span class="hljs-number">2</span>
<span class="hljs-number">110</span>/tcp open  pop3    Dovecot pop3d
<span class="hljs-number">111</span>/tcp open  rpcbind <span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC <span class="hljs-number">#100000</span>)
<span class="hljs-number">143</span>/tcp open  imap    Dovecot imapd
MAC <span class="hljs-attribute">Address</span>: <span class="hljs-number">02</span>:A0:E7:B5:B6:C5 (Unknown)
Device <span class="hljs-attribute">type</span>: general purpose
<span class="hljs-attribute">Running</span>: Linux <span class="hljs-number">3</span>.X
OS <span class="hljs-attribute">CPE</span>: <span class="hljs-attribute">cpe</span>:/<span class="hljs-attribute">o</span>:<span class="hljs-attribute">linux</span>:linux_<span class="hljs-attribute">kernel</span>:<span class="hljs-number">3.13</span>
OS <span class="hljs-attribute">details</span>: Linux <span class="hljs-number">3.13</span>
Network <span class="hljs-attribute">Distance</span>: <span class="hljs-number">1</span> hop
Service <span class="hljs-attribute">Info</span>: <span class="hljs-attribute">Host</span>:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Sep <span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">14</span>:<span class="hljs-number">28</span> <span class="hljs-number">2021</span> -- <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">9.99</span> seconds</code></pre>
<h3 id="grepable">Grepable</h3>
<p>grepable 格式的名称来自命令 <code>grep</code> ； grep 代表全局正则表达式打印机。简而言之，它可以高效地过滤扫描输出中的特定关键字或术语。您可以使用 <code>-oG FILENAME</code> 将扫描结果保存为 grepable 格式。上面以正常格式显示的扫描输出使用 grepable 格式显示在下面的控制台中。正常输出为21行；然而，grepable 输出只有 4 行。主要原因是 Nmap 希望在用户应用 <code>grep</code> 时使每一行都有意义且完整。因此，在 grepable 输出中，与正常输出相比，行很长并且不方便阅读。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ cat <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span>.gnmap 
# Nmap <span class="hljs-number">7.60</span> <span class="hljs-attribute">scan</span> initiated Fri Sep <span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">14</span>:<span class="hljs-number">19</span> <span class="hljs-number">2021</span> <span class="hljs-attribute">as</span>: nmap -sS -sV -O -oG <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span> MACHINE_IP
<span class="hljs-attribute">Host</span>: <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>	<span class="hljs-attribute">Status</span>: Up
<span class="hljs-attribute">Host</span>: MACHINE_IP	<span class="hljs-attribute">Ports</span>: <span class="hljs-number">22</span>/open/tcp//ssh//OpenSSH <span class="hljs-number">6.7</span>p1 Debian <span class="hljs-number">5</span>+deb8u8 (protocol <span class="hljs-number">2.0</span>)/, <span class="hljs-number">25</span>/open/tcp//smtp//Postfix smtpd/, <span class="hljs-number">80</span>/open/tcp//http//nginx <span class="hljs-number">1.6</span>.<span class="hljs-number">2</span>/, <span class="hljs-number">110</span>/open/tcp//pop3//Dovecot pop3d/, <span class="hljs-number">111</span>/open/tcp//rpcbind//<span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC <span class="hljs-number">#100000</span>)/, <span class="hljs-number">143</span>/open/tcp//imap//Dovecot imapd/	Ignored <span class="hljs-attribute">State</span>: closed (<span class="hljs-number">994</span>)	<span class="hljs-attribute">OS</span>: Linux <span class="hljs-number">3.13</span>	Seq <span class="hljs-attribute">Index</span>: <span class="hljs-number">257</span>	IP ID <span class="hljs-attribute">Seq</span>: All zeros
# Nmap done at Fri Sep <span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">14</span>:<span class="hljs-number">28</span> <span class="hljs-number">2021</span> -- <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">9.99</span> seconds</code></pre>
<p><code>grep</code> 的一个使用示例是 <code>grep KEYWORD TEXT_FILE</code> ；该命令将显示包含所提供的关键字的所有行。让我们比较一下在正常输出和 grepable 输出上使用 <code>grep</code> 的输出。您会注意到，前者不提供主机的 IP 地址。相反，它返回 <code>80/tcp open http nginx 1.6.2</code> ，如果您要筛选多个系统的扫描结果，这会非常不方便。然而，后者在每一行中提供了足够的信息，例如主机的 IP 地址，以使其完整。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ grep http <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span>.nmap 
<span class="hljs-number">80</span>/tcp  open  http    nginx <span class="hljs-number">1.6</span>.<span class="hljs-number">2</span>
OS <span class="hljs-keyword">and</span> Service detection performed. Please report any incorrect results at <span class="hljs-attribute">https</span>://nmap.org/submit/ .</code></pre>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ grep http <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span>.gnmap 
<span class="hljs-attribute">Host</span>: <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>	<span class="hljs-attribute">Ports</span>: <span class="hljs-number">22</span>/open/tcp//ssh//OpenSSH <span class="hljs-number">6.7</span>p1 Debian <span class="hljs-number">5</span>+deb8u8 (protocol <span class="hljs-number">2.0</span>)/, <span class="hljs-number">25</span>/open/tcp//smtp//Postfix smtpd/, <span class="hljs-number">80</span>/open/tcp//http//nginx <span class="hljs-number">1.6</span>.<span class="hljs-number">2</span>/, <span class="hljs-number">110</span>/open/tcp//pop3//Dovecot pop3d/, <span class="hljs-number">111</span>/open/tcp//rpcbind//<span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC <span class="hljs-number">#100000</span>)/, <span class="hljs-number">143</span>/open/tcp//imap//Dovecot imapd/	Ignored <span class="hljs-attribute">State</span>: closed (<span class="hljs-number">994</span>)	<span class="hljs-attribute">OS</span>: Linux <span class="hljs-number">3.13</span>	Seq <span class="hljs-attribute">Index</span>: <span class="hljs-number">257</span>	IP ID <span class="hljs-attribute">Seq</span>: All zeros</code></pre>
<h3 id="xml">XML</h3>
<p>第三种格式是XML。您可以使用<code>-oX FILENAME</code>将扫描结果以XML格式保存。XML格式最方便用于在其他程序中处理输出。方便的是，您可以使用<code>-oA FILENAME</code>将扫描输出以所有三种格式保存，即结合了普通格式（-oN）、可grep格式（-oG）和XML格式（-oX）。</p>
<h3 id="脚本小子">脚本小子</h3>
<p>第四种格式是脚本小子。您可以看到，如果您想在输出中搜索任何有趣的关键字或保留结果以供将来参考，则此格式毫无用处。但是，您可以使用它来保存扫描的输出 <code>nmap -sS 127.0.0.1 -oS FILENAME</code> ，显示输出文件名，并在不懂技术的朋友面前查看 31337 。</p>
<pre><code class="hljs scss">pentester<span class="hljs-keyword">@TryHackMe</span>$ cat <span class="hljs-number">10.10</span>.<span class="hljs-number">87.205</span>_<span class="hljs-attribute">scan</span>.kiddie 

<span class="hljs-variable">$tart</span>!ng nMaP <span class="hljs-number">7.60</span> ( <span class="hljs-attribute">httpz</span>://nMap.<span class="hljs-number">0</span>rG ) at <span class="hljs-number">2021</span>-<span class="hljs-number">09</span>-<span class="hljs-number">10</span> <span class="hljs-number">05</span>:<span class="hljs-number">17</span> B<span class="hljs-variable">$T</span>
Nmap <span class="hljs-attribute">scan</span> rEp0rt f0r |p-<span class="hljs-number">10</span>-<span class="hljs-number">10</span>-<span class="hljs-number">161</span>-<span class="hljs-number">170</span>.EU-w3<span class="hljs-variable">$t-1</span>.C0mputE.intErnaL (<span class="hljs-number">10.10</span>.<span class="hljs-number">161.170</span>)
HOSt !s uP (<span class="hljs-number">0.00095s</span> LatEncy).
N0T <span class="hljs-variable">$H0wn</span>: <span class="hljs-number">994</span> closed pOrtS
PoRT    st4Te SeRViC3 VERS1on
<span class="hljs-number">22</span>/tcp  Open  ssH     Op3n$<span class="hljs-variable">$H</span> <span class="hljs-number">6.7</span>p1 Deb|an <span class="hljs-number">5</span>+dEb8u8 (pr0t0COl <span class="hljs-number">2.0</span>)
<span class="hljs-number">25</span>/tCp  Op3n  SmTp    P0<span class="hljs-variable">$Tf</span>!x Smtpd
<span class="hljs-number">80</span>/tcp  <span class="hljs-number">0</span>p3n  http    Ng1nx <span class="hljs-number">1.6</span>.<span class="hljs-number">2</span>
<span class="hljs-number">110</span>/tCP <span class="hljs-number">0</span>pen  pOP3    d0v3coT P0p3D
<span class="hljs-number">111</span>/TcP op3n  RpcbInd <span class="hljs-number">2</span>-<span class="hljs-number">4</span> (RPC <span class="hljs-number">#100000</span>)
<span class="hljs-number">143</span>/Tcp opEn  Imap    Dovecot <span class="hljs-number">1</span>mApd
mAC <span class="hljs-number">4</span>Ddr3<span class="hljs-attribute">sz</span>: <span class="hljs-number">02</span>:<span class="hljs-number">40</span>:e7:B5:B6:c5 (Unknown)
Netw0rk d!stanc3: <span class="hljs-number">1</span> h0p
$<span class="hljs-number">3</span>rv1c3 <span class="hljs-attribute">InFO</span>: Ho<span class="hljs-variable">$t</span>:  dEBra2.thM.lOcal; <span class="hljs-number">0s</span>: Linux; cPe: cP3:/<span class="hljs-number">0</span>:linux:l|nux_k3rnel

<span class="hljs-number">0S</span> and servIc3 D3tEcti0n pErf0rm3d. Plea<span class="hljs-variable">$e</span> r3p0rt any !nc0RrecT rE<span class="hljs-variable">$ultz</span> at hTtpz://nmap.<span class="hljs-number">0</span>rg/<span class="hljs-variable">$ubmit</span>/ .
Nmap d0nE: <span class="hljs-number">1</span> |P addr3SS (<span class="hljs-number">1</span> hoSt up) <span class="hljs-variable">$CaNnEd</span> !n <span class="hljs-number">21.80</span> s3c0Ndz</code></pre>
<p>终止上一个任务的目标机器并启动本任务的目标机器。在 AttackBox 终端上，发出命令 <code>scp pentester@10.10.87.205:/home/pentester/* .</code> 从目标虚拟机下载正常格式和 grepable 格式的 Nmap 报告。</p>
<p>请注意，用户名 <code>pentester</code> 的密码为 <code>THM17577</code></p>
<p>检查附加的 Nmap 日志。有多少系统正在侦听 HTTPS 端口？</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310112055114.png" alt="image-20240310112055114"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310112105178.png" alt="image-20240310112105178"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/he-yi-beichen-star/local_images/raw/master/images/image-20240310112045359.png" alt="image-20240310112045359"></p>
<h2 id="总结">总结</h2>
<p>在这个房间中，我们学习了如何检测正在运行的服务及其版本以及主机操作系统。我们学习了如何启用跟踪路由，并介绍了选择一个或多个脚本来帮助渗透测试。最后，我们介绍了保存扫描结果以供将来参考的不同格式。下表总结了我们在这个房间中讨论的最重要的选项。</p>
<table>
<thead>
<tr>
<th>Option 选项</th>
<th>Meaning 意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-sV</code></td>
<td>确定开放端口上的服务/版本信息</td>
</tr>
<tr>
<td><code>-sV --version-light</code></td>
<td>尝试最有可能的探针 (2)</td>
</tr>
<tr>
<td><code>-sV --version-all</code></td>
<td>尝试所有可用的探针 (9)</td>
</tr>
<tr>
<td><code>-O</code></td>
<td>检测操作系统</td>
</tr>
<tr>
<td><code>--traceroute</code></td>
<td>运行traceroute到目标</td>
</tr>
<tr>
<td><code>--script=SCRIPTS</code></td>
<td>要运行的 Nmap 脚本</td>
</tr>
<tr>
<td><code>-sC</code> or <code>--script=default</code> <code>-sC</code> 或 <code>--script=default</code></td>
<td>运行默认脚本</td>
</tr>
<tr>
<td><code>-A</code></td>
<td>相当于 <code>-sV -O -sC --traceroute</code></td>
</tr>
<tr>
<td><code>-oN</code></td>
<td>以正常格式保存输出</td>
</tr>
<tr>
<td><code>-oG</code></td>
<td>以 grepable 格式保存输出</td>
</tr>
<tr>
<td><code>-oX</code></td>
<td>以 XML 格式保存输出</td>
</tr>
<tr>
<td><code>-oA</code></td>
<td>以普通、XML 和 Grepable 格式保存输出</td>
</tr>
</tbody>
</table>

<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2024/02/19/thm-persisting-active-directory/">THM-Persisting Active Directory</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2024/02/16/thm-lateral-movement-and-pivoting/">THM-Lateral Movement and Pivoting</a></div></section></div>




  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>感谢大佬们的不吝赐教！</p>

    </section>
    <section class='body cmt-body twikoo'>
      

<div id="twikoo_container"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>
    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="text"><p><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<p>本站由 <a href="/">hybcx</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1">Stellar 1.28.1</a> 主题创建。<br>
本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="true"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E7%AE%80%E4%BB%8B"><span class="toc-text">0x01 简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-nmap%E9%80%89%E9%A1%B9"><span class="toc-text">0x02 Nmap选项</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E6%89%AB%E6%8F%8F%E7%B1%BB%E5%9E%8B%E6%A6%82%E8%BF%B0"><span class="toc-text">0x03 扫描类型概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-tcp-%E6%89%AB%E6%8F%8F"><span class="toc-text">0x04 TCP 扫描</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-syn-%E6%89%AB%E6%8F%8F"><span class="toc-text">0x05 SYN 扫描</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-udp-%E6%89%AB%E6%8F%8F"><span class="toc-text">0x06 UDP 扫描</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-null-fin-xmas%E6%89%AB%E6%8F%8F"><span class="toc-text">0x07 NULL、FIN、Xmas扫描</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-icmp-%E6%89%AB%E6%8F%8F"><span class="toc-text">0x08 ICMP 扫描</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x09-nse-%E8%84%9A%E6%9C%AC%E6%A6%82%E8%BF%B0"><span class="toc-text">0x09 NSE 脚本概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x10-%E4%BD%BF%E7%94%A8-nse-%E8%84%9A%E6%9C%AC"><span class="toc-text">0x10 使用 NSE 脚本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x11-nse-%E6%90%9C%E7%B4%A2%E8%84%9A%E6%9C%AC"><span class="toc-text">0x11 NSE 搜索脚本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x12-%E9%98%B2%E7%81%AB%E5%A2%99%E8%A7%84%E9%81%BF"><span class="toc-text">0x12 防火墙规避</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x13-%E5%AE%9E%E8%B7%B5"><span class="toc-text">0x13 实践</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x14-%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-text">0x14 参考文章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x15-nmap-%E5%90%8E%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-text">0x15 Nmap 后端口扫描</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%A3%80%E6%B5%8B"><span class="toc-text">服务检测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B%E5%92%8Ctraceroute"><span class="toc-text">操作系统检测和Traceroute</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B"><span class="toc-text">操作系统检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E8%BF%BD%E8%B8%AA"><span class="toc-text">路由追踪</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap-%E8%84%9A%E6%9C%AC-nse"><span class="toc-text">Nmap 脚本 NSE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E8%BE%93%E5%87%BA"><span class="toc-text">保存输出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#normal-%E6%99%AE%E9%80%9A%E7%9A%84"><span class="toc-text">Normal 普通的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grepable"><span class="toc-text">Grepable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xml"><span class="toc-text">XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%B0%8F%E5%AD%90"><span class="toc-text">脚本小子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M10.46 1.25h3.08c1.603 0 2.86 0 3.864.095c1.023.098 1.861.3 2.6.752a5.75 5.75 0 0 1 1.899 1.899c.452.738.654 1.577.752 2.6c.095 1.004.095 2.261.095 3.865v1.067c0 1.141 0 2.036-.05 2.759c-.05.735-.153 1.347-.388 1.913a5.75 5.75 0 0 1-3.112 3.112c-.805.334-1.721.408-2.977.43a10.81 10.81 0 0 0-.929.036c-.198.022-.275.054-.32.08c-.047.028-.112.078-.224.232c-.121.166-.258.396-.476.764l-.542.916c-.773 1.307-2.69 1.307-3.464 0l-.542-.916a10.605 10.605 0 0 0-.476-.764c-.112-.154-.177-.204-.224-.232c-.045-.026-.122-.058-.32-.08c-.212-.023-.49-.03-.93-.037c-1.255-.021-2.171-.095-2.976-.429A5.75 5.75 0 0 1 1.688 16.2c-.235-.566-.338-1.178-.389-1.913c-.049-.723-.049-1.618-.049-2.76v-1.066c0-1.604 0-2.86.095-3.865c.098-1.023.3-1.862.752-2.6a5.75 5.75 0 0 1 1.899-1.899c.738-.452 1.577-.654 2.6-.752C7.6 1.25 8.857 1.25 10.461 1.25M6.739 2.839c-.914.087-1.495.253-1.959.537A4.25 4.25 0 0 0 3.376 4.78c-.284.464-.45 1.045-.537 1.96c-.088.924-.089 2.11-.089 3.761v1c0 1.175 0 2.019.046 2.685c.045.659.131 1.089.278 1.441a4.25 4.25 0 0 0 2.3 2.3c.515.214 1.173.294 2.429.316h.031c.398.007.747.013 1.037.045c.311.035.616.104.909.274c.29.17.5.395.682.645c.169.232.342.525.538.856l.559.944a.52.52 0 0 0 .882 0l.559-.944c.196-.331.37-.624.538-.856c.182-.25.392-.476.682-.645c.293-.17.598-.24.909-.274c.29-.032.639-.038 1.037-.045h.032c1.255-.022 1.913-.102 2.428-.316a4.25 4.25 0 0 0 2.3-2.3c.147-.352.233-.782.278-1.441c.046-.666.046-1.51.046-2.685v-1c0-1.651 0-2.837-.089-3.762c-.087-.914-.253-1.495-.537-1.959a4.25 4.25 0 0 0-1.403-1.403c-.464-.284-1.045-.45-1.96-.537c-.924-.088-2.11-.089-3.761-.089h-3c-1.651 0-2.837 0-3.762.089" clip-rule="evenodd"/><path fill="currentColor" d="M9 11a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0"/></svg><span>参与讨论</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.28.1" async></script>

<!-- optional -->

  <script>
    function load_twikoo() {
        if (!document.querySelectorAll("#twikoo_container")[0]) return;
        utils.js('https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js', {defer: true}).then(function () {
            const el = document.getElementById("twikoo_container");
            var path = el.getAttribute('comment_id');
            if (!path) {
                path = decodeURI(window.location.pathname);
            }
            twikoo.init(Object.assign({"js":"https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js","envId":"https://blog-comments-phi.vercel.app"}, {
                el: '#twikoo_container',
                path: path,
            }));
        });
    }

    window.addEventListener('DOMContentLoaded', (event) => {
        load_twikoo();
    });
</script>



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
