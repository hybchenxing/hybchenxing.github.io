
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1" theme-name="Stellar" theme-version="1.28.1">
  
  <meta name="generator" content="Hexo 7.2.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f9fafb">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  
  <title>THM-红队 OPSEC - hybcx's blog</title>

  
    <meta name="description" content="0x01 介绍 运营安全（OPSEC）是美国军方创造的术语。在网络安全领域，我们先从NIST提供的定义开始：  “Systematic and proven process by which potential adversaries can be denied information about capabilities and intentions by identifying, contro">
<meta property="og:type" content="article">
<meta property="og:title" content="THM-红队 OPSEC">
<meta property="og:url" content="http://hybcx.xyz/2024/07/09/thm-hong-dui-opsec/index.html">
<meta property="og:site_name" content="hybcx&#39;s blog">
<meta property="og:description" content="0x01 介绍 运营安全（OPSEC）是美国军方创造的术语。在网络安全领域，我们先从NIST提供的定义开始：  “Systematic and proven process by which potential adversaries can be denied information about capabilities and intentions by identifying, contro">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192454338.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192523118.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192748515.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709193335397.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709193610254.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709211756850.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709211849855.png">
<meta property="og:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709212112682.png">
<meta property="article:published_time" content="2024-07-09T11:14:21.000Z">
<meta property="article:modified_time" content="2024-07-10T01:50:39.372Z">
<meta property="article:author" content="hybcx">
<meta property="article:tag" content="tryhackme">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="d:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192454338.png">
  
  
  
  <meta name="keywords" content="tryhackme">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="hybcx's blog" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.28.1">

  
    <link rel="shortcut icon" href="/medias/logo.png">
  

  
    
<link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css">

  

  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/medias/avatar.jpg" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">hybcx's blog</div><div class="sub normal cap">人生当是精彩的</div><div class="sub hover cap" style="opacity:0"> 何必忧虑未来！</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item active" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="关于" href="/about/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="友链" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title" href="/2024/07/10/thm-hong-dui-zhen-cha/"><span class="title">THM-红队侦察</span></a><a class="item title" href="/2024/07/10/thm-c2-jian-jie/"><span class="title">THM-C2简介</span></a><a class="item title" href="/2024/07/09/thm-hong-dui-opsec/"><span class="title">THM-红队 OPSEC</span></a><a class="item title" href="/2024/07/09/thm-hong-dui-wei-xie-intel/"><span class="title">THM-红队威胁Intel</span></a><a class="item title" href="/2024/07/09/thm-hong-dui-ji-chu/"><span class="title">THM-红队基础</span></a><a class="item title" href="/2024/03/29/thm-jin-gong-xing-shen-tou-ce-shi/"><span class="title">THM-进攻性渗透测试</span></a><a class="item title" href="/2024/06/29/xuan-ji-ying-ji-xiang-ying-ba-chang/"><span class="title">玄机应急响应靶场</span></a><a class="item title" href="/2024/06/15/du-web-gong-fang-you-gan/"><span class="title">读web攻防有感</span></a><a class="item title" href="/2024/06/17/thm-corp/"><span class="title">THM-Corp</span></a><a class="item title" href="/2024/06/16/thm-hacking-with-powershell/"><span class="title">THM-Hacking_With_PowerShell</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/hybchenxing/" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/github-logo2.png"/></a><a class="social" href="https://music.163.com/#/user/home?id=9895561810" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/neteasemusic-icon.png"/></a><a class="social" href="https://space.bilibili.com/1761635300" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/bilibili-icon.png"/></a><a class="social" href="https://muselink.cc/hybcx" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/weChat.png"/></a><a class="social" href="javaScript:void('永夜');" rel="noopener noreferrer"><img class="lazy" id="ThemeM" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/moon.svg"/></a><a class="social" href="javaScript:void('永昼');" rel="noopener noreferrer"><img class="lazy" id="ThemeL" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/sun.svg"/></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/tryhackme/">tryhackme</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2024-07-09T11:14:21.000Z">2024-07-09</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2024-07-10T01:50:39.372Z">2024-07-10</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>THM-红队 OPSEC</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h1 id="0x01-介绍">0x01 介绍</h1>
<p>运营安全（OPSEC）是美国军方创造的术语。在网络安全领域，我们先从NIST提供的定义开始：</p>
<blockquote>
<p>“Systematic and proven process by which potential adversaries can be denied information about capabilities and intentions by identifying, controlling, and protecting generally unclassified evidence of the planning and execution of sensitive activities. The process involves five steps: identification of critical information, analysis of threats, analysis of vulnerabilities, assessment of risks, and application of appropriate countermeasures.”<br>
“这是一个系统且经过验证的过程，通过识别、控制和保护敏感活动的规划和执行的一般非机密证据，可以拒绝潜在对手获取有关能力和意图的信息。该过程涉及五个步骤：识别关键信息、分析威胁、分析漏洞、评估风险以及应用适当的对策。”</p>
</blockquote>
<p>让我们从红队的角度深入探讨这个定义。作为红队成员，您的潜在对手是蓝队和第三方。蓝队被视为对手，因为我们正在攻击他们受雇监视和防御的系统。红队与蓝队的演习很常见，可以帮助组织了解给定环境中存在哪些威胁，并在发生真正的恶意攻击时更好地准备蓝队。作为红队成员，即使我们遵守法律并被授权在规定范围内攻击系统，但这并不能改变我们违背蓝队目标并试图规避其安全控制的事实。蓝队想要保护他们的系统，而我们想要渗透他们。</p>
<p>阻止任何潜在对手收集有关我们的能力和意图的信息对于维护 OPSEC 至关重要。 OPSEC 是一个识别、控制和保护与我们活动的规划和执行相关的任何信息的流程。洛克希德·马丁公司的网络杀伤链和 MITRE ATT&amp;CK 等框架可帮助防御者识别对手试图实现的目标。 MITRE ATT&amp;CK 可以说处于报告和分类对手战术、技术和程序 (TTP) 的最前沿，并提供可公开访问的知识库，作为公开的威胁情报和事件报告作为其主要数据源。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192454338.png" alt="image-20240709192454338"></p>
<p>OPSEC 流程有五个步骤：</p>
<ol>
<li>识别关键信息</li>
<li>分析威胁</li>
<li>分析漏洞</li>
<li>评估风险</li>
<li>采取适当的对策</li>
</ol>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192523118.png" alt="image-20240709192523118"></p>
<p>如果对手发现您正在使用 Nmap（我们案例中的蓝队）扫描他们的网络，他们应该能够轻松发现所使用的 IP 地址。例如，如果您使用同一个 IP 地址来托管网络钓鱼站点，那么蓝队连接这两个事件并将其归因于同一个参与者并不困难。</p>
<p>OPSEC 不是一个解决方案或一组规则； OPSEC 是一个五步流程，旨在阻止对手访问任何关键信息（在任务 2 中定义）。我们将深入研究每一步，看看如何改进 OPSEC，作为我们红队运营的一部分。</p>
<h1 id="0x02-关键信息识别">0x02 关键信息识别</h1>
<p>红队成员认为值得保护的关键信息取决于操作以及所使用的资产或工具。在这种情况下，关键信息包括但不限于红队的意图、能力、活动和限制。关键信息包括蓝队一旦获得就会阻碍或降低红队任务的任何信息。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709192748515.png" alt="image-20240709192748515"></p>
<p>为了识别关键信息，红队需要使用对抗性方法，并询问自己对手（在本例中为蓝队）想要了解有关任务的哪些信息。如果获得，对手将处于有利地位来挫败红队的攻击。因此，关键信息不一定是敏感信息；然而，它是任何如果泄露给对手就可能危及你的计划的信息。以下是一些示例：</p>
<ul>
<li>您的团队了解到的客户信息。共享客户特定信息（例如团队发现的员工姓名、角色和基础设施）是不可接受的。共享此类信息应保持在需要知道的基础上，因为它可能会损害操作的完整性。最小权限原则 (PoLP) 规定任何实体（用户或进程）必须只能访问执行其任务所需的信息。 PoLP 应应用于红队采取的每一步。</li>
<li>红队信息，例如身份、活动、计划、能力和限制。对手可以利用此类信息更好地准备应对您的攻击。</li>
<li>您的团队用于模拟攻击的策略、技术和程序 (TTP)。</li>
<li>您的团队使用的操作系统、云托管提供商或 C2 框架。假设您的团队使用 Pentoo 进行渗透测试，并且防御者知道这一点。因此，他们可以密切关注将操作系统暴露为 Pentoo 的日志。根据目标的不同，其他攻击者也有可能使用 <a target="_blank" rel="noopener" href="https://pentoo.github.io/">Pentoo</a> 来发起攻击；但是，如果不需要，没有理由公开您的操作系统。</li>
<li>您的红队将使用的公共 IP 地址。如果蓝队能够访问此类信息，他们可以通过阻止所有到您的 IP 地址的入站和出站流量来快速减轻攻击，让您弄清楚发生了什么。</li>
<li>您的团队已注册的域名。域名在网络钓鱼等攻击中发挥着重要作用。同样，如果蓝队找出您将用于发起攻击的域名，他们可以简单地阻止或沉陷您的恶意域名以抵消您的攻击。</li>
<li>用于模拟对手的托管网站，例如网络钓鱼网站。</li>
</ul>
<h1 id="0x03-威胁分析">0x03 威胁分析</h1>
<p>识别出关键信息后，我们需要分析威胁。威胁分析是指识别潜在对手及其意图和能力。威胁分析改编自美国国防部 <a target="_blank" rel="noopener" href="https://www.esd.whs.mil/Portals/54/Documents/DD/issuances/dodm/520502m.pdf">(DoD) 运营安全 (OPSEC) 计划手册</a>，旨在回答以下问题：</p>
<ol>
<li>对手是谁？</li>
<li>对手的目标是什么？</li>
<li>对手使用什么策略、技术和程序？</li>
<li>对手获得了哪些关键信息（如果有）？</li>
</ol>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709193335397.png" alt="image-20240709193335397"></p>
<p>红队的任务是模拟实际攻击，以便蓝队发现其缺点（如果有），并更好地准备面对即将到来的威胁。蓝队的主要目标是确保组织网络和系统的安全。蓝队的意图很明确；他们希望将红队排除在他们的网络之外。因此，考虑到红队的任务，蓝队被认为是我们的对手，因为每个队都有相互冲突的目标。我们应该注意到，蓝队的能力在一开始可能并不总是已知的。</p>
<p>Malicious third-party players might have different intentions and capabilities and might pause a threat as a result. This party can be someone with humble capabilities scanning the systems randomly looking for low-hanging fruit, such as an unpatched exploitable server, or it can be a capable adversary targeting your company or your client systems. Consequently, the intentions and the capabilities of this third party can make them an adversary as well.<br>
恶意第三方参与者可能有不同的意图和能力，并可能因此暂停威胁。该方可以是能力卑微的人，随机扫描系统寻找容易实现的目标，例如未打补丁的可利用服务器，也可以是针对您的公司或客户端系统的有能力的对手。因此，该第三方的意图和能力也可能使他们成为对手。</p>
<table>
<thead>
<tr>
<th>Adversary</th>
<th>Intentions</th>
<th>Capabilities</th>
</tr>
</thead>
<tbody>
<tr>
<td>Blue Team</td>
<td>将入侵者拒之门外</td>
<td>并不总是为人所知</td>
</tr>
<tr>
<td>Malicious third-party 恶意第三方</td>
<td>Varies 各不相同</td>
<td>Varies 各不相同</td>
</tr>
</tbody>
</table>
<p>我们将任何意图和能力采取行动阻止我们完成行动的对手视为威胁：</p>
<pre><code class="hljs scss">threat = adversary + intent + capability</code></pre>
<p>换句话说，没有意图或能力的对手不会对我们的目的构成威胁。</p>
<h1 id="0x04-漏洞分析">0x04 漏洞分析</h1>
<p>识别出关键信息并分析威胁后，我们可以开始第三步：分析漏洞。不要将其与网络安全相关的漏洞混淆。当对手能够获取关键信息、分析结果并以影响您的计划的方式行事时，就会存在 OPSEC 漏洞。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709193610254.png" alt="image-20240709193610254"></p>
<p>为了更好地理解与红队相关的 OPSEC 漏洞，我们将考虑以下场景。您可以使用 Nmap 发现目标子网上的活动主机并查找活动主机上的开放端口。此外，您还发送各种网络钓鱼电子邮件，引导受害者访问您托管的网络钓鱼网页。此外，您正在使用 Metasploit 框架来尝试利用某些软件漏洞。这是三项独立的活动；但是，如果您使用相同的 IP 地址来执行这些不同的活动，这将导致 OPSEC 漏洞。一旦检测到任何敌对/恶意活动，蓝队就会采取行动，例如暂时或永久阻止源 IP 地址。因此，只有一个源 IP 地址被阻止，使用该 IP 地址的所有其他活动才会失败。换句话说，这将阻止对网络钓鱼服务器使用的目标 IP 地址以及 Nmap 和 Metasploit Framework 使用的源 IP 地址的访问。</p>
<p>OPSEC 漏洞的另一个示例是用于存储从网络钓鱼受害者收到的数据的不安全数据库。如果数据库没有得到适当的保护，可能会导致恶意第三方破坏操作，并可能导致数据被泄露并用于对客户网络的攻击。因此，您最终会帮助暴露登录名和密码，而不是帮助您的客户保护其网络。</p>
<p>宽松的 OPSEC 还可能导致不太复杂的漏洞。例如，考虑这样一种情况：您的一名红队成员在社交媒体上发帖，泄露了您客户的姓名。如果蓝队监控此类信息，将促使他们更多地了解您的团队和您的方法，以便更好地准备应对预期的渗透尝试。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709211756850.png" alt="image-20240709211756850"></p>
<h1 id="0x05-风险评估">0x05 风险评估</h1>
<p>漏洞分析完毕，现在可以进行第四步：进行风险评估。 NIST 将风险评估定义为“识别因信息系统的运行而对组织运营（包括使命、职能、形象、声誉）、组织资产、个人、其他组织和国家造成的风险的过程”。在 OPSEC 中，风险评估需要了解事件发生的可能性以及该事件的预期成本。因此，这涉及评估对手利用漏洞的能力。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709211849855.png" alt="image-20240709211849855"></p>
<p>一旦确定了风险级别，就可以考虑采取对策来减轻该风险。我们需要考虑以下三个因素：</p>
<ol>
<li>降低风险对策的效率</li>
<li>对策的成本与所利用的漏洞的影响相比。</li>
<li>对策向对手泄露信息的可能性</li>
</ol>
<p>让我们回顾一下上一个任务中的两个示例。在第一个示例中，我们考虑了使用 Nmap 扫描网络、使用 Metasploit 框架并使用相同的公共 IP 地址托管网络钓鱼页面的漏洞。我们分析认为这是一个漏洞，因为它使对手更容易通过简单地检测一项活动来阻止我们的三项活动。现在让我们评估一下这种风险。为了评估与此漏洞相关的风险，我们需要了解检测到其中一项或多项活动的可能性。如果没有获得有关对手能力的一些信息，我们就无法回答这个问题。让我们考虑一下客户拥有安全信息和事件管理 (SIEM) 的情况。 SIEM 是一个允许实时监控和分析网络中不同来源的安全相关事件的系统。我们可以预期，SIEM 将使检测可疑活动并将这三个事件联系起来变得相当简单。因此，我们将相关风险评估为高。另一方面，如果我们知道对手用于检测安全事件的资源最少，我们就可以将该漏洞相关的风险评估为较低。</p>
<p>让我们考虑用于存储从网络钓鱼页面接收的数据的不安全数据库的第二个示例。根据多个研究小组使用蜜罐收集的数据，我们可以预期各种恶意机器人会主动瞄准互联网上的随机 IP 地址。因此，安全性较弱的系统被发现并被利用只是时间问题。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="D:%5Cblog%5CHexo%5Csource_posts%5CTHM-%E7%BA%A2%E9%98%9F-OPSEC%5Cimage-20240709212112682.png" alt="image-20240709212112682"></p>
<h1 id="0x06-对策">0x06 对策</h1>
<p>最后一步是采取对策。美国国防部 (DoD) 行动安全 (OPSEC) <a target="_blank" rel="noopener" href="https://www.esd.whs.mil/Portals/54/Documents/DD/issuances/dodm/520502m.pdf">计划手册</a>指出，“对策旨在防止对手检测关键信息、提供对关键信息或指标的替代解释（欺骗）或拒绝对手的收集系统。 ”</p>
<p>让我们回顾一下漏洞分析任务中提供的两个示例。在第一个示例中，我们考虑了运行 Nmap、使用 Metasploit 框架以及使用相同公共 IP 地址托管网络钓鱼页面的漏洞。对此的对策似乎是显而易见的；为每个活动使用不同的 IP 地址。这样，您可以确保如果检测到一项活动且公共 IP 地址被阻止，其他活动可以继续进行而不受影响。</p>
<p>在第二个示例中，我们考虑了用于存储从网络钓鱼页面收到的数据的不安全数据库的漏洞。从风险评估的角度来看，我们认为这是高风险，因为恶意第三方可能会寻找随机的简单目标。在这种情况下，对策是确保数据库得到充分保护，以便除授权人员外无法访问数据。</p>
<h1 id="0x07-更多实际的例子">0x07 更多实际的例子</h1>
<p>在此任务中，我们应用 OPSEC 流程的五个要素，重点关注与红队任务相关的关键信息的不同示例。我们将按照以下步骤进行：</p>
<ol>
<li>识别关键信息</li>
<li>分析威胁</li>
<li>分析漏洞</li>
<li>评估风险</li>
<li>采取适当的对策</li>
</ol>
<h2 id="红队使用的程序osvm">红队使用的程序/OS/VM</h2>
<ul>
<li>关键信息：我们正在谈论程序、操作系统 (OS) 和虚拟机 (VM)。</li>
<li>威胁分析：蓝队正在寻找网络上的任何恶意或异常活动。根据我们连接到的服务，可能会记录我们正在使用的程序的名称和版本，以及操作系统版本和虚拟机主机名。</li>
<li>漏洞分析：如果为给定活动选择的操作系统过于独特，则可以更轻松地将活动链接回您的操作。这同样适用于主机名突出的虚拟机。例如，在物理笔记本电脑和台式机的网络上，如果新主机以主机名 <code>kali2021vm</code> 加入，蓝队应该很容易发现。同样，如果您使用各种安全扫描仪，或者例如您不使用通用用户代理进行基于 Web 的活动。</li>
<li>风险评估：风险主要取决于我们连接到哪些服务。例如，如果我们启动 VPN 连接，VPN 服务器将记录大量有关我们的信息。这同样适用于我们可能连接的其他服务。</li>
<li>对策：如果我们使用的操作系统不常见，那么值得做出必要的更改以将我们的操作系统伪装成不同的操作系统。对于虚拟机和物理主机，值得将主机名更改为不显眼的或与客户端命名约定一致的名称，因为您不希望诸如 <code>AttackBox</code> 之类的主机名出现在 DHCP 服务器日志中。至于程序和工具，值得了解每个工具在服务器日志上留下的签名。</li>
</ul>
<p>示例：下图显示了当 Nmap 探测 Web 服务器时使用 <code>-sC</code> 选项运行 Nmap 扫描时，远程 Web 服务器将记录的用户代理。如果在运行给定的 Nmap 脚本时未设置 HTTP 用户代理，则目标系统上的日志可能会记录包含 <code>Nmap Scripting Engine</code> 的用户代理。可以使用选项 <code>--script-args http.useragent="CUSTOM_AGENT"</code> 来缓解这种情况。</p>
<h1 id="0x08-总结">0x08 总结</h1>
<p>在这个房间里，我们讨论了如何将 OPSEC 流程应用于红队行动。 OPSEC 流程有五个要素：</p>
<ol>
<li>识别关键信息：“关键信息包括但不限于红队的意图、能力、活动和限制。”</li>
<li>分析威胁：威胁分析是指识别潜在对手及其意图和能力。</li>
<li>分析漏洞：当对手能够获取关键信息、分析结果并以影响您的计划的方式采取行动时，就会存在 OPSEC 漏洞。</li>
<li>评估风险：“风险评估需要了解事件发生的可能性以及该事件的预期成本。”</li>
<li>应用适当的对策：对策旨在防止对手检测关键信息，提供关键信息或指标的替代解释（欺骗），或拒绝对手的收集系统。</li>
</ol>
<p>OPSEC 是一个可以应用于军队之外的流程。这个房间介绍了如何将其应用于红队行动；此外，将其应用到其他领域并不困难，例如营销或工业。此过程将有助于防止对手将各个部分组合在一起，从而阻止他们及时采取行动。</p>

<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2024/07/10/thm-c2-jian-jie/">THM-C2简介</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2024/07/09/thm-hong-dui-wei-xie-intel/">THM-红队威胁Intel</a></div></section></div>




  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>感谢大佬们的不吝赐教！</p>

    </section>
    <section class='body cmt-body twikoo'>
      

<div id="twikoo_container"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>
    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="text"><p><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<p>本站由 <a href="/">hybcx</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1">Stellar 1.28.1</a> 主题创建。<br>
本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="true"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E4%BB%8B%E7%BB%8D"><span class="toc-text">0x01 介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E5%85%B3%E9%94%AE%E4%BF%A1%E6%81%AF%E8%AF%86%E5%88%AB"><span class="toc-text">0x02 关键信息识别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E5%A8%81%E8%83%81%E5%88%86%E6%9E%90"><span class="toc-text">0x03 威胁分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-text">0x04 漏洞分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-%E9%A3%8E%E9%99%A9%E8%AF%84%E4%BC%B0"><span class="toc-text">0x05 风险评估</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E5%AF%B9%E7%AD%96"><span class="toc-text">0x06 对策</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-%E6%9B%B4%E5%A4%9A%E5%AE%9E%E9%99%85%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-text">0x07 更多实际的例子</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A2%E9%98%9F%E4%BD%BF%E7%94%A8%E7%9A%84%E7%A8%8B%E5%BA%8Fosvm"><span class="toc-text">红队使用的程序&#x2F;OS&#x2F;VM</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-%E6%80%BB%E7%BB%93"><span class="toc-text">0x08 总结</span></a></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M10.46 1.25h3.08c1.603 0 2.86 0 3.864.095c1.023.098 1.861.3 2.6.752a5.75 5.75 0 0 1 1.899 1.899c.452.738.654 1.577.752 2.6c.095 1.004.095 2.261.095 3.865v1.067c0 1.141 0 2.036-.05 2.759c-.05.735-.153 1.347-.388 1.913a5.75 5.75 0 0 1-3.112 3.112c-.805.334-1.721.408-2.977.43a10.81 10.81 0 0 0-.929.036c-.198.022-.275.054-.32.08c-.047.028-.112.078-.224.232c-.121.166-.258.396-.476.764l-.542.916c-.773 1.307-2.69 1.307-3.464 0l-.542-.916a10.605 10.605 0 0 0-.476-.764c-.112-.154-.177-.204-.224-.232c-.045-.026-.122-.058-.32-.08c-.212-.023-.49-.03-.93-.037c-1.255-.021-2.171-.095-2.976-.429A5.75 5.75 0 0 1 1.688 16.2c-.235-.566-.338-1.178-.389-1.913c-.049-.723-.049-1.618-.049-2.76v-1.066c0-1.604 0-2.86.095-3.865c.098-1.023.3-1.862.752-2.6a5.75 5.75 0 0 1 1.899-1.899c.738-.452 1.577-.654 2.6-.752C7.6 1.25 8.857 1.25 10.461 1.25M6.739 2.839c-.914.087-1.495.253-1.959.537A4.25 4.25 0 0 0 3.376 4.78c-.284.464-.45 1.045-.537 1.96c-.088.924-.089 2.11-.089 3.761v1c0 1.175 0 2.019.046 2.685c.045.659.131 1.089.278 1.441a4.25 4.25 0 0 0 2.3 2.3c.515.214 1.173.294 2.429.316h.031c.398.007.747.013 1.037.045c.311.035.616.104.909.274c.29.17.5.395.682.645c.169.232.342.525.538.856l.559.944a.52.52 0 0 0 .882 0l.559-.944c.196-.331.37-.624.538-.856c.182-.25.392-.476.682-.645c.293-.17.598-.24.909-.274c.29-.032.639-.038 1.037-.045h.032c1.255-.022 1.913-.102 2.428-.316a4.25 4.25 0 0 0 2.3-2.3c.147-.352.233-.782.278-1.441c.046-.666.046-1.51.046-2.685v-1c0-1.651 0-2.837-.089-3.762c-.087-.914-.253-1.495-.537-1.959a4.25 4.25 0 0 0-1.403-1.403c-.464-.284-1.045-.45-1.96-.537c-.924-.088-2.11-.089-3.761-.089h-3c-1.651 0-2.837 0-3.762.089" clip-rule="evenodd"/><path fill="currentColor" d="M9 11a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0"/></svg><span>参与讨论</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.28.1" async></script>

<!-- optional -->

  <script>
    function load_twikoo() {
        if (!document.querySelectorAll("#twikoo_container")[0]) return;
        utils.js('https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js', {defer: true}).then(function () {
            const el = document.getElementById("twikoo_container");
            var path = el.getAttribute('comment_id');
            if (!path) {
                path = decodeURI(window.location.pathname);
            }
            twikoo.init(Object.assign({"js":"https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js","envId":"https://blog-comments-phi.vercel.app"}, {
                el: '#twikoo_container',
                path: path,
            }));
        });
    }

    window.addEventListener('DOMContentLoaded', (event) => {
        load_twikoo();
    });
</script>



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
