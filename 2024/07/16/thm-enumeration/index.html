<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>THM-Enumeration | hybcx</title><meta name="keywords" content="TryHackMe"><meta name="author" content="hybcx,19815455497@163.com"><meta name="copyright" content="hybcx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="THM-Enumeration"><meta name="application-name" content="THM-Enumeration"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="THM-Enumeration"><meta property="og:url" content="http://hybcx.xyz/2024/07/16/thm-enumeration/index.html"><meta property="og:site_name" content="hybcx"><meta property="og:description" content="0x01 介绍 这个房间的重点是利用后枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。而且，我们可能进行了权限升级；换句话说，我们可能在目标系统上拥有管理员或root权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。 如果您对提"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="hybcx"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="0x01 介绍 这个房间的重点是利用后枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。而且，我们可能进行了权限升级；换句话说，我们可能在目标系统上拥有管理员或root权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。 如果您对提"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://hybcx.xyz/2024/07/16/thm-enumeration/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d98ea8480e5ec98a243adfc7bd46b93a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"向✌们无限学习","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"3JLPGIZJOJw6Nvu2","LingQueMonitorID":"3JLPOLHV5W6IAty5"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: {"appId":"Z7A3XW4R2I","apiKey":"12db1ad54372045549ef465881c17e743","indexName":"my-hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: hybcx","link":"链接: ","source":"来源: hybcx","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'hybcx',
  title: 'THM-Enumeration',
  postAI: '',
  pageFillDescription: '0x01 介绍, 0x02 目的, 0x03 Linux枚举, System, Users, Networking, Running Services, 0x04 Windows枚举, System, Users, Networking, 0x05 DNSSMB and SNMP, DNS, SMB, SNMP, 0x06 更多Windows工具, Sysinternals Suite 系统内部套件, Process Hacker, GhostPack Seatbelt, 0x07 总结介绍这个房间的重点是利用后枚举换句话说我们假设我们已经成功获得了某种形式的系统访问权限而且我们可能进行了权限升级换句话说我们可能在目标系统上拥有管理员或权限即使使用非特权帐户即非或管理员本房间讨论的一些技术和工具仍然可以提供有用的输出如果您对提权感兴趣可以查看提权室和室此外还有两个方便的脚本和分别用于和权限升级我们的目的是收集更多信息以帮助我们获得对目标网络的更多访问权限例如我们可能会找到登录凭据来授予对另一个系统的访问权限我们专注于标准系统上常用的工具来收集有关目标的更多信息作为系统的一部分这些工具看起来无害并且产生的噪音最少我们假设您可以访问目标上的命令行界面例如系统上的或系统上的从系统上的一种类型的开始通常很容易切换到另一种类型同样从开始您可以切换到如果可用我们刚刚发出命令在下面的终端中启动交互式命令行这个房间的组织如下枚举的目的使用常用安装工具进行枚举系统用户网络和正在运行的服务使用内置工具进行枚举系统用户网络和正在运行的服务附加工具示例安全带尽管这并不是绝对必要的但我们建议您在完成这一单元之前先完成目的当您获得目标系统的时您通常已经对该系统有了非常基本的了解如果它是一个服务器你已经知道你利用了哪个服务但是您不一定知道其他详细信息例如用户名或网络共享因此看起来就像一个暗室你对周围的事物有不完整和模糊的了解从这个意义上说枚举可以帮助您构建更完整更准确的图景后利用枚举背后的目的是收集尽可能多的有关系统及其网络的信息被利用的系统可能是公司台式机笔记本电脑或服务器我们的目标是收集信息使我们能够转向网络上的其他系统或掠夺当前系统我们有兴趣收集的一些信息包括用户和组主机名路由表网络共享网络服务防火墙配置服务设置和审核配置和详细信息寻找凭证保存在网络浏览器或客户端应用程序上没有办法列出我们可能偶然发现的所有内容例如我们可能会找到可以授予我们访问其他系统的密钥在基于密钥的身份验证中我们生成密钥对公钥和私钥公钥安装在服务器上因此服务器将信任任何可以证明相关私钥知识的系统此外我们可能会偶然发现用户文档或桌面目录中保存的敏感数据认为有人可能保留或而不是适当的密码管理器源代码还可能包含隐藏的密钥和密码特别是在源代码不打算公开的情况下枚举此任务重点是在访问后枚举机器例如尽管有些命令提供多个区域的信息但我们尝试根据我们期望获取的信息将命令分为四类系统用户联网运行服务我们建议您单击启动和启动机器以便您可以在此任务结束时进行实验并回答问题在系统上我们可以通过搜索中以结尾的文件或链接来获取有关发行版和发布版本的更多信息运行可以帮助我们找到此类文件让我们看看上的情况让我们尝试一下系统我们可以使用命令找到系统的名称系统上的各种文件可以提供大量有用的信息特别是请考虑以下和任何用户都可以读取文件和但是密码文件需要权限因为它包含哈希密码如果你设法破解哈希值你就会知道用户的原始密码同样各种目录可能会泄露有关用户的信息并且可能包含敏感文件一个是在处找到的邮件目录要查找已安装的应用程序您可以考虑列出和中的文件在基于的系统上您可以使用获取所有已安装软件包的列表表示我们要查询所有包在基于的系统上您可以使用获取已安装软件包的列表下面的输出是从服务器获得的等文件会泄露用户名但是各种命令可以提供有关系统上其他用户及其行踪的更多信息和见解您可以使用显示谁登录我们可以看到用户直接登录系统而用户和通过网络连接我们可以看到他们的情况地址请注意不应与打印您的有效用户的混淆要将事情提升到一个新的水平您可以使用它显示谁登录了以及他们正在做什么根据下面的终端输出在此示例中正在编辑正在运行要打印真实有效的用户和组您可以发出命令用于您想知道最近谁在使用该系统吗显示最后登录用户的列表此外我们还可以看到谁注销了以及他们保持联系的时间在下面的输出中用户保持登录状态近个小时而用户在四分钟后注销最后值得一提的是列出了当前系统上调用用户允许的命令地址可以使用可缩写为或旧命令其包不再维护下面的终端输出显示了网络接口其地址和子网掩码与一样服务器可以在中找到对于使用进行网络配置的系统请考虑以下终端输出即域名解析服务器设置为是了解网络连接路由表和接口统计信息的有用命令我们在下表中解释了其中的一些选项显示监听和非监听套接字仅显示监听套接字显示数字输出而不是解析地址和端口号显示所属程序的和名称输出中看到的正在侦听端口而正在侦听和地址上的端口请注意要获取所有进程和程序名称您需要以身份运行或使用将显示所有和侦听和已建立的连接以及数字格式的程序名称以及地址和端口人们可能会认为在访问目标计算机之前使用会提供类似的结果然而这并不完全正确需要生成相对大量的数据包来检查开放端口这可以触发入侵检测和防御系统此外路由上的防火墙可能会丢弃某些数据包并阻碍扫描从而导致结果不完整代表列出打开的文件如果我们只想显示互联网和网络连接我们可以使用下面的终端输出显示了和侦听服务以及正在进行的连接用户通过端口连接到服务器请注意要获取匹配程序的完整列表您需要以身份运行或使用由于列表可能会变得相当长因此您可以通过指定您感兴趣的端口例如端口来进一步过滤输出通过运行我们将输出限制为与端口相关的输出如下面的终端输出所示服务器正在监听和地址的端口获取正在运行的进程的快照可以提供许多见解可让您发现正在运行的进程以及有关它们的大量信息您可以使用列出系统上的每个进程其中选择所有进程有关该过程的更多信息您可以添加表示完整格式添加表示长格式尝试和您可以获得类似的输出并使用语法查看所有进程或请注意使用语法时和是必需的因为它们解除了仅限您自己和必须有限制换句话说可以显示所有进程用于获取有关拥有该进程的用户的详细信息所有进程全格式列表职位格式长格式面向用户的格式要获得更多可视化输出您可以发出来打印进程树代表森林它创建一个艺术流程层次结构如下面的终端输出所示总而言之请记住使用或来获取所有正在运行的进程的列表考虑通过管道输出以显示包含某些单词的输出行下面的终端输出显示了其中包含的行如果您尚未启动连接的计算机请启动它因为您需要它来回答以下问题您可以使用登录其中登录凭据为枚举在此任务中我们假设您有权访问主机上的您可能通过利用漏洞并获取或反向来获得此访问权限您还可能在您利用的系统上安装了后门或设置了服务器在所有情况下以下命令都需要才能运行在此任务中我们重点枚举主机对于枚举建议您查看枚举室如果您对主机上的权限升级感兴趣我们推荐我们建议您单击启动和启动机器以便您可以在此任务结束时进行实验并回答问题可以为我们提供有关系统的详细信息例如其内部版本号和已安装的补丁的命令在下面的示例中我们可以看到已安装哪些修补程序您可以使用检查已安装的更新此信息将使您了解系统修补和更新的速度您可以使用检查已安装和启动的服务期望得到一长串名单下面的输出已被截断如果您只对已安装的应用程序感兴趣则可以发出如果您在连接的虚拟机上运行此命令您将获得类似于以下输出的内容要知道你是谁你可以运行此外要了解您的能力即您的特权您可以使用下面的终端输出显示了一个示例此外您可以使用来了解您属于哪些组下面的终端输出显示该用户属于其他组中的您可以通过运行查看用户如果系统是域控制器您可以使用发现可用组否则使用发现可用组如下面的终端所示您可以使用命令列出属于本地管理员组的用户使用查看机器上的本地设置此外如果计算机属于某个域则可以使用此命令有助于了解密码策略例如最短密码长度最长密码期限和锁定持续时间您可以使用命令来了解您的系统网络配置如果您想了解所有与网络相关的设置可以使用下面的终端输出显示了使用时的输出例如如果我们想了解服务器我们可以使用在上我们可以使用来获取各种信息例如系统正在侦听哪些端口哪些连接处于活动状态以及谁正在使用它们在此示例中我们使用选项显示所有侦听端口和活动连接让我们找到连接中涉及的二进制文件而用于避免解析地址和端口号最后显示进程在下面显示的部分输出中我们可以看到显示服务器正在侦听端口和进程分别位于端口和上此外我们可以看到与服务器的两个已建立的连接如状态所示您可能认为通过端口扫描目标系统可以获得相同的结果然而由于两个原因这是不准确的防火墙可能会阻止扫描主机到达特定网络端口此外端口扫描系统会产生大量流量这与不同它的噪音为零最后值得一提的是使用可以帮助您发现同一上最近与您的系统进行通信的其他系统代表地址解析协议显示当前条目即与您的系统通信的同一上的系统的物理地址下面显示了示例输出这表明这些地址已与我们的系统进行了某种通信通信可以是尝试连接甚至是简单的请注意并不代表系统因为它是子网广播地址如果您尚未启动附加的请启动它因为您需要它来回答以下问题您可以通过中的连接到例如使用其中登录凭据为当我们介绍枚举时接触和是个好主意我们都熟悉域名系统查询可以在其中查找和记录等如果您想温习一下知识我们建议您访问详细室如果我们可以获得服务器负责应答的所有记录的副本我们可能会发现我们不知道存在的主机尝试区域传输的一种简单方法是通过命令如果您想了解有关和类似命令的更多信息我们建议您查看被动侦察室根据服务器配置区域传输可能会受到限制如果不限制应该可以使用来实现表示我们正在请求区域传输而位于之前我们要查询与指定服务器消息块是一种提供对文件和打印机的共享访问的通信协议我们可以使用检查共享文件夹这是输出的示例我们可以看到是在名称下共享的简单网络管理协议旨在帮助收集有关网络上不同设备的信息它可以让您了解各种网络事件从磁盘故障的服务器到打印机墨水耗尽因此可以为攻击者保存大量信息查询与相关的服务器的一个简单工具是您可以在的目录中找到它语法非常简单如果您想在本地机器上安装请考虑以下命令确保您正在运行任务中的计算机并回答以下问题更多工具在这个房间里我们的重点是任何现代系统上都可以使用的命令行内置工具我们没有介绍图形用户界面工具此外我们没有介绍任何需要额外下载和安装步骤的程序此任务提到了三个不是内置命令行工具的选项系统内部套件是一组命令行和实用程序和工具提供与系统相关的各个方面的信息为了给您一个想法我们在下表中列出了一些示例显示进程以及打开的文件和注册表项监控文件系统进程和注册表提供有关流程的信息显示已登录的用户检查实用程序索引以获取实用程序的完整列表如果您想了解更多信息并尝试使用这些不同的实用程序我们建议您使用室是另一个高效可靠的工具可以让您收集有关正在运行的进程的信息为您提供有关正在运行的进程和相关活动网络连接的详细信息此外它还可以让您深入了解从和内存到磁盘和网络的系统资源利用率是系列的一部分是一个用编写的工具它没有以二进制形式正式发布因此您需要使用自行编译总结这个房间的重点是和系统中的内置命令行工具尽管命令参数和结果输出不同但两个系统中都存在许多命令下表显示了我们用来获取有关系统的更多信息的主要和命令显示系统的主机名显示谁已登录显示有效用户名显示谁已登录以及他们正在做什么显示最后登录用户的列表显示网络接口和地址显示缓存打印网络连接显示当前进程的快照显示操作系统配置信息包括服务包级别显示用户名和组信息以及相应的安全标识符显示协议统计信息和当前网络连接显示计算机上的用户帐户显示计算机上的本地组显示到物理地址的转换表这个房间专注于或机器的后利用枚举对于与相关的枚举我们建议您加入枚举房间',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-08-01 16:12:21',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://yansedaima.com/" title="颜色代码表"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408121908150.svg" alt="颜色代码表"/><span class="back-menu-item-text">颜色代码表</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">hybcx</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box-archive"></use></svg><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shapes"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tags"></use></svg><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-artstation"></use></svg><span> 朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-paper-plane"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shoe-prints1"></use></svg><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF%E8%B5%9B%E4%BA%8B/" style="font-size: 1.05rem;">CTF赛事<sup>18</sup></a><a href="/tags/CVE/" style="font-size: 1.05rem;">CVE<sup>15</sup></a><a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">Java反序列化<sup>3</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">Java基础<sup>1</sup></a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" style="font-size: 1.05rem;">Linux提权<sup>2</sup></a><a href="/tags/MISC/" style="font-size: 1.05rem;">MISC<sup>1</sup></a><a href="/tags/Metasploit/" style="font-size: 1.05rem;">Metasploit<sup>3</sup></a><a href="/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.05rem;">PHP代码审计<sup>2</sup></a><a href="/tags/SecBook/" style="font-size: 1.05rem;">SecBook<sup>1</sup></a><a href="/tags/TryHackMe/" style="font-size: 1.05rem;">TryHackMe<sup>36</sup></a><a href="/tags/Windows%E6%8F%90%E6%9D%83/" style="font-size: 1.05rem;">Windows提权<sup>2</sup></a><a href="/tags/reverse%E7%B3%BB%E5%88%97/" style="font-size: 1.05rem;">reverse系列<sup>2</sup></a><a href="/tags/tryhackme/" style="font-size: 1.05rem;">tryhackme<sup>1</sup></a><a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">web渗透<sup>2</sup></a><a href="/tags/web%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">web知识总结<sup>2</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.05rem;">代码审计<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">内网渗透<sup>3</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA/" style="font-size: 1.05rem;">内网靶场<sup>2</sup></a><a href="/tags/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">基本知识<sup>21</sup></a><a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">基础知识<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 1.05rem;">攻防世界<sup>1</sup></a><a href="/tags/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" style="font-size: 1.05rem;">玄机应急响应靶场<sup>1</sup></a><a href="/tags/%E7%BA%A2%E9%98%9F%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">红队渗透<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">16</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">18</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/TryHackMe/" itemprop="url">TryHackMe</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/TryHackMe/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>TryHackMe</span></a></span></div></div><h1 class="post-title" itemprop="name headline">THM-Enumeration</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-07-16T10:30:53.000Z" title="发表于 2024-07-16 18:30:53">2024-07-16</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-08-01T08:12:21.553Z" title="更新于 2024-08-01 16:12:21">2024-08-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">8.6k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>38分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="THM-Enumeration"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为太原"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>太原</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/07/16/thm-enumeration/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2024/07/16/thm-enumeration/" itemprop="commentCount"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://hybcx.xyz/2024/07/16/thm-enumeration/"><header><a class="post-meta-categories" href="/categories/TryHackMe/" itemprop="url">TryHackMe</a><a href="/tags/TryHackMe/" tabindex="-1" itemprop="url">TryHackMe</a><h1 id="CrawlerTitle" itemprop="name headline">THM-Enumeration</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">hybcx</span><time itemprop="dateCreated datePublished" datetime="2024-07-16T10:30:53.000Z" title="发表于 2024-07-16 18:30:53">2024-07-16</time><time itemprop="dateCreated datePublished" datetime="2024-08-01T08:12:21.553Z" title="更新于 2024-08-01 16:12:21">2024-08-01</time></header><h1 id="0x01-介绍">0x01 介绍</h1>
<p>这个房间的重点是利用后枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。而且，我们可能进行了权限升级；换句话说，我们可能在目标系统上拥有管理员或root权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。</p>
<p>如果您对提权感兴趣，可以查看<a target="_blank" rel="noopener" href="https://tryhackme.com/room/windowsprivesc20">Windows提权室</a>和<a target="_blank" rel="noopener" href="https://tryhackme.com/room/linprivesc">Linux PrivEsc</a>室。此外，还有两个方便的脚本，<a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS">WinPEAS</a> 和 <a target="_blank" rel="noopener" href="https://grimbins.github.io/grimbins/linpeas/">LinPEAS</a> 分别用于 MS Windows 和 Linux 权限升级。</p>
<p>我们的目的是收集更多信息，以帮助我们获得对目标网络的更多访问权限。例如，我们可能会找到登录凭据来授予对另一个系统的访问权限。我们专注于标准系统上常用的工具来收集有关目标的更多信息。作为系统的一部分，这些工具看起来无害，并且产生的“噪音”最少。</p>
<p>我们假设您可以访问目标上的命令行界面，例如 Linux 系统上的 <code>bash</code> 或 MS Windows 系统上的 <code>cmd.exe</code> 。从 Linux 系统上的一种类型的 shell 开始，通常很容易切换到另一种类型。同样，从 <code>cmd.exe</code> 开始，您可以切换到 PowerShell（如果可用）。我们刚刚发出命令 <code>powershell.exe</code> 在下面的终端中启动 PowerShell 交互式命令行。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ Microsoft Windows [Version <span class="hljs-number">10.0</span>.<span class="hljs-number">17763.2928</span>]
(c) <span class="hljs-number">2018</span> Microsoft Corporation. All rights reserved.

strategos<span class="hljs-keyword">@RED-WIN-ENUM</span> <span class="hljs-attribute">C</span>:\Users\strategos&gt;powershell.exe
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS <span class="hljs-attribute">C</span>:\Users\strategos&gt;</code></pre>
<p>这个房间的组织如下：</p>
<ul>
<li>枚举的目的</li>
<li>使用常用安装工具进行 Linux 枚举：系统、用户、网络和正在运行的服务</li>
<li>使用内置工具进行 MS Windows 枚举：系统、用户、网络和正在运行的服务</li>
<li>Examples of additional tools: Seatbelt 附加工具示例：安全带</li>
</ul>
<p>尽管这并不是绝对必要的，但我们建议您在完成这一单元之前先完成<a target="_blank" rel="noopener" href="https://tryhackme.com/room/thelayoftheland">The Lay of the Land</a> Room</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211288.png" alt="image-20240716190354307"></p>
<h1 id="0x02-目的">0x02 目的</h1>
<p>当您获得目标系统的“shell”时，您通常已经对该系统有了非常基本的了解。如果它是一个服务器，你已经知道你利用了哪个服务；但是，您不一定知道其他详细信息，例如用户名或网络共享。因此，shell看起来就像一个“暗室”，你对周围的事物有不完整和模糊的了解。从这个意义上说，枚举可以帮助您构建更完整、更准确的图景。</p>
<p>后利用枚举背后的目的是收集尽可能多的有关系统及其网络的信息。被利用的系统可能是公司台式机/笔记本电脑或服务器。我们的目标是收集信息，使我们能够转向网络上的其他系统或掠夺当前系统。我们有兴趣收集的一些信息包括：</p>
<ul>
<li>Users and groups 用户和组</li>
<li>Hostnames 主机名</li>
<li>Routing tables 路由表</li>
<li>Network shares 网络共享</li>
<li>Network services 网络服务</li>
<li>Applications and banners</li>
<li>Firewall configurations 防火墙配置</li>
<li>Service settings and audit configurations 服务设置和审核配置</li>
<li>SNMP and DNS details SNMP 和 DNS 详细信息</li>
<li>寻找凭证（保存在网络浏览器或客户端应用程序上）</li>
</ul>
<p>没有办法列出我们可能偶然发现的所有内容。例如，我们可能会找到可以授予我们访问其他系统的 SSH 密钥。在基于 SSH 密钥的身份验证中，我们生成 SSH 密钥对（公钥和私钥）；公钥安装在服务器上。因此，服务器将信任任何可以证明相关私钥知识的系统。</p>
<p>此外，我们可能会偶然发现用户文档或桌面目录中保存的敏感数据。认为有人可能保留 <code>passwords.txt</code> 或 <code>passwords.xlsx</code> 而不是适当的密码管理器。源代码还可能包含隐藏的密钥和密码，特别是在源代码不打算公开的情况下。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211290.png" alt="image-20240716190750185"></p>
<h1 id="0x03-linux枚举">0x03 Linux枚举</h1>
<p>此任务重点是在访问 shell 后枚举 Linux 机器，例如 <code>bash</code> 。尽管有些命令提供多个区域的信息，但我们尝试根据我们期望获取的信息将命令分为四类。</p>
<ul>
<li>System 系统</li>
<li>Users 用户</li>
<li>Networking 联网</li>
<li>Running Services 运行服务</li>
</ul>
<p>我们建议您单击“启动 AttackBox”和“启动机器”，以便您可以在此任务结束时进行实验并回答问题。</p>
<h2 id="system">System</h2>
<p>在 Linux 系统上，我们可以通过搜索 <code>/etc/</code> 中以 <code>-release</code> 结尾的文件或链接来获取有关 Linux 发行版和发布版本的更多信息。运行 <code>ls /etc/*-release</code> 可以帮助我们找到此类文件。让我们看看 CentOS Linux 上的情况。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ls /etc/*-release
/etc/centos-release  /etc/os-release  /etc/redhat-release  /etc/system-release
$ cat /etc/os-release 
NAME=<span class="hljs-string">"CentOS Linux"</span>
VERSION=<span class="hljs-string">"7 (Core)"</span>
[...]</code></pre>
<p>让我们尝试一下 Fedora 系统。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ls /etc/*-release
/etc/fedora-release@  /etc/os-release@  /etc/redhat-release@  /etc/system-release@
$ cat /etc/os-release
NAME=<span class="hljs-string">"Fedora Linux"</span>
VERSION=<span class="hljs-string">"36 (Workstation Edition)"</span>
[...]</code></pre>
<p>我们可以使用命令 <code>hostname</code> 找到系统的名称。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ hostname
rpm-red-enum.thm</code></pre>
<p>系统上的各种文件可以提供大量有用的信息。特别是，请考虑以下 <code>/etc/passwd</code> 、 <code>/etc/group</code> 和 <code>/etc/shadow</code> 。任何用户都可以读取文件 <code>passwd</code> 和 <code>group</code> 。但是， <code>shadow</code> 密码文件需要 root 权限，因为它包含哈希密码。如果你设法破解哈希值，你就会知道用户的原始密码。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ cat /etc/passwd
<span class="hljs-attribute">root</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-attribute">root</span>:/<span class="hljs-attribute">root</span>:/bin/bash
[...]
<span class="hljs-attribute">michael</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1001</span>:<span class="hljs-number">1001</span>::/home/<span class="hljs-attribute">michael</span>:/bin/bash
<span class="hljs-attribute">peter</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1002</span>:<span class="hljs-number">1002</span>::/home/<span class="hljs-attribute">peter</span>:/bin/bash
<span class="hljs-attribute">jane</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1003</span>:<span class="hljs-number">1003</span>::/home/<span class="hljs-attribute">jane</span>:/bin/bash
<span class="hljs-attribute">randa</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1004</span>:<span class="hljs-number">1004</span>::/home/<span class="hljs-attribute">randa</span>:/bin/bash

$ cat /etc/group
<span class="hljs-attribute">root</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">0</span>:
[...]
<span class="hljs-attribute">michael</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1001</span>:
<span class="hljs-attribute">peter</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1002</span>:
<span class="hljs-attribute">jane</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1003</span>:
<span class="hljs-attribute">randa</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1004</span>:

$ sudo cat /etc/shadow
<span class="hljs-attribute">root</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$pZlRFi09</span><span class="hljs-variable">$qqgNBS</span>.<span class="hljs-number">00</span>qtcUF9x0yHetjJbXsw0PAwQabpCilmAB47ye3OzmmJVfV6DxBYyUoWBHtTXPU0kQEVUQfPtZPO3C.:<span class="hljs-number">19131</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
[...]
<span class="hljs-attribute">michael</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$GADCGz6m</span><span class="hljs-variable">$g</span>.ROJGcSX/<span class="hljs-number">910</span>DEipiPjU6clo6Z6/uBZ9Fvg3IaqsVnMA.UZtebTgGHpRU4NZFXTffjKPvOAgPKbtb2nQrVU70:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">peter</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$RN4fdNxf</span><span class="hljs-variable">$wvgzdlrIVYBJjKe3s2eqlIQhvMrtwAWBsjuxL5xMVaIw4nL9pCshJlrMu2iyj</span>/NAryBmItFbhYAVznqRcFWIz1:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">jane</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$Ees6f7QM</span><span class="hljs-variable">$TL8D8yFXVXtIOY9sKjMqJ7BoHK1EHEeqM5dojTaqO52V6CPiGq2W6XjljOGx</span>/<span class="hljs-number">08</span>rSo4QXsBtLUC3PmewpeZ/Q0:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">randa</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$dYsVoPyy</span><span class="hljs-variable">$WR43vaETwoWooZvR03AZGPPKxjrGQ4jTb0uAHDy2GqGEOZyXvrQNH10tGlLIHac7EZGV8hSIfuXP0SnwVmnZn0</span>:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::</code></pre>
<p>同样，各种目录可能会泄露有关用户的信息，并且可能包含敏感文件；一个是在 <code>/var/mail/</code> 处找到的邮件目录。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ls -lh /var/mail/
total <span class="hljs-number">4.0</span>K
-rw-rw----. <span class="hljs-number">1</span> jane      mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">15</span> jane
-rw-rw----. <span class="hljs-number">1</span> michael   mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">13</span> michael
-rw-rw----. <span class="hljs-number">1</span> peter     mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">14</span> peter
-rw-rw----. <span class="hljs-number">1</span> randa     mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">15</span> randa
-rw-------. <span class="hljs-number">1</span> root      mail <span class="hljs-number">639</span> May <span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">37</span> root</code></pre>
<p>要查找已安装的应用程序，您可以考虑列出 <code>/usr/bin/</code> 和 <code>/sbin/</code> 中的文件：</p>
<ul>
<li><code>ls -lh /usr/bin/</code></li>
<li><code>ls -lh /sbin/</code></li>
</ul>
<p>在基于 RPM 的 Linux 系统上，您可以使用 <code>rpm -qa</code> 获取所有已安装软件包的列表。 <code>-qa</code> 表示我们要查询所有包。</p>
<p>在基于 Debian 的 Linux 系统上，您可以使用 <code>dpkg -l</code> 获取已安装软件包的列表。下面的输出是从 Ubuntu 服务器获得的。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ dpkg -l
Desired=Unknown/Install/Remove/Purge/Hold
| Status=<span class="hljs-keyword">Not</span>/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,<span class="hljs-attribute">Err</span>: uppercase=bad)
||/ Name                                  Version                            Architecture Description
+++-=====================================-==================================-============-===============================================================================
ii  accountsservice                       <span class="hljs-number">0.6</span>.<span class="hljs-number">55</span>-<span class="hljs-number">0</span>ubuntu12~<span class="hljs-number">20.04</span>.<span class="hljs-number">5</span>           amd64        query <span class="hljs-keyword">and</span> manipulate user account information
ii  adduser                               <span class="hljs-number">3.118</span>ubuntu2                       all          add <span class="hljs-keyword">and</span> remove users <span class="hljs-keyword">and</span> groups
ii  alsa-topology-conf                    <span class="hljs-number">1.2</span>.<span class="hljs-number">2</span>-<span class="hljs-number">1</span>                            all          ALSA topology configuration files
ii  alsa-ucm-conf                         <span class="hljs-number">1.2</span>.<span class="hljs-number">2</span>-<span class="hljs-number">1</span>ubuntu0.<span class="hljs-number">13</span>                  all          ALSA Use Case Manager configuration files
ii  amd64-microcode                       <span class="hljs-number">3.20191218</span>.<span class="hljs-number">1</span>ubuntu1                amd64        Processor microcode firmware for AMD CPUs
[...   ]
ii  zlib1<span class="hljs-attribute">g-dev</span>:amd64                      <span class="hljs-number">1</span>:<span class="hljs-number">1.2</span>.<span class="hljs-number">11</span>.dfsg-<span class="hljs-number">2</span>ubuntu1.<span class="hljs-number">3</span>           amd64        compression library - development</code></pre>
<h2 id="users">Users</h2>
<p>Files such as <code>/etc/passwd</code> reveal the usernames; however, various commands can provide more information and insights about other users on the system and their whereabouts.<br>
<code>/etc/passwd</code> 等文件会泄露用户名；但是，各种命令可以提供有关系统上其他用户及其行踪的更多信息和见解。</p>
<p>您可以使用 <code>who</code> 显示谁登录。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ who
root     tty1         <span class="hljs-number">2022</span>-<span class="hljs-number">05</span>-<span class="hljs-number">18</span> <span class="hljs-number">13</span>:<span class="hljs-number">24</span>
jane     pts/<span class="hljs-number">0</span>        <span class="hljs-number">2022</span>-<span class="hljs-number">05</span>-<span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">17</span> (<span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>)
peter    pts/<span class="hljs-number">1</span>        <span class="hljs-number">2022</span>-<span class="hljs-number">05</span>-<span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> (<span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>)</code></pre>
<p>我们可以看到用户 <code>root</code> 直接登录系统，而用户 <code>jane</code> 和 <code>peter</code> 通过网络连接，我们可以看到他们的情况IP 地址。</p>
<p>请注意， <code>who</code> 不应与打印您的有效用户 ID 的 <code>whoami</code> 混淆。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ whoami
jane</code></pre>
<p>要将事情提升到一个新的水平，您可以使用 <code>w</code> ，它显示谁登录了以及他们正在做什么。根据下面的终端输出，在此示例中， <code>peter</code> 正在编辑 <code>notes.txt</code> ， <code>jane</code> 正在运行 <code>w</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ w
 <span class="hljs-number">07</span>:<span class="hljs-number">18</span>:<span class="hljs-number">43</span> up <span class="hljs-number">18</span>:<span class="hljs-number">05</span>,  <span class="hljs-number">3</span> users,  load <span class="hljs-attribute">average</span>: <span class="hljs-number">0.00</span>, <span class="hljs-number">0.01</span>, <span class="hljs-number">0.05</span>
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     tty1                      Wed13   <span class="hljs-number">17</span>:<span class="hljs-number">52</span>m  <span class="hljs-number">0.00s</span>  <span class="hljs-number">0.00s</span> less -s
jane     pts/<span class="hljs-number">0</span>    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>     <span class="hljs-number">07</span>:<span class="hljs-number">17</span>    <span class="hljs-number">3.00s</span>  <span class="hljs-number">0.01s</span>  <span class="hljs-number">0.00s</span> w
peter    pts/<span class="hljs-number">1</span>    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>     <span class="hljs-number">07</span>:<span class="hljs-number">13</span>    <span class="hljs-number">5</span>:<span class="hljs-number">23</span>   <span class="hljs-number">0.00s</span>  <span class="hljs-number">0.00s</span> vi notes.txt</code></pre>
<p>要打印真实有效的用户和组IDS，您可以发出命令 <code>id</code> （用于ID）。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ id
uid=<span class="hljs-number">1003</span>(jane) gid=<span class="hljs-number">1003</span>(jane) groups=<span class="hljs-number">1003</span>(jane) context=unconfined_<span class="hljs-attribute">u</span>:unconfined_<span class="hljs-attribute">r</span>:unconfined_<span class="hljs-attribute">t</span>:s0-s0:c0.c1023</code></pre>
<p>您想知道最近谁在使用该系统吗？ <code>last</code> 显示最后登录用户的列表；此外，我们还可以看到谁注销了以及他们保持联系的时间。在下面的输出中，用户 <code>randa</code> 保持登录状态近 17 个小时，而用户 <code>michael</code> 在四分钟后注销。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ last
jane     pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>     Thu May <span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">17</span>   still logged in   
peter    pts/<span class="hljs-number">1</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>     Thu May <span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>   still logged in   
michael  pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>       Thu May <span class="hljs-number">19</span> <span class="hljs-number">05</span>:<span class="hljs-number">12</span> - <span class="hljs-number">05</span>:<span class="hljs-number">17</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">04</span>)    
randa    pts/<span class="hljs-number">1</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.107</span>     Wed May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">18</span> - <span class="hljs-number">07</span>:<span class="hljs-number">08</span>  (<span class="hljs-number">16</span>:<span class="hljs-number">49</span>)    
root     tty1                          Wed May <span class="hljs-number">18</span> <span class="hljs-number">13</span>:<span class="hljs-number">24</span>   still logged in
[...]</code></pre>
<p>最后，值得一提的是， <code>sudo -l</code> 列出了当前系统上调用用户允许的命令。</p>
<h2 id="networking">Networking</h2>
<p>IP 地址可以使用 <code>ip address show</code> （可缩写为 <code>ip a s</code> ）或旧命令 <code>ifconfig -a</code> （其包不再维护。）下面的终端输出显示了网络接口 <code>ens33</code> ，其 IP 地址 <code>10.20.30.129</code> 和子网掩码 <code>255.255.255.0</code> 与 <code>24</code> 一样。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ip a s
<span class="hljs-number">1</span>: <span class="hljs-attribute">lo</span>: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="hljs-number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="hljs-number">1000</span>
    link/loopback <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> brd <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
    inet <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/<span class="hljs-number">8</span> scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::<span class="hljs-number">1</span>/<span class="hljs-number">128</span> scope host 
       valid_lft forever preferred_lft forever
<span class="hljs-number">2</span>: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="hljs-number">1500</span> qdisc pfifo_fast state UP group default qlen <span class="hljs-number">1000</span>
    link/ether <span class="hljs-number">00</span>:<span class="hljs-number">0</span><span class="hljs-attribute">c</span>:<span class="hljs-number">29</span>:a2:<span class="hljs-number">0</span><span class="hljs-attribute">e</span>:<span class="hljs-number">7</span>e brd <span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:ff
    inet <span class="hljs-number">10.20</span>.<span class="hljs-number">30.129</span>/<span class="hljs-number">24</span> brd <span class="hljs-number">10.20</span>.<span class="hljs-number">30.255</span> scope global noprefixroute dynamic ens33
       valid_lft <span class="hljs-number">1580s</span>ec preferred_lft <span class="hljs-number">1580s</span>ec
    inet6 fe80::<span class="hljs-number">761</span><span class="hljs-attribute">a</span>:b360:<span class="hljs-number">78</span>:<span class="hljs-number">26</span>cd/<span class="hljs-number">64</span> scope link noprefixroute 
       valid_lft forever preferred_lft forever</code></pre>
<p>DNS 服务器可以在 <code>/etc/resolv.conf</code> 中找到。对于使用 DHCP 进行网络配置的系统，请考虑以下终端输出。 DNS，即域名解析服务器，设置为 <code>10.20.30.2</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ cat /etc/resolv.conf
# Generated by NetworkManager
search localdomain thm
nameserver <span class="hljs-number">10.20</span>.<span class="hljs-number">30.2</span></code></pre>
<p><code>netstat</code> 是了解网络连接、路由表和接口统计信息的有用命令。我们在下表中解释了其中的一些选项。</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a</code></td>
<td>显示监听和非监听套接字</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>仅显示监听套接字</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>显示数字输出而不是解析 IP 地址和端口号</td>
</tr>
<tr>
<td><code>-t</code></td>
<td>TCP</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>UDP</td>
</tr>
<tr>
<td><code>-x</code></td>
<td>UNIX</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>显示socket所属程序的PID和名称</td>
</tr>
</tbody>
</table>
<p>输出中看到的， <code>sshd</code> 正在侦听 SSH 端口，而 <code>master</code> 正在侦听 IPv4 和 IPv6 地址上的 SMTP 端口。请注意，要获取所有 PID（进程 ID）和程序名称，您需要以 root 身份运行 <code>netstat</code> 或使用 <code>sudo netstat</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo netstat -plt
Active Internet connections (<span class="hljs-keyword">only</span> servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:ssh             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">978</span>/sshd            
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-attribute">localhost</span>:smtp          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">1141</span>/master         
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> [::]:ssh                [::]:*                  LISTEN      <span class="hljs-number">978</span>/sshd            
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-attribute">localhost</span>:smtp          [::]:*                  LISTEN      <span class="hljs-number">1141</span>/master</code></pre>
<p><code>netstat -atupn</code> 将显示所有 TCP 和 UDP 侦听和已建立的连接以及数字格式的程序名称以及地址和端口。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo netstat -atupn
Active Internet connections (servers <span class="hljs-keyword">and</span> established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">978</span>/sshd            
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">25</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">1141</span>/master         
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.20</span>.<span class="hljs-number">30.129</span>:<span class="hljs-number">22</span>         <span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>:<span class="hljs-number">38822</span>        ESTABLISHED <span class="hljs-number">5665</span>/<span class="hljs-attribute">sshd</span>: peter [p 
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.20</span>.<span class="hljs-number">30.129</span>:<span class="hljs-number">22</span>         <span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>:<span class="hljs-number">38826</span>        ESTABLISHED <span class="hljs-number">5723</span>/<span class="hljs-attribute">sshd</span>: jane [pr 
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      <span class="hljs-number">978</span>/sshd            
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">25</span>                  :::*                    LISTEN      <span class="hljs-number">1141</span>/master         
udp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">323</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*                           <span class="hljs-number">640</span>/chronyd         
udp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">68</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*                           <span class="hljs-number">5638</span>/dhclient       
udp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">323</span>                 :::*                                <span class="hljs-number">640</span>/chronyd</code></pre>
<p>人们可能会认为在访问目标计算机之前使用 <code>nmap</code> 会提供类似的结果。然而，这并不完全正确。 Nmap需要生成相对大量的数据包来检查开放端口，这可以触发入侵检测和防御系统。此外，路由上的防火墙可能会丢弃某些数据包并阻碍扫描，从而导致 Nmap 结果不完整。</p>
<p><code>lsof</code> 代表列出打开的文件。如果我们只想显示互联网和网络连接，我们可以使用 <code>lsof -i</code> 。下面的终端输出显示了 IPv4 和 IPv6 侦听服务以及正在进行的连接。用户 <code>peter</code> 通过 <code>ssh</code> 端口连接到服务器 <code>rpm-red-enum.thm</code> 。请注意，要获取匹配程序的完整列表，您需要以 root 身份运行 <code>lsof</code> 或使用 <code>sudo lsof</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo lsof -i
COMMAND   PID      USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
chronyd   <span class="hljs-number">640</span>    chrony    <span class="hljs-number">5</span>u  IPv4  <span class="hljs-number">16945</span>      <span class="hljs-number">0</span>t0  UDP <span class="hljs-attribute">localhost</span>:<span class="hljs-number">323</span> 
chronyd   <span class="hljs-number">640</span>    chrony    <span class="hljs-number">6</span>u  IPv6  <span class="hljs-number">16946</span>      <span class="hljs-number">0</span>t0  UDP <span class="hljs-attribute">localhost</span>:<span class="hljs-number">323</span> 
sshd      <span class="hljs-number">978</span>      root    <span class="hljs-number">3</span>u  IPv4  <span class="hljs-number">20035</span>      <span class="hljs-number">0</span>t0  TCP *:ssh (LISTEN)
sshd      <span class="hljs-number">978</span>      root    <span class="hljs-number">4</span>u  IPv6  <span class="hljs-number">20058</span>      <span class="hljs-number">0</span>t0  TCP *:ssh (LISTEN)
master   <span class="hljs-number">1141</span>      root   <span class="hljs-number">13</span>u  IPv4  <span class="hljs-number">20665</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)
master   <span class="hljs-number">1141</span>      root   <span class="hljs-number">14</span>u  IPv6  <span class="hljs-number">20666</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)
dhclient <span class="hljs-number">5638</span>      root    <span class="hljs-number">6</span>u  IPv4  <span class="hljs-number">47458</span>      <span class="hljs-number">0</span>t0  UDP *:bootpc 
sshd     <span class="hljs-number">5693</span>     peter    <span class="hljs-number">3</span>u  IPv4  <span class="hljs-number">47594</span>      <span class="hljs-number">0</span>t0  TCP rpm-red-enum.<span class="hljs-attribute">thm</span>:ssh-&gt;<span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>:<span class="hljs-number">38822</span> (ESTABLISHED)
[...]</code></pre>
<p>由于列表可能会变得相当长，因此您可以通过指定您感兴趣的端口（例如 SMTP 端口 25）来进一步过滤输出。通过运行 <code>lsof -i :25</code> ，我们将输出限制为与端口 25 相关的输出，如下面的终端输出所示。服务器正在监听 IPv4 和 IPv6 地址的端口 25。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo lsof -i :<span class="hljs-number">25</span>
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
master  <span class="hljs-number">1141</span> root   <span class="hljs-number">13</span>u  IPv4  <span class="hljs-number">20665</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)
master  <span class="hljs-number">1141</span> root   <span class="hljs-number">14</span>u  IPv6  <span class="hljs-number">20666</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)</code></pre>
<h2 id="running-services">Running Services</h2>
<p>获取正在运行的进程的快照可以提供许多见解。 <code>ps</code> 可让您发现正在运行的进程以及有关它们的大量信息。</p>
<p>您可以使用 <code>ps -e</code> 列出系统上的每个进程，其中 <code>-e</code> 选择所有进程。有关该过程的更多信息，您可以添加 <code>-f</code> 表示完整格式，添加 <code>-l</code> 表示长格式。尝试 <code>ps -e</code> 、 <code>ps -ef</code> 和 <code>ps -el</code> 。</p>
<p>您可以获得类似的输出并使用 BSD 语法查看所有进程： <code>ps ax</code> 或 <code>ps aux</code> 。请注意，使用 BSD 语法时 <code>a</code> 和 <code>x</code> 是必需的，因为它们解除了“仅限您自己”和“必须有 tty”限制；换句话说，可以显示所有进程。 <code>u</code> 用于获取有关拥有该进程的用户的详细信息。</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-e</code></td>
<td>所有进程</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>全格式列表</td>
</tr>
<tr>
<td><code>-j</code></td>
<td>职位格式</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>长格式</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>面向用户的格式</td>
</tr>
</tbody>
</table>
<p>要获得更多“可视化”输出，您可以发出 <code>ps axjf</code> 来打印进程树。 <code>f</code> 代表“森林”，它创建一个 ASCII 艺术流程层次结构，如下面的终端输出所示。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ps axf
   PID TTY      STAT   TIME COMMAND
     <span class="hljs-number">2</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [kthreadd]
     <span class="hljs-number">4</span> ?        S&lt;     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ [kworker/<span class="hljs-number">0</span>:<span class="hljs-number">0</span>H]
     <span class="hljs-number">5</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">01</span>  \_ [kworker/u256:<span class="hljs-number">0</span>]
[...]
   <span class="hljs-number">978</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /usr/sbin/sshd -D
  <span class="hljs-number">5665</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ <span class="hljs-attribute">sshd</span>: peter [priv]
  <span class="hljs-number">5693</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  |   \_ <span class="hljs-attribute">sshd</span>: peter<span class="hljs-keyword">@pts</span>/<span class="hljs-number">1</span>
  <span class="hljs-number">5694</span> pts/<span class="hljs-number">1</span>    Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  |       \_ -bash
  <span class="hljs-number">5713</span> pts/<span class="hljs-number">1</span>    S+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  |           \_ vi notes.txt
  <span class="hljs-number">5723</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ <span class="hljs-attribute">sshd</span>: jane [priv]
  <span class="hljs-number">5727</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>      \_ <span class="hljs-attribute">sshd</span>: jane<span class="hljs-keyword">@pts</span>/<span class="hljs-number">0</span>
  <span class="hljs-number">5728</span> pts/<span class="hljs-number">0</span>    Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>          \_ -bash
  <span class="hljs-number">7080</span> pts/<span class="hljs-number">0</span>    R+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>              \_ ps axf
   <span class="hljs-number">979</span> ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">12</span> /usr/bin/python2 -Es /usr/sbin/tuned -l -P
   <span class="hljs-number">981</span> ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">07</span> /usr/sbin/rsyslogd -n
  <span class="hljs-number">1141</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /usr/libexec/postfix/master -w
  <span class="hljs-number">1147</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ qmgr -l -t unix -u
  <span class="hljs-number">6991</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ pickup -l -t unix -u
  <span class="hljs-number">1371</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span> login -- root
  <span class="hljs-number">1376</span> tty1     Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ -bash
  <span class="hljs-number">1411</span> tty1     S+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>      \_ man man
  <span class="hljs-number">1420</span> tty1     S+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>          \_ less -s
[...]</code></pre>
<p>总而言之，请记住使用 <code>ps -ef</code> 或 <code>ps aux</code> 来获取所有正在运行的进程的列表。考虑通过 <code>grep</code> 管道输出以显示包含某些单词的输出行。下面的终端输出显示了其中包含 <code>peter</code> 的行。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ps -ef | grep peter
root       <span class="hljs-number">5665</span>    <span class="hljs-number">978</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">11</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-attribute">sshd</span>: peter [priv]
peter      <span class="hljs-number">5693</span>   <span class="hljs-number">5665</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-attribute">sshd</span>: peter<span class="hljs-keyword">@pts</span>/<span class="hljs-number">1</span>
peter      <span class="hljs-number">5694</span>   <span class="hljs-number">5693</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> pts/<span class="hljs-number">1</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> -bash
peter      <span class="hljs-number">5713</span>   <span class="hljs-number">5694</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> pts/<span class="hljs-number">1</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> vi notes.txt</code></pre>
<p>如果您尚未启动连接的 Linux 计算机，请启动它，因为您需要它来回答以下问题。您可以使用 SSH 登录： <code>ssh user@10.10.27.56</code> ，其中登录凭据为：</p>
<ul>
<li>Username: <code>user</code></li>
<li>Password: <code>THM6877</code></li>
</ul>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ cat /etc/os-release 
NAME=<span class="hljs-string">"Ubuntu"</span>
VERSION=<span class="hljs-string">"20.04.4 LTS (Focal Fossa)"</span>
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=<span class="hljs-string">"Ubuntu 20.04.4 LTS"</span>
VERSION_ID=<span class="hljs-string">"20.04"</span>
HOME_URL=<span class="hljs-string">"https://www.ubuntu.com/"</span>
SUPPORT_URL=<span class="hljs-string">"https://help.ubuntu.com/"</span>
BUG_REPORT_URL=<span class="hljs-string">"https://bugs.launchpad.net/ubuntu/"</span>
PRIVACY_POLICY_URL=<span class="hljs-string">"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"</span>
VERSION_CODENAME=focal
UBUNTU_CODENAME=focal</code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ last
user     pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.11</span>.<span class="hljs-number">81.232</span>     Tue Jul <span class="hljs-number">16</span> <span class="hljs-number">11</span>:<span class="hljs-number">40</span>   still logged in
reboot   system boot  <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">120</span>-generi Tue Jul <span class="hljs-number">16</span> <span class="hljs-number">11</span>:<span class="hljs-number">09</span>   still running
reboot   system boot  <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">120</span>-generi Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">13</span>:<span class="hljs-number">10</span> - <span class="hljs-number">13</span>:<span class="hljs-number">13</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">02</span>)
randa    pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>       Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">11</span>:<span class="hljs-number">00</span> - <span class="hljs-number">11</span>:<span class="hljs-number">01</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)
reboot   system boot  <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">120</span>-generi Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">09</span>:<span class="hljs-number">58</span> - <span class="hljs-number">11</span>:<span class="hljs-number">01</span>  (<span class="hljs-number">01</span>:<span class="hljs-number">03</span>)

wtmp begins Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">09</span>:<span class="hljs-number">58</span>:<span class="hljs-number">27</span> <span class="hljs-number">2022</span></code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ netstat -tnlp
(<span class="hljs-keyword">Not</span> all processes could be identified, non-owned process info
 will <span class="hljs-keyword">not</span> be shown, you would have to be root to see it all.)
Active Internet connections (<span class="hljs-keyword">only</span> servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">953</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">389</span>             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">6667</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">27.56</span>:<span class="hljs-number">53</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">53</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.53</span>:<span class="hljs-number">53</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">953</span>                 :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">389</span>                  :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> fe80::<span class="hljs-number">27</span>:<span class="hljs-number">4</span><span class="hljs-attribute">aff</span>:fe60:<span class="hljs-number">3</span>:<span class="hljs-number">53</span> :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">53</span>                  :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">21</span>                   :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      -</code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ sudo netstat -tnlp
[sudo] password for <span class="hljs-attribute">user</span>: 
Active Internet connections (<span class="hljs-keyword">only</span> servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">953</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">619</span>/named           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">389</span>             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">728</span>/slapd           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">6667</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">734</span>/inspircd        
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">27.56</span>:<span class="hljs-number">53</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">619</span>/named           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">53</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">619</span>/named           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.53</span>:<span class="hljs-number">53</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">581</span>/systemd-resolve 
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">659</span>/<span class="hljs-attribute">sshd</span>: /usr/sbin 
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">953</span>                 :::*                    LISTEN      <span class="hljs-number">619</span>/named           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">389</span>                  :::*                    LISTEN      <span class="hljs-number">728</span>/slapd           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> fe80::<span class="hljs-number">27</span>:<span class="hljs-number">4</span><span class="hljs-attribute">aff</span>:fe60:<span class="hljs-number">3</span>:<span class="hljs-number">53</span> :::*                    LISTEN      <span class="hljs-number">619</span>/named           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">53</span>                  :::*                    LISTEN      <span class="hljs-number">619</span>/named           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">21</span>                   :::*                    LISTEN      <span class="hljs-number">658</span>/vsftpd          
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      <span class="hljs-number">659</span>/<span class="hljs-attribute">sshd</span>: /usr/sbin</code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ ps -aux | grep listen
root         <span class="hljs-number">659</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.6</span>  <span class="hljs-number">12172</span>  <span class="hljs-number">6928</span> ?        Ss   <span class="hljs-number">11</span>:<span class="hljs-number">10</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> <span class="hljs-attribute">sshd</span>: /usr/sbin/sshd -D [listener] <span class="hljs-number">0</span> of <span class="hljs-number">10</span>-<span class="hljs-number">100</span> startups
user        <span class="hljs-number">1209</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>   <span class="hljs-number">6432</span>   <span class="hljs-number">720</span> pts/<span class="hljs-number">0</span>    S+   <span class="hljs-number">11</span>:<span class="hljs-number">47</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> grep --color=auto listen
user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ ps -aux | grep THM
randa        <span class="hljs-number">664</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>   <span class="hljs-number">2608</span>   <span class="hljs-number">532</span> ?        Ss   <span class="hljs-number">11</span>:<span class="hljs-number">10</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /bin/sh -c /home/randa/THM-<span class="hljs-number">24765</span>.sh
randa        <span class="hljs-number">675</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.3</span>   <span class="hljs-number">6892</span>  <span class="hljs-number">3240</span> ?        S    <span class="hljs-number">11</span>:<span class="hljs-number">10</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /bin/bash /home/randa/THM-<span class="hljs-number">24765</span>.sh
user        <span class="hljs-number">1212</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>   <span class="hljs-number">6432</span>   <span class="hljs-number">720</span> pts/<span class="hljs-number">0</span>    S+   <span class="hljs-number">11</span>:<span class="hljs-number">48</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> grep --color=auto THM</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211291.png" alt="image-20240716194955020"></p>
<h1 id="0x04-windows枚举">0x04 Windows枚举</h1>
<p>在此任务中，我们假设您有权访问 Microsoft Windows 主机上的 <code>cmd</code> 。您可能通过利用漏洞并获取 shell 或反向 shell 来获得此访问权限。您还可能在您利用的系统上安装了后门或设置了 SSH 服务器。在所有情况下，以下命令都需要 <code>cmd</code> 才能运行。</p>
<p>在此任务中，我们重点枚举 MS Windows 主机。对于枚举 MS Active Directory，建议您查看枚举 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/adenumeration">Active Directory</a> 室。如果您对 MS Windows 主机上的权限升级感兴趣，我们推荐 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/windowsprivesc20">Windows Privesc 2.0 room</a>。</p>
<p>我们建议您单击“启动 AttackBox”和“启动机器”，以便您可以在此任务结束时进行实验并回答问题。</p>
<h2 id="system">System</h2>
<p><code>systeminfo</code> 可以为我们提供有关系统的详细信息（例如其内部版本号和已安装的补丁）的命令。在下面的示例中，我们可以看到已安装哪些修补程序。</p>
<pre><code class="hljs scss">C:\&gt;systeminfo

Host Name:                 WIN-SERVER-CLI
OS Name:                   Microsoft Windows Server <span class="hljs-number">2022</span> Standard
OS Version:                <span class="hljs-number">10.0</span>.<span class="hljs-number">20348</span> N/A Build <span class="hljs-number">20348</span>
OS Manufacturer:           Microsoft Corporation
[...]
<span class="hljs-built_in">Hotfix</span>(s):                 <span class="hljs-number">3</span> <span class="hljs-built_in">Hotfix</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: KB5013630
                           [<span class="hljs-number">02</span>]: KB5013944
                           [<span class="hljs-number">03</span>]: KB5012673
Network <span class="hljs-built_in">Card</span>(s):           <span class="hljs-number">1</span> <span class="hljs-built_in">NIC</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: <span class="hljs-built_in">Intel</span>(R) <span class="hljs-number">82574</span>L Gigabit Network Connection
[...]</code></pre>
<p>您可以使用 <code>wmic qfe get Caption,Description</code> 检查已安装的更新。此信息将使您了解系统修补和更新的速度。</p>
<pre><code class="hljs scss">C:\&gt;wmic qfe get Caption,Description
Caption                                     Description      
http://support.microsoft.com/?kbid=<span class="hljs-number">5013630</span>  Update
https://support.microsoft.com/help/<span class="hljs-number">5013944</span>  Security Update
                                            Update</code></pre>
<p>您可以使用 <code>net start</code> 检查已安装和启动的 Windows 服务。期望得到一长串名单；下面的输出已被截断。</p>
<pre><code class="hljs scss">C:\&gt;net start
These Windows services are started:

   Base Filtering Engine
   Certificate Propagation
   Client License Service (ClipSVC)
   COM+ Event System
   Connected User Experiences and Telemetry
   CoreMessaging
   Cryptographic Services
   DCOM Server Process Launcher
   DHCP Client
   DNS Client
[...]
   Windows Time
   Windows Update
   WinHTTP Web Proxy Auto-Discovery Service
   Workstation

The command completed successfully.</code></pre>
<p>如果您只对已安装的应用程序感兴趣，则可以发出 <code>wmic product get name,version,vendor</code> 。如果您在连接的虚拟机上运行此命令，您将获得类似于以下输出的内容。</p>
<pre><code class="hljs scss">C:\&gt;wmic product get name,version,vendor
Name                                                            Vendor                                   Version
Microsoft Visual C++ <span class="hljs-number">2019</span> X64 Minimum Runtime - <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span>     Microsoft Corporation                    <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span>
[...]
Microsoft Visual C++ <span class="hljs-number">2019</span> X64 Additional Runtime - <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span>  Microsoft Corporation                    <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span></code></pre>
<h2 id="users">Users</h2>
<p>要知道你是谁，你可以运行 <code>whoami</code> ；此外，要了解您的能力，即您的特权，您可以使用 <code>whoami /priv</code> 。下面的终端输出显示了一个示例。</p>
<pre><code class="hljs scss">C:\&gt;whoami
win-server-cli\strategos

&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State
========================================= ================================================================== =======
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
[...]</code></pre>
<p>此外，您可以使用 <code>whoami /groups</code> 来了解您属于哪些组。下面的终端输出显示该用户属于其他组中的 <code>NT AUTHORITY\Local account and member of Administrators group</code> 。</p>
<pre><code class="hljs scss">C:\&gt;whoami /groups

GROUP INFORMATION
-----------------

Group Name                                                    Type             SID          Attributes
============================================================= ================ ============ ===============================================================
Everyone                                                      Well-known group S-<span class="hljs-number">1</span>-<span class="hljs-number">1</span>-<span class="hljs-number">0</span>      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account and member of Administrators group Well-known group S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">114</span>    Mandatory group, Enabled by default, Enabled group
BUILTIN\Administrators                                        Alias            S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">544</span> Mandatory group, Enabled by default, Enabled group, Group owner
[...]</code></pre>
<p>您可以通过运行 <code>net user</code> 查看用户。</p>
<pre><code class="hljs scss">C:\&gt;net user

User accounts for \\WIN-SERVER-CLI

-------------------------------------------------------------------------------
Administrator            DefaultAccount           Guest
michael                  peter                    strategos
WDAGUtilityAccount
The command completed successfully.</code></pre>
<p>如果系统是 Windows 域控制器，您可以使用 <code>net group</code> 发现可用组，否则使用 <code>net localgroup</code> 发现可用组，如下面的终端所示。</p>
<pre><code class="hljs scss">C:\&gt;net localgroup

Aliases for \\WIN-SERVER-CLI

-------------------------------------------------------------------------------
*Access Control Assistance Operators
*Administrators
*Backup Operators
*Certificate Service DCOM Access
*Cryptographic Operators
*Device Owners
[...]</code></pre>
<p>您可以使用命令 <code>net localgroup administrators</code> 列出属于本地管理员组的用户。</p>
<pre><code class="hljs scss">C:\&gt;net localgroup administrators
Alias name     administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
Administrator
michael
peter
strategos
The command completed successfully.</code></pre>
<p>使用 <code>net accounts</code> 查看机器上的本地设置；此外，如果计算机属于某个域，则可以使用 <code>net accounts /domain</code> 。此命令有助于了解密码策略，例如最短密码长度、最长密码期限和锁定持续时间。</p>
<h2 id="networking">Networking</h2>
<p>您可以使用 <code>ipconfig</code> 命令来了解您的系统网络配置。如果您想了解所有与网络相关的设置，可以使用 <code>ipconfig /all</code> 。下面的终端输出显示了使用 <code>ipconfig</code> 时的输出。例如，如果我们想了解 DNS 服务器，我们可以使用 <code>ipconfig /all</code> 。</p>
<pre><code class="hljs scss">C:\&gt;ipconfig

Windows IP Configuration


Ethernet adapter Ethernet0:

   Connection-specific DNS Suffix  . : localdomain
   Link-local IPv6 Address . . . . . : fe80::<span class="hljs-number">3</span>dc5:<span class="hljs-number">78</span>ef:<span class="hljs-number">1274</span>:a740%<span class="hljs-number">5</span>
   IPv4 Address. . . . . . . . . . . : <span class="hljs-number">10.20</span>.<span class="hljs-number">30.130</span>
   Subnet Mask . . . . . . . . . . . : <span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span>
   Default Gateway . . . . . . . . . : <span class="hljs-number">10.20</span>.<span class="hljs-number">30.2</span></code></pre>
<p>在 MS Windows 上，我们可以使用 <code>netstat</code> 来获取各种信息，例如系统正在侦听哪些端口、哪些连接处于活动状态以及谁正在使用它们。在此示例中，我们使用选项 <code>-a</code> 显示所有侦听端口和活动连接。 <code>-b</code> 让我们找到连接中涉及的二进制文件，而 <code>-n</code> 用于避免解析 IP 地址和端口号。最后， <code>-o</code> 显示进程ID（PID）。</p>
<p>在下面显示的部分输出中，我们可以看到 <code>netstat -abno</code> 显示服务器正在侦听 TCP 端口 22、135、445 和 3389。进程 <code>sshd.exe</code> 、 <code>RpcSs</code> 分别位于端口 <code>22</code> 、 <code>135</code> 和 <code>3389</code> 上。此外，我们可以看到与 SSH 服务器的两个已建立的连接，如状态 <code>ESTABLISHED</code> 所示。</p>
<pre><code class="hljs scss">C:\&gt;netstat -abno

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2016</span>
 [sshd.exe]
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">135</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">924</span>
  RpcSs
 [svchost.exe]
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">445</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span>
 Can not obtain ownership information
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">3389</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">416</span>
  TermService
 [svchost.exe]
[...]
  TCP    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.130</span>:<span class="hljs-number">22</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>:<span class="hljs-number">39956</span>       ESTABLISHED     <span class="hljs-number">2016</span>
 [sshd.exe]
  TCP    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.130</span>:<span class="hljs-number">22</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>:<span class="hljs-number">39964</span>       ESTABLISHED     <span class="hljs-number">2016</span>
 [sshd.exe]
[...]</code></pre>
<p>您可能认为通过端口扫描目标系统可以获得相同的结果；然而，由于两个原因，这是不准确的。防火墙可能会阻止扫描主机到达特定网络端口。此外，端口扫描系统会产生大量流量，这与 <code>netstat</code> 不同，它的噪音为零。</p>
<p>最后，值得一提的是，使用 <code>arp -a</code> 可以帮助您发现同一 LAN 上最近与您的系统进行通信的其他系统。 ARP代表地址解析协议； <code>arp -a</code> 显示当前 ARP 条目，即与您的系统通信的同一 LAN 上的系统的物理地址。下面显示了示例输出。这表明这些 IP 地址已与我们的系统进行了某种通信；通信可以是尝试连接，甚至是简单的 ping。请注意， <code>10.10.255.255</code> 并不代表系统，因为它是子网广播地址。</p>
<pre><code class="hljs scss">C:\&gt;arp -a

Interface: <span class="hljs-number">10.10</span>.<span class="hljs-number">204.175</span> --- <span class="hljs-number">0</span>x4 
  Internet Address      Physical Address      Type
  <span class="hljs-number">10.10</span>.<span class="hljs-number">0.1</span>             <span class="hljs-number">02</span>-c8-<span class="hljs-number">85</span>-b5-<span class="hljs-number">5</span>a-aa     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">16.117</span>          <span class="hljs-number">02</span>-f2-<span class="hljs-number">42</span>-<span class="hljs-number">76</span>-fc-ef     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">122.196</span>         <span class="hljs-number">02</span>-<span class="hljs-number">48</span>-<span class="hljs-number">58</span>-<span class="hljs-number">7</span>b-<span class="hljs-number">92</span>-e5     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">146.13</span>          <span class="hljs-number">02</span>-<span class="hljs-number">36</span>-c1-<span class="hljs-number">4</span>d-<span class="hljs-number">05</span>-f9     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">161.4</span>           <span class="hljs-number">02</span>-a8-<span class="hljs-number">58</span>-<span class="hljs-number">98</span>-<span class="hljs-number">1</span>a-d3     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">217.222</span>         <span class="hljs-number">02</span>-<span class="hljs-number">68</span>-<span class="hljs-number">10</span>-dd-be-<span class="hljs-number">8</span>d     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">255.255</span>         ff-ff-ff-ff-ff-ff     static</code></pre>
<p>如果您尚未启动附加的 MS Windows Server，请启动它，因为您需要它来回答以下问题。您可以通过 AttackBox 中的 SSH 连接到 MS Windows VM，例如，使用 <code>ssh user@10.10.5.135</code> ，其中登录凭据为：</p>
<ul>
<li>Username: <code>user</code></li>
<li>Password: <code>THM33$$88</code></li>
</ul>
<pre><code class="hljs scss">PS C:\Users\user&gt; systeminfo
                                                                                           
Host Name:                 RED-WIN-ENUM                                                    
OS Name:                   Microsoft Windows Server <span class="hljs-number">2019</span> Datacenter                        
OS Version:                <span class="hljs-number">10.0</span>.<span class="hljs-number">17763</span> N/A Build <span class="hljs-number">17763</span>                                      
OS Manufacturer:           Microsoft Corporation                                           
OS Configuration:          Standalone Server                                               
OS Build Type:             Multiprocessor Free                                             
Registered Owner:          EC2                                                             
Registered Organization:   Amazon.com                                                      
Product ID:                <span class="hljs-number">00430</span>-<span class="hljs-number">00000</span>-<span class="hljs-number">00000</span>-AA155                                         
Original Install Date:     <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2021</span>, <span class="hljs-number">2</span>:<span class="hljs-number">59</span>:<span class="hljs-number">06</span> PM                                           
System Boot Time:          <span class="hljs-number">7</span>/<span class="hljs-number">16</span>/<span class="hljs-number">2024</span>, <span class="hljs-number">12</span>:<span class="hljs-number">43</span>:<span class="hljs-number">50</span> PM                                          
System Manufacturer:       Amazon EC2                                                      
System Model:              t3a.small                                                       
System Type:               x64-based PC                                                    
<span class="hljs-built_in">Processor</span>(s):              <span class="hljs-number">1</span> <span class="hljs-built_in">Processor</span>(s) Installed.                                       
                           [<span class="hljs-number">01</span>]: AMD64 Family <span class="hljs-number">23</span> Model <span class="hljs-number">1</span> Stepping <span class="hljs-number">2</span> AuthenticAMD ~<span class="hljs-number">2200</span> Mhz 
BIOS Version:              Amazon EC2 <span class="hljs-number">1.0</span>, <span class="hljs-number">10</span>/<span class="hljs-number">16</span>/<span class="hljs-number">2017</span>                                      
Windows Directory:         C:\Windows                                                      
System Directory:          C:\Windows\system32                                             
Boot Device:               \Device\HarddiskVolume1
System Locale:             en-us;English (United States)
<span class="hljs-selector-tag">Input</span> Locale:              en-us;English (United States)
<span class="hljs-selector-tag">Time</span> Zone:                 (UTC) Coordinated Universal Time
Total Physical Memory:     <span class="hljs-number">2</span>,<span class="hljs-number">016</span> MB
Available Physical Memory: <span class="hljs-number">452</span> MB
Virtual Memory: Max Size:  <span class="hljs-number">2</span>,<span class="hljs-number">400</span> MB
Virtual Memory: Available: <span class="hljs-number">907</span> MB
Virtual Memory: In Use:    <span class="hljs-number">1</span>,<span class="hljs-number">493</span> MB
Page File <span class="hljs-built_in">Location</span>(s):     C:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              N/A
<span class="hljs-built_in">Hotfix</span>(s):                 <span class="hljs-number">30</span> <span class="hljs-built_in">Hotfix</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: KB5015731
                           [<span class="hljs-number">02</span>]: KB4470502
                           [<span class="hljs-number">03</span>]: KB4470788
                           [<span class="hljs-number">04</span>]: KB4480056
                           [<span class="hljs-number">05</span>]: KB4486153
                           [<span class="hljs-number">06</span>]: KB4493510
                           [<span class="hljs-number">07</span>]: KB4499728
                           [<span class="hljs-number">08</span>]: KB4504369
                           [<span class="hljs-number">09</span>]: KB4512577
                           [<span class="hljs-number">10</span>]: KB4512937
                           [<span class="hljs-number">11</span>]: KB4521862
                           [<span class="hljs-number">12</span>]: KB4523204
                           [<span class="hljs-number">13</span>]: KB4535680
                           [<span class="hljs-number">14</span>]: KB4539571
                           [<span class="hljs-number">15</span>]: KB4549947
                           [<span class="hljs-number">16</span>]: KB4558997
                           [<span class="hljs-number">17</span>]: KB4562562
                           [<span class="hljs-number">18</span>]: KB4566424
                           [<span class="hljs-number">19</span>]: KB4570332
                           [<span class="hljs-number">20</span>]: KB4577586
                           [<span class="hljs-number">21</span>]: KB4577667
                           [<span class="hljs-number">22</span>]: KB4587735
                           [<span class="hljs-number">23</span>]: KB4589208
                           [<span class="hljs-number">24</span>]: KB4598480
                           [<span class="hljs-number">25</span>]: KB4601393
                           [<span class="hljs-number">26</span>]: KB5000859
                           [<span class="hljs-number">27</span>]: KB5015811
                           [<span class="hljs-number">28</span>]: KB5012675
                           [<span class="hljs-number">29</span>]: KB5014031
                           [<span class="hljs-number">30</span>]: KB5014797
Network <span class="hljs-built_in">Card</span>(s):           <span class="hljs-number">1</span> <span class="hljs-built_in">NIC</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: Amazon Elastic Network Adapter
                                 Connection Name: Ethernet <span class="hljs-number">3</span>
                                 DHCP Enabled:    Yes
                                 DHCP Server:     <span class="hljs-number">10.10</span>.<span class="hljs-number">0.1</span>
                                 IP <span class="hljs-built_in">address</span>(es)
                                 [<span class="hljs-number">01</span>]: <span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>
                                 [<span class="hljs-number">02</span>]: fe80::adab:<span class="hljs-number">8</span>db:dd45:<span class="hljs-number">3744</span>
Hyper-V Requirements:      A hypervisor has been detected. Features required for Hyper-V will not be displayed.</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211292.png" alt="image-20240716210027010"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211293.png" alt="image-20240716210015177"></p>
<h1 id="0x05-dnssmb-and-snmp">0x05 DNS,SMB and SNMP</h1>
<p>当我们介绍枚举时，接触 DNS、SMB 和 SNMP 是个好主意。</p>
<h2 id="dns">DNS</h2>
<p>我们都熟悉域名系统 (DNS) 查询，可以在其中查找 A、AAAA、CName 和 TXT 记录等。如果您想温习一下 DNS 知识，我们建议您访问 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/dnsindetail">DNS 详细室</a>。如果我们可以获得 DNS 服务器负责应答的所有记录的“副本”，我们可能会发现我们不知道存在的主机。</p>
<p>尝试 DNS 区域传输的一种简单方法是通过 <code>dig</code> 命令。如果您想了解有关 <code>dig</code> 和类似命令的更多信息，我们建议您查看<a target="_blank" rel="noopener" href="https://tryhackme.com/room/passiverecon">被动侦察室</a>。根据 DNS 服务器配置，DNS 区域传输可能会受到限制。如果不限制，应该可以使用 <code>dig -t AXFR DOMAIN_NAME @DNS_SERVER</code> 来实现。 <code>-t AXFR</code> 表示我们正在请求区域传输，而 <code>@</code> 位于 <code>DNS_SERVER</code> 之前，我们要查询与指定 <code>DOMAIN_NAME</code></p>
<h2 id="smb">SMB</h2>
<p>服务器消息块 (SMB) 是一种提供对文件和打印机的共享访问的通信协议。我们可以使用 <code>net share</code> 检查共享文件夹。这是输出的示例。我们可以看到 <code>C:\Internal Files</code> 是在 Internal 名称下共享的。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ net share

Share name   Resource                        Remark

-------------------------------------------------------------------------------
C$           <span class="hljs-attribute">C</span>:\                             Default share
IPC$                                         Remote IPC
ADMIN$       <span class="hljs-attribute">C</span>:\Windows                      Remote Admin
Internal     <span class="hljs-attribute">C</span>:\Internal Files               Internal Documents
Users        <span class="hljs-attribute">C</span>:\Users
The command completed successfully.</code></pre>
<h2 id="snmp">SNMP</h2>
<p>简单网络管理协议 (SNMP) 旨在帮助收集有关网络上不同设备的信息。它可以让您了解各种网络事件，从磁盘故障的服务器到打印机墨水耗尽。因此，SNMP 可以为攻击者保存大量信息。查询与 SNMP 相关的服务器的一个简单工具是 <code>snmpcheck</code> 。您可以在 AttackBox 的 <code>/opt/snmpcheck/</code> 目录中找到它；语法非常简单： <code>/opt/snmpcheck/snmpcheck.rb 10.10.5.135 -c COMMUNITY_STRING</code> 。</p>
<p>如果您想在本地 Linux 机器上安装 <code>snmpcheck</code> ，请考虑以下命令。</p>
<pre><code class="hljs scss">git clone https://gitlab.com/kalilinux/packages/snmpcheck.git
cd snmpcheck/
gem install snmp
chmod +x snmpcheck-<span class="hljs-number">1.9</span>.rb</code></pre>
<p>确保您正在运行任务 4 中的 MS Windows Server 计算机并回答以下问题。</p>
<pre><code class="hljs scss">┌──(hybcx㉿LAPTOP-<span class="hljs-number">1</span>TO1HS75)-<span class="hljs-selector-attr">[/root]</span>
└─$ dig -t AXFR redteam<span class="hljs-selector-class">.thm</span> @<span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>

; &lt;&lt;&gt;&gt; DiG <span class="hljs-number">9.19</span><span class="hljs-selector-class">.25-185-g392e7199df2-1-Debian</span> &lt;&lt;&gt;&gt; -t AXFR redteam<span class="hljs-selector-class">.thm</span> @<span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>
;; global options: +cmd
redteam.thm.            <span class="hljs-number">3600</span>    IN      SOA     red-win-enum. hostmaster. <span class="hljs-number">5</span> <span class="hljs-number">900</span> <span class="hljs-number">600</span> <span class="hljs-number">86400</span> <span class="hljs-number">3600</span>
redteam.thm.            <span class="hljs-number">3600</span>    IN      NS      red-win-enum.
first.redteam.thm.      <span class="hljs-number">3600</span>    IN      A       <span class="hljs-number">10.10</span>.<span class="hljs-number">254.1</span>
flag.redteam.thm.       <span class="hljs-number">3600</span>    IN      TXT     <span class="hljs-string">"THM{DNS_ZONE}"</span>
second.redteam.thm.     <span class="hljs-number">3600</span>    IN      A       <span class="hljs-number">10.10</span>.<span class="hljs-number">254.2</span>
tryhackme.redteam.thm.  <span class="hljs-number">3600</span>    IN      CNAME   tryhackme.com.
redteam.thm.            <span class="hljs-number">3600</span>    IN      SOA     red-win-enum. hostmaster. <span class="hljs-number">5</span> <span class="hljs-number">900</span> <span class="hljs-number">600</span> <span class="hljs-number">86400</span> <span class="hljs-number">3600</span>
;; Query <span class="hljs-selector-tag">time</span>: <span class="hljs-number">279</span> msec
;; SERVER: <span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>#<span class="hljs-number">53</span>(<span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>) (TCP)
;; WHEN: Tue Jul <span class="hljs-number">16</span> <span class="hljs-number">21</span>:<span class="hljs-number">25</span>:<span class="hljs-number">48</span> CST <span class="hljs-number">2024</span>
;; XFR size: <span class="hljs-number">7</span> records (messages <span class="hljs-number">1</span>, bytes <span class="hljs-number">295</span>)</code></pre>
<pre><code class="hljs scss">PS C:\Users\user&gt; net share

Share name   Resource                        Remark

-------------------------------------------------------------------------------
C$           C:\                             Default share
IPC$                                         Remote IPC
ADMIN$       C:\Windows                      Remote Admin
Internal     C:\Internal Files               Internal Documents
THM{<span class="hljs-number">829738</span>}  C:\Users\user\Private           Enjoy SMB shares
Users        C:\Users
The command completed successfully.</code></pre>
<pre><code class="hljs scss">┌──(hybcx㉿LAPTOP-<span class="hljs-number">1</span>TO1HS75)-<span class="hljs-selector-attr">[/root]</span>
└─$ snmpwalk -v2c -c public <span class="hljs-number">10.10</span><span class="hljs-selector-class">.5</span><span class="hljs-selector-class">.135</span>                                                                
iso<span class="hljs-selector-class">.3</span><span class="hljs-selector-class">.6</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.2</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.0</span> = STRING: <span class="hljs-string">"Hardware: AMD64 Family 23 Model 1 Stepping 2 AT/AT COMPATIBLE - Software: Windows Version 6.3 (Build 17763 Multiprocessor Free)"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">2.0</span> = OID: iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.4</span>.<span class="hljs-number">1.311</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">3.1</span>.<span class="hljs-number">2</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">3.0</span> = Timeticks: (<span class="hljs-number">268432</span>) <span class="hljs-number">0</span>:<span class="hljs-number">44</span>:<span class="hljs-number">44.32</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">4.0</span> = STRING: <span class="hljs-string">"TryHackMe"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">5.0</span> = STRING: <span class="hljs-string">"RED-WIN-ENUM"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">6.0</span> = STRING: <span class="hljs-string">"THM{SNMP_SERVICE}"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">7.0</span> = INTEGER: <span class="hljs-number">79</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.0</span> = INTEGER: <span class="hljs-number">11</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.1</span> = INTEGER: <span class="hljs-number">1</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.2</span> = INTEGER: <span class="hljs-number">2</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.3</span> = INTEGER: <span class="hljs-number">3</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.4</span> = INTEGER: <span class="hljs-number">4</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.5</span> = INTEGER: <span class="hljs-number">5</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.6</span> = INTEGER: <span class="hljs-number">6</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.7</span> = INTEGER: <span class="hljs-number">7</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.8</span> = INTEGER: <span class="hljs-number">8</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.9</span> = INTEGER: <span class="hljs-number">9</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.10</span> = INTEGER: <span class="hljs-number">10</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.11</span> = INTEGER: <span class="hljs-number">11</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211294.png" alt="image-20240716213006356"></p>
<h1 id="0x06-更多windows工具">0x06 更多Windows工具</h1>
<p>在这个房间里，我们的重点是任何现代 MS Windows 系统上都可以使用的命令行内置工具。我们没有介绍图形用户界面 (GUI) 工具；此外，我们没有介绍任何需要额外下载和安装步骤的程序。</p>
<p>此任务提到了三个不是内置命令行工具的选项：</p>
<ul>
<li>Sysinternals Suite</li>
<li>Process Hacker</li>
<li>GhostPack Seatbelt</li>
</ul>
<h2 id="sysinternals-suite-系统内部套件">Sysinternals Suite 系统内部套件</h2>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/">Sysinternals Suite</a> 是一组命令行和 GUI 实用程序和工具，提供与 Windows 系统相关的各个方面的信息。为了给您一个想法，我们在下表中列出了一些示例。</p>
<table>
<thead>
<tr>
<th>Utility Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Process Explorer</td>
<td>显示进程以及打开的文件和注册表项</td>
</tr>
<tr>
<td>Process Monitor</td>
<td>监控文件系统、进程和注册表</td>
</tr>
<tr>
<td>PsList</td>
<td>提供有关流程的信息</td>
</tr>
<tr>
<td>PsLoggedOn</td>
<td>显示已登录的用户</td>
</tr>
</tbody>
</table>
<p>检查 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/">Sysinternals 实用程序</a>索引以获取实用程序的完整列表。如果您想了解更多信息并尝试使用这些不同的实用程序，我们建议您使用 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/btsysinternalssg">Sysinternals 室</a>。</p>
<h2 id="process-hacker">Process Hacker</h2>
<p><a target="_blank" rel="noopener" href="https://processhacker.sourceforge.io/">Process Hacker</a> 是另一个高效可靠的 MS Windows GUI 工具，可以让您收集有关正在运行的进程的信息。 Process Hacker 为您提供有关正在运行的进程和相关活动网络连接的详细信息；此外，它还可以让您深入了解从 CPU 和内存到磁盘和网络的系统资源利用率。</p>
<h2 id="ghostpack-seatbelt">GhostPack Seatbelt</h2>
<p>Seatbelt 是 GhostPack 系列的一部分，是一个用 C# 编写的工具。它没有以二进制形式正式发布；因此，您需要使用 MS Visual Studio 自行编译。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211295.png" alt="image-20240716215222112"></p>
<h1 id="0x07-总结">0x07 总结</h1>
<p>这个房间的重点是 Linux 和 MS Windows 系统中的内置命令行工具。尽管命令参数和结果输出不同，但两个系统中都存在许多命令。下表显示了我们用来获取有关系统的更多信息的主要 Linux 和 MS Windows 命令。</p>
<table>
<thead>
<tr>
<th>Linux Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hostname</code></td>
<td>显示系统的主机名</td>
</tr>
<tr>
<td><code>who</code></td>
<td>显示谁已登录</td>
</tr>
<tr>
<td><code>whoami</code></td>
<td>显示有效用户名</td>
</tr>
<tr>
<td><code>w</code></td>
<td>显示谁已登录以及他们正在做什么</td>
</tr>
<tr>
<td><code>last</code></td>
<td>显示最后登录用户的列表</td>
</tr>
<tr>
<td><code>ip address show</code></td>
<td>显示网络接口和地址</td>
</tr>
<tr>
<td><code>arp</code></td>
<td>显示 ARP 缓存</td>
</tr>
<tr>
<td><code>netstat</code></td>
<td>打印网络连接</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>显示当前进程的快照</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Windows Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>systeminfo</code></td>
<td>显示操作系统配置信息，包括服务包级别</td>
</tr>
<tr>
<td><code>whoami</code></td>
<td>显示用户名和组信息以及相应的安全标识符</td>
</tr>
<tr>
<td><code>netstat</code></td>
<td>显示协议统计信息和当前 TCP/IP 网络连接</td>
</tr>
<tr>
<td><code>net user</code></td>
<td>显示计算机上的用户帐户</td>
</tr>
<tr>
<td><code>net localgroup</code></td>
<td>显示计算机上的本地组</td>
</tr>
<tr>
<td><code>arp</code></td>
<td>显示 IP 到物理地址的转换表</td>
</tr>
</tbody>
</table>
<p>这个房间专注于 Linux 或 MS Windows 机器的后利用枚举。对于与Active Directory相关的枚举，我们建议您加入<a target="_blank" rel="noopener" href="https://tryhackme.com/room/adenumeration">枚举AD房间</a>。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">hybcx</div><div class="post-copyright__author_desc">只需热爱, 未来可期！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://hybcx.xyz/2024/07/16/thm-enumeration/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://hybcx.xyz/2024/07/16/thm-enumeration/')">THM-Enumeration</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://hybcx.xyz/2024/07/16/thm-enumeration/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=THM-Enumeration&amp;url=http://hybcx.xyz/2024/07/16/thm-enumeration/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hybcx.xyz" target="_blank">hybcx</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/TryHackMe/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>TryHackMe<span class="tagsPageCount">36</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/16/thm-dang-qian-tai-shi/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">THM-当前态势</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/20/thm-shu-ju-xie-lu/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">THM-数据泄露</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/02/14/thm-basic-pentesting/" title="THM-Basic Pentesting"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-02-14</div><div class="title">THM-Basic Pentesting</div></div></a></div><div><a href="/2024/07/10/thm-c2-jian-jie/" title="THM-C2简介"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-07-10</div><div class="title">THM-C2简介</div></div></a></div><div><a href="/2024/08/08/thm-bypass-uac/" title="THM-ByPass_UAC"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-08-08</div><div class="title">THM-ByPass_UAC</div></div></a></div><div><a href="/2024/06/09/thm-enumerating-active-directory/" title="THM-Enumerating Active Directory"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-09</div><div class="title">THM-Enumerating Active Directory</div></div></a></div><div><a href="/2024/06/17/thm-corp/" title="THM-Corp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-17</div><div class="title">THM-Corp</div></div></a></div><div><a href="/2024/06/16/thm-hacking-with-powershell/" title="THM-Hacking_With_PowerShell"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-16</div><div class="title">THM-Hacking_With_PowerShell</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">hybcx</h1><div class="author-info__desc">只需热爱, 未来可期！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hybchenxing" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/1761635300" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">0x01 介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E7%9B%AE%E7%9A%84"><span class="toc-number">2.</span> <span class="toc-text">0x02 目的</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-linux%E6%9E%9A%E4%B8%BE"><span class="toc-number">3.</span> <span class="toc-text">0x03 Linux枚举</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#system"><span class="toc-number">3.1.</span> <span class="toc-text">System</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#users"><span class="toc-number">3.2.</span> <span class="toc-text">Users</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#networking"><span class="toc-number">3.3.</span> <span class="toc-text">Networking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#running-services"><span class="toc-number">3.4.</span> <span class="toc-text">Running Services</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-windows%E6%9E%9A%E4%B8%BE"><span class="toc-number">4.</span> <span class="toc-text">0x04 Windows枚举</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#system"><span class="toc-number">4.1.</span> <span class="toc-text">System</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#users"><span class="toc-number">4.2.</span> <span class="toc-text">Users</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#networking"><span class="toc-number">4.3.</span> <span class="toc-text">Networking</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-dnssmb-and-snmp"><span class="toc-number">5.</span> <span class="toc-text">0x05 DNS,SMB and SNMP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dns"><span class="toc-number">5.1.</span> <span class="toc-text">DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#smb"><span class="toc-number">5.2.</span> <span class="toc-text">SMB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#snmp"><span class="toc-number">5.3.</span> <span class="toc-text">SNMP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E6%9B%B4%E5%A4%9Awindows%E5%B7%A5%E5%85%B7"><span class="toc-number">6.</span> <span class="toc-text">0x06 更多Windows工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sysinternals-suite-%E7%B3%BB%E7%BB%9F%E5%86%85%E9%83%A8%E5%A5%97%E4%BB%B6"><span class="toc-number">6.1.</span> <span class="toc-text">Sysinternals Suite 系统内部套件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#process-hacker"><span class="toc-number">6.2.</span> <span class="toc-text">Process Hacker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ghostpack-seatbelt"><span class="toc-number">6.3.</span> <span class="toc-text">GhostPack Seatbelt</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">0x07 总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/08/thm-yun-xing-shi-gui-bi-jian-ce/" title="THM-运行时规避检测">THM-运行时规避检测</a><time datetime="2024-08-08T14:19:16.000Z" title="发表于 2024-08-08 22:19:16">2024-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/08/thm-bypass-uac/" title="THM-ByPass_UAC">THM-ByPass_UAC</a><time datetime="2024-08-08T07:36:41.000Z" title="发表于 2024-08-08 15:36:41">2024-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/07/thm-qian-ming-gui-bi/" title="THM-签名规避">THM-签名规避</a><time datetime="2024-08-07T09:11:33.000Z" title="发表于 2024-08-07 17:11:33">2024-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/05/windows-ti-quan-zong-jie/" title="Windows提权总结">Windows提权总结</a><time datetime="2024-08-05T02:59:37.000Z" title="发表于 2024-08-05 10:59:37">2024-08-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/02/thm-dai-ma-hun-yao-yuan-li/" title="THM-代码混淆原理">THM-代码混淆原理</a><time datetime="2024-08-02T01:46:10.000Z" title="发表于 2024-08-02 09:46:10">2024-08-02</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="hybcx" target="_blank">hybcx</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">199</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">30</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://yansedaima.com/" title="颜色代码表"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408121908150.svg" alt="颜色代码表"/><span class="back-menu-item-text">颜色代码表</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box-archive"></use></svg><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shapes"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tags"></use></svg><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-artstation"></use></svg><span> 朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-paper-plane"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shoe-prints1"></use></svg><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF%E8%B5%9B%E4%BA%8B/" style="font-size: 0.88rem;">CTF赛事<sup>18</sup></a><a href="/tags/CVE/" style="font-size: 0.88rem;">CVE<sup>15</sup></a><a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">Java反序列化<sup>3</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">Java基础<sup>1</sup></a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" style="font-size: 0.88rem;">Linux提权<sup>2</sup></a><a href="/tags/MISC/" style="font-size: 0.88rem;">MISC<sup>1</sup></a><a href="/tags/Metasploit/" style="font-size: 0.88rem;">Metasploit<sup>3</sup></a><a href="/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.88rem;">PHP代码审计<sup>2</sup></a><a href="/tags/SecBook/" style="font-size: 0.88rem;">SecBook<sup>1</sup></a><a href="/tags/TryHackMe/" style="font-size: 0.88rem;">TryHackMe<sup>36</sup></a><a href="/tags/Windows%E6%8F%90%E6%9D%83/" style="font-size: 0.88rem;">Windows提权<sup>2</sup></a><a href="/tags/reverse%E7%B3%BB%E5%88%97/" style="font-size: 0.88rem;">reverse系列<sup>2</sup></a><a href="/tags/tryhackme/" style="font-size: 0.88rem;">tryhackme<sup>1</sup></a><a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">web渗透<sup>2</sup></a><a href="/tags/web%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" style="font-size: 0.88rem;">web知识总结<sup>2</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.88rem;">代码审计<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">内网渗透<sup>3</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA/" style="font-size: 0.88rem;">内网靶场<sup>2</sup></a><a href="/tags/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">基本知识<sup>21</sup></a><a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">基础知识<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 0.88rem;">攻防世界<sup>1</sup></a><a href="/tags/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" style="font-size: 0.88rem;">玄机应急响应靶场<sup>1</sup></a><a href="/tags/%E7%BA%A2%E9%98%9F%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">红队渗透<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 hybcx 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '7Sc5uZwcoDwvbgqkpwGKyCpN-gzGzoHsz',
      appKey: 'iEFJUGMm2FY91n9ZG1gdKBSy',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://7Sc5uZwc.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": '7Sc5uZwcoDwvbgqkpwGKyCpN-gzGzoHsz',
        "X-LC-Key": 'iEFJUGMm2FY91n9ZG1gdKBSy',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>