
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1" theme-name="Stellar" theme-version="1.28.1">
  
  <meta name="generator" content="Hexo 7.2.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f9fafb">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  
  <title>THM-Enumeration - hybcx's blog</title>

  
    <meta name="description" content="0x01 介绍 这个房间的重点是利用后枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。而且，我们可能进行了权限升级；换句话说，我们可能在目标系统上拥有管理员或root权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。 如果您对提权感兴趣，可以查看Windows提权室和Linux PrivEsc室。此外，还有两个方便的脚本，Wi">
<meta property="og:type" content="article">
<meta property="og:title" content="THM-Enumeration">
<meta property="og:url" content="http://hybcx.xyz/2024/07/16/thm-enumeration/index.html">
<meta property="og:site_name" content="hybcx&#39;s blog">
<meta property="og:description" content="0x01 介绍 这个房间的重点是利用后枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。而且，我们可能进行了权限升级；换句话说，我们可能在目标系统上拥有管理员或root权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。 如果您对提权感兴趣，可以查看Windows提权室和Linux PrivEsc室。此外，还有两个方便的脚本，Wi">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211288.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211290.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211291.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211292.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211293.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211294.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211295.png">
<meta property="article:published_time" content="2024-07-16T10:30:53.000Z">
<meta property="article:modified_time" content="2024-07-22T12:22:41.293Z">
<meta property="article:author" content="hybcx">
<meta property="article:tag" content="tryhackme">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211288.png">
  
  
  
  <meta name="keywords" content="tryhackme">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="hybcx's blog" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.28.1">

  
    <link rel="shortcut icon" href="/medias/logo.png">
  

  
    
<link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css">

  

  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/medias/avatar.jpg" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">hybcx's blog</div><div class="sub normal cap">人生当是精彩的</div><div class="sub hover cap" style="opacity:0"> 何必忧虑未来！</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item active" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="关于" href="/about/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="友链" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title" href="/2024/07/25/thm-windows-api-jie-shao/"><span class="title">THM-Windows-API介绍</span></a><a class="item title" href="/2024/07/24/thm-windows-nei-he/"><span class="title">THM-Windows内核</span></a><a class="item title" href="/2024/07/20/thm-shu-ju-xie-lu/"><span class="title">THM-数据泄露</span></a><a class="item title" href="/2024/07/21/linux-ti-quan-zong-jie/"><span class="title">Linux提权总结</span></a><a class="item title" href="/2024/07/16/thm-enumeration/"><span class="title">THM-Enumeration</span></a><a class="item title" href="/2024/07/16/thm-dang-qian-tai-shi/"><span class="title">THM-当前态势</span></a><a class="item title" href="/2024/02/10/thm-linux-quan-xian-ti-sheng/"><span class="title">THM-Linux权限提升</span></a><a class="item title" href="/2024/02/14/thm-basic-pentesting/"><span class="title">THM-Basic Pentesting</span></a><a class="item title" href="/2024/07/20/linux-ti-quan-xue-xi-yi/"><span class="title">Linux提权学习之rbash逃逸</span></a><a class="item title" href="/2023/08/07/qian-xi-mu-lu-chuan-yue/"><span class="title">浅析目录穿越</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/hybchenxing/" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/github-logo2.png"/></a><a class="social" href="https://music.163.com/#/user/home?id=9895561810" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/neteasemusic-icon.png"/></a><a class="social" href="https://space.bilibili.com/1761635300" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/bilibili-icon.png"/></a><a class="social" href="https://muselink.cc/hybcx" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/weChat.png"/></a><a class="social" href="javaScript:void('永夜');" rel="noopener noreferrer"><img class="lazy" id="ThemeM" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/moon.svg"/></a><a class="social" href="javaScript:void('永昼');" rel="noopener noreferrer"><img class="lazy" id="ThemeL" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/sun.svg"/></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/tryhackme/">tryhackme</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2024-07-16T10:30:53.000Z">2024-07-16</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2024-07-22T12:22:41.293Z">2024-07-22</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>THM-Enumeration</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h1 id="0x01-介绍">0x01 介绍</h1>
<p>这个房间的重点是利用后枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。而且，我们可能进行了权限升级；换句话说，我们可能在目标系统上拥有管理员或root权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。</p>
<p>如果您对提权感兴趣，可以查看<a target="_blank" rel="noopener" href="https://tryhackme.com/room/windowsprivesc20">Windows提权室</a>和<a target="_blank" rel="noopener" href="https://tryhackme.com/room/linprivesc">Linux PrivEsc</a>室。此外，还有两个方便的脚本，<a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS">WinPEAS</a> 和 <a target="_blank" rel="noopener" href="https://grimbins.github.io/grimbins/linpeas/">LinPEAS</a> 分别用于 MS Windows 和 Linux 权限升级。</p>
<p>我们的目的是收集更多信息，以帮助我们获得对目标网络的更多访问权限。例如，我们可能会找到登录凭据来授予对另一个系统的访问权限。我们专注于标准系统上常用的工具来收集有关目标的更多信息。作为系统的一部分，这些工具看起来无害，并且产生的“噪音”最少。</p>
<p>我们假设您可以访问目标上的命令行界面，例如 Linux 系统上的 <code>bash</code> 或 MS Windows 系统上的 <code>cmd.exe</code> 。从 Linux 系统上的一种类型的 shell 开始，通常很容易切换到另一种类型。同样，从 <code>cmd.exe</code> 开始，您可以切换到 PowerShell（如果可用）。我们刚刚发出命令 <code>powershell.exe</code> 在下面的终端中启动 PowerShell 交互式命令行。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ Microsoft Windows [Version <span class="hljs-number">10.0</span>.<span class="hljs-number">17763.2928</span>]
(c) <span class="hljs-number">2018</span> Microsoft Corporation. All rights reserved.

strategos<span class="hljs-keyword">@RED-WIN-ENUM</span> <span class="hljs-attribute">C</span>:\Users\strategos&gt;powershell.exe
Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

PS <span class="hljs-attribute">C</span>:\Users\strategos&gt;</code></pre>
<p>这个房间的组织如下：</p>
<ul>
<li>枚举的目的</li>
<li>使用常用安装工具进行 Linux 枚举：系统、用户、网络和正在运行的服务</li>
<li>使用内置工具进行 MS Windows 枚举：系统、用户、网络和正在运行的服务</li>
<li>Examples of additional tools: Seatbelt 附加工具示例：安全带</li>
</ul>
<p>尽管这并不是绝对必要的，但我们建议您在完成这一单元之前先完成<a target="_blank" rel="noopener" href="https://tryhackme.com/room/thelayoftheland">The Lay of the Land</a> Room</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211288.png" alt="image-20240716190354307"></p>
<h1 id="0x02-目的">0x02 目的</h1>
<p>当您获得目标系统的“shell”时，您通常已经对该系统有了非常基本的了解。如果它是一个服务器，你已经知道你利用了哪个服务；但是，您不一定知道其他详细信息，例如用户名或网络共享。因此，shell看起来就像一个“暗室”，你对周围的事物有不完整和模糊的了解。从这个意义上说，枚举可以帮助您构建更完整、更准确的图景。</p>
<p>后利用枚举背后的目的是收集尽可能多的有关系统及其网络的信息。被利用的系统可能是公司台式机/笔记本电脑或服务器。我们的目标是收集信息，使我们能够转向网络上的其他系统或掠夺当前系统。我们有兴趣收集的一些信息包括：</p>
<ul>
<li>Users and groups 用户和组</li>
<li>Hostnames 主机名</li>
<li>Routing tables 路由表</li>
<li>Network shares 网络共享</li>
<li>Network services 网络服务</li>
<li>Applications and banners</li>
<li>Firewall configurations 防火墙配置</li>
<li>Service settings and audit configurations 服务设置和审核配置</li>
<li>SNMP and DNS details SNMP 和 DNS 详细信息</li>
<li>寻找凭证（保存在网络浏览器或客户端应用程序上）</li>
</ul>
<p>没有办法列出我们可能偶然发现的所有内容。例如，我们可能会找到可以授予我们访问其他系统的 SSH 密钥。在基于 SSH 密钥的身份验证中，我们生成 SSH 密钥对（公钥和私钥）；公钥安装在服务器上。因此，服务器将信任任何可以证明相关私钥知识的系统。</p>
<p>此外，我们可能会偶然发现用户文档或桌面目录中保存的敏感数据。认为有人可能保留 <code>passwords.txt</code> 或 <code>passwords.xlsx</code> 而不是适当的密码管理器。源代码还可能包含隐藏的密钥和密码，特别是在源代码不打算公开的情况下。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211290.png" alt="image-20240716190750185"></p>
<h1 id="0x03-linux枚举">0x03 Linux枚举</h1>
<p>此任务重点是在访问 shell 后枚举 Linux 机器，例如 <code>bash</code> 。尽管有些命令提供多个区域的信息，但我们尝试根据我们期望获取的信息将命令分为四类。</p>
<ul>
<li>System 系统</li>
<li>Users 用户</li>
<li>Networking 联网</li>
<li>Running Services 运行服务</li>
</ul>
<p>我们建议您单击“启动 AttackBox”和“启动机器”，以便您可以在此任务结束时进行实验并回答问题。</p>
<h2 id="system">System</h2>
<p>在 Linux 系统上，我们可以通过搜索 <code>/etc/</code> 中以 <code>-release</code> 结尾的文件或链接来获取有关 Linux 发行版和发布版本的更多信息。运行 <code>ls /etc/*-release</code> 可以帮助我们找到此类文件。让我们看看 CentOS Linux 上的情况。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ls /etc/*-release
/etc/centos-release  /etc/os-release  /etc/redhat-release  /etc/system-release
$ cat /etc/os-release 
NAME=<span class="hljs-string">"CentOS Linux"</span>
VERSION=<span class="hljs-string">"7 (Core)"</span>
[...]</code></pre>
<p>让我们尝试一下 Fedora 系统。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ls /etc/*-release
/etc/fedora-release@  /etc/os-release@  /etc/redhat-release@  /etc/system-release@
$ cat /etc/os-release
NAME=<span class="hljs-string">"Fedora Linux"</span>
VERSION=<span class="hljs-string">"36 (Workstation Edition)"</span>
[...]</code></pre>
<p>我们可以使用命令 <code>hostname</code> 找到系统的名称。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ hostname
rpm-red-enum.thm</code></pre>
<p>系统上的各种文件可以提供大量有用的信息。特别是，请考虑以下 <code>/etc/passwd</code> 、 <code>/etc/group</code> 和 <code>/etc/shadow</code> 。任何用户都可以读取文件 <code>passwd</code> 和 <code>group</code> 。但是， <code>shadow</code> 密码文件需要 root 权限，因为它包含哈希密码。如果你设法破解哈希值，你就会知道用户的原始密码。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ cat /etc/passwd
<span class="hljs-attribute">root</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:<span class="hljs-attribute">root</span>:/<span class="hljs-attribute">root</span>:/bin/bash
[...]
<span class="hljs-attribute">michael</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1001</span>:<span class="hljs-number">1001</span>::/home/<span class="hljs-attribute">michael</span>:/bin/bash
<span class="hljs-attribute">peter</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1002</span>:<span class="hljs-number">1002</span>::/home/<span class="hljs-attribute">peter</span>:/bin/bash
<span class="hljs-attribute">jane</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1003</span>:<span class="hljs-number">1003</span>::/home/<span class="hljs-attribute">jane</span>:/bin/bash
<span class="hljs-attribute">randa</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1004</span>:<span class="hljs-number">1004</span>::/home/<span class="hljs-attribute">randa</span>:/bin/bash

$ cat /etc/group
<span class="hljs-attribute">root</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">0</span>:
[...]
<span class="hljs-attribute">michael</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1001</span>:
<span class="hljs-attribute">peter</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1002</span>:
<span class="hljs-attribute">jane</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1003</span>:
<span class="hljs-attribute">randa</span>:<span class="hljs-attribute">x</span>:<span class="hljs-number">1004</span>:

$ sudo cat /etc/shadow
<span class="hljs-attribute">root</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$pZlRFi09</span><span class="hljs-variable">$qqgNBS</span>.<span class="hljs-number">00</span>qtcUF9x0yHetjJbXsw0PAwQabpCilmAB47ye3OzmmJVfV6DxBYyUoWBHtTXPU0kQEVUQfPtZPO3C.:<span class="hljs-number">19131</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
[...]
<span class="hljs-attribute">michael</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$GADCGz6m</span><span class="hljs-variable">$g</span>.ROJGcSX/<span class="hljs-number">910</span>DEipiPjU6clo6Z6/uBZ9Fvg3IaqsVnMA.UZtebTgGHpRU4NZFXTffjKPvOAgPKbtb2nQrVU70:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">peter</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$RN4fdNxf</span><span class="hljs-variable">$wvgzdlrIVYBJjKe3s2eqlIQhvMrtwAWBsjuxL5xMVaIw4nL9pCshJlrMu2iyj</span>/NAryBmItFbhYAVznqRcFWIz1:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">jane</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$Ees6f7QM</span><span class="hljs-variable">$TL8D8yFXVXtIOY9sKjMqJ7BoHK1EHEeqM5dojTaqO52V6CPiGq2W6XjljOGx</span>/<span class="hljs-number">08</span>rSo4QXsBtLUC3PmewpeZ/Q0:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">randa</span>:$<span class="hljs-number">6</span><span class="hljs-variable">$dYsVoPyy</span><span class="hljs-variable">$WR43vaETwoWooZvR03AZGPPKxjrGQ4jTb0uAHDy2GqGEOZyXvrQNH10tGlLIHac7EZGV8hSIfuXP0SnwVmnZn0</span>:<span class="hljs-number">19130</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::</code></pre>
<p>同样，各种目录可能会泄露有关用户的信息，并且可能包含敏感文件；一个是在 <code>/var/mail/</code> 处找到的邮件目录。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ls -lh /var/mail/
total <span class="hljs-number">4.0</span>K
-rw-rw----. <span class="hljs-number">1</span> jane      mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">15</span> jane
-rw-rw----. <span class="hljs-number">1</span> michael   mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">13</span> michael
-rw-rw----. <span class="hljs-number">1</span> peter     mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">14</span> peter
-rw-rw----. <span class="hljs-number">1</span> randa     mail   <span class="hljs-number">0</span> May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">15</span> randa
-rw-------. <span class="hljs-number">1</span> root      mail <span class="hljs-number">639</span> May <span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">37</span> root</code></pre>
<p>要查找已安装的应用程序，您可以考虑列出 <code>/usr/bin/</code> 和 <code>/sbin/</code> 中的文件：</p>
<ul>
<li><code>ls -lh /usr/bin/</code></li>
<li><code>ls -lh /sbin/</code></li>
</ul>
<p>在基于 RPM 的 Linux 系统上，您可以使用 <code>rpm -qa</code> 获取所有已安装软件包的列表。 <code>-qa</code> 表示我们要查询所有包。</p>
<p>在基于 Debian 的 Linux 系统上，您可以使用 <code>dpkg -l</code> 获取已安装软件包的列表。下面的输出是从 Ubuntu 服务器获得的。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ dpkg -l
Desired=Unknown/Install/Remove/Purge/Hold
| Status=<span class="hljs-keyword">Not</span>/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,<span class="hljs-attribute">Err</span>: uppercase=bad)
||/ Name                                  Version                            Architecture Description
+++-=====================================-==================================-============-===============================================================================
ii  accountsservice                       <span class="hljs-number">0.6</span>.<span class="hljs-number">55</span>-<span class="hljs-number">0</span>ubuntu12~<span class="hljs-number">20.04</span>.<span class="hljs-number">5</span>           amd64        query <span class="hljs-keyword">and</span> manipulate user account information
ii  adduser                               <span class="hljs-number">3.118</span>ubuntu2                       all          add <span class="hljs-keyword">and</span> remove users <span class="hljs-keyword">and</span> groups
ii  alsa-topology-conf                    <span class="hljs-number">1.2</span>.<span class="hljs-number">2</span>-<span class="hljs-number">1</span>                            all          ALSA topology configuration files
ii  alsa-ucm-conf                         <span class="hljs-number">1.2</span>.<span class="hljs-number">2</span>-<span class="hljs-number">1</span>ubuntu0.<span class="hljs-number">13</span>                  all          ALSA Use Case Manager configuration files
ii  amd64-microcode                       <span class="hljs-number">3.20191218</span>.<span class="hljs-number">1</span>ubuntu1                amd64        Processor microcode firmware for AMD CPUs
[...   ]
ii  zlib1<span class="hljs-attribute">g-dev</span>:amd64                      <span class="hljs-number">1</span>:<span class="hljs-number">1.2</span>.<span class="hljs-number">11</span>.dfsg-<span class="hljs-number">2</span>ubuntu1.<span class="hljs-number">3</span>           amd64        compression library - development</code></pre>
<h2 id="users">Users</h2>
<p>Files such as <code>/etc/passwd</code> reveal the usernames; however, various commands can provide more information and insights about other users on the system and their whereabouts.<br>
<code>/etc/passwd</code> 等文件会泄露用户名；但是，各种命令可以提供有关系统上其他用户及其行踪的更多信息和见解。</p>
<p>您可以使用 <code>who</code> 显示谁登录。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ who
root     tty1         <span class="hljs-number">2022</span>-<span class="hljs-number">05</span>-<span class="hljs-number">18</span> <span class="hljs-number">13</span>:<span class="hljs-number">24</span>
jane     pts/<span class="hljs-number">0</span>        <span class="hljs-number">2022</span>-<span class="hljs-number">05</span>-<span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">17</span> (<span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>)
peter    pts/<span class="hljs-number">1</span>        <span class="hljs-number">2022</span>-<span class="hljs-number">05</span>-<span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> (<span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>)</code></pre>
<p>我们可以看到用户 <code>root</code> 直接登录系统，而用户 <code>jane</code> 和 <code>peter</code> 通过网络连接，我们可以看到他们的情况IP 地址。</p>
<p>请注意， <code>who</code> 不应与打印您的有效用户 ID 的 <code>whoami</code> 混淆。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ whoami
jane</code></pre>
<p>要将事情提升到一个新的水平，您可以使用 <code>w</code> ，它显示谁登录了以及他们正在做什么。根据下面的终端输出，在此示例中， <code>peter</code> 正在编辑 <code>notes.txt</code> ， <code>jane</code> 正在运行 <code>w</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ w
 <span class="hljs-number">07</span>:<span class="hljs-number">18</span>:<span class="hljs-number">43</span> up <span class="hljs-number">18</span>:<span class="hljs-number">05</span>,  <span class="hljs-number">3</span> users,  load <span class="hljs-attribute">average</span>: <span class="hljs-number">0.00</span>, <span class="hljs-number">0.01</span>, <span class="hljs-number">0.05</span>
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
root     tty1                      Wed13   <span class="hljs-number">17</span>:<span class="hljs-number">52</span>m  <span class="hljs-number">0.00s</span>  <span class="hljs-number">0.00s</span> less -s
jane     pts/<span class="hljs-number">0</span>    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>     <span class="hljs-number">07</span>:<span class="hljs-number">17</span>    <span class="hljs-number">3.00s</span>  <span class="hljs-number">0.01s</span>  <span class="hljs-number">0.00s</span> w
peter    pts/<span class="hljs-number">1</span>    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>     <span class="hljs-number">07</span>:<span class="hljs-number">13</span>    <span class="hljs-number">5</span>:<span class="hljs-number">23</span>   <span class="hljs-number">0.00s</span>  <span class="hljs-number">0.00s</span> vi notes.txt</code></pre>
<p>要打印真实有效的用户和组IDS，您可以发出命令 <code>id</code> （用于ID）。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ id
uid=<span class="hljs-number">1003</span>(jane) gid=<span class="hljs-number">1003</span>(jane) groups=<span class="hljs-number">1003</span>(jane) context=unconfined_<span class="hljs-attribute">u</span>:unconfined_<span class="hljs-attribute">r</span>:unconfined_<span class="hljs-attribute">t</span>:s0-s0:c0.c1023</code></pre>
<p>您想知道最近谁在使用该系统吗？ <code>last</code> 显示最后登录用户的列表；此外，我们还可以看到谁注销了以及他们保持联系的时间。在下面的输出中，用户 <code>randa</code> 保持登录状态近 17 个小时，而用户 <code>michael</code> 在四分钟后注销。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ last
jane     pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>     Thu May <span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">17</span>   still logged in   
peter    pts/<span class="hljs-number">1</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>     Thu May <span class="hljs-number">19</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span>   still logged in   
michael  pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>       Thu May <span class="hljs-number">19</span> <span class="hljs-number">05</span>:<span class="hljs-number">12</span> - <span class="hljs-number">05</span>:<span class="hljs-number">17</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">04</span>)    
randa    pts/<span class="hljs-number">1</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.107</span>     Wed May <span class="hljs-number">18</span> <span class="hljs-number">14</span>:<span class="hljs-number">18</span> - <span class="hljs-number">07</span>:<span class="hljs-number">08</span>  (<span class="hljs-number">16</span>:<span class="hljs-number">49</span>)    
root     tty1                          Wed May <span class="hljs-number">18</span> <span class="hljs-number">13</span>:<span class="hljs-number">24</span>   still logged in
[...]</code></pre>
<p>最后，值得一提的是， <code>sudo -l</code> 列出了当前系统上调用用户允许的命令。</p>
<h2 id="networking">Networking</h2>
<p>IP 地址可以使用 <code>ip address show</code> （可缩写为 <code>ip a s</code> ）或旧命令 <code>ifconfig -a</code> （其包不再维护。）下面的终端输出显示了网络接口 <code>ens33</code> ，其 IP 地址 <code>10.20.30.129</code> 和子网掩码 <code>255.255.255.0</code> 与 <code>24</code> 一样。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ip a s
<span class="hljs-number">1</span>: <span class="hljs-attribute">lo</span>: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="hljs-number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="hljs-number">1000</span>
    link/loopback <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> brd <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
    inet <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/<span class="hljs-number">8</span> scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::<span class="hljs-number">1</span>/<span class="hljs-number">128</span> scope host 
       valid_lft forever preferred_lft forever
<span class="hljs-number">2</span>: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="hljs-number">1500</span> qdisc pfifo_fast state UP group default qlen <span class="hljs-number">1000</span>
    link/ether <span class="hljs-number">00</span>:<span class="hljs-number">0</span><span class="hljs-attribute">c</span>:<span class="hljs-number">29</span>:a2:<span class="hljs-number">0</span><span class="hljs-attribute">e</span>:<span class="hljs-number">7</span>e brd <span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:<span class="hljs-attribute">ff</span>:ff
    inet <span class="hljs-number">10.20</span>.<span class="hljs-number">30.129</span>/<span class="hljs-number">24</span> brd <span class="hljs-number">10.20</span>.<span class="hljs-number">30.255</span> scope global noprefixroute dynamic ens33
       valid_lft <span class="hljs-number">1580s</span>ec preferred_lft <span class="hljs-number">1580s</span>ec
    inet6 fe80::<span class="hljs-number">761</span><span class="hljs-attribute">a</span>:b360:<span class="hljs-number">78</span>:<span class="hljs-number">26</span>cd/<span class="hljs-number">64</span> scope link noprefixroute 
       valid_lft forever preferred_lft forever</code></pre>
<p>DNS 服务器可以在 <code>/etc/resolv.conf</code> 中找到。对于使用 DHCP 进行网络配置的系统，请考虑以下终端输出。 DNS，即域名解析服务器，设置为 <code>10.20.30.2</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ cat /etc/resolv.conf
# Generated by NetworkManager
search localdomain thm
nameserver <span class="hljs-number">10.20</span>.<span class="hljs-number">30.2</span></code></pre>
<p><code>netstat</code> 是了解网络连接、路由表和接口统计信息的有用命令。我们在下表中解释了其中的一些选项。</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-a</code></td>
<td>显示监听和非监听套接字</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>仅显示监听套接字</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>显示数字输出而不是解析 IP 地址和端口号</td>
</tr>
<tr>
<td><code>-t</code></td>
<td>TCP</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>UDP</td>
</tr>
<tr>
<td><code>-x</code></td>
<td>UNIX</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>显示socket所属程序的PID和名称</td>
</tr>
</tbody>
</table>
<p>输出中看到的， <code>sshd</code> 正在侦听 SSH 端口，而 <code>master</code> 正在侦听 IPv4 和 IPv6 地址上的 SMTP 端口。请注意，要获取所有 PID（进程 ID）和程序名称，您需要以 root 身份运行 <code>netstat</code> 或使用 <code>sudo netstat</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo netstat -plt
Active Internet connections (<span class="hljs-keyword">only</span> servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:ssh             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">978</span>/sshd            
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-attribute">localhost</span>:smtp          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">1141</span>/master         
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> [::]:ssh                [::]:*                  LISTEN      <span class="hljs-number">978</span>/sshd            
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-attribute">localhost</span>:smtp          [::]:*                  LISTEN      <span class="hljs-number">1141</span>/master</code></pre>
<p><code>netstat -atupn</code> 将显示所有 TCP 和 UDP 侦听和已建立的连接以及数字格式的程序名称以及地址和端口。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo netstat -atupn
Active Internet connections (servers <span class="hljs-keyword">and</span> established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">978</span>/sshd            
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">25</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">1141</span>/master         
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.20</span>.<span class="hljs-number">30.129</span>:<span class="hljs-number">22</span>         <span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>:<span class="hljs-number">38822</span>        ESTABLISHED <span class="hljs-number">5665</span>/<span class="hljs-attribute">sshd</span>: peter [p 
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.20</span>.<span class="hljs-number">30.129</span>:<span class="hljs-number">22</span>         <span class="hljs-number">10.20</span>.<span class="hljs-number">30.105</span>:<span class="hljs-number">38826</span>        ESTABLISHED <span class="hljs-number">5723</span>/<span class="hljs-attribute">sshd</span>: jane [pr 
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      <span class="hljs-number">978</span>/sshd            
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">25</span>                  :::*                    LISTEN      <span class="hljs-number">1141</span>/master         
udp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">323</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*                           <span class="hljs-number">640</span>/chronyd         
udp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">68</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*                           <span class="hljs-number">5638</span>/dhclient       
udp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">323</span>                 :::*                                <span class="hljs-number">640</span>/chronyd</code></pre>
<p>人们可能会认为在访问目标计算机之前使用 <code>nmap</code> 会提供类似的结果。然而，这并不完全正确。 Nmap需要生成相对大量的数据包来检查开放端口，这可以触发入侵检测和防御系统。此外，路由上的防火墙可能会丢弃某些数据包并阻碍扫描，从而导致 Nmap 结果不完整。</p>
<p><code>lsof</code> 代表列出打开的文件。如果我们只想显示互联网和网络连接，我们可以使用 <code>lsof -i</code> 。下面的终端输出显示了 IPv4 和 IPv6 侦听服务以及正在进行的连接。用户 <code>peter</code> 通过 <code>ssh</code> 端口连接到服务器 <code>rpm-red-enum.thm</code> 。请注意，要获取匹配程序的完整列表，您需要以 root 身份运行 <code>lsof</code> 或使用 <code>sudo lsof</code> 。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo lsof -i
COMMAND   PID      USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
chronyd   <span class="hljs-number">640</span>    chrony    <span class="hljs-number">5</span>u  IPv4  <span class="hljs-number">16945</span>      <span class="hljs-number">0</span>t0  UDP <span class="hljs-attribute">localhost</span>:<span class="hljs-number">323</span> 
chronyd   <span class="hljs-number">640</span>    chrony    <span class="hljs-number">6</span>u  IPv6  <span class="hljs-number">16946</span>      <span class="hljs-number">0</span>t0  UDP <span class="hljs-attribute">localhost</span>:<span class="hljs-number">323</span> 
sshd      <span class="hljs-number">978</span>      root    <span class="hljs-number">3</span>u  IPv4  <span class="hljs-number">20035</span>      <span class="hljs-number">0</span>t0  TCP *:ssh (LISTEN)
sshd      <span class="hljs-number">978</span>      root    <span class="hljs-number">4</span>u  IPv6  <span class="hljs-number">20058</span>      <span class="hljs-number">0</span>t0  TCP *:ssh (LISTEN)
master   <span class="hljs-number">1141</span>      root   <span class="hljs-number">13</span>u  IPv4  <span class="hljs-number">20665</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)
master   <span class="hljs-number">1141</span>      root   <span class="hljs-number">14</span>u  IPv6  <span class="hljs-number">20666</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)
dhclient <span class="hljs-number">5638</span>      root    <span class="hljs-number">6</span>u  IPv4  <span class="hljs-number">47458</span>      <span class="hljs-number">0</span>t0  UDP *:bootpc 
sshd     <span class="hljs-number">5693</span>     peter    <span class="hljs-number">3</span>u  IPv4  <span class="hljs-number">47594</span>      <span class="hljs-number">0</span>t0  TCP rpm-red-enum.<span class="hljs-attribute">thm</span>:ssh-&gt;<span class="hljs-number">10.20</span>.<span class="hljs-number">30.113</span>:<span class="hljs-number">38822</span> (ESTABLISHED)
[...]</code></pre>
<p>由于列表可能会变得相当长，因此您可以通过指定您感兴趣的端口（例如 SMTP 端口 25）来进一步过滤输出。通过运行 <code>lsof -i :25</code> ，我们将输出限制为与端口 25 相关的输出，如下面的终端输出所示。服务器正在监听 IPv4 和 IPv6 地址的端口 25。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ sudo lsof -i :<span class="hljs-number">25</span>
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
master  <span class="hljs-number">1141</span> root   <span class="hljs-number">13</span>u  IPv4  <span class="hljs-number">20665</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)
master  <span class="hljs-number">1141</span> root   <span class="hljs-number">14</span>u  IPv6  <span class="hljs-number">20666</span>      <span class="hljs-number">0</span>t0  TCP <span class="hljs-attribute">localhost</span>:smtp (LISTEN)</code></pre>
<h2 id="running-services">Running Services</h2>
<p>获取正在运行的进程的快照可以提供许多见解。 <code>ps</code> 可让您发现正在运行的进程以及有关它们的大量信息。</p>
<p>您可以使用 <code>ps -e</code> 列出系统上的每个进程，其中 <code>-e</code> 选择所有进程。有关该过程的更多信息，您可以添加 <code>-f</code> 表示完整格式，添加 <code>-l</code> 表示长格式。尝试 <code>ps -e</code> 、 <code>ps -ef</code> 和 <code>ps -el</code> 。</p>
<p>您可以获得类似的输出并使用 BSD 语法查看所有进程： <code>ps ax</code> 或 <code>ps aux</code> 。请注意，使用 BSD 语法时 <code>a</code> 和 <code>x</code> 是必需的，因为它们解除了“仅限您自己”和“必须有 tty”限制；换句话说，可以显示所有进程。 <code>u</code> 用于获取有关拥有该进程的用户的详细信息。</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-e</code></td>
<td>所有进程</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>全格式列表</td>
</tr>
<tr>
<td><code>-j</code></td>
<td>职位格式</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>长格式</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>面向用户的格式</td>
</tr>
</tbody>
</table>
<p>要获得更多“可视化”输出，您可以发出 <code>ps axjf</code> 来打印进程树。 <code>f</code> 代表“森林”，它创建一个 ASCII 艺术流程层次结构，如下面的终端输出所示。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ps axf
   PID TTY      STAT   TIME COMMAND
     <span class="hljs-number">2</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span> [kthreadd]
     <span class="hljs-number">4</span> ?        S&lt;     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ [kworker/<span class="hljs-number">0</span>:<span class="hljs-number">0</span>H]
     <span class="hljs-number">5</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">01</span>  \_ [kworker/u256:<span class="hljs-number">0</span>]
[...]
   <span class="hljs-number">978</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /usr/sbin/sshd -D
  <span class="hljs-number">5665</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ <span class="hljs-attribute">sshd</span>: peter [priv]
  <span class="hljs-number">5693</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  |   \_ <span class="hljs-attribute">sshd</span>: peter<span class="hljs-keyword">@pts</span>/<span class="hljs-number">1</span>
  <span class="hljs-number">5694</span> pts/<span class="hljs-number">1</span>    Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  |       \_ -bash
  <span class="hljs-number">5713</span> pts/<span class="hljs-number">1</span>    S+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  |           \_ vi notes.txt
  <span class="hljs-number">5723</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ <span class="hljs-attribute">sshd</span>: jane [priv]
  <span class="hljs-number">5727</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>      \_ <span class="hljs-attribute">sshd</span>: jane<span class="hljs-keyword">@pts</span>/<span class="hljs-number">0</span>
  <span class="hljs-number">5728</span> pts/<span class="hljs-number">0</span>    Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>          \_ -bash
  <span class="hljs-number">7080</span> pts/<span class="hljs-number">0</span>    R+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>              \_ ps axf
   <span class="hljs-number">979</span> ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">12</span> /usr/bin/python2 -Es /usr/sbin/tuned -l -P
   <span class="hljs-number">981</span> ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">07</span> /usr/sbin/rsyslogd -n
  <span class="hljs-number">1141</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /usr/libexec/postfix/master -w
  <span class="hljs-number">1147</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ qmgr -l -t unix -u
  <span class="hljs-number">6991</span> ?        S      <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ pickup -l -t unix -u
  <span class="hljs-number">1371</span> ?        Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span> login -- root
  <span class="hljs-number">1376</span> tty1     Ss     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>  \_ -bash
  <span class="hljs-number">1411</span> tty1     S+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>      \_ man man
  <span class="hljs-number">1420</span> tty1     S+     <span class="hljs-number">0</span>:<span class="hljs-number">00</span>          \_ less -s
[...]</code></pre>
<p>总而言之，请记住使用 <code>ps -ef</code> 或 <code>ps aux</code> 来获取所有正在运行的进程的列表。考虑通过 <code>grep</code> 管道输出以显示包含某些单词的输出行。下面的终端输出显示了其中包含 <code>peter</code> 的行。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ ps -ef | grep peter
root       <span class="hljs-number">5665</span>    <span class="hljs-number">978</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">11</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-attribute">sshd</span>: peter [priv]
peter      <span class="hljs-number">5693</span>   <span class="hljs-number">5665</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> <span class="hljs-attribute">sshd</span>: peter<span class="hljs-keyword">@pts</span>/<span class="hljs-number">1</span>
peter      <span class="hljs-number">5694</span>   <span class="hljs-number">5693</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> pts/<span class="hljs-number">1</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> -bash
peter      <span class="hljs-number">5713</span>   <span class="hljs-number">5694</span>  <span class="hljs-number">0</span> <span class="hljs-number">07</span>:<span class="hljs-number">13</span> pts/<span class="hljs-number">1</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> vi notes.txt</code></pre>
<p>如果您尚未启动连接的 Linux 计算机，请启动它，因为您需要它来回答以下问题。您可以使用 SSH 登录： <code>ssh user@10.10.27.56</code> ，其中登录凭据为：</p>
<ul>
<li>Username: <code>user</code></li>
<li>Password: <code>THM6877</code></li>
</ul>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ cat /etc/os-release 
NAME=<span class="hljs-string">"Ubuntu"</span>
VERSION=<span class="hljs-string">"20.04.4 LTS (Focal Fossa)"</span>
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME=<span class="hljs-string">"Ubuntu 20.04.4 LTS"</span>
VERSION_ID=<span class="hljs-string">"20.04"</span>
HOME_URL=<span class="hljs-string">"https://www.ubuntu.com/"</span>
SUPPORT_URL=<span class="hljs-string">"https://help.ubuntu.com/"</span>
BUG_REPORT_URL=<span class="hljs-string">"https://bugs.launchpad.net/ubuntu/"</span>
PRIVACY_POLICY_URL=<span class="hljs-string">"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"</span>
VERSION_CODENAME=focal
UBUNTU_CODENAME=focal</code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ last
user     pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.11</span>.<span class="hljs-number">81.232</span>     Tue Jul <span class="hljs-number">16</span> <span class="hljs-number">11</span>:<span class="hljs-number">40</span>   still logged in
reboot   system boot  <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">120</span>-generi Tue Jul <span class="hljs-number">16</span> <span class="hljs-number">11</span>:<span class="hljs-number">09</span>   still running
reboot   system boot  <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">120</span>-generi Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">13</span>:<span class="hljs-number">10</span> - <span class="hljs-number">13</span>:<span class="hljs-number">13</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">02</span>)
randa    pts/<span class="hljs-number">0</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>       Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">11</span>:<span class="hljs-number">00</span> - <span class="hljs-number">11</span>:<span class="hljs-number">01</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)
reboot   system boot  <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">120</span>-generi Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">09</span>:<span class="hljs-number">58</span> - <span class="hljs-number">11</span>:<span class="hljs-number">01</span>  (<span class="hljs-number">01</span>:<span class="hljs-number">03</span>)

wtmp begins Mon Jun <span class="hljs-number">20</span> <span class="hljs-number">09</span>:<span class="hljs-number">58</span>:<span class="hljs-number">27</span> <span class="hljs-number">2022</span></code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ netstat -tnlp
(<span class="hljs-keyword">Not</span> all processes could be identified, non-owned process info
 will <span class="hljs-keyword">not</span> be shown, you would have to be root to see it all.)
Active Internet connections (<span class="hljs-keyword">only</span> servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">953</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">389</span>             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">6667</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">27.56</span>:<span class="hljs-number">53</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">53</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.53</span>:<span class="hljs-number">53</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">953</span>                 :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">389</span>                  :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> fe80::<span class="hljs-number">27</span>:<span class="hljs-number">4</span><span class="hljs-attribute">aff</span>:fe60:<span class="hljs-number">3</span>:<span class="hljs-number">53</span> :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">53</span>                  :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">21</span>                   :::*                    LISTEN      -                   
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      -</code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ sudo netstat -tnlp
[sudo] password for <span class="hljs-attribute">user</span>: 
Active Internet connections (<span class="hljs-keyword">only</span> servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">953</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">619</span>/named           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">389</span>             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">728</span>/slapd           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">6667</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">734</span>/inspircd        
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">27.56</span>:<span class="hljs-number">53</span>          <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">619</span>/named           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">53</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">619</span>/named           
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.53</span>:<span class="hljs-number">53</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">581</span>/systemd-resolve 
tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>              <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:*               LISTEN      <span class="hljs-number">659</span>/<span class="hljs-attribute">sshd</span>: /usr/sbin 
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">953</span>                 :::*                    LISTEN      <span class="hljs-number">619</span>/named           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">389</span>                  :::*                    LISTEN      <span class="hljs-number">728</span>/slapd           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> fe80::<span class="hljs-number">27</span>:<span class="hljs-number">4</span><span class="hljs-attribute">aff</span>:fe60:<span class="hljs-number">3</span>:<span class="hljs-number">53</span> :::*                    LISTEN      <span class="hljs-number">619</span>/named           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span>:<span class="hljs-number">53</span>                  :::*                    LISTEN      <span class="hljs-number">619</span>/named           
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">21</span>                   :::*                    LISTEN      <span class="hljs-number">658</span>/vsftpd          
tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      <span class="hljs-number">659</span>/<span class="hljs-attribute">sshd</span>: /usr/sbin</code></pre>
<pre><code class="hljs scss">user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ ps -aux | grep listen
root         <span class="hljs-number">659</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.6</span>  <span class="hljs-number">12172</span>  <span class="hljs-number">6928</span> ?        Ss   <span class="hljs-number">11</span>:<span class="hljs-number">10</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> <span class="hljs-attribute">sshd</span>: /usr/sbin/sshd -D [listener] <span class="hljs-number">0</span> of <span class="hljs-number">10</span>-<span class="hljs-number">100</span> startups
user        <span class="hljs-number">1209</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>   <span class="hljs-number">6432</span>   <span class="hljs-number">720</span> pts/<span class="hljs-number">0</span>    S+   <span class="hljs-number">11</span>:<span class="hljs-number">47</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> grep --color=auto listen
user<span class="hljs-keyword">@red-linux-enumeration</span>:~$ ps -aux | grep THM
randa        <span class="hljs-number">664</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>   <span class="hljs-number">2608</span>   <span class="hljs-number">532</span> ?        Ss   <span class="hljs-number">11</span>:<span class="hljs-number">10</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /bin/sh -c /home/randa/THM-<span class="hljs-number">24765</span>.sh
randa        <span class="hljs-number">675</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.3</span>   <span class="hljs-number">6892</span>  <span class="hljs-number">3240</span> ?        S    <span class="hljs-number">11</span>:<span class="hljs-number">10</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /bin/bash /home/randa/THM-<span class="hljs-number">24765</span>.sh
user        <span class="hljs-number">1212</span>  <span class="hljs-number">0.0</span>  <span class="hljs-number">0.0</span>   <span class="hljs-number">6432</span>   <span class="hljs-number">720</span> pts/<span class="hljs-number">0</span>    S+   <span class="hljs-number">11</span>:<span class="hljs-number">48</span>   <span class="hljs-number">0</span>:<span class="hljs-number">00</span> grep --color=auto THM</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211291.png" alt="image-20240716194955020"></p>
<h1 id="0x04-windows枚举">0x04 Windows枚举</h1>
<p>在此任务中，我们假设您有权访问 Microsoft Windows 主机上的 <code>cmd</code> 。您可能通过利用漏洞并获取 shell 或反向 shell 来获得此访问权限。您还可能在您利用的系统上安装了后门或设置了 SSH 服务器。在所有情况下，以下命令都需要 <code>cmd</code> 才能运行。</p>
<p>在此任务中，我们重点枚举 MS Windows 主机。对于枚举 MS Active Directory，建议您查看枚举 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/adenumeration">Active Directory</a> 室。如果您对 MS Windows 主机上的权限升级感兴趣，我们推荐 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/windowsprivesc20">Windows Privesc 2.0 room</a>。</p>
<p>我们建议您单击“启动 AttackBox”和“启动机器”，以便您可以在此任务结束时进行实验并回答问题。</p>
<h2 id="system">System</h2>
<p><code>systeminfo</code> 可以为我们提供有关系统的详细信息（例如其内部版本号和已安装的补丁）的命令。在下面的示例中，我们可以看到已安装哪些修补程序。</p>
<pre><code class="hljs scss">C:\&gt;systeminfo

Host Name:                 WIN-SERVER-CLI
OS Name:                   Microsoft Windows Server <span class="hljs-number">2022</span> Standard
OS Version:                <span class="hljs-number">10.0</span>.<span class="hljs-number">20348</span> N/A Build <span class="hljs-number">20348</span>
OS Manufacturer:           Microsoft Corporation
[...]
<span class="hljs-built_in">Hotfix</span>(s):                 <span class="hljs-number">3</span> <span class="hljs-built_in">Hotfix</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: KB5013630
                           [<span class="hljs-number">02</span>]: KB5013944
                           [<span class="hljs-number">03</span>]: KB5012673
Network <span class="hljs-built_in">Card</span>(s):           <span class="hljs-number">1</span> <span class="hljs-built_in">NIC</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: <span class="hljs-built_in">Intel</span>(R) <span class="hljs-number">82574</span>L Gigabit Network Connection
[...]</code></pre>
<p>您可以使用 <code>wmic qfe get Caption,Description</code> 检查已安装的更新。此信息将使您了解系统修补和更新的速度。</p>
<pre><code class="hljs scss">C:\&gt;wmic qfe get Caption,Description
Caption                                     Description      
http://support.microsoft.com/?kbid=<span class="hljs-number">5013630</span>  Update
https://support.microsoft.com/help/<span class="hljs-number">5013944</span>  Security Update
                                            Update</code></pre>
<p>您可以使用 <code>net start</code> 检查已安装和启动的 Windows 服务。期望得到一长串名单；下面的输出已被截断。</p>
<pre><code class="hljs scss">C:\&gt;net start
These Windows services are started:

   Base Filtering Engine
   Certificate Propagation
   Client License Service (ClipSVC)
   COM+ Event System
   Connected User Experiences and Telemetry
   CoreMessaging
   Cryptographic Services
   DCOM Server Process Launcher
   DHCP Client
   DNS Client
[...]
   Windows Time
   Windows Update
   WinHTTP Web Proxy Auto-Discovery Service
   Workstation

The command completed successfully.</code></pre>
<p>如果您只对已安装的应用程序感兴趣，则可以发出 <code>wmic product get name,version,vendor</code> 。如果您在连接的虚拟机上运行此命令，您将获得类似于以下输出的内容。</p>
<pre><code class="hljs scss">C:\&gt;wmic product get name,version,vendor
Name                                                            Vendor                                   Version
Microsoft Visual C++ <span class="hljs-number">2019</span> X64 Minimum Runtime - <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span>     Microsoft Corporation                    <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span>
[...]
Microsoft Visual C++ <span class="hljs-number">2019</span> X64 Additional Runtime - <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span>  Microsoft Corporation                    <span class="hljs-number">14.28</span>.<span class="hljs-number">29910</span></code></pre>
<h2 id="users">Users</h2>
<p>要知道你是谁，你可以运行 <code>whoami</code> ；此外，要了解您的能力，即您的特权，您可以使用 <code>whoami /priv</code> 。下面的终端输出显示了一个示例。</p>
<pre><code class="hljs scss">C:\&gt;whoami
win-server-cli\strategos

&gt; whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                            Description                                                        State
========================================= ================================================================== =======
SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled
SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
[...]</code></pre>
<p>此外，您可以使用 <code>whoami /groups</code> 来了解您属于哪些组。下面的终端输出显示该用户属于其他组中的 <code>NT AUTHORITY\Local account and member of Administrators group</code> 。</p>
<pre><code class="hljs scss">C:\&gt;whoami /groups

GROUP INFORMATION
-----------------

Group Name                                                    Type             SID          Attributes
============================================================= ================ ============ ===============================================================
Everyone                                                      Well-known group S-<span class="hljs-number">1</span>-<span class="hljs-number">1</span>-<span class="hljs-number">0</span>      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Local account and member of Administrators group Well-known group S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">114</span>    Mandatory group, Enabled by default, Enabled group
BUILTIN\Administrators                                        Alias            S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">32</span>-<span class="hljs-number">544</span> Mandatory group, Enabled by default, Enabled group, Group owner
[...]</code></pre>
<p>您可以通过运行 <code>net user</code> 查看用户。</p>
<pre><code class="hljs scss">C:\&gt;net user

User accounts for \\WIN-SERVER-CLI

-------------------------------------------------------------------------------
Administrator            DefaultAccount           Guest
michael                  peter                    strategos
WDAGUtilityAccount
The command completed successfully.</code></pre>
<p>如果系统是 Windows 域控制器，您可以使用 <code>net group</code> 发现可用组，否则使用 <code>net localgroup</code> 发现可用组，如下面的终端所示。</p>
<pre><code class="hljs scss">C:\&gt;net localgroup

Aliases for \\WIN-SERVER-CLI

-------------------------------------------------------------------------------
*Access Control Assistance Operators
*Administrators
*Backup Operators
*Certificate Service DCOM Access
*Cryptographic Operators
*Device Owners
[...]</code></pre>
<p>您可以使用命令 <code>net localgroup administrators</code> 列出属于本地管理员组的用户。</p>
<pre><code class="hljs scss">C:\&gt;net localgroup administrators
Alias name     administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
Administrator
michael
peter
strategos
The command completed successfully.</code></pre>
<p>使用 <code>net accounts</code> 查看机器上的本地设置；此外，如果计算机属于某个域，则可以使用 <code>net accounts /domain</code> 。此命令有助于了解密码策略，例如最短密码长度、最长密码期限和锁定持续时间。</p>
<h2 id="networking">Networking</h2>
<p>您可以使用 <code>ipconfig</code> 命令来了解您的系统网络配置。如果您想了解所有与网络相关的设置，可以使用 <code>ipconfig /all</code> 。下面的终端输出显示了使用 <code>ipconfig</code> 时的输出。例如，如果我们想了解 DNS 服务器，我们可以使用 <code>ipconfig /all</code> 。</p>
<pre><code class="hljs scss">C:\&gt;ipconfig

Windows IP Configuration


Ethernet adapter Ethernet0:

   Connection-specific DNS Suffix  . : localdomain
   Link-local IPv6 Address . . . . . : fe80::<span class="hljs-number">3</span>dc5:<span class="hljs-number">78</span>ef:<span class="hljs-number">1274</span>:a740%<span class="hljs-number">5</span>
   IPv4 Address. . . . . . . . . . . : <span class="hljs-number">10.20</span>.<span class="hljs-number">30.130</span>
   Subnet Mask . . . . . . . . . . . : <span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span>
   Default Gateway . . . . . . . . . : <span class="hljs-number">10.20</span>.<span class="hljs-number">30.2</span></code></pre>
<p>在 MS Windows 上，我们可以使用 <code>netstat</code> 来获取各种信息，例如系统正在侦听哪些端口、哪些连接处于活动状态以及谁正在使用它们。在此示例中，我们使用选项 <code>-a</code> 显示所有侦听端口和活动连接。 <code>-b</code> 让我们找到连接中涉及的二进制文件，而 <code>-n</code> 用于避免解析 IP 地址和端口号。最后， <code>-o</code> 显示进程ID（PID）。</p>
<p>在下面显示的部分输出中，我们可以看到 <code>netstat -abno</code> 显示服务器正在侦听 TCP 端口 22、135、445 和 3389。进程 <code>sshd.exe</code> 、 <code>RpcSs</code> 分别位于端口 <code>22</code> 、 <code>135</code> 和 <code>3389</code> 上。此外，我们可以看到与 SSH 服务器的两个已建立的连接，如状态 <code>ESTABLISHED</code> 所示。</p>
<pre><code class="hljs scss">C:\&gt;netstat -abno

Active Connections

  Proto  Local Address          Foreign Address        State           PID
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">22</span>             <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2016</span>
 [sshd.exe]
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">135</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">924</span>
  RpcSs
 [svchost.exe]
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">445</span>            <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span>
 Can not obtain ownership information
  TCP    <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">3389</span>           <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">416</span>
  TermService
 [svchost.exe]
[...]
  TCP    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.130</span>:<span class="hljs-number">22</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>:<span class="hljs-number">39956</span>       ESTABLISHED     <span class="hljs-number">2016</span>
 [sshd.exe]
  TCP    <span class="hljs-number">10.20</span>.<span class="hljs-number">30.130</span>:<span class="hljs-number">22</span>        <span class="hljs-number">10.20</span>.<span class="hljs-number">30.1</span>:<span class="hljs-number">39964</span>       ESTABLISHED     <span class="hljs-number">2016</span>
 [sshd.exe]
[...]</code></pre>
<p>您可能认为通过端口扫描目标系统可以获得相同的结果；然而，由于两个原因，这是不准确的。防火墙可能会阻止扫描主机到达特定网络端口。此外，端口扫描系统会产生大量流量，这与 <code>netstat</code> 不同，它的噪音为零。</p>
<p>最后，值得一提的是，使用 <code>arp -a</code> 可以帮助您发现同一 LAN 上最近与您的系统进行通信的其他系统。 ARP代表地址解析协议； <code>arp -a</code> 显示当前 ARP 条目，即与您的系统通信的同一 LAN 上的系统的物理地址。下面显示了示例输出。这表明这些 IP 地址已与我们的系统进行了某种通信；通信可以是尝试连接，甚至是简单的 ping。请注意， <code>10.10.255.255</code> 并不代表系统，因为它是子网广播地址。</p>
<pre><code class="hljs scss">C:\&gt;arp -a

Interface: <span class="hljs-number">10.10</span>.<span class="hljs-number">204.175</span> --- <span class="hljs-number">0</span>x4 
  Internet Address      Physical Address      Type
  <span class="hljs-number">10.10</span>.<span class="hljs-number">0.1</span>             <span class="hljs-number">02</span>-c8-<span class="hljs-number">85</span>-b5-<span class="hljs-number">5</span>a-aa     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">16.117</span>          <span class="hljs-number">02</span>-f2-<span class="hljs-number">42</span>-<span class="hljs-number">76</span>-fc-ef     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">122.196</span>         <span class="hljs-number">02</span>-<span class="hljs-number">48</span>-<span class="hljs-number">58</span>-<span class="hljs-number">7</span>b-<span class="hljs-number">92</span>-e5     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">146.13</span>          <span class="hljs-number">02</span>-<span class="hljs-number">36</span>-c1-<span class="hljs-number">4</span>d-<span class="hljs-number">05</span>-f9     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">161.4</span>           <span class="hljs-number">02</span>-a8-<span class="hljs-number">58</span>-<span class="hljs-number">98</span>-<span class="hljs-number">1</span>a-d3     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">217.222</span>         <span class="hljs-number">02</span>-<span class="hljs-number">68</span>-<span class="hljs-number">10</span>-dd-be-<span class="hljs-number">8</span>d     dynamic
  <span class="hljs-number">10.10</span>.<span class="hljs-number">255.255</span>         ff-ff-ff-ff-ff-ff     static</code></pre>
<p>如果您尚未启动附加的 MS Windows Server，请启动它，因为您需要它来回答以下问题。您可以通过 AttackBox 中的 SSH 连接到 MS Windows VM，例如，使用 <code>ssh user@10.10.5.135</code> ，其中登录凭据为：</p>
<ul>
<li>Username: <code>user</code></li>
<li>Password: <code>THM33$$88</code></li>
</ul>
<pre><code class="hljs scss">PS C:\Users\user&gt; systeminfo
                                                                                           
Host Name:                 RED-WIN-ENUM                                                    
OS Name:                   Microsoft Windows Server <span class="hljs-number">2019</span> Datacenter                        
OS Version:                <span class="hljs-number">10.0</span>.<span class="hljs-number">17763</span> N/A Build <span class="hljs-number">17763</span>                                      
OS Manufacturer:           Microsoft Corporation                                           
OS Configuration:          Standalone Server                                               
OS Build Type:             Multiprocessor Free                                             
Registered Owner:          EC2                                                             
Registered Organization:   Amazon.com                                                      
Product ID:                <span class="hljs-number">00430</span>-<span class="hljs-number">00000</span>-<span class="hljs-number">00000</span>-AA155                                         
Original Install Date:     <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2021</span>, <span class="hljs-number">2</span>:<span class="hljs-number">59</span>:<span class="hljs-number">06</span> PM                                           
System Boot Time:          <span class="hljs-number">7</span>/<span class="hljs-number">16</span>/<span class="hljs-number">2024</span>, <span class="hljs-number">12</span>:<span class="hljs-number">43</span>:<span class="hljs-number">50</span> PM                                          
System Manufacturer:       Amazon EC2                                                      
System Model:              t3a.small                                                       
System Type:               x64-based PC                                                    
<span class="hljs-built_in">Processor</span>(s):              <span class="hljs-number">1</span> <span class="hljs-built_in">Processor</span>(s) Installed.                                       
                           [<span class="hljs-number">01</span>]: AMD64 Family <span class="hljs-number">23</span> Model <span class="hljs-number">1</span> Stepping <span class="hljs-number">2</span> AuthenticAMD ~<span class="hljs-number">2200</span> Mhz 
BIOS Version:              Amazon EC2 <span class="hljs-number">1.0</span>, <span class="hljs-number">10</span>/<span class="hljs-number">16</span>/<span class="hljs-number">2017</span>                                      
Windows Directory:         C:\Windows                                                      
System Directory:          C:\Windows\system32                                             
Boot Device:               \Device\HarddiskVolume1
System Locale:             en-us;English (United States)
<span class="hljs-selector-tag">Input</span> Locale:              en-us;English (United States)
<span class="hljs-selector-tag">Time</span> Zone:                 (UTC) Coordinated Universal Time
Total Physical Memory:     <span class="hljs-number">2</span>,<span class="hljs-number">016</span> MB
Available Physical Memory: <span class="hljs-number">452</span> MB
Virtual Memory: Max Size:  <span class="hljs-number">2</span>,<span class="hljs-number">400</span> MB
Virtual Memory: Available: <span class="hljs-number">907</span> MB
Virtual Memory: In Use:    <span class="hljs-number">1</span>,<span class="hljs-number">493</span> MB
Page File <span class="hljs-built_in">Location</span>(s):     C:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              N/A
<span class="hljs-built_in">Hotfix</span>(s):                 <span class="hljs-number">30</span> <span class="hljs-built_in">Hotfix</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: KB5015731
                           [<span class="hljs-number">02</span>]: KB4470502
                           [<span class="hljs-number">03</span>]: KB4470788
                           [<span class="hljs-number">04</span>]: KB4480056
                           [<span class="hljs-number">05</span>]: KB4486153
                           [<span class="hljs-number">06</span>]: KB4493510
                           [<span class="hljs-number">07</span>]: KB4499728
                           [<span class="hljs-number">08</span>]: KB4504369
                           [<span class="hljs-number">09</span>]: KB4512577
                           [<span class="hljs-number">10</span>]: KB4512937
                           [<span class="hljs-number">11</span>]: KB4521862
                           [<span class="hljs-number">12</span>]: KB4523204
                           [<span class="hljs-number">13</span>]: KB4535680
                           [<span class="hljs-number">14</span>]: KB4539571
                           [<span class="hljs-number">15</span>]: KB4549947
                           [<span class="hljs-number">16</span>]: KB4558997
                           [<span class="hljs-number">17</span>]: KB4562562
                           [<span class="hljs-number">18</span>]: KB4566424
                           [<span class="hljs-number">19</span>]: KB4570332
                           [<span class="hljs-number">20</span>]: KB4577586
                           [<span class="hljs-number">21</span>]: KB4577667
                           [<span class="hljs-number">22</span>]: KB4587735
                           [<span class="hljs-number">23</span>]: KB4589208
                           [<span class="hljs-number">24</span>]: KB4598480
                           [<span class="hljs-number">25</span>]: KB4601393
                           [<span class="hljs-number">26</span>]: KB5000859
                           [<span class="hljs-number">27</span>]: KB5015811
                           [<span class="hljs-number">28</span>]: KB5012675
                           [<span class="hljs-number">29</span>]: KB5014031
                           [<span class="hljs-number">30</span>]: KB5014797
Network <span class="hljs-built_in">Card</span>(s):           <span class="hljs-number">1</span> <span class="hljs-built_in">NIC</span>(s) Installed.
                           [<span class="hljs-number">01</span>]: Amazon Elastic Network Adapter
                                 Connection Name: Ethernet <span class="hljs-number">3</span>
                                 DHCP Enabled:    Yes
                                 DHCP Server:     <span class="hljs-number">10.10</span>.<span class="hljs-number">0.1</span>
                                 IP <span class="hljs-built_in">address</span>(es)
                                 [<span class="hljs-number">01</span>]: <span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>
                                 [<span class="hljs-number">02</span>]: fe80::adab:<span class="hljs-number">8</span>db:dd45:<span class="hljs-number">3744</span>
Hyper-V Requirements:      A hypervisor has been detected. Features required for Hyper-V will not be displayed.</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211292.png" alt="image-20240716210027010"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211293.png" alt="image-20240716210015177"></p>
<h1 id="0x05-dnssmb-and-snmp">0x05 DNS,SMB and SNMP</h1>
<p>当我们介绍枚举时，接触 DNS、SMB 和 SNMP 是个好主意。</p>
<h2 id="dns">DNS</h2>
<p>我们都熟悉域名系统 (DNS) 查询，可以在其中查找 A、AAAA、CName 和 TXT 记录等。如果您想温习一下 DNS 知识，我们建议您访问 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/dnsindetail">DNS 详细室</a>。如果我们可以获得 DNS 服务器负责应答的所有记录的“副本”，我们可能会发现我们不知道存在的主机。</p>
<p>尝试 DNS 区域传输的一种简单方法是通过 <code>dig</code> 命令。如果您想了解有关 <code>dig</code> 和类似命令的更多信息，我们建议您查看<a target="_blank" rel="noopener" href="https://tryhackme.com/room/passiverecon">被动侦察室</a>。根据 DNS 服务器配置，DNS 区域传输可能会受到限制。如果不限制，应该可以使用 <code>dig -t AXFR DOMAIN_NAME @DNS_SERVER</code> 来实现。 <code>-t AXFR</code> 表示我们正在请求区域传输，而 <code>@</code> 位于 <code>DNS_SERVER</code> 之前，我们要查询与指定 <code>DOMAIN_NAME</code></p>
<h2 id="smb">SMB</h2>
<p>服务器消息块 (SMB) 是一种提供对文件和打印机的共享访问的通信协议。我们可以使用 <code>net share</code> 检查共享文件夹。这是输出的示例。我们可以看到 <code>C:\Internal Files</code> 是在 Internal 名称下共享的。</p>
<pre><code class="hljs scss">user<span class="hljs-keyword">@TryHackMe</span>$ net share

Share name   Resource                        Remark

-------------------------------------------------------------------------------
C$           <span class="hljs-attribute">C</span>:\                             Default share
IPC$                                         Remote IPC
ADMIN$       <span class="hljs-attribute">C</span>:\Windows                      Remote Admin
Internal     <span class="hljs-attribute">C</span>:\Internal Files               Internal Documents
Users        <span class="hljs-attribute">C</span>:\Users
The command completed successfully.</code></pre>
<h2 id="snmp">SNMP</h2>
<p>简单网络管理协议 (SNMP) 旨在帮助收集有关网络上不同设备的信息。它可以让您了解各种网络事件，从磁盘故障的服务器到打印机墨水耗尽。因此，SNMP 可以为攻击者保存大量信息。查询与 SNMP 相关的服务器的一个简单工具是 <code>snmpcheck</code> 。您可以在 AttackBox 的 <code>/opt/snmpcheck/</code> 目录中找到它；语法非常简单： <code>/opt/snmpcheck/snmpcheck.rb 10.10.5.135 -c COMMUNITY_STRING</code> 。</p>
<p>如果您想在本地 Linux 机器上安装 <code>snmpcheck</code> ，请考虑以下命令。</p>
<pre><code class="hljs scss">git clone https://gitlab.com/kalilinux/packages/snmpcheck.git
cd snmpcheck/
gem install snmp
chmod +x snmpcheck-<span class="hljs-number">1.9</span>.rb</code></pre>
<p>确保您正在运行任务 4 中的 MS Windows Server 计算机并回答以下问题。</p>
<pre><code class="hljs scss">┌──(hybcx㉿LAPTOP-<span class="hljs-number">1</span>TO1HS75)-<span class="hljs-selector-attr">[/root]</span>
└─$ dig -t AXFR redteam<span class="hljs-selector-class">.thm</span> @<span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>

; &lt;&lt;&gt;&gt; DiG <span class="hljs-number">9.19</span><span class="hljs-selector-class">.25-185-g392e7199df2-1-Debian</span> &lt;&lt;&gt;&gt; -t AXFR redteam<span class="hljs-selector-class">.thm</span> @<span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>
;; global options: +cmd
redteam.thm.            <span class="hljs-number">3600</span>    IN      SOA     red-win-enum. hostmaster. <span class="hljs-number">5</span> <span class="hljs-number">900</span> <span class="hljs-number">600</span> <span class="hljs-number">86400</span> <span class="hljs-number">3600</span>
redteam.thm.            <span class="hljs-number">3600</span>    IN      NS      red-win-enum.
first.redteam.thm.      <span class="hljs-number">3600</span>    IN      A       <span class="hljs-number">10.10</span>.<span class="hljs-number">254.1</span>
flag.redteam.thm.       <span class="hljs-number">3600</span>    IN      TXT     <span class="hljs-string">"THM{DNS_ZONE}"</span>
second.redteam.thm.     <span class="hljs-number">3600</span>    IN      A       <span class="hljs-number">10.10</span>.<span class="hljs-number">254.2</span>
tryhackme.redteam.thm.  <span class="hljs-number">3600</span>    IN      CNAME   tryhackme.com.
redteam.thm.            <span class="hljs-number">3600</span>    IN      SOA     red-win-enum. hostmaster. <span class="hljs-number">5</span> <span class="hljs-number">900</span> <span class="hljs-number">600</span> <span class="hljs-number">86400</span> <span class="hljs-number">3600</span>
;; Query <span class="hljs-selector-tag">time</span>: <span class="hljs-number">279</span> msec
;; SERVER: <span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>#<span class="hljs-number">53</span>(<span class="hljs-number">10.10</span>.<span class="hljs-number">5.135</span>) (TCP)
;; WHEN: Tue Jul <span class="hljs-number">16</span> <span class="hljs-number">21</span>:<span class="hljs-number">25</span>:<span class="hljs-number">48</span> CST <span class="hljs-number">2024</span>
;; XFR size: <span class="hljs-number">7</span> records (messages <span class="hljs-number">1</span>, bytes <span class="hljs-number">295</span>)</code></pre>
<pre><code class="hljs scss">PS C:\Users\user&gt; net share

Share name   Resource                        Remark

-------------------------------------------------------------------------------
C$           C:\                             Default share
IPC$                                         Remote IPC
ADMIN$       C:\Windows                      Remote Admin
Internal     C:\Internal Files               Internal Documents
THM{<span class="hljs-number">829738</span>}  C:\Users\user\Private           Enjoy SMB shares
Users        C:\Users
The command completed successfully.</code></pre>
<pre><code class="hljs scss">┌──(hybcx㉿LAPTOP-<span class="hljs-number">1</span>TO1HS75)-<span class="hljs-selector-attr">[/root]</span>
└─$ snmpwalk -v2c -c public <span class="hljs-number">10.10</span><span class="hljs-selector-class">.5</span><span class="hljs-selector-class">.135</span>                                                                
iso<span class="hljs-selector-class">.3</span><span class="hljs-selector-class">.6</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.2</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.0</span> = STRING: <span class="hljs-string">"Hardware: AMD64 Family 23 Model 1 Stepping 2 AT/AT COMPATIBLE - Software: Windows Version 6.3 (Build 17763 Multiprocessor Free)"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">2.0</span> = OID: iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.4</span>.<span class="hljs-number">1.311</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">3.1</span>.<span class="hljs-number">2</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">3.0</span> = Timeticks: (<span class="hljs-number">268432</span>) <span class="hljs-number">0</span>:<span class="hljs-number">44</span>:<span class="hljs-number">44.32</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">4.0</span> = STRING: <span class="hljs-string">"TryHackMe"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">5.0</span> = STRING: <span class="hljs-string">"RED-WIN-ENUM"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">6.0</span> = STRING: <span class="hljs-string">"THM{SNMP_SERVICE}"</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.1</span>.<span class="hljs-number">7.0</span> = INTEGER: <span class="hljs-number">79</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.0</span> = INTEGER: <span class="hljs-number">11</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.1</span> = INTEGER: <span class="hljs-number">1</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.2</span> = INTEGER: <span class="hljs-number">2</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.3</span> = INTEGER: <span class="hljs-number">3</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.4</span> = INTEGER: <span class="hljs-number">4</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.5</span> = INTEGER: <span class="hljs-number">5</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.6</span> = INTEGER: <span class="hljs-number">6</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.7</span> = INTEGER: <span class="hljs-number">7</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.8</span> = INTEGER: <span class="hljs-number">8</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.9</span> = INTEGER: <span class="hljs-number">9</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.10</span> = INTEGER: <span class="hljs-number">10</span>
iso.<span class="hljs-number">3.6</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">1.2</span>.<span class="hljs-number">2.1</span>.<span class="hljs-number">1.11</span> = INTEGER: <span class="hljs-number">11</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211294.png" alt="image-20240716213006356"></p>
<h1 id="0x06-更多windows工具">0x06 更多Windows工具</h1>
<p>在这个房间里，我们的重点是任何现代 MS Windows 系统上都可以使用的命令行内置工具。我们没有介绍图形用户界面 (GUI) 工具；此外，我们没有介绍任何需要额外下载和安装步骤的程序。</p>
<p>此任务提到了三个不是内置命令行工具的选项：</p>
<ul>
<li>Sysinternals Suite</li>
<li>Process Hacker</li>
<li>GhostPack Seatbelt</li>
</ul>
<h2 id="sysinternals-suite-系统内部套件">Sysinternals Suite 系统内部套件</h2>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/">Sysinternals Suite</a> 是一组命令行和 GUI 实用程序和工具，提供与 Windows 系统相关的各个方面的信息。为了给您一个想法，我们在下表中列出了一些示例。</p>
<table>
<thead>
<tr>
<th>Utility Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Process Explorer</td>
<td>显示进程以及打开的文件和注册表项</td>
</tr>
<tr>
<td>Process Monitor</td>
<td>监控文件系统、进程和注册表</td>
</tr>
<tr>
<td>PsList</td>
<td>提供有关流程的信息</td>
</tr>
<tr>
<td>PsLoggedOn</td>
<td>显示已登录的用户</td>
</tr>
</tbody>
</table>
<p>检查 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/">Sysinternals 实用程序</a>索引以获取实用程序的完整列表。如果您想了解更多信息并尝试使用这些不同的实用程序，我们建议您使用 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/btsysinternalssg">Sysinternals 室</a>。</p>
<h2 id="process-hacker">Process Hacker</h2>
<p><a target="_blank" rel="noopener" href="https://processhacker.sourceforge.io/">Process Hacker</a> 是另一个高效可靠的 MS Windows GUI 工具，可以让您收集有关正在运行的进程的信息。 Process Hacker 为您提供有关正在运行的进程和相关活动网络连接的详细信息；此外，它还可以让您深入了解从 CPU 和内存到磁盘和网络的系统资源利用率。</p>
<h2 id="ghostpack-seatbelt">GhostPack Seatbelt</h2>
<p>Seatbelt 是 GhostPack 系列的一部分，是一个用 C# 编写的工具。它没有以二进制形式正式发布；因此，您需要使用 MS Visual Studio 自行编译。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202407162211295.png" alt="image-20240716215222112"></p>
<h1 id="0x07-总结">0x07 总结</h1>
<p>这个房间的重点是 Linux 和 MS Windows 系统中的内置命令行工具。尽管命令参数和结果输出不同，但两个系统中都存在许多命令。下表显示了我们用来获取有关系统的更多信息的主要 Linux 和 MS Windows 命令。</p>
<table>
<thead>
<tr>
<th>Linux Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hostname</code></td>
<td>显示系统的主机名</td>
</tr>
<tr>
<td><code>who</code></td>
<td>显示谁已登录</td>
</tr>
<tr>
<td><code>whoami</code></td>
<td>显示有效用户名</td>
</tr>
<tr>
<td><code>w</code></td>
<td>显示谁已登录以及他们正在做什么</td>
</tr>
<tr>
<td><code>last</code></td>
<td>显示最后登录用户的列表</td>
</tr>
<tr>
<td><code>ip address show</code></td>
<td>显示网络接口和地址</td>
</tr>
<tr>
<td><code>arp</code></td>
<td>显示 ARP 缓存</td>
</tr>
<tr>
<td><code>netstat</code></td>
<td>打印网络连接</td>
</tr>
<tr>
<td><code>ps</code></td>
<td>显示当前进程的快照</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Windows Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>systeminfo</code></td>
<td>显示操作系统配置信息，包括服务包级别</td>
</tr>
<tr>
<td><code>whoami</code></td>
<td>显示用户名和组信息以及相应的安全标识符</td>
</tr>
<tr>
<td><code>netstat</code></td>
<td>显示协议统计信息和当前 TCP/IP 网络连接</td>
</tr>
<tr>
<td><code>net user</code></td>
<td>显示计算机上的用户帐户</td>
</tr>
<tr>
<td><code>net localgroup</code></td>
<td>显示计算机上的本地组</td>
</tr>
<tr>
<td><code>arp</code></td>
<td>显示 IP 到物理地址的转换表</td>
</tr>
</tbody>
</table>
<p>这个房间专注于 Linux 或 MS Windows 机器的后利用枚举。对于与Active Directory相关的枚举，我们建议您加入<a target="_blank" rel="noopener" href="https://tryhackme.com/room/adenumeration">枚举AD房间</a>。</p>

<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2024/07/20/thm-shu-ju-xie-lu/">THM-数据泄露</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2024/07/16/thm-dang-qian-tai-shi/">THM-当前态势</a></div></section></div>




  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>感谢大佬们的不吝赐教！</p>

    </section>
    <section class='body cmt-body twikoo'>
      

<div id="twikoo_container"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>
    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="text"><p><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<p>本站由 <a href="/">hybcx</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1">Stellar 1.28.1</a> 主题创建。<br>
本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="true"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E4%BB%8B%E7%BB%8D"><span class="toc-text">0x01 介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E7%9B%AE%E7%9A%84"><span class="toc-text">0x02 目的</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-linux%E6%9E%9A%E4%B8%BE"><span class="toc-text">0x03 Linux枚举</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#system"><span class="toc-text">System</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#users"><span class="toc-text">Users</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#networking"><span class="toc-text">Networking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#running-services"><span class="toc-text">Running Services</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-windows%E6%9E%9A%E4%B8%BE"><span class="toc-text">0x04 Windows枚举</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#system"><span class="toc-text">System</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#users"><span class="toc-text">Users</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#networking"><span class="toc-text">Networking</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-dnssmb-and-snmp"><span class="toc-text">0x05 DNS,SMB and SNMP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#dns"><span class="toc-text">DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#smb"><span class="toc-text">SMB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#snmp"><span class="toc-text">SNMP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E6%9B%B4%E5%A4%9Awindows%E5%B7%A5%E5%85%B7"><span class="toc-text">0x06 更多Windows工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sysinternals-suite-%E7%B3%BB%E7%BB%9F%E5%86%85%E9%83%A8%E5%A5%97%E4%BB%B6"><span class="toc-text">Sysinternals Suite 系统内部套件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#process-hacker"><span class="toc-text">Process Hacker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ghostpack-seatbelt"><span class="toc-text">GhostPack Seatbelt</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-%E6%80%BB%E7%BB%93"><span class="toc-text">0x07 总结</span></a></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M10.46 1.25h3.08c1.603 0 2.86 0 3.864.095c1.023.098 1.861.3 2.6.752a5.75 5.75 0 0 1 1.899 1.899c.452.738.654 1.577.752 2.6c.095 1.004.095 2.261.095 3.865v1.067c0 1.141 0 2.036-.05 2.759c-.05.735-.153 1.347-.388 1.913a5.75 5.75 0 0 1-3.112 3.112c-.805.334-1.721.408-2.977.43a10.81 10.81 0 0 0-.929.036c-.198.022-.275.054-.32.08c-.047.028-.112.078-.224.232c-.121.166-.258.396-.476.764l-.542.916c-.773 1.307-2.69 1.307-3.464 0l-.542-.916a10.605 10.605 0 0 0-.476-.764c-.112-.154-.177-.204-.224-.232c-.045-.026-.122-.058-.32-.08c-.212-.023-.49-.03-.93-.037c-1.255-.021-2.171-.095-2.976-.429A5.75 5.75 0 0 1 1.688 16.2c-.235-.566-.338-1.178-.389-1.913c-.049-.723-.049-1.618-.049-2.76v-1.066c0-1.604 0-2.86.095-3.865c.098-1.023.3-1.862.752-2.6a5.75 5.75 0 0 1 1.899-1.899c.738-.452 1.577-.654 2.6-.752C7.6 1.25 8.857 1.25 10.461 1.25M6.739 2.839c-.914.087-1.495.253-1.959.537A4.25 4.25 0 0 0 3.376 4.78c-.284.464-.45 1.045-.537 1.96c-.088.924-.089 2.11-.089 3.761v1c0 1.175 0 2.019.046 2.685c.045.659.131 1.089.278 1.441a4.25 4.25 0 0 0 2.3 2.3c.515.214 1.173.294 2.429.316h.031c.398.007.747.013 1.037.045c.311.035.616.104.909.274c.29.17.5.395.682.645c.169.232.342.525.538.856l.559.944a.52.52 0 0 0 .882 0l.559-.944c.196-.331.37-.624.538-.856c.182-.25.392-.476.682-.645c.293-.17.598-.24.909-.274c.29-.032.639-.038 1.037-.045h.032c1.255-.022 1.913-.102 2.428-.316a4.25 4.25 0 0 0 2.3-2.3c.147-.352.233-.782.278-1.441c.046-.666.046-1.51.046-2.685v-1c0-1.651 0-2.837-.089-3.762c-.087-.914-.253-1.495-.537-1.959a4.25 4.25 0 0 0-1.403-1.403c-.464-.284-1.045-.45-1.96-.537c-.924-.088-2.11-.089-3.761-.089h-3c-1.651 0-2.837 0-3.762.089" clip-rule="evenodd"/><path fill="currentColor" d="M9 11a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0"/></svg><span>参与讨论</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.28.1" async></script>

<!-- optional -->

  <script>
    function load_twikoo() {
        if (!document.querySelectorAll("#twikoo_container")[0]) return;
        utils.js('https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js', {defer: true}).then(function () {
            const el = document.getElementById("twikoo_container");
            var path = el.getAttribute('comment_id');
            if (!path) {
                path = decodeURI(window.location.pathname);
            }
            twikoo.init(Object.assign({"js":"https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js","envId":"https://blog-comments-phi.vercel.app"}, {
                el: '#twikoo_container',
                path: path,
            }));
        });
    }

    window.addEventListener('DOMContentLoaded', (event) => {
        load_twikoo();
    });
</script>



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
