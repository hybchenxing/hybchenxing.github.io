<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>渗透测试流程&amp;外网打点 | hybcx</title><meta name="keywords" content="内网渗透"><meta name="author" content="hybcx,19815455497@163.com"><meta name="copyright" content="hybcx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="渗透测试流程&amp;外网打点"><meta name="application-name" content="渗透测试流程&amp;外网打点"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="渗透测试流程&amp;外网打点"><meta property="og:url" content="http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/index.html"><meta property="og:site_name" content="hybcx"><meta property="og:description" content="0x01 前言 终于抽出时间来学习了，看了看st3pby师傅给的资料，对于渗透测试流程不熟悉的我，感觉需要学的挺多的，估计又是一场恶战，话不多说直接开卷！！ 0x02 渗透测试基本流程 这里先学习一下大致测试的框架流程： 大致可分为三个阶段：信息搜集、漏洞发现、漏洞利用。但放到实战中，这三个方面又可"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg"><meta property="article:author" content="hybcx"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg"><meta name="description" content="0x01 前言 终于抽出时间来学习了，看了看st3pby师傅给的资料，对于渗透测试流程不熟悉的我，感觉需要学的挺多的，估计又是一场恶战，话不多说直接开卷！！ 0x02 渗透测试基本流程 这里先学习一下大致测试的框架流程： 大致可分为三个阶段：信息搜集、漏洞发现、漏洞利用。但放到实战中，这三个方面又可"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d98ea8480e5ec98a243adfc7bd46b93a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"向✌们无限学习","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":"3JLPGIZJOJw6Nvu2","LingQueMonitorID":"3JLPOLHV5W6IAty5"},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":null},
  algolia: {"appId":"Z7A3XW4R2I","apiKey":"12db1ad54372045549ef465881c17e743","indexName":"my-hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: hybcx","link":"链接: ","source":"来源: hybcx","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'hybcx',
  title: '渗透测试流程&外网打点',
  postAI: '',
  pageFillDescription: '0x01 前言, 0x02 渗透测试基本流程, 2.1 确定目标, 范围的确定, 规则的确定, 需求的确定, 2.2 分析风险获得授权, 2.3 信息搜集, 2.4 漏洞探测（手动amp自动）, 探测方法, 探测内容, 2.5 漏洞验证, 2.6 信息分析, 2.7 利用漏洞获取数据, 2.8 信息整理, 2.9 形成报告, 0x03 信息搜集, 3.1 信息搜集的分类, 3.2 搜集什么信息, 3.3 目标确认, 域名注册信息（主域名查询）, whois查询, 方法一：根服务器, 方法二：第三方服务查询, 方法三：whois命令, 方法四：中文域名, dig查询, ICP备案查询, 站长工具, 爱站网, 证书查询, DNS共享记录查询, IP反查, 股权信息, Hackerone, Google, 国家企业信用信息公示系统, 获取真实IP, 如何判断是否有CDN, 方法一：多地ping, 方法二：nslookup, 方法三：在线工具, 绕过CDN, 查询历史DNS记录, 使用国外主机请求域名, 网站信息泄露漏洞, 查询子域名, 邮件信息, 目标网站 APP 应用, 子域名查询, SubDomainsBrute, ESD, Layer 子域名挖掘机, Xray, Bypass-firewalls-by-DNS-history, OneForAll, 搜索引擎发现子域名, 第三方聚合服务发现子域名, 通过 SSL 证书, 使用命令行, 使用工具和脚本, 证书收集, 通过海外 DNS 查询, 通过变更的域名, 通过 APP 移动端应用, 通过 F5 LTM 解码, 通过全网扫描, 通过 virtual-host 碰撞, 通过 favicon.ico 哈希特征, 通过网页源码特征值, 使用 CloudFair 工具, DNS 域传送发现子域名, IP段的收集, C段与旁站查询, Nmap扫描, 搜索引擎语法, nmap扫描, httpscan, bufferfly, cscan, masscan, fscan, shuize, ALLiN, Ehole, 开放端口探测, 网络架构探测, CMS识别, 服务器信息搜集, 特定关键字识别, 特定文件及路径识别, 响应头信息识别, 常见脚本工具, 数字观星平台, WAF识别, 其他应用收集, 小程序, 公众号, 生活号, APP搜集, PC应用, 敏感文件、敏感目录探测, 脚本工具, Google hacking, 针对信息泄露的搜索引擎, Google hacking database, ffuf, dirmap, github语法, 历史页面, 网盘信息搜集, 邮箱信息搜集, 寻找目标邮箱入口, 通过子域名, 通过搜索引擎, 在线平台搜集, 工具搜集, 验证邮箱, 邮箱爆破, JS信息搜集, 手工搜集, 利用工具, JSFinder, LinkFinder, Hae, 社会工程学, 目标域名邮箱收集, 0x04 外网打点基本流程, Step One, 主域名收集, 收集子域名, 获取真实IP与C段, 获取对应的资产, 子域名探活, 整理资产指纹识别, web资产漏扫, IP和C段的高危端口利用, web资产目录扫描, 敏感Web资产深入挖掘, app、小程序、公众号, Step Second, 收集目标, 0x05 后记, 0x06 参考文章前言终于抽出时间来学习了看了看师傅给的资料对于渗透测试流程不熟悉的我感觉需要学的挺多的估计又是一场恶战话不多说直接开卷渗透测试基本流程这里先学习一下大致测试的框架流程大致可分为三个阶段信息搜集漏洞发现漏洞利用但放到实战中这三个方面又可以有很多的细节优化进一步深入明确测试流程这里主要通过个阶段来学习一下整个测试流程渗透测试一般就是典型的黑盒测试就是模拟黑客的入侵还有一种叫白盒渗透是在了解了一些内部的情况之后再挖掘漏洞一般性黑盒测试的东西多一点确定目标范围的确定测试的范围我们要知道当前测试的范围是域名内网和外网整个网站还是网站的某个功能模块一般来说可能测试的是一个公司或企业的内部网络针对的大部分是服务器或者是一个网站或网站群或者是一些软件应用或者这类的话一般都是获取应用的后台服务器的权限规则的确定我们需要知道我们可以测试到什么程度是发现漏洞即可还是要进一步利用漏洞是否有时间限制是否可以修改上传能否提权等等等等也就是确定问我们可以做什么不可以做什么这里填充一下文章给的目标系统介绍重点保护对象及特性是否允许数据破坏是否允许阻断业务正常运行测试之前是否应当知会相关部门接口人接入方式外网和内网测试是发现问题就算成功还是尽可能的发现多的问题渗透过程是否需要考虑社会工程需求的确定我们需要明确让我们测试的需求具体是什么应用的漏洞新上线程序业务逻辑漏洞针对业务的人员权限管理漏洞针对人员权限根据需求和自己技术能力来确定能不能做能做多少点到为止分析风险获得授权这里的知识就不懂了没了解过直接加自己的浅薄理解了分析渗透测试过程中可能产生的风险如大量测试数据的处理影响正常业务开展服务器发生异常的应急数据备份和恢复测试人力物力成本由测试方书写实施方案初稿并提交给客户本公司内部领导进行审核在审核完成后从客户本公司内部领导获取对测试方进行书面委托授权书授权测试方进行渗透测试不授权不测试信息搜集这里一块可以说是奠定了一次渗透测试是否会成功的基础虽然之前有所总结但现在也几乎忘了因此这一块得重点温习一下令起一部分首先明确一下信息搜集阶段的目的尽可能多的获取到目标应用的各种信息信息包括脚本语言类型服务器类型目录结构是否使用开源软件且使用的哪种开源软件数据库类型页面所含的超链接部署应用用到的框架中间件类型用到了哪些网络服务使用的哪种等等还有很多而其中搜集利用到的方式为主动扫描开放搜索利用搜索引擎获取后台未授权页面敏感等等基础信息网段域名端口旁站段系统信息操作系统版本在之后的提权中才能对症下药应用信息各端口的应用例如应用邮件应用等版本信息所有探测到的版本服务信息服务器类型版本中间件数据库脚本类型软件类型微信用到的网络服务人员信息域名注册人员信息应用中网站发帖人的管理员姓名等防护信息试着看能否探测到防护设备这种信息一般可以先通过部分功能强大的小插件先获取漏洞探测手动自动到了这一阶段就需要利用搜集到的各类信息尝试找到相应的漏洞进行探测探测方法各类漏扫工具等等结合漏洞去开源漏洞库等地方去尝试寻找是否是已经公开过的漏洞网络漫游找寻漏洞验证平常也需要多关注一些关于网络安全的新闻掌握漏洞实时消息说不定日后就不会用到的简单列举一下常见的软件漏洞提权漏洞大量漏洞漏洞漏洞低版本解析漏洞解析漏洞后门漏洞等网络服务弱口令漏洞后门漏洞探测内容系统漏洞找寻对方系统是否没有打入相关补丁幸运地话可能会发现对方操作系统并未及时打补丁后果就是直接拿下漏洞配置问题也就是中间件漏洞这一块爆的漏洞还是很多的应用漏洞应用开发问题还有就是开启了其他端口的服务但却没设置授权访问或者可以弱口令打入各种端口服务这里主要是针对端口服务的开启比如这里可能有等等常被用于代理服务端口一般为服务远程连接服务远程桌面连接等等通信安全看看传输过程中的敏感数据是明文的比如在的传输加密所用的各类加密盐等等漏洞验证将上一步发现的有可能可以成功利用的漏洞都验证一遍结合实际情况搭建模拟环境进行测试成功后再在目标中实现验证发面包括一下内容自动化验证结合自动化扫描工具提供的结果手工验证根据公开资源进行验证试验验证自己搭建模拟环境进行验证登录猜解有时可以尝试猜解一下登陆口的账号密码等信息可关注前端接口业务漏洞验证如发现业务漏洞要进行验证公开资源的利用渗透代码网站通用缺省口令厂商的漏洞警告等信息分析这一步是为下一步实施具体渗透做准备精准攻击准备好上一步探测到的漏洞漏洞利用用来对某个模块进行精准攻击绕过防御机制是否有防火墙等设备如何绕过定制攻击路径最佳工具路径根据薄弱点入口搞清楚内网权限位置确定最终目标绕过检测机制是否有检测机制流量监控杀毒软件恶意代码检测等免杀攻击代码经过试验得来的代码包括不限于代码注入语句等利用漏洞获取数据实施攻击根据前几步的结果进行攻击获取内部信息基础设施网络连接路由拓扑等进一步渗透内网入侵敏感目标持续性存在一般对客户做渗透不需要后门添加管理账号驻扎手法等清理痕迹清理相关日志访问操作上传文件等信息整理整理渗透工具整理渗透过程中用到的代码等整理收集信息整理渗透过程中收集到的一切信息整理漏洞信息整理渗透过程中遇到的各种漏洞各种脆弱位置信息目的为了最后形成报告形成测试结果使用形成报告按需整理按照之前第一步跟客户确定好的范围需求来整理资料并将资料形成报告补充介绍要对漏洞成因验证过程和带来危害进行分析修补建议要对所有产生的问题提出合理高效安全的解决办法信息搜集这里就单独着重学习一下信息搜集的各类奇淫巧技吧信息搜集的分类主动式信息搜集可获取到的信息较多但易被目标发现通过直接发起与被测目标网络之间的互动来获取相关信息如通过扫描目标系统被动式信息搜集搜集到的信息较少但不易被发现通过第三方服务来获取目标网络相关信息如通过搜索引擎方式来搜集信息搜集什么信息信息微步网站架构信息通过查询我们可以检测是否存在域传送漏洞子域名搜集敏感目录及敏感信息源码泄露搜索引擎工具脆弱系统网络空间旁站查询端查询指纹信息端口服务备案信息真实探测社工朋友圈微博空间求职交易等社交平台企业信息天眼查企业信用信息公示系统工业和信息化部地址域名信息备案管理系统目标确认域名注册信息主域名查询通过如下步骤确认目标所有者信息目标域名主机名解析目标域名主机名的地址获取域名的详细解析过程后续用于字典制作和进一步收集目标信息的基础查询就是一个用来查询域名是否已经被注册以及注册域名的详细信息的数据库如域名所有人域名注册商信息可以获取关键注册人的信息包括注册商联系人联系邮箱联系电话创建时间等可以进行邮箱反查域名爆破邮箱社工域名劫持等等注不同域名后缀的信息需要到不同的数据库查询主要的实现原理根据域名从根服务器获取域名所在服务器再根据域名从域名所在服务器获取域名信息即当然如果知道了域名信息所在服务器可以跳过第一步直接查询域名信息下面实操一手方法一根服务器通过原始网页查询首先根据域名从的根服务器获取域名所在的服务器或者根据域名后缀在数据库中查询对应服务器地址这里我们就以为例查询一下如下图可以看到该域名对应的服务器接下来就是根据得到的服务器获取域名信息结果如下但这里只能查询一级域名不能携带之类的前缀这里也能看到如果域名后缀不对应也是查询不到的方法二第三方服务查询下方有对应的英文详细信息体验下来感觉更好一点信息挺完善的不过本质来似乎都是来自根服务器查询到的信息整合了一下而已而阿里云和腾讯云的感觉用于查国内就行了最后一个站长工具的不太完善但直接提供了反查功能感觉还算不错感觉是查国内挺效率的工具了这里还有爱站这里最全面的感觉就是微步社区了可以看到结果很全面就是想要查询一些隐私还得氪金方法三命令就是用命令进行查询这个命令在与下都可安装这里用演示了至于安装办法就不赘述了同样的如下图二级域名就查询不到了这里需要注意的是国际域名可以设置隐私保护但像国内等域名是不可以设置隐私保护的方法四中文域名这里看了几篇文章还有用代码去实现的自我感觉没太必要这里的代码可以自己写也可以直接用第三方库具体的感兴趣参考一文搞定数据库查询域名信息这里介绍这篇文章提到的中文域名查询他这里说通过接口直接查询中文域名会提示没有查询结果这时候需要将中文域名进行编码在线编码其实中文后缀的域名可以不编码主要是中英结合的域名比如中万从浏览器直接复制过来是这是一种叫做的编码方式中万然后加上前缀就和上面的结果一致了可以看到还是可以查询到的不过这里如果进入其对应的服务器中就查询错误格式不正确不过这里竟然可以直接中文域名查询当然根服务器也可以这里附上一个查询信息的解释是查询命令是要查询的域名域名是号相当于注册对象的一个身份证号码也就是客户端禁止转移该状态由注册商设置域名可以更新域名信息修改续费删除需要指派至少一台域名服务器则可以正常使用域名注册人的姓名注册人的联系邮箱注册商他们进行抢注域名然后进行价转让的公司也就是域名解析服务器它在互联网的作用是把域名转换成为网络可以识别的地址注册该域名的时间该域名到期时间安全扩展是由提供的一系列安全认证的机制可参考它提供了一种来源鉴定和数据完整性的扩展但不去保障可用性加密性和证实域名不存在未设置未部署查询是常用的域名查询工具可以从域名服务器查询主机地址信息获取到详细的域名信息这个命令是的一部分本身并没有在和系统中集成所以如果我们想要使用该命令就需要先下载相应的软件包至于下载方式这里就不说了这里补充一下对于资源记录的四个元组的知识记录地址记录记录一个域名对应的地址记录地址记录记录一个域名对应的地址记录别名记录记录一个主机的别名记录电子邮件交换记录记录一个邮件域名对应的地址比如后面的部分邮件服务器对应的地址记录域名服务器记录记录该域名由哪台域名服务器解析记录反向记录也即从地址到域名的一条记录记录记录域名的相关文本信息记录开始授权是一种比较难以理解的记录值一般二级域名才会有简单使用对一些字段的解释第一二行输出了有关的版本信息和全局设置选项以及输入参数信息输出了从返回的技术信息比较重要的是如果的值为则说明本次查询成功这段信息可以用选项来控制是否显示但是小心禁止掉也可能关闭一些其它的选项查询字段显示了我们查询的域名以及查询的服务代表的是查询记录即主机查询回答字段这里的结果表示要查询先查询记录对进行访问当我们访问后该主机让我们访问我们访问后这个的主机会告诉我们的是这部分显示了请求所花的时间服务器当前时间以及查询信息的大小还有一个值得记录的是选项说是根据反查域名另外每个命令后面添加可以简化输出信息访问记录查询该地址所对应的主机名解析是用域名查而记录是查域名不过这里始终没看出来域名在哪里还有一个命令可以看到域名解析详细过程备案查询备案是指网站在信息产业部提交网站信息进行官方认可对国内各大小网站包括企业及个人站点的严格审查工作对于没有合法备案的非经营性网站或没有取得许可证的经营性网站根据网站性质将予以罚款严重的关闭网站以此规范网络安全打击一切利用网络资源进行不法活动的犯罪行为也就是说只要是盈利为目的的网站都要进行备案否则会受到相应的处罚国内使用国内服务器的网站都必须要先办理备案后才可以上线通过查询目标企业的备案信息可直接获取到目标企业注册了哪些域名从而增加可渗透的目标范围推荐使用官方网站地址域名信息备案管理系统支持使用单位名称域名和备案号进行查询站长工具爱站网站长综合查询工具爱站网证书查询证书是一种遵守协议的服务器数字证书由受信任的根证书颁发机构颁发证书采用协议进行通信证书部署到服务器后服务器端的访问将启用协议您的网站将会通过加密协议来传输数据可帮助服务器端和客户端之间建立加密链接从而保证数据传输的安全通过查询共用证书的网站可以找到相关的其他域名第一种可以浏览器直接查看如下图点击更多信息接着点击上图的查看证书即可第二种是利用在线网站查询第三种是通过网络空间搜索引擎可查询语法手册语法说明搜索证书或者等中带有的资产搜索证书持有者是的资产搜索证书颁发者为的资产验证证书是否有效有效无效共享记录查询域名服务器是进行域名和与之相对应的地址转换的服务器中保存了一张域名和与之相对应的地址的表以解析消息的域名域名是上某一台计算机或计算机组的名称用于在数据传输时标识计算机的电子方位有时也指地理位置域名是由一串用点分隔的名字组成的通常包含组织名而且始终包括两到三个字母的后缀以指明组织的类型或该域所在的国家或地区此处通过查询共享服务器的主机来获取到相关的域名需要注意的是如果是公开的服务器那么查询的效果将会特别差首先查询目标是否存在自建的服务器将获取到的服务器带入进行查询此处查询的结果并不全是属于目标范围需要进一步的确认和观察反查目标多个域名可能绑定在同一上通过反查一定情况下可获取到其他的域名信息同网站查询同服务器网站查询站长工具输入相关的域名或地址即可查询搜索引擎搜索反查域名即可但有时候效果并不理想很多情况查不到推荐使用平台等最推荐的还是效果最好能查到很多东西股权信息通过查询股权信息或者股权穿透图寻找子公司和孙公司等一般对外投资超过或者有行政权限的都可以算目标天眼查企查查如查询字节跳动通过查询子公司再查询子公司对应的产品可以大范围的扩大攻击面工具推荐一些在上进行众测的厂商会把自己的测试范围列举出来其中就包含有大量的域名因此通过来完善资产收集也是一个不错的方法以阿里为例直接搜索里面的一些关键内容来查询比如公司名备案引用的特殊等还是以阿里为例别人的成果图浙备号国家企业信用信息公示系统获取真实为了保证网络的稳定和快速传输网站服务商会在网络的不同位置设置节点服务器通过内容分发网络技术将网络请求分发到最优的节点服务器上面如果网站开启了加速就无法通过网站的域名信息获取真实的要对目标的资源进行收集就要绕过查询到其真实的信息一个小浏览器切换手机模式可能是真实公众号小程序中的资产也可能对应真实如何判断是否有在对目标信息收集之前首先要判断目标网站是否开启了一般通过不同地方的主机域名和域名解析两种方法通过查看返回的是否是多个的方式来判断网站是否开启了如果返回的信息是多个不同的那就有可能使用了技术方法一多地使用各种多地的服务查看对应地址是否唯一如果不唯一多半是使用了多地网站有可以到有多个一般这种方法要根据多个网站都进行尝试一下才能更好的确定不过这里能用的我知道的只有两个而且后者还似乎崩了查询没反应又去谷歌找了一番无果感觉有需要的话需要多翻翻一些网站了方法二试用进行检测如果返回域名解析对应多个那么多半是试用了这里看到一个是有多个地址一个是的值直接就是什么的这很明显就是有了方法三在线工具在线工具查看是否存在可以参考以下站点这里推荐第二个站点绕过查询历史记录查看与域名绑定的历史记录可能会存在使用前的记录相关查询网站有未仔细查看需要企业邮箱注册不过很全前身为拥有大约万亿记录亿记录亿证书记录以及超过亿子域的记录数据自年以来网站每天都收集和更新海量数据记录历史子域名拥有超过亿个变更记录提供支持同时进行多域名查询这个网站自年以来一直在跟踪和记录历史变更数据底蕴很足不过这里查了半天没查到什么信息而且这个网站似乎对于历史记录用的是上面的网站的拥有爬取超过亿个子域数据该网站调用非常方便以和格式返回数据还有很多网站这里就不一一介绍了详细可浏览参考文章这里汇总一下使用国外主机请求域名部分国内的加速服务商只对国内的线路做了加速但是国外的线路没有做加速这样就可以通过国外的主机来探测真实的信息探测的方式也有两种可以利用已有的国外主机直接进行探测如果没有国外主机可以利用公开的多地服务多地服务有国外的探测节点可以利用国外的探测节点返回的信息来判断真实的信息网站信息泄露漏洞服务器日志文件探针文件例如网站备份压缩文件字典非常重要往往疏忽的点就在一台边缘服务器小页面中有一个字段会显示该主机真实查询子域名这里注意的就是子域名段以及旁站同网站由于加速需要支付一定的费用很多网站只对主站做了加速子域名没有做加速子域名可能跟主站在同一个服务器或者同一个段网络中可以通过子域名探测的方式收集目标的子域名信息通过查询子域名的信息来辅助判断主站的真实信息具体的方法在下面叙述邮件信息一般大型网站自己部署架设的邮件服务器如果向外部用户发送邮件的话如果中间未经任何数据处理和防护措施那么邮件头部的源码中会包含此邮件服务器的真实地址常见的邮件触发点有订阅邮箱注册激活处邮箱找回密码处产品更新的邮件推送某业务执行后发送的邮件通知员工邮箱邮件管理平台等入口处的忘记密码另外这里还有一个奇淫技巧通过发送邮件给一个不存在的邮箱地址比如因为该用户不存在所以发送将失败并且还会收到一个包含发送该电子邮件给你的服务器的真实通知生产上多关注这些点一个不成功继续测试下一个邮件触发点很多大型网站的邮件服务器不止一台并不是所有都做了防护处理细节决定成败目标网站应用如果目标网站有自己的可以尝试利用等流量抓包工具抓取的请求从里面可能会找到目标的真实子域名查询这里除了常见的网络空间如等就是一些强大脚本工具了这里熟悉几个常见的项目地址是通过纯爆破来寻找子域名为了最大提升脚本效率采用协程多进程的方式进行爆破以上需要安装库进行异步查询需要安装库和协程库且在最近更新之后是支持扫描泛解析域名的使用参数这里简单了解了一下域名泛解析简单来说就是的泛域名解析也可以理解为带通配符的解析记录带通配符的解析记录是用来为不存在的子域提供解析请求响应的方法例如存在一个如果我们设置通配符记录则对其不存在的所有子域比如这些都是不存在的子域则如果我们在对这些子域进行请求的时候都会自动指向因此基于上述原理如果我们的目标域名设置了这样的泛解析那我们可以凭借强大的字典对其任意子域进行请求看最终返回的是否与其主域一致如果一致那说明该子域不存在但如果不一致说明该子域是存在的当然如果目标域名没有设置泛解析那我们在对其子域进行请求的时候如果返回了与主域地址不同的情况则直接说明该子域存在我们针对一个泛解析的域名进行爆破会提示错误之后使用参数开启泛解析强制爆破项目地址具体的就不介绍了看一下使用效果即可这里扫描单个域名看看就是速度有点慢扫描单个域名模式扫描单个域名扫描多个域名英文逗号分隔扫描单个域名且过滤子域名中单个特定响应内容搜本店扫描单个域名且过滤子域名中多个特定响应内容搜本店收藏店铺扫描文件文件中每行一个域名跳过相似度对比开启这个选项会把所有泛解析的域名都过滤掉平均分割字典加快爆破使用域传送漏洞获取子域名使用证书透明度获取子域名子域名挖掘机项目地址项目地址是一款强大的安全评估工具一款自动化扫描器我们可以用其自带的子域名发掘功能来针对性探测功能支持暴力破解模式和非暴力模式可以只探测服务或者只探测可解析的子域另外支持数据传递作为插件端或者分发消息的接收端来使用都非常方便快捷项目地址是一款集成全自动化的探测工具通过探测历史记录搜索旧的收集子域并检查服务器是否对该域名进行答复另外它还基于源服务器和防火墙在响应中的相似性阈值来判断项目地址搜索引擎发现子域名使用搜索引擎语法如或者百度等第三方聚合服务发现子域名第三方聚合平台和等获取子域信息通过证书证书颁发机构必须将他们发布的每个证书发布到公共日志中证书通常包含域名子域名和电子邮件地址因此可以利用证书来发现目标站点的真实地址运营商在给服务器提供保护的同时也会与其服务器进行加密通信这时当服务器的端口接入域名时也会在端口暴露其证书我们通过证书比对便可发现网站的真实地址利用引擎搜索引擎能够扫描整个互联网每天都会扫描地址空间以搜索所有联网设备并收集相关的信息可以利用进行全网方面的证书搜索找到匹配的真实可以看到当我们针对一个互联网地址进行搜索时是有匹配到证书签名的同理我们根据域名指纹搜索证书指纹然后再反查就可以了首先针对目标域名选择证书搜索结果出来一堆有效的证书和无效的证书我们在搜索的时候可以使用语法来先检索有效证书如果无果再回去查看无效证书使用命令行通过和等常见的基础命令也同样可以达到反查证书的效果附上成果图使用工具和脚本通过自己写工具脚本集成前面的两点完全可以做到一个简易版的全网证书爬取也可以利用现有的一些脚本工具和网站省的我们自己费力了例如项目地址脚本兼容和需要配置不过只针对目标网站是否使用服务进行探测证书收集可以通过进行快速证书查询收集附上查询的小脚本获得所有包含证书的子域通过海外查询针对国内市场用户大部分的服务商并没有做海外市场的所以可以通过寻找小众冷门的海外查询看是否能获得真实海外地址也可以使用海外的超级类的平台在线多国家多地区测试推荐支持多个地区的测试另外支持针对某子域超长期的监控通过邮件通知简直太强大了就是需要氪金小技巧在上也可以搜索子域名运气好的话会有意想不到的收获通过变更的域名很多网站在发展的过程中会更换域名比如京东以前的域名是后来斥巨资购买了网站在更换新域名时如果将部署到新的域名上而之前的域名由于没过期可能未使用因此可以直接获得服务器所以历史域名也是一个很重要的点通过移动端应用如果网站存在可以通过抓包分析其的数据流量看是否能找到网站真实地址记得关注的历史版本里面会有很多通过解码是将所有的应用请求分配到多个节点服务器上提高业务的处理能力也就是负载均衡当服务器使用做负载均衡时通过对关键字的解码可以获取服务器真实地址例如先把第一小节的十进制数即取出来将其转为十六进制数接着从后至前取四个字节出来最后依次转为十进制数即是服务器的真实地址通过全网扫描首先从网络信息中心或获取目标地区段接着使用等工具对扫描出来端口开放的主机进行爬取然后在的字段写入我们需要寻找的子域最后过滤特征确认是否有对应的服务器响应如果端口不是常见或者固定当场退役缺陷实际上全网扫描的方法十分笨重不推荐因为已经有很多的网站给我们提供了全网爬取服务之前的方法里都有介绍到何必自己全网扫描呢受限于网络受限于设备你个人爬的数据也不会有人家商业爬的全通过碰撞当我们收集了目标足够多的可能的真实时可以通过和子域的碰撞来批量获得命中目标以及目标哪些的子域这里对于我这个小白还不懂什么是碰撞那我们先来了解一下什么是碰撞当直接访问回显错误直接指定头为某个域名时访问该回显正常时可判断可进行碰撞当一些域名只允许在内网访问时可通过这种碰撞直接突破边界限制访问到内网系统进行下一步渗透测试比如如果此时对方的网站对应的中间件有如下配置第一个的意思是监听端口且如果我们访问的不是其他块儿也就是这里的第二个配置的那就返回这里我们第二个块儿设置了为指定域名也就是如果我们在访问该网站的时候不是用指定域名访问的就会返回也就是禁用访问了这里我结合那些文章举个例子吧比如我们此时对目标网站进行信息搜集之后有了大量的资产并且这些资产也开启了端口但当我们使用直接访问的时候会发现总是返回等等这基本就是对方的中间件使用了反向代理禁用了访问此时呢对方网站设置的是只能使用内网域名来访问该网站而对于处于外网的我们来讲如果我们找到了该对应的真正域名此时我们去访问该域名的时候也是行不通的因为他是内网域名而我们在访问的时候会去公网服务器去寻求域名对应解析出来的但很明显是找不到的只有我们在本地文件中设置正确域名的解析关系这时我们再去访问的时候就可以成功访问目标内网系统因为本地的解析优先级高于公共的服务器具体可参考边界渗透中的小技巧碰撞利用碰撞突破边界碰撞环境搭建原理及复现回到正题那我们在遇到类似情况就可以使用自动化工具来快速明确与域名的正确绑定关系自动化的过程可以使用工具项目地址使用方法其中参数可以省略默认有一个字典加载使用该参数则是指定我们自己想要跑的子域列表执行后即可快速找出命中的子域这里放上一个成果图未实践另外可以通过工具来在线快速针对全网数据扫描比对得出结果通过哈希特征是现代浏览器在网页标题的左侧显示的一个小图标该图标数据通常是从处获取的浏览器会在浏览任何网站时自动请求它因为可以通过计算的指纹哈希然后去等搜索引擎搜索与之相同的主机结果从而进一步探测是否能挖掘出目标网站的真实地址计算哈希的小脚本安装好环境依赖后执行脚本计算得到目标网站的哈希值然后用搜索引擎搜索哈希去命中这里不知为何访问总是被禁但在网站上还是可以正常访问的感觉是的问题但也没解决先放着吧通过网页源码特征值在服务器源地址允许访问并且返回的也是类似的网站内容情况下可以通过侦察页面源码中等一系列静态特征值然后用等搜索引擎进行匹配搜索从而定位例如源码中找到一段的特征这里我的找的特征值也不够有特色可以看到回显的使用工具如果你的目标是保护的建议先上这款工具跑是一种战术侦察工具旨在收集有关受保护的目标的足够信息以期发现服务器的位置该工具目前探测经过个不同的攻击阶段使用扫描配置错误扫描和比对数据库内置字典暴力扫描超过个子域名安装和使用域传送发现子域名服务器分为主服务器备份服务器和缓存服务器在主备服务器之间同步数据库需要使用域传送域传送是指备份服务器从主服务器拷贝数据并用得到的数据更新自身数据库若服务器配置不当可能导致攻击者获取某个域的所有记录造成整个网络的拓扑结构泄露给潜在的攻击者包括一些安全性较低的内部主机如测试服务器同时黑客可以快速的判定出某个特定的所有主机收集域信息选择攻击目标找出未使用的地址绕过基于网络的访问控制目前来看域传送漏洞已经很少了利用漏洞检测脚本进行检测命令进行测试最后记几个未能实践但却值得记录的几个方法万一日后用上呢通过标头特征值搜索通过通信似乎是针对支持的网站的方法通过协议利用协议针对那些没有针对进行部署的网站社会工程学社工的魅力通过全网扫描通过网站远程资源业务注入我们自己的服务器资源文件看日志通过机器对于自搭建的网站我们可以尝试渗透一些防护弱的机器通过流量耗尽流量放大攻击利用流量有限的特点来进行通过域名备案信息广域探测尝试寻找没有做的边缘子域利用服务商默认配置默认配置二级子域指向服务器源段的收集一般的话我们在收集子域名的时候就大概知道目标网站的段了也可以通过命令获取即通过中国互联网信息中心进行查询段与旁站查询段是指与目标服务器在同一段网络的服务器攻击目标的段存活主机是信息收集的重要步骤很多企业的内部服务器可能都会在一个段网络中在很难找到攻击目标服务器互联网漏洞的情况下可以通过攻击段主机获取对段主机的控制权进入企业内网在企业的内网安全隔离及安全防护不如互联网防护健全的情况下可以通过段的主机进行内网渗透这样就可以绕过互联网的防护对目标进行攻击但是这种攻击方式容易打偏旁站是和目标网站在同一台服务器上的其它的网站扫描使用命令对目标的段主机进行存活扫描根据扫描的结果可以判断目标的段还有哪些主机存活这个命令在实际工作中的使用很多该命令不通过协议进行主机存活判断会直接对端口进行扫描这样在开启了防火墙禁的情况下也可以利用这个命令正常扫描目标是否存活及对外开启的相关服务搜索引擎语法语法为查旁站云悉工具御剑北极熊扫描器等站长之家在线扫描这里一共是扫描出的存活的项目地址项目地址攻防资产处理小工具对攻防前的信息搜集到的大批量资产域名进行存活检测获取标题头语料提取常见端口检测简单中间识别去重等便于筛选有价值资产下面附上一个成果展示图项目地址与很像不过这是的但效果感觉不如项目地址与类似一个强大的端口扫描工具优势在于速度快缺点是误报率也高项目地址扫描速度快支持漏洞验证一款内网综合扫描工具方便一键自动化全方位漏扫扫描支持主机存活探测端口扫描常见服务的爆破批量写公钥计划任务反弹读取网卡信息指纹识别漏洞扫描探测域控识别等功能项目地址水泽自带资产探活支持漏洞验证碰撞项目地址一个辅助平常渗透测试项目或者攻防项目快速打点的综合工具由之前写的工具改名而来是一款轻便小巧快速全面的扫描工具多用于渗透前资产收集和渗透后内网横向渗透工具从项目上迭代了一些懒人功能比如提供扫描资产文件中可以写绝大部分的各种形式的链接并在此基础上可以添加任意端口和路径红队信息搜集工具被动识别访问站点是否是云上站点项目地址是一款对资产中重点系统指纹识别的工具在红队作战中信息收集是必不可少的环节如何才能从大量的资产中提取有用的系统如旨在帮助红队人员在信息收集期间能够快速从段大量杂乱的资产中精准定位到易被攻击的系统从而实施进一步攻击开放端口探测收集到大量那就要进行端口扫描了看看有什么常见的漏洞最常用的就是神器了命令扫描扫描扫描扫描不通过探测详细文档其次可能还会用到常见端口及对应服务表端口服务渗透用途允许匿名的上传下载爆破嗅探提权远程执行各类后门可根据已搜集到的信息尝试爆破版本可中间人隧道及内网代理转发文件传输等等爆破嗅探一般常用于路由交换登陆可尝试弱口令邮件伪造查询邮件用户信息可使用工具来自动跑允许区域传送劫持缓存投毒欺骗以及各种基于隧道的远控尝试下载目标及其的各类重要配置文件各种常用的服务端口可尝试经典的目标各类控制台各类服务器管理面板各类中间件漏洞利用各类框架漏洞利用等等可尝试爆破嗅探权限配置不当可尝试爆破以及自身的各种远程执行类漏洞利用如嗅探等可尝试爆破爆破默认团队字符串搜集目标内网信息注入允许匿名访问弱口令可爆破登陆匿名访问文件上传想办法钓账号进内网弱口令信息泄漏爆破注入提权弱口令爆破爆破注入弹弱口令爆破想办法钓账号进内网弱口令未授权访问默认密码弱口令弱口令注入提权爆破后门需要以下的系统爆破泄露未授权访问弱口令爆破注入爆破注入弱口令弱口令爆破未授权导致的任意指令执行可尝试未授权访问弱口令爆破反序列化弱口令主机面板登录弱口令弱口令远程执行注入反序列化控制台弱口令反序列化弱口令远程执行未授权访问爆破未授权访问默认端口未授权访问端口号端口说明渗透思路文件传输协议爆破内网嗅探远程连接用户名枚举爆破远程连接爆破内网嗅探邮件服务邮件伪造域名系统域传送缓存投毒欺骗利用隧道技术刺透防火墙未授权访问通过工具直接连入服务心脏滴血目标服务远程代码执行服务未授权访问反序列化远程命令执行漏洞邮件服务爆破弱口令信息泄漏源代码注入弱口令爆破提权注入爆破配置不当服务未授权访问注入爆破写提权爆破后门远程代码执行控制台爆破控制台弱口令认证绕过数据库爆破注入爆破弱口令高权限执行系统命令服务爆破弱口令爆破弱口令认证绕过未授权访问爆破弱口令中间件反序列化控制台弱口令部署包远程命令执行漏洞工具反序列化控制台弱口令未授权任意文件写入反序列化远程命令执行控制台控制台弱口令远程代码执行服务远程代码执行未授权访问目标未授权访问爆破弱口令远程代码执行未授权访问端口号服务渗透思路爆破嗅探溢出后门远程连接爆破漏洞远程连接爆破嗅探弱口令邮件服务邮件伪造域名解析系统域传送劫持缓存投毒欺骗服务劫持欺骗爆破嗅探服务爆破未授权访问远程命令执行协议爆破协议爆破搜集目标内网信息目录访问协议注入未授权访问弱口令端口溢出服务爆破登陆服务文件上传未授权访问爆破邮件服务爆破信息泄漏爆破注入弱口令爆破注入爆破反弹服务配置不当服务未授权访问未授权访问爆破注入远程桌面链接爆破后门控制台爆破认证绕过数据库爆破注入提权爆破注入缓冲区溢出服务抓密码代码执行爆破认证绕过数据库未授权访问爆破反序列化控制台弱口令应用漏洞心脏滴血服务远程命令执行注入弱口令写文件爆破文件上传反序列化未授权访问远程命令执行控制台爆破反序列化弱口令远程代码执行未授权访问未授权访问爆破端口号服务渗透思路爆破嗅探溢出后门爆破嗅探溢出后门爆破嗅探邮件伪造区域传输劫持缓存投毒欺骗深度利用利用隧道技术刺透防火墙劫持欺骗劫持欺骗爆破爆破未授权访问远程代码执行爆破爆破注入攻击未授权访问直接使用直接使用直接使用未授权访问宝塔主机管理后台默认帐户默认密码护卫神佩带的管理后台默认帐户默认密码爆破进行内网渗透爆破弱口令信息泄露源代码爆破使用系统用户登录注入攻击爆破注入攻击配置不当未授权访问爆破拒绝服务注入爆破后门爆破控制台弱口令认证绕过爆破注入缓冲区溢出注入攻击爆破弱口令拒绝服务代码执行爆破弱口令认证绕过爆破弱口令认证绕过爆破弱口令认证绕过未授权访问爆破弱口令反序列化控制台弱口令控制台部署反序列化控制台弱口令控制台部署常见攻击控制台爆破对应服务器版本漏洞常见攻击控制台爆破对应服务器版本漏洞常见攻击控制台爆破对应服务器版本漏洞漏洞远程命令执行文件泄露爆破控制台弱口令反序列未授权访问远程代码执行未授权访问远程代码执行未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问爆破未授权访问服务器虚拟主机管理系统爆破未授权访问未授权访问弱口令爆破检测是否有等溢出主机管理系统登陆国外用较多主机管理系统登陆国外用较多虚拟主机管理系统登陆国外用较多路由路由代理默认端口如果没设置口令很可能就直接漫游内网了主机管理系统登陆主机管理系统登陆参考借用新浪某服务成功漫游新浪内网参考未授权访问易导致网站被直接篡改或者作为代理进入内网主机控制面板登录主机管理系统国外用较多主机管理系统默认端口执行命令执行网络架构探测当我们探测目标站点网站架构时比如说操作系统中间件脚本语言数据库服务器容器等等可以使用以下方法查询识别识别的目的在于方便利用已公开漏洞进行渗透测试甚至可以到对应的官网下载对应版本的进行本地白盒代码审计插件火狐插件云悉不过这个邀请码有点指纹识别但这个似乎不能用了指纹识别又有很多方法比如说御剑指纹识别工具工具还有在线查询的网站等等服务器信息搜集服务版本识别操作系统信息识别都可以利用实现识别特定关键字识别的首页文件特定文件可能包含了类型及版本信息通过访问这些文件将返回的网页信息如与扫描工具数据库存储的指纹信息进行正则匹配判断的类型也可能前端源码中或标签中的字段存在一些特征信息下图很明显能得知是框架特定文件及路径识别不同的会有不同的网站结构及文件名称可以通过特定文件及路径识别如会有特定的文件路径等有些的文件也可能包含了特定的文件路径与扫描工具数据库存储的指纹信息进行正则匹配判断的类型会有一些图片等静态文件这些文件一般不会变化可以利用这些特定文件的值作为指纹信息来判断的类型响应头信息识别应用程序会在响应头等字段中返回信息或者自定义的数据字段通过响应头返回的信息可以对应用进行识别有些设备也可以通过响应头信息进行识别判断当然信息并不一定是完全准确的应用程序可以自定义自己的信息例如的响应头信息中包含字段常见脚本工具项目地址是一款针对资产列表的快速指纹识别工具通过调用等接口快速查询资产信息并识别重点资产的指纹也可针对段或资产列表进行快速的指纹识别旨在帮助红队人员在资产信息收集期间能够快速从段大量杂乱的资产中精准识别到易被攻击的系统从而实施进一步测试攻击还有两款只支持如的工具还有一些其他优秀项目数字观星平台识别也叫应用防火墙是通过执行一系列针对的安全策略来专门为应用提供保护的一款产品的探测很多人都会忽略掉主要有两种手法吧一种是手动一种是工具知道了是否有用的什么我们才好对症下药手动的话一般来说都会拦截敏感文件下载如等直接添加到网站中即可一些可能不防护这些那么就可以拿一些的来测试也可贴个图还有就是靠工具识别还有神器探测有两种脚本一种是一种是几款常见的拦截页整理其他应用收集小程序企查查等找到小程序点击即可微信支付宝和微信类似但是不同平台因为不同的规则可能有一点点差异这里贴个别的师傅的图公众号企查查天眼查直接搜索相应公司在菜单栏中找到微信公众号和上面查小程序一般依旧还可以用微信搜索这里那位师傅说还可以用搜狗微信但我搜不出来先贴个图生活号感觉有点类似微信上的公众号也是通过支付宝搜索即可搜集收集到可以测正常功能也可以对它进行反编译查看源码可能获取一些敏感的接口等信息不仅要收集最新版还要收集历史版本的可能存在敏感信息也有可能存在有漏洞的历史接口七麦数据直接搜索可以获取到部分相关的但是有些较隐藏的直接搜名字还是搜不出来这个时候我们就会用到七麦一个很方便的功能同开发者此外还可以获取的历史版本可能里面存在大量的敏感信息豌豆荚使用豌豆荚可以方便的获取到的历史版本这里就直接贴图了企查查天眼查依旧类似上面的小程序搜索到应用往下滑其实也是和七麦数据找同开发者一样的贴图应用看看客户端的产品可能有时候也会发现一些突破口一般比较明显的官网就可以下载可能还有一些隐藏的应用或者测试版就需要自己去寻找了敏感文件敏感目录探测通常我们所说的敏感文件敏感目录大概有以下几种泄露备份文件泄露配置文件泄露敏感文件敏感目录挖掘一般都是靠工具脚本来找当然大佬手工也能找得到脚本工具御剑真的很万能文末附上全家桶爬虫等搜索引擎等一位巨佬写的脚本也是一位巨佬写的脚本不过这个工具似乎存在问题我配置不成功社交平台目录遍历配置文件泄露数据库文件泄露日志文件泄露备份和历史文件登录页面错误公开文件信息搜索粘贴站点搜索在线利用针对信息泄露的搜索引擎项目地址字典需要自己添加在需要的地方添加支持递归扫描功能将会强于御剑语法一些语法参考自所有语法版自动化工具历史页面在线网站会记录网站版本更迭可以获取到之前版本的网站可能会找到一些后来删除的敏感资产信息或者一些漏洞下面是年的在推荐两款强力工具网盘信息搜集某些安全意识薄弱的人员可能上传资料到一些网盘中没有加密码或者密码泄露然后被一些在线云盘抓取收录了导致信息泄露超能搜百度网盘爬虫邮箱信息搜集目前情况来看通过打点不一定是最优的方式可以社工等方式同步进行因此尽可能多的收集目标的邮箱然后进行社工钓鱼可能大有突破实际过程中我们可以尽可能的把收集到疑似网络管理员运维人员安全部门的人员提取出来这些人单独写邮件或者不发因为这些人安全意识相对较高容易打草惊蛇我们需要对一些非技术员工安全意识薄弱的人下手挑软柿子捏寻找目标邮箱入口目标为开放的邮服端口或邮箱入口拿到目标后先要先从记录域名找到他的真实地址某些目标可能是第三方邮件服务器这种情况记录就没有参考价值了然后针对这个地址的段进行扫描端口通过子域名主要是利用一些子域名收集工具如挖掘机等通过搜索引擎语法邮箱网络空间搜索引擎邮箱在线平台搜集邮箱查找工具还可以收集域名与工具搜集自带不理解的是总是查不出来感觉是的问题吧验证邮箱在经过上述的邮箱搜集之后我们可以对邮箱进行存活性验证检测目标邮箱是否存在被弃用的情况离职职位调动等通过邮箱爆破这种方式的弱口令爆破只适用于目标企业自己的邮件服务器如等像百度腾讯阿里网易等第三方邮箱不优先考虑协议爆破组织爆破工具等网页邮箱爆破等信息搜集在中可能会存在大量的敏感信息包括但不限于某些服务的接口可以测试这些接口是否有未授权等子域名可能包含有不常见或者子域名收集过程中没收集到的目标密码等敏感数据手工搜集可以全局搜索这种关键词利用工具是一款用作快速在网站的文件中提取子域名的工具用法参考项目文档或者简单爬取这也是一款一直在用的工具效果杠杠的可以本地用也可以集成到插件里面是基于插件开发的请求高亮标记与信息提取的辅助型插件基于正则表达式除了提取敏感信息也可以提取页面中的链接等贴个图社会工程学社会工程学收集的信息有很多包含网络现用和曾用真实姓名手机号电子邮箱出生日期身份证号银行卡支付宝账号号微信号家庭地址注册网站贴吧微博人人网等等信息在目标相关网页中可能会存在招聘信息客服联系等可以利用招聘或客服聊天的方式进行钓鱼木马植入等搜集到相关的人员信息后可以制作社工字典有如下在线或本地工具密码攻击器白鹿社工字典生成器还有一些社工机器人狗狗免费社工机器人平安社工库数据相对比较全但是需要推广一定人才能用社工密码生成目标域名邮箱收集一定要养成收集站点邮箱账号收集的习惯因为好多官方后台都是用内部邮箱账号登录的指不定哪天你就得到一个进后台的机会通过说明文档以及网站页面收集或者网站发表者以及留言板信息处收集账号通过或者语法收集搜索相关群收集相关企业员工的社交账号用途可用来进行爆破或者弱口令登录以及撞裤攻击外网打点基本流程经过以上的学习接下来跟着文章梳理一遍打点的流程主域名收集先收集目标的各种主域名包括子公司小程序公众号等工具备案反查域名等企查查收集子域名配置好的等等工具获得比较全的子域名获取真实与段对于子域名获取其真实和段段量大比较分散的话可以放到后面再看可能很大一部分是快速过滤掉以及做一些简单的绕过时间充足的话对重点域名详细绕过寻找真实工具快速筛选真实并整理为段网络条件好的话准确率挺高的国外可以使用可检测云国内基本没啥用再过滤一遍输出的真实结果获取对应的资产获取和段信息对应的资产通过等快速获取和段信息对应的资产相关工具再通过语法搜一遍主域对应的资产信息时间充足的话对和段信息进行全端口扫描获取更多资产子域名探活对子域名进行探活获取资产信息等可以增加一下常用的端口探活有时候不太准确漏掉一些可以将所有子域前面增加进行一遍识别探活可以跟指纹识别一起进行整理资产指纹识别整合所有资产进行指纹识别通过子域名获得的资产段等等获得的资产进行整合整合后通过扩充指纹等进行指纹识别云溪只能单个资产漏扫根据目标的防护情况选择漏扫工具快速完备整合自带整合一些其他的爬虫等个左右爬虫补充和段的高危端口利用一些非端口如各种数据库之类的弱口令历史漏洞资产目录扫描可以先只扫可以在前面就先挂上备份文件扫描主要针对一些自建的站针对重点资产手工测试的时候再进行深入扫描敏感资产深入挖掘登录注册敏感框架组件服务等指纹识别和可能不够完备针对一些产品手工识别并找一些历史漏洞测试重点关注反序列化文件上传注入漏洞详细挖掘一下登录点爆破可以收集目标邮箱和社工字典根据目录扫描结果对有东西的站深入看一下有充足时间可以像挖一样对一些站深入挖掘一下接口爬虫的敏感链接之类测试时插件安装完备注入相关等都打开同时有条件可以挂着被动可以只用来测注入站基本是和二选一有时间都打一遍同时要注意漏洞一定要测一下工具一般使用插件工具智能后台密码爆破工具可以批量爆破后台小备份文件扫描可以提前对一些自建站点可以进行备份文件扫描找到备份文件审源码通过证书关键字单位名等收集更多资产或者泄露信息对于一些小众产品可以通过等找其他人使用的可能在用低版本或者有备份文件拿到源码去审计小程序公众号对发现的小程序公众号进行进一步的探测类比探测进行收集目标上下游公司供应链代理商等信息重复第一轮的步骤用收集到的邮箱再去反查一波就能找到一部分了然后去相关备案网站再找一部分剩下的就是通过爬取相关新闻超链接年报从里面找跟他业务相关的公司后记这几天忙得要死来不及学习今天大概学习完了回顾之前的学习历程感觉是有点抽象的毕竟感觉在纸上谈兵学的有点没激情但这却是后面进一步深入的基础必须啃下来经过上述的学习对渗透测试以及打点流程有了认识但日后能实施于实践才算成功只能说任重道远总的来说对于上述的流程是有认识了但对于工具和平台等的使用还是有点懵的被强行喂了一通知识但却没有好好消化因此在今后应该多实战熟悉工具的利用进一步熟悉渗透测试流程水很深啊之后在看一看师傅给的实战打点文章看看佬们的骚操作本篇文章日后肯定也会更新的毕竟质量有点差希望不断完善形成一个优美的信息搜集知识库参考文章安全渗透测试基本流程知识库干货最全渗透测试信息搜集全流程信息收集方法总结篇之使用详解很详细命令的介绍与使用服务系列之一泛域名解析的安全案例命令详解是一种网络管理命令行工具',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2024-03-17 21:22:49',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://yansedaima.com/" title="颜色代码表"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408121908150.svg" alt="颜色代码表"/><span class="back-menu-item-text">颜色代码表</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">hybcx</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box-archive"></use></svg><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shapes"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tags"></use></svg><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-artstation"></use></svg><span> 朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-paper-plane"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shoe-prints1"></use></svg><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF%E8%B5%9B%E4%BA%8B/" style="font-size: 1.05rem;">CTF赛事<sup>18</sup></a><a href="/tags/CVE/" style="font-size: 1.05rem;">CVE<sup>15</sup></a><a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">Java反序列化<sup>3</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">Java基础<sup>1</sup></a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" style="font-size: 1.05rem;">Linux提权<sup>2</sup></a><a href="/tags/MISC/" style="font-size: 1.05rem;">MISC<sup>1</sup></a><a href="/tags/Metasploit/" style="font-size: 1.05rem;">Metasploit<sup>3</sup></a><a href="/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.05rem;">PHP代码审计<sup>2</sup></a><a href="/tags/SecBook/" style="font-size: 1.05rem;">SecBook<sup>1</sup></a><a href="/tags/TryHackMe/" style="font-size: 1.05rem;">TryHackMe<sup>42</sup></a><a href="/tags/Windows%E6%8F%90%E6%9D%83/" style="font-size: 1.05rem;">Windows提权<sup>2</sup></a><a href="/tags/reverse%E7%B3%BB%E5%88%97/" style="font-size: 1.05rem;">reverse系列<sup>2</sup></a><a href="/tags/tryhackme/" style="font-size: 1.05rem;">tryhackme<sup>1</sup></a><a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">web渗透<sup>2</sup></a><a href="/tags/web%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">web知识总结<sup>2</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 1.05rem;">代码审计<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">内网渗透<sup>3</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA/" style="font-size: 1.05rem;">内网靶场<sup>2</sup></a><a href="/tags/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">基本知识<sup>21</sup></a><a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">基础知识<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 1.05rem;">攻防世界<sup>1</sup></a><a href="/tags/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" style="font-size: 1.05rem;">玄机应急响应靶场<sup>1</sup></a><a href="/tags/%E7%BA%A2%E9%98%9F%E6%B8%97%E9%80%8F/" style="font-size: 1.05rem;">红队渗透<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">16</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">18</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" itemprop="url">内网渗透</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>内网渗透</span></a></span></div></div><h1 class="post-title" itemprop="name headline">渗透测试流程&amp;外网打点</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-12-31T08:25:52.551Z" title="发表于 2023-12-31 16:25:52">2023-12-31</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-03-17T13:22:49.506Z" title="更新于 2024-03-17 21:22:49">2024-03-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">20.7k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>70分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="渗透测试流程&amp;外网打点"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为太原"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>太原</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/" itemprop="commentCount"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/"><header><a class="post-meta-categories" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" itemprop="url">内网渗透</a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" tabindex="-1" itemprop="url">内网渗透</a><h1 id="CrawlerTitle" itemprop="name headline">渗透测试流程&amp;外网打点</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">hybcx</span><time itemprop="dateCreated datePublished" datetime="2023-12-31T08:25:52.551Z" title="发表于 2023-12-31 16:25:52">2023-12-31</time><time itemprop="dateCreated datePublished" datetime="2024-03-17T13:22:49.506Z" title="更新于 2024-03-17 21:22:49">2024-03-17</time></header><h1 id="0x01-前言">0x01 前言</h1>
<p>终于抽出时间来学习了，看了看st3pby师傅给的资料，对于渗透测试流程不熟悉的我，感觉需要学的挺多的，估计又是一场恶战，话不多说直接开卷！！</p>
<h1 id="0x02-渗透测试基本流程">0x02 渗透测试基本流程</h1>
<p>这里先学习一下大致测试的框架流程：</p>
<p>大致可分为三个阶段：信息搜集、漏洞发现、漏洞利用。但放到实战中，这三个方面又可以有很多的细节优化，进一步深入明确测试流程，这里主要通过9个阶段来学习一下整个测试流程。</p>
<p>渗透测试一般就是典型的<strong>黑盒测试</strong>，就是模拟黑客的入侵；还有一种叫<strong>白盒渗透</strong>，是在了解了一些内部的情况之后再挖掘漏洞。一般性黑盒测试的东西多一点。</p>
<h2 id="21-确定目标">2.1 确定目标</h2>
<h3 id="范围的确定">范围的确定</h3>
<p>测试的范围：我们要知道当前测试的范围是IP、域名、内网和外网、整个网站还是网站的某个功能模块？</p>
<p>一般来说可能测试的是一个公司或企业的内部网络，针对的大部分是服务器。或者是一个网站或网站群，或者是一些软件应用或者APP，这类的话一般都是获取应用的后台服务器的权限。</p>
<h3 id="规则的确定">规则的确定</h3>
<p>我们需要知道我们可以测试到什么程度：是发现漏洞即可，还是要进一步利用漏洞；是否有时间限制、是否可以修改上传、能否提权等等等等，也就是确定问我们可以做什么不可以做什么。这里填充一下文章给的：</p>
<ul>
<li>目标系统介绍、重点保护对象及特性。</li>
<li>是否允许数据破坏？</li>
<li>是否允许阻断业务正常运行？</li>
<li>测试之前是否应当知会相关部门接口人？</li>
<li>接入方式？外网和内网？</li>
<li>测试是发现问题就算成功，还是尽可能的发现多的问题？</li>
<li>渗透过程是否需要考虑社会工程？</li>
</ul>
<h3 id="需求的确定">需求的确定</h3>
<p>我们需要明确让我们测试的需求具体是什么：web应用的漏洞(新上线程序)？业务逻辑漏洞（针对业务的）？人员权限管理漏洞（针对人员、权限）？根据需求和自己技术能力来确定能不能做、能做多少，点到为止。</p>
<h2 id="22-分析风险获得授权">2.2 分析风险，获得授权</h2>
<p>这里的知识就不懂了，没了解过。。。直接cv加自己的浅薄理解了</p>
<p>分析渗透测试过程中可能产生的风险，如大量测试数据的处理、影响正常业务开展、服务器发生异常的应急、数据备份和恢复、测试人力物力成本…</p>
<p>由测试方书写实施方案初稿并提交给客户（or本公司内部领导）进行审核。在审核完成后，从客户（or本公司内部领导）获取对测试方进行书面委托授权书，授权测试方进行渗透测试。（不授权不测试~~~）</p>
<h2 id="23-信息搜集">2.3 信息搜集</h2>
<p>这里一块可以说是奠定了一次渗透测试是否会成功的基础，虽然之前有所总结，但现在也几乎忘了，因此这一块得重点温习一下（令起一部分）。</p>
<p>首先明确一下信息搜集阶段的目的：尽可能多的获取到目标web应用的各种信息。</p>
<p>信息包括：脚本语言类型、服务器类型、目录结构、是否使用开源软件且使用的哪种开源软件、数据库类型、页面所含的超链接、部署应用用到的框架、中间件类型、用到了哪些网络服务（SSH、FTP）、使用的哪种CMS等等还有很多。</p>
<p>而其中搜集利用到的方式为：主动扫描；开放搜索；利用搜索引擎获取后台、未授权页面、敏感url等等</p>
<pre><code class="hljs plaintext">基础信息：IP，网段，域名，端口，旁站、C段
系统信息：操作系统版本--》在之后的提权中才能“对症下药”
应用信息：各端口的应用，例如web应用，邮件应用等
版本信息：所有探测到的版本
服务信息：服务器类型、版本、中间件、数据库、脚本类型、软件类型（微信，Chrome）、用到的网络服务
人员信息：域名注册人员信息，web应用中网站发帖人的id，管理员姓名等
防护信息：试着看能否探测到防护设备</code></pre>
<p>这种信息一般可以先通过部分功能强大的小插件先获取</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101172201533.png" alt="image-20240101172201533"></p>
<h2 id="24-漏洞探测手动amp自动">2.4 漏洞探测（手动&amp;自动）</h2>
<p>到了这一阶段就需要利用2.3搜集到的各类信息，尝试找到相应的漏洞进行探测。</p>
<h3 id="探测方法">探测方法</h3>
<ul>
<li>各类漏扫工具：AWVS、AppScan等等；</li>
<li>结合漏洞去开源漏洞库（exploit-db）等地方去尝试寻找是否是已经公开过的漏洞。</li>
<li>网络漫游找寻漏洞验证POC</li>
<li>平常也需要多关注一些关于网络安全的新闻，掌握漏洞实时消息，说不定日后就不会用到的</li>
</ul>
<p>简单列举一下常见的软件漏洞：</p>
<pre><code class="hljs plaintext">XAMPP提权漏洞
WordPress大量漏洞
PhpStudy漏洞
phpMyAdmin漏洞
IIS低版本解析漏洞
Nginx/Apache解析漏洞
SSH后门漏洞
FTP/RDP等网络服务弱口令漏洞
Rlogin后门漏洞</code></pre>
<h3 id="探测内容">探测内容</h3>
<ul>
<li>系统漏洞：找寻对方系统是否没有打入相关补丁，幸运地话可能会发现对方操作系统并未及时打补丁，后果就是直接拿下！</li>
<li>Webserver漏洞：Webserver配置问题–也就是中间件漏洞（这一块爆的漏洞还是很多的）</li>
<li>Web应用漏洞：Web应用开发问题、还有就是Web开启了其他端口的服务，但却没设置授权访问，或者可以弱口令打入。</li>
<li>各种端口服务：这里主要是针对端口服务的开启，比如21–FTP、8080–这里可能有Apache-tomcat、struct2等等，常被用于代理www服务、7001端口–一般为weblogic服务、22–Linux-SSH远程连接服务、3389–Windows远程桌面连接等等。</li>
<li>通信安全：看看传输过程中的敏感数据是明文的、比如token在cookie的传输、jwt加密所用的key、各类加密盐等等。</li>
</ul>
<h2 id="25-漏洞验证">2.5 漏洞验证</h2>
<p>将上一步发现的有可能可以成功利用的漏洞都验证一遍。结合实际情况，搭建模拟环境进行测试，成功后再在目标中实现，验证发面包括一下内容：</p>
<ul>
<li>自动化验证：结合自动化扫描工具提供的结果</li>
<li>手工验证：根据公开资源进行验证</li>
<li>试验验证：自己搭建模拟环境进行验证</li>
<li>登录猜解：有时可以尝试猜解一下登陆口的账号密码等信息，可关注前端js接口。</li>
<li>业务漏洞验证：如发现业务漏洞，要进行验证</li>
<li>公开资源的利用exploit-db/wooyun/渗透代码网站通用、缺省口令厂商的漏洞警告等</li>
</ul>
<h2 id="26-信息分析">2.6 信息分析</h2>
<p>这一步是为下一步实施具体渗透做准备。</p>
<ul>
<li>精准攻击：准备好上一步探测到的漏洞exp（漏洞利用），用来对某个模块进行精准攻击</li>
<li>绕过防御机制：是否有防火墙等设备，如何绕过</li>
<li>定制攻击路径：最佳工具路径，根据薄弱点入口，搞清楚内网权限位置，确定最终目标</li>
<li>绕过检测机制：是否有检测机制，流量监控，杀毒软件，恶意代码检测等（免杀）</li>
<li>攻击代码：经过试验得来的代码，包括不限于xss代码，sql注入语句等</li>
</ul>
<h2 id="27-利用漏洞获取数据">2.7 利用漏洞获取数据</h2>
<ul>
<li>实施攻击：根据前几步的结果，进行攻击</li>
<li>获取内部信息：基础设施（网络连接，vpn，路由，拓扑等）</li>
<li>进一步渗透：内网入侵，敏感目标</li>
<li>持续性存在：一般对客户做渗透不需要。rookit，后门，添加管理账号，驻扎手法等</li>
<li>清理痕迹：清理相关日志（访问，操作），上传文件等</li>
</ul>
<h2 id="28-信息整理">2.8 信息整理</h2>
<ul>
<li>整理渗透工具：整理渗透过程中用到的代码，poc，exp等</li>
<li>整理收集信息：整理渗透过程中收集到的一切信息</li>
<li>整理漏洞信息：整理渗透过程中遇到的各种漏洞，各种脆弱位置信息</li>
<li>目的：为了最后形成报告，形成测试结果使用。</li>
</ul>
<h2 id="29-形成报告">2.9 形成报告</h2>
<ul>
<li>按需整理：按照之前第一步跟客户确定好的范围，需求来整理资料，并将资料形成报告</li>
<li>补充介绍：要对漏洞成因，验证过程和带来危害进行分析</li>
<li>修补建议：要对所有产生的问题提出合理高效安全的解决办法</li>
</ul>
<h1 id="0x03-信息搜集">0x03 信息搜集</h1>
<p>这里就单独着重学习一下信息搜集的各类奇淫巧技吧。</p>
<h2 id="31-信息搜集的分类">3.1 信息搜集的分类</h2>
<p>1、主动式信息搜集（可获取到的信息较多，但易被目标发现）</p>
<p>2、通过直接发起与被测目标网络之间的互动来获取相关信息，如通过Nmap扫描目标系统。</p>
<p>3、被动式信息搜集（搜集到的信息较少，但不易被发现）</p>
<p>4、通过第三方服务来获取目标网络相关信息。如通过搜索引擎方式来搜集信息。</p>
<h2 id="32-搜集什么信息">3.2 搜集什么信息</h2>
<blockquote>
<p>1、whois信息（微步）</p>
<p>2、网站架构</p>
<p>3、dns信息（通过查询dns我们可以检测是否存在dns域传送漏洞）</p>
<p>4、子域名搜集</p>
<p>5、敏感目录及敏感信息、源码泄露（搜索引擎+工具）</p>
<p>6、脆弱系统（网络空间）</p>
<p>7、旁站查询</p>
<p>8、C端查询</p>
<p>9、指纹信息</p>
<p>10、端口服务</p>
<p>11、备案信息</p>
<p>12、真实ip</p>
<p>13、探测waf</p>
<p>14、社工（朋友圈、微博、qq空间、求职、交易等社交平台）</p>
<p>15、企业信息（天眼查、企业信用信息公示系统、工业和信息化部ICP/IP地址/域名信息备案管理系统）</p>
</blockquote>
<h2 id="33-目标确认">3.3 目标确认</h2>
<h3 id="域名注册信息主域名查询">域名注册信息（主域名查询）</h3>
<p><strong>通过如下步骤确认目标所有者信息：</strong></p>
<blockquote>
<p>Whois 目标域名/主机名：whois <a target="_blank" rel="noopener" href="http://example.com">http://example.com</a><br>
解析目标域名/主机名的IP地址：dig +short <a target="_blank" rel="noopener" href="http://example.com">http://example.com</a><br>
获取域名的详细解析过程：dig +trace <a target="_blank" rel="noopener" href="http://example.com">http://example.com</a></p>
</blockquote>
<p>后续用于字典制作和进一步收集目标信息的基础</p>
<h4 id="whois查询">whois查询</h4>
<p>whois就是一个用来查询域名是否已经被注册，以及注册域名的详细信息的<code>数据库</code>（如域名所有人、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%9F%9F%E5%90%8D%E6%B3%A8%E5%86%8C&amp;spm=1001.2101.3001.7020">域名注册</a>商）。</p>
<p>whois信息可以获取关键注册人的信息，包括注册商、联系人、联系邮箱、联系电话、创建时间等,可以进行邮箱反查域名，爆破邮箱，社工，域名劫持等等。</p>
<p>注：不同域名后缀的whois信息需要到不同的whois数据库查询</p>
<p>主要的实现原理：</p>
<pre><code class="hljs scss"><span class="hljs-number">1</span>.根据域名从根服务器获取域名所在whois服务器
<span class="hljs-number">2</span>.再根据域名从域名所在whois服务器获取域名信息
即
domain + rootServer =&gt; targetServer
domain + targetServer =&gt; domainInfo
当然，如果知道了域名信息所在服务器，可以跳过第一步，直接查询域名信息</code></pre>
<p>下面实操一手。</p>
<h5 id="方法一根服务器">方法一：根服务器</h5>
<p>通过原始网页查询：首先根据域名从whois的根服务器获取域名所在的whois服务器：<a target="_blank" rel="noopener" href="https://www.iana.org/whois">https://www.iana.org/whois</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101185641310.png" alt="image-20240101185641310"></p>
<p>或者根据域名后缀在数据库中查询对应whois服务器地址：<a target="_blank" rel="noopener" href="https://www.iana.org/domains/root/db">https://www.iana.org/domains/root/db</a></p>
<p>这里我们就以.cn为例，查询一下，如下图可以看到该域名对应的whois服务器</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101185846245.png" alt="image-20240101185846245"></p>
<p>接下来就是根据得到的whois服务器获取域名信息，结果如下，但这里只能查询一级域名，不能携带www之类的前缀</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101190016712.png" alt="image-20240101190016712"></p>
<p>这里也能看到如果域名后缀不对应，也是查询不到的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101190119728.png" alt="image-20240101190119728"></p>
<h5 id="方法二第三方服务查询">方法二：第三方服务查询</h5>
<ul>
<li><a target="_blank" rel="noopener" href="https://whois.aliyun.com/">https://whois.aliyun.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://whois.cloud.tencent.com/">https://whois.cloud.tencent.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://who.is/">https://who.is/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.whois.com/whois/">https://www.whois.com/whois/</a></li>
<li><a target="_blank" rel="noopener" href="https://whois.chinaz.com/">https://whois.chinaz.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://whois.aizhan.com/">https://whois.aizhan.com/</a></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101191413063.png" alt="image-20240101191413063"></p>
<p>下方有对应的英文详细信息：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101191442021.png" alt="image-20240101191442021"></p>
<p>体验下来感觉<a target="_blank" rel="noopener" href="https://www.whois.com/whois%E6%9B%B4%E5%A5%BD%E4%B8%80%E7%82%B9%EF%BC%8C%E4%BF%A1%E6%81%AF%E6%8C%BA%E5%AE%8C%E5%96%84%E7%9A%84%E3%80%82%E4%B8%8D%E8%BF%87%E6%9C%AC%E8%B4%A8%E6%9D%A5%E4%BC%BC%E4%B9%8E%E9%83%BD%E6%98%AF%E6%9D%A5%E8%87%AAwhois%E6%A0%B9%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9F%A5%E8%AF%A2%E5%88%B0%E7%9A%84%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%95%B4%E5%90%88%E4%BA%86%E4%B8%80%E4%B8%8B%E8%80%8C%E5%B7%B2%E3%80%82%E8%80%8C%E9%98%BF%E9%87%8C%E4%BA%91%E5%92%8C%E8%85%BE%E8%AE%AF%E4%BA%91%E7%9A%84%E6%84%9F%E8%A7%89%E7%94%A8%E4%BA%8E%E6%9F%A5%E5%9B%BD%E5%86%85%E5%B0%B1%E8%A1%8C%E4%BA%86%EF%BC%8C%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E7%AB%99%E9%95%BF%E5%B7%A5%E5%85%B7%E7%9A%84whois%E4%B8%8D%E5%A4%AA%E5%AE%8C%E5%96%84%EF%BC%8C%E4%BD%86%E7%9B%B4%E6%8E%A5%E6%8F%90%E4%BE%9B%E4%BA%86%E5%8F%8D%E6%9F%A5%E5%8A%9F%E8%83%BD%EF%BC%8C%E6%84%9F%E8%A7%89%E8%BF%98%E7%AE%97%E4%B8%8D%E9%94%99%EF%BC%88%E6%84%9F%E8%A7%89%E6%98%AF%E6%9F%A5%E5%9B%BD%E5%86%85%E6%8C%BA%E6%95%88%E7%8E%87%E7%9A%84%E5%B7%A5%E5%85%B7%E4%BA%86%EF%BC%89">https://www.whois.com/whois更好一点，信息挺完善的。不过本质来似乎都是来自whois根服务器查询到的信息，整合了一下而已。而阿里云和腾讯云的感觉用于查国内就行了，最后一个站长工具的whois不太完善，但直接提供了反查功能，感觉还算不错（感觉是查国内挺效率的工具了）</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101191921703.png" alt="image-20240101191921703"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101192120541.png" alt="image-20240101192120541"></p>
<p>这里还有爱站</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101210107271.png" alt="image-20240101210107271"></p>
<p>这里最全面的感觉就是微步社区了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101210308820.png" alt="image-20240101210308820"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101210313055.png" alt="image-20240101210313055"></p>
<p>可以看到结果很全面，就是想要查询一些隐私还得氪金~~~</p>
<h5 id="方法三whois命令">方法三：whois命令</h5>
<p>就是用whois命令进行查询，这个命令在Linux与Windows下都可安装，这里用Linux演示了，至于安装办法就不赘述了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101192245053.png" alt="image-20240101192245053"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101192300021.png" alt="image-20240101192300021"></p>
<p>同样的如下图，二级域名就查询不到了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101192340912.png" alt="image-20240101192340912"></p>
<p>这里需要注意的是国际域名可以设置隐私保护，但像国内.cn等域名是不可以设置隐私保护的。</p>
<h5 id="方法四中文域名">方法四：中文域名</h5>
<p>这里看了几篇文章，还有用代码去实现的（自我感觉没太必要），这里的代码可以自己写，也可以直接用第三方库</p>
<p>具体的感兴趣参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/mouday/article/details/129691736?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170410215916800227411682%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170410215916800227411682&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-129691736-null-null.142%5Ev99%5Epc_search_result_base2&amp;utm_term=whois%E5%91%BD%E4%BB%A4&amp;spm=1018.2226.3001.4187">一文搞定：whois数据库查询域名信息（WHOIS）</a></p>
<p>这里介绍这篇文章提到的中文域名查询。。。</p>
<p>他这里说：通过接口直接查询中文域名，会提示没有查询结果。这时候需要将中文域名进行编码</p>
<p>在线编码：<a target="_blank" rel="noopener" href="http://tools.jb51.net/punycode/index.php">http://tools.jb51.net/punycode/index.php</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101192800298.png" alt="image-20240101192800298"></p>
<p>其实，中文后缀的域名可以不编码，主要是中英结合的域名, 比如 <a target="_blank" rel="noopener" href="http://xn--chq7c.cn/">http://中万.cn/</a></p>
<p>从浏览器直接复制过来是<a target="_blank" rel="noopener" href="http://xn--chq7c.cn/">http://xn–chq7c.cn/</a></p>
<p>这是一种叫做：Punycode的编码方式</p>
<pre><code class="hljs python"><span class="hljs-built_in">print</span>(<span class="hljs-string">"中万"</span>.encode(<span class="hljs-string">'punycode'</span>).decode())
<span class="hljs-comment"># chq7c</span>
<span class="hljs-number">12</span></code></pre>
<p>然后加上前缀<code>xn--</code>，就和上面的结果一致了</p>
<pre><code class="hljs scss">xn<span class="hljs-attr">--chq7c</span></code></pre>
<p>可以看到还是可以查询到的，不过这里如果进入其对应的refer服务器中就查询错误（格式不正确）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101193453609.png" alt="image-20240101193453609"></p>
<p>不过这里竟然可以直接中文域名查询！！当然whois根服务器也可以</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101193650786.png" alt="image-20240101193650786"></p>
<p>这里附上一个whois查询信息的解释：</p>
<pre><code class="hljs plaintext">01 whois：是查询命令

02 qqpk.cn：是要查询的域名

03 Domain.name：域名

04 ROID：是Register Object ID号，相当于注册对象的一个身份证号码

05 Domain Status: CLIENT TRANSFER PROHIBITED 
   【也就是客户端禁止转移，该状态由注册商设置，域名可以更新（域名信息修改）、续费、删除，需要指派至少一台域名服务器则可以正常使用。】

06 Registrant：域名注册人的姓名

07 Registrant Contact Email：注册人的联系邮箱

08 Sponsoring Registrar：注册商 
   【他们进行抢注域名，然后进行high价转让的公司】

09 Name Server：也就是DNS域名解析服务器，它在互联网的作用是把域名转换成为网络可以识别的IP地址

10 Registration Time：注册该域名的时间

11 Expiration Time：该域名到期时间

12 DNSSEC：unsigne 
   【DNSSEC=Domain Name System Security Extensions (DNSSEC)，DNS安全扩展，是由IETF提供的一系列DNS安全认证的机制（可参考RFC2535）。它提供了一种来源鉴定和数据完整性的扩展，但不去保障可用性、加密性和证实域名不存在。】
   【Unsigned：未设置、未部署】</code></pre>
<h4 id="dig查询">dig查询</h4>
<p>dig（domain information group）是常用的域名查询工具，可以从DNS域名服务器查询主机地址信息，获取到详细的域名信息。这个命令是Bind的一部分，本身并没有在Windows和<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Linux&amp;spm=1001.2101.3001.7020">Linux</a>系统中集成，所以如果我们想要使用该命令就需要先下载相应的软件包。–至于下载方式这里就不说了</p>
<p>这里补充一下对于资源记录(RR)的四个元组的知识：</p>
<blockquote>
<p>A记录 IP地址记录,记录一个域名对应的IP地址</p>
<p>AAAA记录  IPv6地址记录，记录一个域名对应的IPv6地址</p>
<p>CNAME记录   别名记录，记录一个主机的别名</p>
<p>MX记录    电子邮件交换记录，记录一个邮件域名对应的IP地址，比如my[at]<a target="_blank" rel="noopener" href="http://lijiejie.com">lijiejie.com</a><br>
<a target="_blank" rel="noopener" href="http://xn--lijiejie-ul7mw1owm9img2c1ur.com">后面的部分lijiejie.com</a>，邮件服务器对应的IP地址</p>
<p>NS记录      域名服务器记录 ,记录该域名由哪台域名服务器解析</p>
<p>PTR记录     反向记录，也即从IP地址到域名的一条记录</p>
<p>TXT记录     记录域名的相关文本信息</p>
<p>SOA记录   start of anthorization 开始授权，是一种比较难以理解的记录值，一般二级域名才会有</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240104200233900.png" alt="image-20240104200233900"></p>
<p>简单使用：<code>dig www.baidu.com</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101200849679.png" alt="image-20240101200849679"></p>
<p>对一些字段的解释：</p>
<blockquote>
<p>第一二行：输出了有关dig的版本信息，和全局设置选项：+cmd，以及输入参数信息</p>
<p>Got answer：输出了从DNS返回的技术信息，比较重要的是 status，如果 status 的值为 NOERROR ，则说明本次查询成功。这段信息可以用选项 [no]comments 来控制是否显示，但是小心禁止掉comments也可能关闭一些其它的选项。</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101201303974.png" alt="image-20240101201303974"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101201637507.png" alt="image-20240101201637507"></p>
<blockquote>
<p>QUESTION SECTION：查询字段，显示了我们查询的域名以及查询的服务，A代表的是查询A记录，即主机查询</p>
<p>ANSWER SECTION：回答字段这里的结果表示：要查询www.baidu.com先查询CNAME记录，对www.a.shifen.com进行访问，当我们访问www.a.shifen.com后，该主机让我们访问110.242.68.3，我们访问110.242.68.3后，这个ip的主机会告诉我们www.baidu.com的IP是110.242.68.4</p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101201839925.png" alt="image-20240101201839925"></p>
<blockquote>
<p>这部分显示了请求所花的时间，dns服务器，当前时间，以及查询信息的大小</p>
</blockquote>
<p>还有一个值得记录的是-x选项，说是根据IP反查域名（另外每个命令后面添加+short可以简化输出信息）</p>
<pre><code class="hljs plaintext">dig -x 183.84.6.134	# 访问PTR记录，查询该IP地址所对应的主机名，DNS解析是用域名查IP，而PTR记录是IP查域名</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101202406892.png" alt="image-20240101202406892"></p>
<p>不过这里始终没看出来域名在哪里。。。。还有一个+trace命令可以看到域名解析详细过程</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101204008916.png" alt="image-20240101204008916"></p>
<h4 id="icp备案查询">ICP备案查询</h4>
<p>ICP备案是指网站在信息产业部提交网站信息进行官方认可。对国内各大小网站(包括企业及个人站点)的严格审查工作，对于没有合法备案的非经营性网站或没有取得ICP许可证的经营性网站，根据网站性质，将予以罚款，严重的关闭网站，以此规范网络安全，打击一切利用网络资源进行不法活动的犯罪行为。也就是说，只要是盈利为目的的网站，都要进行ICP备案，否则会受到相应的处罚。</p>
<p><strong>国内使用国内服务器的网站，都必须要先办理ICP备案后才可以上线。</strong></p>
<p>通过查询目标企业的备案信息，可直接获取到目标企业注册了哪些域名，从而增加可渗透的目标范围。</p>
<p>推荐使用官方网站<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/#/Integrated/recordQuery">ICP/IP地址/域名信息备案管理系统</a> ——支持使用<code>单位名称</code>、<code>域名</code>和<code>备案号</code>进行查询</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106150321631.png" alt="image-20240106150321631"></p>
<h4 id="站长工具">站长工具</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106150456508.png" alt="image-20240106150456508"></p>
<h4 id="爱站网">爱站网</h4>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.aizhan.com/cha/">站长seo综合查询工具-爱站网</a></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106150621739.png" alt="image-20240106150621739"></p>
<h4 id="证书查询">证书查询</h4>
<p>SSL证书是一种遵守SSL协议的服务器数字证书，由受信任的根证书颁发机构颁发。 SSL证书采用SSL协议进行通信，SSL证书部署到服务器后，服务器端的访问将启用HTTPS协议。 您的网站将会通过HTTPS加密协议来传输数据，可帮助服务器端和客户端之间建立加密链接，从而保证数据传输的安全。</p>
<p>通过查询共用SSL证书的网站，可以找到相关的其他域名。</p>
<p>第一种可以浏览器直接查看，如下图，点击更多信息</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106151111537.png" alt="image-20240106151111537"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106151207608.png" alt="image-20240106151207608"></p>
<p>接着点击上图的查看证书即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106151233576.png" alt="image-20240106151233576"></p>
<p>第二种是利用在线网站查询： <a target="_blank" rel="noopener" href="https://crt.sh/">crt.sh</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106151348228.png" alt="image-20240106151348228"></p>
<p>第三种是通过网络空间搜索引擎</p>
<p>可查询fofa语法手册：</p>
<table>
<thead>
<tr>
<th style="text-align:left">语法</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>cert="baidu"</code></td>
<td style="text-align:left">搜索证书(https或者imaps等)中带有baidu的资产。</td>
</tr>
<tr>
<td style="text-align:left"><code>cert.subject="Oracle Corporation"</code></td>
<td style="text-align:left">搜索证书持有者是Oracle Corporation的资产</td>
</tr>
<tr>
<td style="text-align:left"><code>cert.issuer="DigiCert"</code></td>
<td style="text-align:left">搜索证书颁发者为DigiCert Inc的资产</td>
</tr>
<tr>
<td style="text-align:left"><code>cert.is_valid=true</code></td>
<td style="text-align:left">验证证书是否有效，true有效，false无效</td>
</tr>
</tbody>
</table>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106151558662.png" alt="image-20240106151558662"></p>
<h4 id="dns共享记录查询">DNS共享记录查询</h4>
<p>DNS（Domain Name Server，域名服务器）是进行域名(domain name)和与之相对应的IP地址 (IP address)转换的服务器。DNS中保存了一张域名(domain name)和与之相对应的IP地址 (IP address)的表，以解析消息的域名。 域名是Internet上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位（有时也指地理位置）。域名是由一串用点分隔的名字组成的，通常包含组织名，而且始终包括两到三个字母的后缀，以指明组织的类型或该域所在的国家或地区。</p>
<p>此处通过查询共享DNS服务器的主机来获取到相关的域名；需要注意的是，如果是公开的DNS服务器，那么查询的效果将会特别差。</p>
<p>首先查询目标是否存在自建的NS服务器</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106151959401.png" alt="image-20240106151959401"></p>
<p>将获取到的NS服务器带入 <a target="_blank" rel="noopener" href="https://hackertarget.com/find-shared-dns-servers/">https://hackertarget.com/find-shared-dns-servers/</a> 进行查询</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106152116789.png" alt="image-20240106152116789"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106152128296.png" alt="image-20240106152128296"></p>
<p>此处查询的结果并不全是属于目标范围，需要进一步的确认和观察。</p>
<h4 id="ip反查">IP反查</h4>
<p>目标多个域名可能绑定在同一IP上，通过IP反查一定情况下可获取到其他的域名信息。</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://s.tool.chinaz.com/same">同IP网站查询，同服务器网站查询 - 站长工具</a></li>
<li><a target="_blank" rel="noopener" href="https://dnslytics.com/">Online investigation tool - Reverse IP, NS, MX, WHOIS and Search Tools</a></li>
</ul>
<p>输入相关的域名或IP地址即可查询。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106152413850.png" alt="image-20240106152413850"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106152542354.png" alt="image-20240106152542354"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106152557186.png" alt="image-20240106152557186"></p>
<p>搜索引擎搜索<code>IP反查域名</code>即可，但有时候效果并不理想，很多情况查不到</p>
<p>推荐使用平台：<a target="_blank" rel="noopener" href="https://securitytrails.com/dns-trails">https://securitytrails.com/dns-trails</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106175828753.png" alt="image-20240106175828753"></p>
<p><code>fofa</code>、<code>zoomeye</code>、<code>hunter</code>、<code>quake</code>等，最推荐的还是<code>hunter</code>，效果最好，能查到很多东西</p>
<pre><code class="hljs scss">https://hunter.qianxin.com/list?search=ip%<span class="hljs-number">3</span>D<span class="hljs-string">"220.181.38.251"</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106175927343.png" alt="image-20240106175927343"></p>
<h4 id="股权信息">股权信息</h4>
<p>通过查询股权信息，或者股权穿透图，寻找子公司和孙公司等，一般对外投资超过50%或者有行政权限的都可以算目标</p>
<ol>
<li>天眼查：<a target="_blank" rel="noopener" href="https://www.tianyancha.com/">https://www.tianyancha.com/</a></li>
<li>企查查：<a target="_blank" rel="noopener" href="https://www.qcc.com/">https://www.qcc.com/</a></li>
</ol>
<p>如查询字节跳动</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106162039305.png" alt="image-20240106162039305"></p>
<p>通过查询子公司，再查询子公司对应的产品，可以大范围的扩大攻击面</p>
<p><strong>工具推荐</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/wgpsec/ENScan_GO">https://github.com/wgpsec/ENScan_GO</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/i11us0ry/AScan">https://github.com/i11us0ry/AScan</a></li>
</ul>
<h4 id="hackerone">Hackerone</h4>
<p>一些在hackerone上进行众测的厂商，会把自己的测试范围列举出来，其中就包含有大量的域名，因此通过hackerone来完善资产收集也是一个不错的方法。</p>
<p>以阿里为例：<a target="_blank" rel="noopener" href="https://hackerone.com/alibaba?type=team&amp;view_policy=true">https://hackerone.com/alibaba?type=team&amp;view_policy=true</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106164324179.png" alt="image-20240106164324179"></p>
<h4 id="google">Google</h4>
<p>Google直接搜索里面的一些关键内容来查询，比如公司名、备案、引用的特殊js等</p>
<p>还是以阿里为例（别人的成果图）</p>
<pre><code class="hljs scss">intext:浙ICP备<span class="hljs-number">09048685</span>号 intext:<span class="hljs-number">11040102700068</span> -www</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106164906048.png" alt="image-20240106164906048"></p>
<h4 id="国家企业信用信息公示系统">国家企业信用信息公示系统</h4>
<p><a target="_blank" rel="noopener" href="https://shiming.gsxt.gov.cn/corp-query-search-1.html">https://shiming.gsxt.gov.cn/corp-query-search-1.html</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106165623017.png" alt="image-20240106165623017"></p>
<h3 id="获取真实ip">获取真实IP</h3>
<p>为了保证网络的稳定和快速传输，网站服务商会在网络的不同位置设置节点服务器，通过 CDN（Content Delivery Network，内容分发网络）技术，将网络请求分发到最优的节点服务器上面。如果网站开启了 CDN 加速，就无法通过网站的域名信息获取真实的 IP，要对目标的 IP 资源进行收集，就要绕过 CDN 查询到其真实的 IP 信息。</p>
<p>一个小tip：浏览器切换手机模式，可能是真实ip，公众号、小程序中的资产也可能对应真实ip。</p>
<h4 id="如何判断是否有cdn">如何判断是否有CDN</h4>
<p>在对目标 IP 信息收集之前，首先要判断目标网站是否开启了 CDN，一般通过不同地方的主机 ping 域名和 nslookup 域名解析两种方法，通过查看返回的 IP 是否是多个的方式来判断网站是否开启了 CDN，如果返回的 IP 信息是多个不同的 IP，那就有可能使用了 CDN 技术。</p>
<h5 id="方法一多地ping">方法一：多地ping</h5>
<p>使用各种多地 ping 的服务，查看对应 IP 地址是否唯一，如果不唯一多半是使用了CDN， 多地 Ping 网站有：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101205110956.png" alt="image-20240101205110956"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101205140092.png" alt="image-20240101205140092"></p>
<p>可以到有多个IP，一般这种方法要根据多个网站都进行尝试一下，才能更好的确定，不过这里能用的我知道的只有两个</p>
<p><a target="_blank" rel="noopener" href="http://ping.chinaz.com/%E3%80%81http://ping.aizhan.com/%E8%80%8C%E4%B8%94%E5%90%8E%E8%80%85%E8%BF%98%E4%BC%BC%E4%B9%8E%E5%B4%A9%E4%BA%86%EF%BC%8C%E6%9F%A5%E8%AF%A2%E6%B2%A1%E5%8F%8D%E5%BA%94">http://ping.chinaz.com/、http://ping.aizhan.com/而且后者还似乎崩了，查询没反应</a></p>
<p>又去谷歌找了一番，无果，感觉有需要的话需要多翻翻一些网站了。</p>
<h5 id="方法二nslookup">方法二：nslookup</h5>
<p>试用nslookup进行检测，如果返回域名解析对应多个IP，那么多半是试用了CDN.</p>
<pre><code class="hljs plaintext">nslookup http://example.com</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101210831289.png" alt="image-20240101210831289"></p>
<p>这里看到一个是有多个IP地址，一个是name的值直接就是cdn.net什么的，这很明显就是有CDN了</p>
<h5 id="方法三在线工具">方法三：在线工具</h5>
<p>在线工具查看是否存在CDN，可以参考以下站点:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.cdnplanet.com/tools/cdnfinder">http://www.cdnplanet.com/tools/cdnfinder</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ipip.net/ip.html">http://www.ipip.net/ip.html</a></li>
</ul>
<p>这里推荐第二个站点</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101211349443.png" alt="image-20240101211349443"></p>
<h4 id="绕过cdn">绕过CDN</h4>
<h5 id="查询历史dns记录">查询历史DNS记录</h5>
<p>查看 IP 与 域名绑定的历史记录，可能会存在使用 CDN 前的记录，相关查询网站有</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101220032934.png" alt="image-20240101220032934"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://censys.io/ipv4?q=baidu.com">https://censys.io/ipv4?q=baidu.com</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/cdncheck">https://github.com/projectdiscovery/cdncheck</a> –未仔细查看</li>
<li><a target="_blank" rel="noopener" href="https://viewdns.info/iphistory/">https://viewdns.info/iphistory/</a></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101212421633.png" alt="image-20240101212421633"></p>
<p><a target="_blank" rel="noopener" href="https://securitytrails.com/">https://securitytrails.com/</a> –需要企业邮箱注册，不过很全</p>
<p>SecurityTrails（前身为 DNS Trails）拥有大约3.5万亿DNS记录，3亿whois记录，8亿SSL证书记录以及超过4.5亿子域的记录数据。自2008年以来，网站每天都收集和更新海量数据。</p>
<p>DNS 记录：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101214927518.png" alt="image-20240101214927518"></p>
<p>IP历史</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101214837563.png" alt="image-20240101214837563"></p>
<p>子域名：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101215012570.png" alt="image-20240101215012570"></p>
<p>Complete DNS（<a target="_blank" rel="noopener" href="https://completedns.com/%EF%BC%89Complete">https://completedns.com/）Complete</a> DNS 拥有超过 22 亿个DNS变更记录，提供API，支持同时进行多域名/IP查询。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101215229120.png" alt="image-20240101215229120"></p>
<p>WhoISrequest （<a target="_blank" rel="noopener" href="https://whoisrequest.com/%EF%BC%89">https://whoisrequest.com/）</a></p>
<p>WhoISrequest 这个网站自2002年以来一直在跟踪和记录DNS历史变更，数据底蕴很足。</p>
<p>不过这里查了半天没查到什么信息，而且这个网站似乎对于dns历史记录用的是上面的网站的api</p>
<p>Whoxy（<a target="_blank" rel="noopener" href="https://www.whoxy.com/%EF%BC%89">https://www.whoxy.com/）</a></p>
<p>Whoxy 拥有爬取超过 3.65亿个子域数据，该网站 API 调用非常方便，以 XML 和 JSON 格式返回数据。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240101215944112.png" alt="image-20240101215944112"></p>
<p>还有很多网站，这里就不一一介绍了，详细可浏览参考文章，这里汇总一下</p>
<blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.cdnplanet.com/tools/cdnfinder">http://www.cdnplanet.com/tools/cdnfinder</a></li>
<li><a target="_blank" rel="noopener" href="http://www.ipip.net/ip.html">http://www.ipip.net/ip.html</a></li>
<li><a target="_blank" rel="noopener" href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></li>
<li><a target="_blank" rel="noopener" href="https://censys.io/ipv4?q=baidu.com">https://censys.io/ipv4?q=baidu.com</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/cdncheck">https://github.com/projectdiscovery/cdncheck</a></li>
<li><a target="_blank" rel="noopener" href="https://viewdns.info/iphistory/">https://viewdns.info/iphistory/</a></li>
<li><a target="_blank" rel="noopener" href="https://securitytrails.com/">https://securitytrails.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://completedns.com/">https://completedns.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://whoisrequest.com/">https://whoisrequest.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.whoxy.com/">https://www.whoxy.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://dnsdb.io/">https://dnsdb.io/</a></li>
<li><a target="_blank" rel="noopener" href="https://reverse-ip.whoisxmlapi.com/">https://reverse-ip.whoisxmlapi.com/</a></li>
</ul>
</blockquote>
<h5 id="使用国外主机请求域名">使用国外主机请求域名</h5>
<p>部分国内的 CDN 加速服务商只对国内的线路做了 CDN 加速，但是国外的线路没有做加速，这样就可以通过国外的主机来探测真实的 IP 信息。</p>
<p>探测的方式也有两种，可以利用已有的国外主机直接进行探测；如果没有国外主机，可以利用公开的多地 ping 服务（多地 ping 服务有国外的探测节点），可以利用国外的探测节点返回的信息来判断真实的 IP 信息。</p>
<h5 id="网站信息泄露漏洞">网站信息泄露漏洞</h5>
<ul>
<li>服务器日志文件</li>
<li>探针文件，例如 phpinfo</li>
<li>网站备份压缩文件</li>
<li>.DS_Store</li>
<li>.hg</li>
<li>.git</li>
<li>SVN</li>
<li>Web.xml</li>
</ul>
<p>字典非常重要，往往疏忽的点就在一台边缘服务器。</p>
<p>小tip：phpinfo 页面中有一个 SERVER_ADDR 字段会显示该主机真实 IP。</p>
<h5 id="查询子域名">查询子域名</h5>
<p>这里注意的就是子域名、C段以及旁站（同IP网站）</p>
<p>由于 CDN 加速需要支付一定的费用，很多网站只对主站做了 CDN 加速，子域名没有做 CDN 加速，子域名可能跟主站在同一个服务器或者同一个 C 段网络中，可以通过子域名探测的方式，收集目标的子域名信息，通过查询子域名的 IP 信息来辅助判断主站的真实 IP 信息。   ———具体的方法在下面叙述</p>
<h5 id="邮件信息">邮件信息</h5>
<p>一般大型网站自己部署架设的邮件服务器如果向外部用户发送邮件的话，如果中间未经任何数据处理和防护措施，那么邮件头部的源码中会包含此邮件服务器的真实 IP 地址。常见的邮件触发点有：</p>
<ul>
<li>RSS 订阅</li>
<li>邮箱注册、激活处</li>
<li>邮箱找回密码处</li>
<li>产品更新的邮件推送</li>
<li>某业务执行后发送的邮件通知</li>
<li>员工邮箱、邮件管理平台等入口处的忘记密码</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102153303790.png" alt="image-20240102153303790"></p>
<p>另外这里还有一个<code>奇淫技巧</code>，通过发送邮件给一个不存在的邮箱地址，比如 <a href="mailto:000xxx@domain.com">000xxx@domain.com</a> ，因为该用户不存在，所以发送将失败，并且还会收到一个包含发送该电子邮件给你的服务器的真实 IP 通知。</p>
<p>生产上多关注这些点，一个不成功继续测试下一个邮件触发点，很多大型网站的邮件服务器不止一台，并不是所有都做了防护处理，细节决定成败。</p>
<h5 id="目标网站-app-应用">目标网站 APP 应用</h5>
<p>如果目标网站有自己的 App，可以尝试利用 Burp Suite 等流量抓包工具抓取 App 的请求，从里面可能会找到目标的真实 IP。</p>
<h3 id="子域名查询">子域名查询</h3>
<p>这里除了常见的网络空间如fofa、shodan、zoomeye、censys等，就是一些强大脚本工具了。这里熟悉几个常见的</p>
<h4 id="subdomainsbrute">SubDomainsBrute</h4>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/subDomainsBrute">https://github.com/lijiejie/subDomainsBrute</a></p>
<p>SubDomainsBrute 是通过纯 DNS 爆破来寻找子域名，为了最大提升脚本效率，采用协程+多进程的方式进行爆破。Python 3.5 以上需要安装 aiodns 库进行异步查询，python 2 需要安装 dnspython 库和 gevent 协程库。</p>
<pre><code class="hljs scss">python subDomainsBrute<span class="hljs-selector-class">.py</span> baidu<span class="hljs-selector-class">.com</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102190611143.png" alt="image-20240102190611143"></p>
<p>且在最近更新之后是支持扫描泛解析域名的，使用 -w 参数。——这里简单了解了一下域名泛解析。</p>
<p>简单来说就是DNS的泛域名解析也可以理解为带通配符的解析记录，带通配符的解析记录是用来为不存在的子域提供解析请求响应的方法。 <a target="_blank" rel="noopener" href="http://xn--example-4t3kgms1jty2anogusg.com">例如存在一个example.com</a>，如果我们设置通配符记录：*.example.com，则对其不存在的所有子域，<a target="_blank" rel="noopener" href="http://xn--abcd-f96g315g.example.com">比如abcd.example.com</a>、<a target="_blank" rel="noopener" href="http://xxx.example.com">xxx.example.com</a>（这些都是不存在的子域），则如果我们在对这些子域进行请求的时候，<a target="_blank" rel="noopener" href="http://xn--example-lo5kg8xfwdy10d6p7ek7wb.com">都会自动指向example.com</a>。</p>
<p>因此基于上述原理，如果我们的目标域名设置了这样的泛解析，那我们可以凭借强大的字典对其任意子域进行请求，看最终返回的ip是否与其主域IP一致，如果一致那说明该子域不存在；但如果不一致，说明该子域是存在的。</p>
<p>当然如果目标域名没有设置泛解析，那我们在对其子域进行请求的时候，如果返回了与主域IP地址不同的情况，则直接说明该子域存在</p>
<p>我们针对一个泛解析的域名进行爆破，subDomainsBrute 会提示 any-sub 错误，之后使用 -w 参数开启泛解析强制爆破</p>
<h4 id="esd">ESD</h4>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/FeeiCN/ESD">https://github.com/FeeiCN/ESD</a> –具体的就不介绍了，看一下使用效果即可，这里扫描单个域名看看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102194424947.png" alt="image-20240102194424947"></p>
<p>就是速度有点慢</p>
<pre><code class="hljs plaintext"># 扫描单个域名
esd -d qq.com

# debug模式扫描单个域名
esd=debug esd -d qq.com

# 扫描多个域名（英文逗号分隔）
esd --domain qq.com,tencent.com

# 扫描单个域名且过滤子域名中单个特定响应内容
esd --domain mogujie.com --filter 搜本店

# 扫描单个域名且过滤子域名中多个特定响应内容
esd --domain mogujie.com --filter 搜本店,收藏店铺

# 扫描文件（文件中每行一个域名）
esd --file targets.txt

# 跳过相似度对比（开启这个选项会把所有泛解析的域名都过滤掉）
esd --domain qq.com --skip-rsc

# 平均分割字典，加快爆破
esd --domain qq.com --split 1/4

# 使用DNS域传送漏洞获取子域名
esd --domain qq.com --dns-transfer

# 使用HTTPS证书透明度获取子域名
esd --domain qq.com --ca-info</code></pre>
<h4 id="layer-子域名挖掘机">Layer 子域名挖掘机</h4>
<p>项目地址：<a target="_blank" rel="noopener" href="https://hub.fastgit.org/euphrat1ca/LayerDomainFinder/releases/tag/3">https://hub.fastgit.org/euphrat1ca/LayerDomainFinder/releases/tag/3</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102195144221.png" alt="image-20240102195144221"></p>
<h4 id="xray">Xray</h4>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/chaitin/xray">https://github.com/chaitin/xray</a></p>
<p>xray 是一款强大的安全评估工具，一款自动化扫描器，我们可以用其自带的 subdomain 子域名发掘功能来针对性探测：</p>
<p>subdomain 功能支持暴力破解模式和非暴力模式，可以只探测 web 服务或者只探测 ip 可解析的子域，另外支持 webhook 数据传递，作为插件端或者分发消息的接收端来使用都非常方便快捷。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102205755924.png" alt="image-20240102205755924"></p>
<h4 id="bypass-firewalls-by-dns-history">Bypass-firewalls-by-DNS-history</h4>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/vincentcox/bypass-firewalls-by-DNS-history">https://github.com/vincentcox/bypass-firewalls-by-DNS-history</a></p>
<p>Bypass-firewalls-by-DNS-history 是一款集成全自动化的探测工具，通过探测 DNS 历史记录，搜索旧的 DNS A Record，收集子域，并检查服务器是否对该域名进行答复。 另外它还基于源服务器和防火墙在HTML响应中的相似性阈值来判断。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102210033498.png" alt="image-20240102210033498"></p>
<h4 id="oneforall">OneForAll</h4>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/shmilylty/OneForAll">https://github.com/shmilylty/OneForAll</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102211435020.png" alt="image-20240102211435020"></p>
<h4 id="搜索引擎发现子域名">搜索引擎发现子域名</h4>
<p>使用搜索引擎语法，如Google 或者百度等</p>
<pre><code class="hljs plaintext">Google-》site:xxx.com
Fofa-》domain="xxx.com"</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102211855257.png" alt="image-20240102211855257"></p>
<h4 id="第三方聚合服务发现子域名">第三方聚合服务发现子域名</h4>
<p>第三方聚合平台 Netcraft、Virustotal、ThreatCrowd、DNSdumpster 和 ReverseDNS 等获取子域信息。</p>
<h4 id="通过-ssl-证书">通过 SSL 证书</h4>
<ul>
<li>证书颁发机构 (CA) 必须将他们发布的每个 SSL/TLS 证书发布到公共日志中，SSL/TLS 证书通常包含域名、子域名和电子邮件地址。因此可以利用 SSL/TLS 证书来发现目标站点的真实 IP 地址。</li>
<li>CDN 运营商在给服务器提供保护的同时，也会与其服务器进行加密通信（ssl），这时当服务器的 443 端口接入域名时也会在 443 端口暴露其证书，我们通过证书比对便可发现网站的真实 IP 地址。</li>
</ul>
<ol>
<li>利用 Censys 引擎（<a target="_blank" rel="noopener" href="https://censys.io/%EF%BC%89">https://censys.io/）</a></li>
</ol>
<ul>
<li>Censys 搜索引擎能够扫描整个互联网，每天都会扫描 IPv4 地址空间，以搜索所有联网设备并收集相关的信息，可以利用 Censys 进行全网方面的 SSL 证书搜索，找到匹配的真实 IP 。</li>
</ul>
<p>可以看到，当我们针对一个互联网 IP 地址进行搜索时，是有匹配到证书 sha1 签名的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102215326027.png" alt="image-20240102215326027"></p>
<p>同理，我们根据域名指纹搜索 SSL 证书指纹，然后再反查 IP 就可以了。</p>
<p>首先针对目标域名，选择 <code>Certificates</code> 证书搜索，结果出来一堆 <code>有效</code> 的证书和 <code>无效 </code> 的证书：</p>
<p>我们在搜索的时候可以使用语法来先检索有效证书，如果无果再回去查看无效证书</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102215803297.png" alt="image-20240102215803297"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102215743683.png" alt="image-20240102215743683"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102215826897.png" alt="image-20240102215826897"></p>
<h4 id="使用命令行">使用命令行</h4>
<ul>
<li>通过 <code>openssl</code> 和 <code>curl</code> 等常见的基础命令，也同样可以达到反查 SSL 证书的效果。</li>
</ul>
<p>openssl：附上成果图</p>
<pre><code class="hljs scss">openssl s_client -connect ip:<span class="hljs-number">443</span> | grep subject</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102220521953.png" alt="image-20240102220521953"></p>
<p>curl：</p>
<pre><code class="hljs sh">curl -v https://123.123.123.123 | grep <span class="hljs-string">'subject'</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102220459535.png" alt="image-20240102220459535"></p>
<h4 id="使用工具和脚本">使用工具和脚本</h4>
<ul>
<li>通过自己写工具脚本，集成前面的1、2两点，完全可以做到一个简易版的 SSL 全网证书爬取，也可以利用现有的一些脚本工具和网站，省的我们自己费力了。</li>
</ul>
<p>例如 <code>CloudFlair</code> ，项目地址：<a target="_blank" rel="noopener" href="https://github.com/christophetd/CloudFlair">https://github.com/christophetd/CloudFlair</a></p>
<p>脚本兼容 python2.7 和 3.5，需要配置 Censys API，不过只针对目标网站是否使用 CloudFlare 服务进行探测。</p>
<h4 id="证书收集">证书收集</h4>
<p>可以通过 <a target="_blank" rel="noopener" href="https://crt.sh/">https://crt.sh</a> 进行快速证书查询收集</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102220811833.png" alt="image-20240102220811833"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102220822759.png" alt="image-20240102220822759"></p>
<p>附上查询的 python 小脚本：</p>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> re

TIME_OUT = <span class="hljs-number">60</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_SSL</span>(<span class="hljs-params">domain</span>):
    domains = []
    url = <span class="hljs-string">'https://crt.sh/?q=%25.{}'</span>.<span class="hljs-built_in">format</span>(domain)
    response = requests.get(url,timeout=TIME_OUT)
    ssl = re.findall(<span class="hljs-string">"&lt;TD&gt;(.*?).{}&lt;/TD&gt;"</span>.<span class="hljs-built_in">format</span>(domain),response.text)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ssl:
        i += <span class="hljs-string">'.'</span> + domain
        domains.append(i)
    <span class="hljs-built_in">print</span>(domains)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    get_SSL(<span class="hljs-string">"baidu.com"</span>)</code></pre>
<p>获得所有包含证书的子域：</p>
<h4 id="通过海外-dns-查询">通过海外 DNS 查询</h4>
<ul>
<li>针对国内市场用户，大部分的 CDN 服务商并没有做海外市场的 CDN ，所以可以通过寻找小众、冷门的海外 DNS 查询，看是否能获得真实 IP 。</li>
</ul>
<pre><code class="hljs scss">nslookup target<span class="hljs-selector-class">.com</span> &lt;海外 DNS 地址&gt;</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102221000835.png" alt="image-20240102221000835"></p>
<p>也可以使用海外的超级ping类的平台在线多国家多地区测试，推荐 <a target="_blank" rel="noopener" href="https://www.host-tracker.com/v3/check/">https://www.host-tracker.com/v3/check/</a> ，支持 140 多个地区的 ping 测试，另外支持针对某子域超长期的监控，通过邮件通知，简直太强大了。——就是需要氪金</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240102221402157.png" alt="image-20240102221402157"></p>
<p>小技巧：在<a target="_blank" rel="noopener" href="https://github.com/">https://github.com/</a> 上也可以搜索子域名，运气好的话，会有意想不到的收获。</p>
<h4 id="通过变更的域名">通过变更的域名</h4>
<ul>
<li>很多网站在发展的过程中，会更换域名，比如京东以前的域名是 <a target="_blank" rel="noopener" href="http://360buy.com">360buy.com</a> ，后来斥巨资购买了 <a target="_blank" rel="noopener" href="http://jd.com">jd.com</a> 。</li>
<li>网站在更换新域名时，如果将 CDN 部署到新的域名上，而之前的域名由于没过期，可能未使用 CDN，因此可以直接获得服务器 IP，所以，历史域名也是一个很重要的点。</li>
</ul>
<h4 id="通过-app-移动端应用">通过 APP 移动端应用</h4>
<ul>
<li>如果网站存在 APP ，可以通过抓包分析其 APP 的数据流量，看是否能找到网站真实 IP 地址，记得关注 APP 的历史版本，里面会有很多 surprise 。</li>
</ul>
<h4 id="通过-f5-ltm-解码">通过 F5 LTM 解码</h4>
<ul>
<li>LTM 是将所有的应用请求分配到多个节点服务器上。提高业务的处理能力，也就是负载均衡。</li>
<li>当服务器使用 F5 LTM 做负载均衡时，通过对 <code>set-cookie</code> 关键字的解码，可以获取服务器真实 ip 地址。</li>
</ul>
<p>例如：</p>
<pre><code class="hljs plaintext">Set-Cookie: BIGipServerpool_9.29_5229=605532106.22012.0000</code></pre>
<ul>
<li>先把第一小节的十进制数，即 605532106 取出来</li>
<li>将其转为十六进制数 2417afca</li>
<li>接着从后至前，取四个字节出来： CA AF 17 24</li>
<li>最后依次转为十进制数 202.175.23.36，即是服务器的真实 ip 地址。</li>
</ul>
<h4 id="通过全网扫描">通过全网扫描</h4>
<ul>
<li>首先从 apnic 网络信息中心 或 IPdeny 获取目标地区 ip 段。</li>
<li>接着使用 Zmap、masscan 等工具对扫描出来端口开放的主机进行 banner 爬取。</li>
<li>然后在 http-req 的 Host 字段，写入我们需要寻找的子域。</li>
<li>最后过滤特征，确认是否有对应的服务器响应。</li>
<li>如果端口不是常见或者固定，当场退役。</li>
</ul>
<p>缺陷：实际上，全网扫描的方法十分笨重，不推荐。因为已经有很多的网站给我们提供了全网爬取服务，之前的方法里都有介绍到，何必自己全网扫描呢，受限于网络、受限于设备，你个人爬的数据也不会有人家商业爬的全</p>
<h4 id="通过-virtual-host-碰撞">通过 virtual-host 碰撞</h4>
<ul>
<li>当我们收集了目标足够多的可能的真实 IP 时，可以通过 IP 和子域的碰撞，来批量获得命中目标以及目标哪些的子域。</li>
</ul>
<p>这里对于我这个小白还不懂什么是host碰撞，那我们先来了解一下：</p>
<p>什么是HOSTS碰撞：</p>
<blockquote>
<p>当直接访问IP回显4xx错误，直接指定HOST头为某个域名时访问该IP回显正常时，可判断可进行HOSTS碰撞。<br>
当一些域名只允许在内网访问时，可通过这种碰撞直接突破边界限制，访问到内网系统进行下一步渗透测试。</p>
</blockquote>
<p>比如如果此时对方的网站对应的中间件有如下配置</p>
<pre><code class="hljs scss">server {
    listen <span class="hljs-number">80</span> default_server;
    server_name _;
    return <span class="hljs-number">400</span>;
}
server {
    listen <span class="hljs-number">80</span>;
    server_name www<span class="hljs-selector-class">.tpaertest</span><span class="hljs-selector-class">.com</span>;
        
    location / {
        proxy_pass http://<span class="hljs-number">192.168</span>.<span class="hljs-number">3.17</span>:<span class="hljs-number">8003</span>;
        proxy_redirect off;
        proxy_set_header Host <span class="hljs-variable">$host</span>:<span class="hljs-variable">$server_port</span>;
        proxy_set_header X-Real-IP <span class="hljs-variable">$remote_addr</span>;
        proxy_set_header X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;
        root <span class="hljs-selector-tag">html</span>;
        index index<span class="hljs-selector-class">.html</span> index<span class="hljs-selector-class">.html</span>;
    }
     access_log  logs/test<span class="hljs-selector-class">.com</span><span class="hljs-selector-class">.log</span>;
}</code></pre>
<p>第一个server的意思是，监听80端口，且如果我们访问的servername不是其他server块儿（也就是这里的第二个）配置的servername，那就返回400。这里我们第二个server块儿设置了servername为指定域名，也就是如果我们在访问该网站的时候不是用指定域名访问的，就会返回400（也就是禁用IP访问了）。这里我结合那些文章举个例子吧：</p>
<p>比如我们此时对目标网站进行信息搜集之后，有了大量的IP资产，并且这些IP资产也开启了web端口，但当我们使用IP直接访问的时候会发现总是返回400、403、404等等。这基本就是对方的中间件使用了反向代理，禁用了IP访问。此时呢，对方网站设置的是：只能使用内网域名来访问该网站。</p>
<p>而对于处于外网的我们来讲，如果我们找到了该IP对应的真正域名，此时我们去访问该域名的时候也是行不通的，因为他是内网域名，而我们在访问的时候，会去公网DNS服务器去寻求域名对应解析出来的IP，但很明显是找不到的。</p>
<p>只有我们在本地hosts文件中设置<code>IP-&gt;正确域名</code>的解析关系，这时我们再去访问的时候就可以成功访问目标内网系统。因为本地hosts的IP解析优先级高于公共的DNS服务器。</p>
<p>具体可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/lxc408863575/article/details/120278310">边界渗透中的小技巧-Hosts碰撞</a> 、<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9590">利用HOSTS碰撞突破边界</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_18980147/article/details/127511001">Host碰撞环境搭建原理及复现</a></p>
<p>回到正题，那我们在遇到类似情况就可以使用自动化工具来快速明确IP与域名的正确绑定关系：</p>
<p>自动化的过程可以使用 virtual-host-discovery 工具，项目地址：<a target="_blank" rel="noopener" href="https://github.com/jobertabma/virtual-host-discovery">https://github.com/jobertabma/virtual-host-discovery</a></p>
<p>使用方法：</p>
<pre><code class="hljs scss">$ ruby scan<span class="hljs-selector-class">.rb</span> <span class="hljs-attr">--ip</span>=x<span class="hljs-selector-class">.x</span><span class="hljs-selector-class">.x</span><span class="hljs-selector-class">.x</span> <span class="hljs-attr">--host</span>=domain  <span class="hljs-attr">--wordlist</span>=&lt;dict file&gt;</code></pre>
<p>其中wordlsit 参数可以省略，默认有一个字典加载，使用该参数则是指定我们自己想要跑的子域列表。</p>
<p>执行后，即可快速找出命中 IP 的子域，这里放上一个成果图（未实践）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240104212403832.png" alt="image-20240104212403832"></p>
<p>另外可以通过 find-virtual-hosts （<a target="_blank" rel="noopener" href="https://pentest-tools.com/information-gathering/find-virtual-hosts#%EF%BC%89%E5%B7%A5%E5%85%B7%E6%9D%A5%E5%9C%A8%E7%BA%BF%E5%BF%AB%E9%80%9F%E9%92%88%E5%AF%B9%E5%85%A8%E7%BD%91%E6%95%B0%E6%8D%AE%E6%89%AB%E6%8F%8F%E6%AF%94%E5%AF%B9%E5%BE%97%E5%87%BA%E7%BB%93%E6%9E%9C%EF%BC%9A">https://pentest-tools.com/information-gathering/find-virtual-hosts#）工具来在线快速针对全网数据扫描比对得出结果：</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240104212659798.png" alt="image-20240104212659798"></p>
<h4 id="通过-faviconico-哈希特征">通过 favicon.ico 哈希特征</h4>
<ul>
<li>favicon.ico 是现代浏览器在网页标题的左侧显示的一个小图标。</li>
<li>该图标数据通常是从 <a target="_blank" rel="noopener" href="https://anywebsite/favicon.ico">https://anywebsite/favicon.ico</a> 处获取的，浏览器会在浏览任何网站时自动请求它。</li>
<li>因为可以通过计算 favicon.ico 的指纹哈希，然后去 shodan 等搜索引擎搜索与之相同的主机结果，从而进一步探测是否能挖掘出目标网站的真实 IP 地址。</li>
</ul>
<p>计算 favicon.ico 哈希的小脚本：</p>
<p>python 2</p>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> mmh3
<span class="hljs-keyword">import</span> requests
 
response = requests.get(<span class="hljs-string">'https://domain.com/favicon.ico'</span>)
favicon = response.content.encode(<span class="hljs-string">'base64'</span>)
<span class="hljs-built_in">hash</span> = mmh3.<span class="hljs-built_in">hash</span>(favicon)
<span class="hljs-built_in">print</span> <span class="hljs-built_in">hash</span></code></pre>
<p>python 3</p>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> mmh3
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> codecs
 
response = requests.get(<span class="hljs-string">'https://domain.com/favicon.ico'</span>)
favicon = codecs.encode(response.content,<span class="hljs-string">"base64"</span>)
<span class="hljs-built_in">hash</span> = mmh3.<span class="hljs-built_in">hash</span>(favicon)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">hash</span>)</code></pre>
<p>安装好环境依赖后执行脚本，计算得到目标网站的 favicon.ico 哈希值：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240104220746280.png" alt="image-20240104220746280"></p>
<p>然后用 shodan 搜索引擎搜索哈希，去命中 IP：</p>
<pre><code class="hljs sh">proxychains4 shodan search http.favicon.hash:1533180946 --fields ip_str,port --separator <span class="hljs-string">" "</span> | awk <span class="hljs-string">'{print $1":"$2}'</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240105194829215.png" alt="image-20240105194829215"></p>
<p>这里不知为何访问总是被禁，但在网站上还是可以正常访问的。。。。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240105194901587.png" alt="image-20240105194901587"></p>
<p>感觉是api-key的问题，但也没解决，先放着吧。。。</p>
<h4 id="通过网页源码特征值">通过网页源码特征值</h4>
<ul>
<li>在服务器源 IP 地址允许访问并且返回的也是类似的网站内容情况下，可以通过侦察页面源码中 JS 、CSS 、HTML 等一系列静态特征值，然后用 Shodan 、Zoomeye 、Censys 等搜索引擎进行匹配搜索，从而定位 IP 。</li>
</ul>
<p>例如源码中找到一段 Google Analytics 的 JS 特征：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240105195727776.png" alt="image-20240105195727776"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240105195737542.png" alt="image-20240105195737542"></p>
<p>这里我的找的特征值也不够有特色，可以看到回显的</p>
<h4 id="使用-cloudfair-工具">使用 CloudFair 工具</h4>
<ul>
<li>如果你的目标是 CloudFlare 保护的，建议先上这款工具跑。</li>
<li>CloudFail 是一种战术侦察工具，旨在收集有关受 Cloudflare 保护的目标的足够信息，以期发现服务器的 IP 位置。</li>
</ul>
<p>该工具目前探测经过3个不同的攻击阶段：</p>
<p>1.使用 <a target="_blank" rel="noopener" href="http://DNSDumpster.com">DNSDumpster.com</a> 扫描 DNS 配置错误。 2.扫描和比对 <a target="_blank" rel="noopener" href="http://Crimeflare.com">Crimeflare.com</a> 数据库。 3.内置字典暴力扫描超过11000个子域名。</p>
<p>安装和使用：</p>
<pre><code class="hljs scss">git clone https://github.com/m0rtem/CloudFail
pip install -r requirements.txt
python cloudfail.py -t domain.com</code></pre>
<h4 id="dns-域传送发现子域名">DNS 域传送发现子域名</h4>
<p>DNS 服务器分为：主服务器、备份服务器和缓存服务器。在主备服务器之间同步数据库，需要使用 “DNS 域传送”。域传送是指备份服务器从主服务器拷贝数据，并用得到的数据更新自身数据库。</p>
<p>若 DNS 服务器配置不当，可能导致攻击者获取某个域的所有记录。造成整个网络的拓扑结构泄露给潜在的攻击者，包括一些安全性较低的内部主机，如测试服务器。同时，黑客可以快速的判定出某个特定 zone 的所有主机，收集域信息，选择攻击目标，找出未使用的 IP 地址，绕过基于网络的访问控制。目前来看 “DNS 域传送漏洞” 已经很少了。</p>
<p>利用 nmap 漏洞检测脚本 <code>dns-zone-transfer</code> 进行检测</p>
<pre><code class="hljs shell">nmap&nbsp;--script&nbsp;dns-zone-transfer&nbsp;--script-args&nbsp;dns-zone-transfer.domain=xxx.edu.cn&nbsp;-p&nbsp;53&nbsp;-Pn&nbsp;dns.xxx.edu.cn</code></pre>
<p>Linux dig命令进行测试</p>
<pre><code class="hljs scss">dig xxx<span class="hljs-selector-class">.com</span> nsdig axfr <span class="hljs-keyword">@dns</span> xxx.com</code></pre>
<p>最后记几个未能实践但却值得记录的几个方法（万一日后用上呢）</p>
<blockquote>
<ol>
<li>通过 CDN 标头特征值–censys搜索</li>
<li>通过 XML-RPC PINGBACK 通信 ——似乎是针对支持 WordPress 的网站的方法</li>
<li>通过 FTP/SCP 协议</li>
<li>利用 Websocket 协议——针对那些没有针对websocket进行部署的网站</li>
<li>社会工程学——社工的魅力</li>
<li>通过全网扫描</li>
<li>通过网站远程资源业务 ——注入我们自己的服务器资源文件，看http日志</li>
<li>通过CDN机器 ——对于自搭建CDN的网站，我们可以尝试渗透一些防护弱的CDN机器</li>
<li>通过流量耗尽、流量放大攻击 ——利用CDN流量有限的特点来进行ddos</li>
<li>通过域名备案信息广域探测——尝试寻找没有做CDN的边缘子域</li>
<li>利用CDN 服务商默认配置 ——CloudFlare ，默认配置 <a target="_blank" rel="noopener" href="http://direct.domain.com">direct.domain.com</a> 二级子域指向服务器源 IP</li>
</ol>
</blockquote>
<h2 id="ip段的收集">IP段的收集</h2>
<p>一般IP的话，我们在收集子域名的时候，就大概知道目标网站的IP段了。</p>
<p>也可以通过whois命令获取。即通过中国互联网信息中心<a target="_blank" rel="noopener" href="http://ipwhois.cnnic.net.cn/%E8%BF%9B%E8%A1%8C%E6%9F%A5%E8%AF%A2%EF%BC%9A">http://ipwhois.cnnic.net.cn/进行查询：</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240105222056899.png" alt="image-20240105222056899"></p>
<h2 id="c段与旁站查询">C段与旁站查询</h2>
<p>C 段：是指与目标服务器在同一 C 段网络的服务器。攻击目标的 C 段存活主机是信息收集的重要步骤，很多企业的内部服务器可能都会在一个 C 段网络中。在很难找到攻击目标服务器互联网漏洞的情况下，可以通过攻击 C 段主机，获取对 C 段主机的控制权，进入企业内网，在企业的内网安全隔离及安全防护不如互联网防护健全的情况下，可以通过 C 段的主机进行内网渗透，这样就可以绕过互联网的防护，对目标进行攻击。但是这种攻击方式容易打偏。</p>
<p>旁站：是和目标网站在同一台服务器上的其它的网站。</p>
<h3 id="nmap扫描">Nmap扫描</h3>
<p>使用命令 nmap -sn x.x.x.x/24，对目标 IP 的 C 段主机进行存活扫描，根据扫描的结果可以判断目标 IP 的 C 段还有哪些主机存活。</p>
<p>nmap -Pn 这个命令在实际工作中的使用很多，该命令不通过 ICMP 协议进行主机存活判断，会直接对端口进行扫描。这样在开启了防火墙禁 Ping 的情况下，也可以利用这个命令正常扫描目标是否存活及对外开启的相关服务。</p>
<h3 id="搜索引擎语法">搜索引擎语法</h3>
<pre><code class="hljs scss">Google：site:x.x.x.*
Bing.com，语法为：http://cn.bing.com/search?q=ip:<span class="hljs-number">111.111</span>.<span class="hljs-number">111.111</span> 
Fofa：ip=<span class="hljs-string">"x.x.x.x/24"</span>
查旁站：https://chapangzhan.com/
云悉：https://www.yunsee.cn/
K8工具、goby、御剑、北极熊扫描器等
站长之家：http://s.tool.chinaz.com/same 
在线：http://www.webscan.cc/</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240105223400508.png" alt="image-20240105223400508"></p>
<p><a target="_blank" rel="noopener" href="http://www.webscan.cc/">http://www.webscan.cc/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106134155197.png" alt="image-20240106134155197"></p>
<h3 id="nmap扫描">nmap扫描</h3>
<pre><code class="hljs scss">nmap -<span class="hljs-selector-tag">p</span> <span class="hljs-number">80</span>,<span class="hljs-number">8080</span> <span class="hljs-attr">--open</span> ip/<span class="hljs-number">24</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106135431424.png" alt="image-20240106135431424"></p>
<p>这里一共是扫描出256的存活的ip。</p>
<h3 id="httpscan">httpscan</h3>
<p>项目地址： <a target="_blank" rel="noopener" href="https://github.com/zer0h/httpscan">https://github.com/zer0h/httpscan</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106141827978.png" alt="image-20240106141827978"></p>
<h3 id="bufferfly">bufferfly</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/dr0op/bufferfly">https://github.com/dr0op/bufferfly</a></p>
<p>攻防资产处理小工具，对攻防前的信息搜集到的大批量资产/域名进行存活检测、获取标题头、语料提取、常见web端口检测、简单中间识别，去重等，便于筛选有价值资产。——下面附上一个成果展示图：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106142632225.png" alt="image-20240106142632225"></p>
<h3 id="cscan">cscan</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/z1un/cscan">https://github.com/z1un/cscan</a></p>
<p>与httpscan很像，不过这是py3的，但效果感觉不如http</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106143008013.png" alt="image-20240106143008013"></p>
<h3 id="masscan">masscan</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/robertdavidgraham/masscan">https://github.com/robertdavidgraham/masscan</a></p>
<p>与nmap类似，一个强大的端口扫描工具。优势在于速度快，缺点是误报率也高</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106144229835.png" alt="image-20240106144229835"></p>
<h3 id="fscan">fscan</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a> ——扫描速度快，支持漏洞验证</p>
<p>一款内网综合扫描工具，方便一键自动化、全方位漏扫扫描。<br>
支持主机存活探测、端口扫描、常见服务的爆破、ms17010、redis批量写公钥、计划任务反弹shell、读取win网卡信息、web指纹识别、web漏洞扫描、netbios探测、域控识别等功能。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106154843054.png" alt="image-20240106154843054"></p>
<h3 id="shuize">shuize</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/0x727/ShuiZe_0x727">https://github.com/0x727/ShuiZe_0x727</a></p>
<p>水泽自带资产探活、支持漏洞验证、Host碰撞</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106171305716.png" alt="image-20240106171305716"></p>
<h3 id="allin">ALLiN</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/P1-Team/AlliN">https://github.com/P1-Team/AlliN</a></p>
<p>一个辅助平常渗透测试项目或者攻防项目快速打点的综合工具，由之前写的工具AG3改名而来。是一款轻便、小巧、快速、全面的扫描工具。多用于渗透前资产收集和渗透后内网横向渗透。工具从项目上迭代了一些懒人功能（比如提供扫描资产文件中，可以写绝大部分的各种形式的链接/CIDR,并在此基础上可以添加任意端口和路径）</p>
<p>红队信息搜集工具，被动识别访问站点是否是云上站点</p>
<pre><code class="hljs shell">python3 AlliN.py --host 110.242.68.0/24 -p 80 -m pscan</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106171621563.png" alt="image-20240106171621563"></p>
<h3 id="ehole">Ehole</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/EdgeSecurityTeam/EHole">https://github.com/EdgeSecurityTeam/EHole</a></p>
<p>EHole是一款对资产中重点系统指纹识别的工具，在红队作战中，信息收集是必不可少的环节，如何才能从大量的资产中提取有用的系统(如OA、VPN、Weblogic…)。EHole旨在帮助红队人员在信息收集期间能够快速从C段、大量杂乱的资产中精准定位到易被攻击的系统，从而实施进一步攻击。</p>
<h2 id="开放端口探测">开放端口探测</h2>
<p>收集到大量IP，那就要进行端口扫描了，看看有什么常见的漏洞。</p>
<p>最常用的就是神器Nmap了。命令：nmap  -T4  -sT  -p -sV  ip</p>
<pre><code class="hljs scss">-sS (TCP SYN扫描)
-sT (TCP connect()扫描)
-sU (UDP扫描)
-sN; -sF; -sX (TCP Null，FIN，and Xmas扫描)
-Pn (不通过ICMP探测)

详细文档：
https://nmap.org/man/zh/</code></pre>
<p>其次可能还会用到 masscan，常见端口及对应服务表：</p>
<table>
<thead>
<tr>
<th>端口</th>
<th>服务</th>
<th>渗透用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>tcp 20,21</td>
<td>FTP</td>
<td>允许匿名的上传下载,爆破,嗅探,win提权,远程执行(proftpd 1.3.5),各类后门(proftpd,vsftp 2.3.4)</td>
</tr>
<tr>
<td>tcp 22</td>
<td>SSH</td>
<td>可根据已搜集到的信息尝试爆破,v1版本可中间人,ssh隧道及内网代理转发,文件传输等等</td>
</tr>
<tr>
<td>tcp 23</td>
<td>Telnet</td>
<td>爆破,嗅探,一般常用于路由,交换登陆,可尝试弱口令</td>
</tr>
<tr>
<td>tcp 25</td>
<td>SMTP</td>
<td>邮件伪造,vrfy/expn查询邮件用户信息,可使用smtp-user-enum工具来自动跑</td>
</tr>
<tr>
<td>tcp/udp 53</td>
<td>DNS</td>
<td>允许区域传送,dns劫持,缓存投毒,欺骗以及各种基于dns隧道的远控</td>
</tr>
<tr>
<td>tcp/udp 69</td>
<td>TFTP</td>
<td>尝试下载目标及其的各类重要配置文件</td>
</tr>
<tr>
<td>tcp 80-89,443,8440-8450,8080-8089</td>
<td>各种常用的Web服务端口</td>
<td>可尝试经典的topn,vpn,owa,webmail,目标oa,各类Java控制台,各类服务器Web管理面板,各类Web中间件漏洞利用,各类Web框架漏洞利用等等……</td>
</tr>
<tr>
<td>tcp 110</td>
<td>POP3</td>
<td>可尝试爆破,嗅探</td>
</tr>
<tr>
<td>tcp 111,2049</td>
<td>NFS</td>
<td>权限配置不当</td>
</tr>
<tr>
<td>tcp 137,139,445</td>
<td>Samba</td>
<td>可尝试爆破以及smb自身的各种远程执行类漏洞利用,如,ms08-067,ms17-010,嗅探等……</td>
</tr>
<tr>
<td>tcp 143</td>
<td>IMAP</td>
<td>可尝试爆破</td>
</tr>
<tr>
<td>udp 161</td>
<td>SNMP</td>
<td>爆破默认团队字符串,搜集目标内网信息</td>
</tr>
<tr>
<td>tcp 389</td>
<td>LDAP</td>
<td>ldap注入,允许匿名访问,弱口令</td>
</tr>
<tr>
<td>tcp 512,513,514</td>
<td>Linux rexec</td>
<td>可爆破,rlogin登陆</td>
</tr>
<tr>
<td>tcp 873</td>
<td>Rsync</td>
<td>匿名访问,文件上传</td>
</tr>
<tr>
<td>tcp 1194</td>
<td>OpenVPN</td>
<td>想办法钓VPN账号,进内网</td>
</tr>
<tr>
<td>tcp 1352</td>
<td>Lotus</td>
<td>弱口令,信息泄漏,爆破</td>
</tr>
<tr>
<td>tcp 1433</td>
<td>SQL Server</td>
<td>注入,提权,sa弱口令,爆破</td>
</tr>
<tr>
<td>tcp 1521</td>
<td>Oracle</td>
<td>tns爆破,注入,弹shell…</td>
</tr>
<tr>
<td>tcp 1500</td>
<td>ISPmanager</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 1723</td>
<td>PPTP</td>
<td>爆破,想办法钓VPN账号,进内网</td>
</tr>
<tr>
<td>tcp 2082,2083</td>
<td>cPanel</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 2181</td>
<td>ZooKeeper</td>
<td>未授权访问</td>
</tr>
<tr>
<td>tcp 2601,2604</td>
<td>Zebra</td>
<td>默认密码zerbra</td>
</tr>
<tr>
<td>tcp 3128</td>
<td>Squid</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 3312,3311</td>
<td>kangle</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 3306</td>
<td>MySQL</td>
<td>注入,提权,爆破</td>
</tr>
<tr>
<td>tcp 3389</td>
<td>Windows rdp</td>
<td>shift后门[需要03以下的系统],爆破,ms12-020</td>
</tr>
<tr>
<td>tcp 3690</td>
<td>SVN</td>
<td>svn泄露,未授权访问</td>
</tr>
<tr>
<td>tcp 4848</td>
<td>GlassFish</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 5000</td>
<td>Sybase/DB2</td>
<td>爆破,注入</td>
</tr>
<tr>
<td>tcp 5432</td>
<td>PostgreSQL</td>
<td>爆破,注入,弱口令</td>
</tr>
<tr>
<td>tcp 5900,5901,5902</td>
<td>VNC</td>
<td>弱口令爆破</td>
</tr>
<tr>
<td>tcp 5984</td>
<td>CouchDB</td>
<td>未授权导致的任意指令执行</td>
</tr>
<tr>
<td>tcp 6379</td>
<td>Redis</td>
<td>可尝试未授权访问,弱口令爆破</td>
</tr>
<tr>
<td>tcp 7001,7002</td>
<td>WebLogic</td>
<td>Java反序列化,弱口令</td>
</tr>
<tr>
<td>tcp 7778</td>
<td>Kloxo</td>
<td>主机面板登录</td>
</tr>
<tr>
<td>tcp 8000</td>
<td>Ajenti</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 8443</td>
<td>Plesk</td>
<td>弱口令</td>
</tr>
<tr>
<td>tcp 8069</td>
<td>Zabbix</td>
<td>远程执行,SQL注入</td>
</tr>
<tr>
<td>tcp 8080-8089</td>
<td>Jenkins,JBoss</td>
<td>反序列化,控制台弱口令</td>
</tr>
<tr>
<td>tcp 9080-9081,9090</td>
<td>WebSphere</td>
<td>Java反序列化/弱口令</td>
</tr>
<tr>
<td>tcp 9200,9300</td>
<td>ElasticSearch</td>
<td>远程执行</td>
</tr>
<tr>
<td>tcp 11211</td>
<td>Memcached</td>
<td>未授权访问</td>
</tr>
<tr>
<td>tcp 27017,27018</td>
<td>MongoDB</td>
<td>爆破,未授权访问</td>
</tr>
<tr>
<td>tcp 50070,50030</td>
<td>Hadoop</td>
<td>默认端口未授权访问</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th><strong>端口号</strong></th>
<th><strong>端口说明</strong></th>
<th><strong>渗透思路</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>21/69</td>
<td>FTP/TFTP：文件传输协议</td>
<td>爆破、内网嗅探</td>
</tr>
<tr>
<td>22</td>
<td>SSH：远程连接</td>
<td>用户名枚举、爆破</td>
</tr>
<tr>
<td>23</td>
<td>Telnet：远程连接</td>
<td>爆破、内网嗅探</td>
</tr>
<tr>
<td>25</td>
<td>SMTP：邮件服务</td>
<td>邮件伪造</td>
</tr>
<tr>
<td>53</td>
<td>DNS：域名系统</td>
<td>DNS域传送\DNS缓存投毒\DNS欺骗\利用DNS隧道技术刺透防火墙</td>
</tr>
<tr>
<td>389</td>
<td>LDAP</td>
<td>未授权访问（通过LdapBrowser工具直接连入）</td>
</tr>
<tr>
<td>443</td>
<td>https服务</td>
<td>OpenSSL 心脏滴血（nmap -sV --script=ssl-heartbleed 目标）</td>
</tr>
<tr>
<td>445</td>
<td>SMB服务</td>
<td>ms17_010远程代码执行</td>
</tr>
<tr>
<td>873</td>
<td>rsync服务</td>
<td>未授权访问</td>
</tr>
<tr>
<td>1090/1099</td>
<td>Java-rmi</td>
<td>JAVA反序列化远程命令执行漏洞</td>
</tr>
<tr>
<td>1352</td>
<td>Lotus Domino邮件服务</td>
<td>爆破：弱口令、信息泄漏：源代码</td>
</tr>
<tr>
<td>1433</td>
<td>MSSQL</td>
<td>注入、SA弱口令爆破、提权</td>
</tr>
<tr>
<td>1521</td>
<td>Oracle</td>
<td>注入、TNS爆破</td>
</tr>
<tr>
<td>2049</td>
<td>NFS</td>
<td>配置不当</td>
</tr>
<tr>
<td>2181</td>
<td>ZooKeeper服务</td>
<td>未授权访问</td>
</tr>
<tr>
<td>3306</td>
<td>MySQL</td>
<td>注入、爆破、写shell、提权</td>
</tr>
<tr>
<td>3389</td>
<td>RDP</td>
<td>爆破、Shift后门、CVE-2019-0708远程代码执行</td>
</tr>
<tr>
<td>4848</td>
<td>GlassFish控制台</td>
<td>爆破：控制台弱口令、认证绕过</td>
</tr>
<tr>
<td>5000</td>
<td>Sybase/DB2数据库</td>
<td>爆破、注入</td>
</tr>
<tr>
<td>5432</td>
<td>PostgreSQL</td>
<td>爆破弱口令、高权限执行系统命令</td>
</tr>
<tr>
<td>5632</td>
<td>PcAnywhere服务</td>
<td>爆破弱口令</td>
</tr>
<tr>
<td>5900</td>
<td>VNC</td>
<td>爆破：弱口令、认证绕过</td>
</tr>
<tr>
<td>6379</td>
<td>Redis</td>
<td>未授权访问、爆破弱口令</td>
</tr>
<tr>
<td>7001</td>
<td>WebLogic中间件</td>
<td>反序列化、控制台弱口令+部署war包、SSRF</td>
</tr>
<tr>
<td>8000</td>
<td>jdwp</td>
<td>JDWP 远程命令执行漏洞（<a target="_blank" rel="noopener" href="https://github.com/IOActive/jdwp-shellifier">工具</a>）</td>
</tr>
<tr>
<td>8080/8089</td>
<td>Tomcat/JBoss/Resin/Jetty/Jenkins</td>
<td>反序列化、控制台弱口令、未授权</td>
</tr>
<tr>
<td>8161</td>
<td>ActiveMQ</td>
<td>admin/admin、任意文件写入、反序列化</td>
</tr>
<tr>
<td>8069</td>
<td>Zabbix</td>
<td>远程命令执行</td>
</tr>
<tr>
<td>9043</td>
<td>WebSphere控制台</td>
<td>控制台弱口令<a target="_blank" rel="noopener" href="https://blog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/01.%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/1.%E8%B5%84%E4%BA%A7%E6%94%B6%E9%9B%86/03.ip%E6%AE%B5%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/07.%E7%AB%AF%E5%8F%A3%E5%AF%B9%E5%BA%94%E6%B8%97%E9%80%8F%EF%BC%88%E7%AB%AF%E5%8F%A3%E6%B8%97%E9%80%8F%E5%A4%87%E5%BF%98%E5%BD%95%EF%BC%89.html">https://:9043/ibm/console/logon.jsp、远程代码执行</a></td>
</tr>
<tr>
<td>9200/9300</td>
<td>Elasticsearch服务</td>
<td>远程代码执行</td>
</tr>
<tr>
<td>11211</td>
<td>Memcache</td>
<td>未授权访问（nc -vv 目标 11211）</td>
</tr>
<tr>
<td>27017</td>
<td>MongoDB</td>
<td>未授权访问、爆破弱口令</td>
</tr>
<tr>
<td>50000</td>
<td>SAP</td>
<td>远程代码执行</td>
</tr>
<tr>
<td>50070</td>
<td>hadoop</td>
<td>未授权访问</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th><strong>端口号</strong></th>
<th><strong>服务</strong></th>
<th><strong>渗透思路</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>21</td>
<td>FTP/TFTP/VSFTPD</td>
<td>爆破/嗅探/溢出/后门</td>
</tr>
<tr>
<td>22</td>
<td>ssh远程连接</td>
<td>爆破/openssh漏洞</td>
</tr>
<tr>
<td>23</td>
<td>Telnet远程连接</td>
<td>爆破/嗅探/弱口令</td>
</tr>
<tr>
<td>25</td>
<td>SMTP邮件服务</td>
<td>邮件伪造</td>
</tr>
<tr>
<td>53</td>
<td>DNS域名解析系统</td>
<td>域传送/劫持/缓存投毒/欺骗</td>
</tr>
<tr>
<td>67/68</td>
<td>dhcp服务</td>
<td>劫持/欺骗</td>
</tr>
<tr>
<td>110</td>
<td>pop3</td>
<td>爆破/嗅探</td>
</tr>
<tr>
<td>139</td>
<td>Samba服务</td>
<td>爆破/未授权访问/远程命令执行</td>
</tr>
<tr>
<td>143</td>
<td>Imap协议</td>
<td>爆破161SNMP协议爆破/搜集目标内网信息</td>
</tr>
<tr>
<td>389</td>
<td>Ldap目录访问协议</td>
<td>注入/未授权访问/弱口令</td>
</tr>
<tr>
<td>445</td>
<td>smb</td>
<td>ms17-010/端口溢出</td>
</tr>
<tr>
<td>512/513/514</td>
<td>Linux Rexec服务</td>
<td>爆破/Rlogin登陆</td>
</tr>
<tr>
<td>873</td>
<td>Rsync服务</td>
<td>文件上传/未授权访问</td>
</tr>
<tr>
<td>1080</td>
<td>socket</td>
<td>爆破</td>
</tr>
<tr>
<td>1352</td>
<td>Lotus domino邮件服务</td>
<td>爆破/信息泄漏</td>
</tr>
<tr>
<td>1433</td>
<td>mssql</td>
<td>爆破/注入/SA弱口令</td>
</tr>
<tr>
<td>1521</td>
<td>oracle</td>
<td>爆破/注入/TNS爆破/反弹shell2049Nfs服务配置不当</td>
</tr>
<tr>
<td>2181</td>
<td>zookeeper服务</td>
<td>未授权访问</td>
</tr>
<tr>
<td>2375</td>
<td>docker remote api</td>
<td>未授权访问</td>
</tr>
<tr>
<td>3306</td>
<td>mysql</td>
<td>爆破/注入</td>
</tr>
<tr>
<td>3389</td>
<td>Rdp远程桌面链接</td>
<td>爆破/shift后门</td>
</tr>
<tr>
<td>4848</td>
<td>GlassFish控制台</td>
<td>爆破/认证绕过</td>
</tr>
<tr>
<td>5000</td>
<td>sybase/DB2数据库</td>
<td>爆破/注入/提权</td>
</tr>
<tr>
<td>5432</td>
<td>postgresql</td>
<td>爆破/注入/缓冲区溢出</td>
</tr>
<tr>
<td>5632</td>
<td>pcanywhere服务</td>
<td>抓密码/代码执行</td>
</tr>
<tr>
<td>5900</td>
<td>vnc</td>
<td>爆破/认证绕过</td>
</tr>
<tr>
<td>6379</td>
<td>Redis数据库</td>
<td>未授权访问/爆破</td>
</tr>
<tr>
<td>7001/7002</td>
<td>weblogic</td>
<td>java反序列化/控制台弱口令</td>
</tr>
<tr>
<td>80/443</td>
<td>http/https</td>
<td>web应用漏洞/心脏滴血</td>
</tr>
<tr>
<td>8069</td>
<td>zabbix服务</td>
<td>远程命令执行/注入</td>
</tr>
<tr>
<td>8161</td>
<td>activemq</td>
<td>弱口令/写文件</td>
</tr>
<tr>
<td>8080/8089</td>
<td>Jboss/Tomcat/Resin</td>
<td>爆破/PUT文件上传/反序列化</td>
</tr>
<tr>
<td>8083/8086</td>
<td>influxDB</td>
<td>未授权访问</td>
</tr>
<tr>
<td>9000</td>
<td>fastcgi</td>
<td>远程命令执行</td>
</tr>
<tr>
<td>9090</td>
<td>Websphere</td>
<td>控制台爆破/java反序列化/弱口令</td>
</tr>
<tr>
<td>9200/9300</td>
<td>elasticsearch</td>
<td>远程代码执行</td>
</tr>
<tr>
<td>11211</td>
<td>memcached</td>
<td>未授权访问</td>
</tr>
<tr>
<td>27017/27018</td>
<td>mongodb</td>
<td>未授权访问/爆破</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th><strong>端口号</strong></th>
<th><strong>服务</strong></th>
<th><strong>渗透思路</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>20</td>
<td>ftp_data</td>
<td>爆破、嗅探、溢出、后门</td>
</tr>
<tr>
<td>21</td>
<td>ftp_control</td>
<td>爆破、嗅探、溢出、后门</td>
</tr>
<tr>
<td>23</td>
<td>telnet</td>
<td>爆破、嗅探</td>
</tr>
<tr>
<td>25</td>
<td>smtp</td>
<td>邮件伪造</td>
</tr>
<tr>
<td>53</td>
<td>DNS</td>
<td>DNS区域传输、DNS劫持、DNS缓存投毒、DNS欺骗、深度利用：利用DNS隧道技术刺透防火墙</td>
</tr>
<tr>
<td>67</td>
<td>dhcp</td>
<td>劫持、欺骗</td>
</tr>
<tr>
<td>68</td>
<td>dhcp</td>
<td>劫持、欺骗</td>
</tr>
<tr>
<td>110</td>
<td>pop3</td>
<td>爆破</td>
</tr>
<tr>
<td>139</td>
<td>samba</td>
<td>爆破、未授权访问、远程代码执行</td>
</tr>
<tr>
<td>143</td>
<td>imap</td>
<td>爆破</td>
</tr>
<tr>
<td>161</td>
<td>snmp</td>
<td>爆破</td>
</tr>
<tr>
<td>389</td>
<td>ldap</td>
<td>注入攻击、未授权访问</td>
</tr>
<tr>
<td>512</td>
<td>linux r</td>
<td>直接使用rlogin</td>
</tr>
<tr>
<td>513</td>
<td>linux r</td>
<td>直接使用rlogin</td>
</tr>
<tr>
<td>514</td>
<td>linux r</td>
<td>直接使用rlogin</td>
</tr>
<tr>
<td>873</td>
<td>rsync</td>
<td>未授权访问</td>
</tr>
<tr>
<td>888</td>
<td>BTLINUX</td>
<td>宝塔Linux主机管理后台/默认帐户：admin｜默认密码：admin</td>
</tr>
<tr>
<td>999</td>
<td>PMA</td>
<td>护卫神佩带的phpmyadmin管理后台，默认帐户：root｜默认密码：<a target="_blank" rel="noopener" href="http://huweishen.com">huweishen.com</a></td>
</tr>
<tr>
<td>1080</td>
<td>socket</td>
<td>爆破：进行内网渗透</td>
</tr>
<tr>
<td>1352</td>
<td>lotus</td>
<td>爆破：弱口令、信息泄露：源代码</td>
</tr>
<tr>
<td>1433</td>
<td>mssql</td>
<td>爆破：使用系统用户登录、注入攻击</td>
</tr>
<tr>
<td>1521</td>
<td>oracle</td>
<td>爆破：TNS、注入攻击</td>
</tr>
<tr>
<td>2049</td>
<td>nfs</td>
<td>配置不当</td>
</tr>
<tr>
<td>2181</td>
<td>zookeeper</td>
<td>未授权访问</td>
</tr>
<tr>
<td>3306</td>
<td>mysql</td>
<td>爆破、拒绝服务、注入</td>
</tr>
<tr>
<td>3389</td>
<td>rdp</td>
<td>爆破、Shift后门</td>
</tr>
<tr>
<td>4848</td>
<td>glassfish</td>
<td>爆破：控制台弱口令、认证绕过</td>
</tr>
<tr>
<td>5000</td>
<td>sybase/DB2</td>
<td>爆破、注入</td>
</tr>
<tr>
<td>5432</td>
<td>postgresql</td>
<td>缓冲区溢出、注入攻击、爆破：弱口令</td>
</tr>
<tr>
<td>5632</td>
<td>pcanywhere</td>
<td>拒绝服务、代码执行</td>
</tr>
<tr>
<td>5900</td>
<td>vnc</td>
<td>爆破：弱口令、认证绕过</td>
</tr>
<tr>
<td>5901</td>
<td>vnc</td>
<td>爆破：弱口令、认证绕过</td>
</tr>
<tr>
<td>5902</td>
<td>vnc</td>
<td>爆破：弱口令、认证绕过</td>
</tr>
<tr>
<td>6379</td>
<td>redis</td>
<td>未授权访问、爆破：弱口令</td>
</tr>
<tr>
<td>7001</td>
<td>weblogic</td>
<td>JAVA反序列化、控制台弱口令、控制台部署webshell</td>
</tr>
<tr>
<td>7002</td>
<td>weblogic</td>
<td>JAVA反序列化、控制台弱口令、控制台部署webshell</td>
</tr>
<tr>
<td>80</td>
<td>web</td>
<td>常见Web攻击、控制台爆破、对应服务器版本漏洞</td>
</tr>
<tr>
<td>443</td>
<td>web</td>
<td>常见Web攻击、控制台爆破、对应服务器版本漏洞</td>
</tr>
<tr>
<td>8080</td>
<td>web｜Tomcat｜…</td>
<td>常见Web攻击、控制台爆破、对应服务器版本漏洞、Tomcat漏洞</td>
</tr>
<tr>
<td>8069</td>
<td>zabbix</td>
<td>远程命令执行</td>
</tr>
<tr>
<td>9090</td>
<td>websphere</td>
<td>文件泄露、爆破：控制台弱口令、Java反序列</td>
</tr>
<tr>
<td>9200</td>
<td>elasticsearch</td>
<td>未授权访问、远程代码执行</td>
</tr>
<tr>
<td>9300</td>
<td>elasticsearch</td>
<td>未授权访问、远程代码执行</td>
</tr>
<tr>
<td>11211</td>
<td>memcacache</td>
<td>未授权访问</td>
</tr>
<tr>
<td>27017</td>
<td>mongodb</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>27018</td>
<td>mongodb</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>50070</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>50075</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>14000</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>8480</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>8088</td>
<td>web</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>50030</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>50060</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>60010</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>60030</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>10000</td>
<td>Virtualmin/Webmin</td>
<td>服务器虚拟主机管理系统</td>
</tr>
<tr>
<td>10003</td>
<td>Hadoop</td>
<td>爆破、未授权访问</td>
</tr>
<tr>
<td>5984</td>
<td>couchdb</td>
<td>未授权访问</td>
</tr>
<tr>
<td>445</td>
<td>SMB</td>
<td>弱口令爆破，检测是否有ms_08067等溢出</td>
</tr>
<tr>
<td>1025</td>
<td>111</td>
<td>NFS</td>
</tr>
<tr>
<td>2082</td>
<td></td>
<td>cpanel主机管理系统登陆 （国外用较多）</td>
</tr>
<tr>
<td>2083</td>
<td></td>
<td>cpanel主机管理系统登陆 （国外用较多）</td>
</tr>
<tr>
<td>2222</td>
<td></td>
<td>DA虚拟主机管理系统登陆 （国外用较多）</td>
</tr>
<tr>
<td>2601</td>
<td></td>
<td>zebra路由</td>
</tr>
<tr>
<td>2604</td>
<td></td>
<td>zebra路由</td>
</tr>
<tr>
<td>3128</td>
<td></td>
<td>代理默认端口,如果没设置口令很可能就直接漫游内网了</td>
</tr>
<tr>
<td>3311</td>
<td></td>
<td>kangle主机管理系统登陆</td>
</tr>
<tr>
<td>3312</td>
<td></td>
<td>kangle主机管理系统登陆</td>
</tr>
<tr>
<td>4440</td>
<td></td>
<td>参考WooYun: 借用新浪某服务成功漫游新浪内网</td>
</tr>
<tr>
<td>6082</td>
<td></td>
<td>参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致网站被直接篡改或者作为代理进入内网</td>
</tr>
<tr>
<td>7778</td>
<td></td>
<td>主机控制面板登录</td>
</tr>
<tr>
<td>8083</td>
<td></td>
<td>主机管理系统 （国外用较多）</td>
</tr>
<tr>
<td>8649</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8888</td>
<td></td>
<td>主机管理系统默认端口</td>
</tr>
<tr>
<td>9000</td>
<td></td>
<td>fcgi php执行</td>
</tr>
<tr>
<td>50000</td>
<td>SAP</td>
<td>命令执行</td>
</tr>
</tbody>
</table>
<h2 id="网络架构探测">网络架构探测</h2>
<p>当我们探测目标站点网站架构时，比如说：操作系统，中间件，脚本语言，数据库，服务器，web容器等等，可以使用以下方法查询。</p>
<h3 id="cms识别">CMS识别</h3>
<p>识别 CMS 的目的在于，方便利用已公开漏洞进行渗透测试，甚至可以到对应 CMS 的官网下载对应版本的 CMS 进行本地白盒代码审计。</p>
<blockquote>
<p>（1）wappalyzer插件——火狐插件</p>
<p>（2）云悉：<a target="_blank" rel="noopener" href="http://www.yunsee.cn/">http://www.yunsee.cn/</a>   —不过这个邀请码有点。。。。</p>
<p>（3）CMS指纹识别：<a target="_blank" rel="noopener" href="http://whatweb.bugscaner.com/look/">http://whatweb.bugscaner.com/look/</a> ——但这个似乎不能用了</p>
</blockquote>
<p>CMS指纹识别又有很多方法，比如说御剑指纹识别、Webrobot工具、whatweb工具、还有在线查询的网站等等。</p>
<h3 id="服务器信息搜集">服务器信息搜集</h3>
<p>服务版本识别、操作系统信息识别都可以利用 nmap 实现识别</p>
<pre><code class="hljs shell">nmap -sV -p 1-65535 x.x.x.xnmap -O x.x.x.x</code></pre>
<h3 id="特定关键字识别">特定关键字识别</h3>
<p>CMS 的首页文件、特定文件可能包含了 CMS 类型及版本信息，通过访问这些文件，将返回的网页信息（如 Powered by XXCMS）与扫描工具数据库存储的指纹信息进行正则匹配，判断 CMS 的类型。</p>
<p>也可能前端源码中或 meta 标签中的 content 字段存在一些 CMS 特征信息，下图很明显能得知是 WordPress 框架</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106180713688.png" alt="image-20240106180713688"></p>
<h3 id="特定文件及路径识别">特定文件及路径识别</h3>
<p>不同的 CMS 会有不同的网站结构及文件名称，可以通过特定文件及路径识别 CMS。如 WordPress 会有特定的文件路径 /wp-admin、/wp-includes 等，有些 CMS 的 robots.txt 文件也可能包含了 CMS 特定的文件路径，与扫描工具数据库存储的指纹信息进行正则匹配，判断 CMS 的类型。</p>
<p>CMS 会有一些 JS、CSS、图片等<strong>静态文件</strong>，这些文件一般不会变化，可以利用这些特定文件的 MD5 值作为指纹信息来判断 CMS 的类型。</p>
<h3 id="响应头信息识别">响应头信息识别</h3>
<p>应用程序会在响应头 Server、X-Powered-By、Set-Cookie 等字段中返回 Banner 信息或者自定义的数据字段，通过响应头返回的信息，可以对应用进行识别，有些 WAF 设备也可以通过响应头信息进行识别判断。当然 Banner 信息并不一定是完全准确的，应用程序可以自定义自己的 Banner 信息。</p>
<p>例如 Shiro 的响应头信息中包含 rememberMe 字段：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106180837983.png" alt="image-20240106180837983"></p>
<h3 id="常见脚本工具">常见脚本工具</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/s7ckTeam/Glass">https://github.com/s7ckTeam/Glass</a></p>
<p>Glass是一款针对资产列表的快速指纹识别工具，通过调用Fofa/ZoomEye/Shodan/360等api接口快速查询资产信息并识别重点资产的指纹，也可针对IP/IP段或资产列表进行快速的指纹识别。</p>
<p>Glass旨在帮助红队人员在资产信息收集期间能够快速从C段、大量杂乱的资产中精准识别到易被攻击的系统，从而实施进一步测试攻击。</p>
<p>还有两款只支持如 WordPress, Joomla, Drupal 的工具</p>
<p>CMSScan：<a target="_blank" rel="noopener" href="https://github.com/ajinabraham/CMSScan">https://github.com/ajinabraham/CMSScan</a></p>
<p>CMSmap：<a target="_blank" rel="noopener" href="https://github.com/Dionach/CMSmap">https://github.com/Dionach/CMSmap</a></p>
<p>还有一些其他优秀Github项目</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Tuhinshubhra/CMSeeK">CMSeeK</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Dionach/CMSmap">CMSmap</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/aedoo/ACMSDiscovery">ACMSDiscovery</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/TideSec/TideFinger">TideFinger</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Lucifer1993/AngelSword">AngelSword</a></li>
</ul>
<h3 id="数字观星平台">数字观星平台</h3>
<p><a target="_blank" rel="noopener" href="https://fp.shuziguanxing.com/#/">https://fp.shuziguanxing.com/#/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106190841702.png" alt="image-20240106190841702"></p>
<h3 id="waf识别">WAF识别</h3>
<p>Waf也叫Web应用防火墙，是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一款产品。Waf的探测很多人都会忽略掉</p>
<p>主要有两种手法吧，一种是手动，一种是工具；知道了是否有WAF，用的什么WAF，我们才好对症下药</p>
<p>手动的话：一般来说WAF都会拦截敏感文件下载，如<code>a.sql</code>、<code>a.mdb</code>等，直接添加到网站URL中即可</p>
<p>一些WAF可能不防护这些，那么就可以拿一些XSS、SQLI的payload来测试也可（贴个图）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106191110508.png" alt="image-20240106191110508"></p>
<p>还有就是靠工具识别：wafw00f：<a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106191404217.png" alt="image-20240106191404217"></p>
<p>还有Nmap神器：探测WAF有两种脚本。</p>
<p>一种是http-waf-detect。</p>
<pre><code class="hljs scss">nmap  -p80,<span class="hljs-number">443</span>  <span class="hljs-attr">--script</span>=http-waf-detect  ip</code></pre>
<p>一种是http-waf-fingerprint。</p>
<pre><code class="hljs scss">nmap  -p80,<span class="hljs-number">443</span>  <span class="hljs-attr">--script</span>=http-waf-fingerprint  ip</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106191658297.png" alt="image-20240106191658297"></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8F060FU9g_78z57UKS-JsQ">30几款常见WAF的拦截页整理</a></p>
<h2 id="其他应用收集">其他应用收集</h2>
<h3 id="小程序">小程序</h3>
<p>企查查等：找到小程序点击即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106212813758.png" alt="image-20240106212813758"></p>
<p>微信APP</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106212905850.png" alt="image-20240106212905850"></p>
<p>支付宝APP</p>
<p>和微信类似，但是不同平台因为不同的规则，可能有一点点差异  ——这里贴个别的师傅的图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106212944804.png" alt="image-20240106212944804"></p>
<h3 id="公众号">公众号</h3>
<ul>
<li>企查查：<a target="_blank" rel="noopener" href="https://www.qcc.com/">https://www.qcc.com/</a></li>
<li>天眼查：<a target="_blank" rel="noopener" href="https://www.tianyancha.com/">https://www.tianyancha.com/</a></li>
</ul>
<p>直接搜索相应公司，在菜单栏中找到微信公众号 ——和上面查小程序一般</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213034093.png" alt="image-20240106213034093"></p>
<p>依旧还可以用微信搜索，这里那位师傅说还可以用搜狗微信：<a target="_blank" rel="noopener" href="https://weixin.sogou.com/">https://weixin.sogou.com/</a> ——但我搜不出来。。</p>
<p>先贴个图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213241089.png" alt="image-20240106213241089"></p>
<h3 id="生活号">生活号</h3>
<p>感觉有点类似微信上的公众号，也是通过支付宝APP搜索即可</p>
<h3 id="app搜集">APP搜集</h3>
<p>收集到APP，可以测正常功能，也可以对它进行反编译查看源码，可能获取一些敏感的接口等信息。</p>
<p>tips：不仅要收集最新版，还要收集历史版本的APP，可能存在敏感信息，也有可能存在有漏洞的历史接口。</p>
<p>七麦数据</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.qimai.cn/">https://www.qimai.cn/</a></p>
</blockquote>
<p>直接搜索可以获取到部分相关的APP</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213524959.png" alt="image-20240106213524959"></p>
<p>但是有些较隐藏的APP直接搜名字还是搜不出来，这个时候我们就会用到七麦一个很方便的功能：<strong>同开发者APP</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213708598.png" alt="image-20240106213708598"></p>
<p>此外，还可以获取APP的历史版本，可能里面存在大量的敏感信息!!!</p>
<p>豌豆荚</p>
<p>使用豌豆荚可以方便的获取到APP的历史版本，这里就直接贴图了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213752937.png" alt="image-20240106213752937"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213759030.png" alt="image-20240106213759030"></p>
<p>企查查&amp;天眼查——依旧类似上面的小程序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213830237.png" alt="image-20240106213830237"></p>
<p>App Store</p>
<p>搜索到应用往下滑，其实也是和七麦数据找同开发者APP一样的 ——贴图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106213846866.png" alt="image-20240106213846866"></p>
<h3 id="pc应用">PC应用</h3>
<p>看看客户端的产品，可能有时候也会发现一些突破口</p>
<p>一般比较明显的官网就可以下载，可能还有一些隐藏的PC应用，或者测试版，就需要自己去寻找了</p>
<h2 id="敏感文件-敏感目录探测">敏感文件、敏感目录探测</h2>
<p>通常我们所说的敏感文件、敏感目录大概有以下几种：</p>
<blockquote>
<p>（1）Git</p>
<p>（2）hg/Mercurial</p>
<p>（3）svn/Subversion</p>
<p>（4）bzr/Bazaar</p>
<p>（5）Cvs</p>
<p>（6）WEB-INF泄露</p>
<p>（7）备份文件泄露、配置文件泄露</p>
</blockquote>
<p>敏感文件、敏感目录挖掘一般都是靠工具、脚本来找，当然大佬手工也能找得到。</p>
<h3 id="脚本工具">脚本工具</h3>
<blockquote>
<p>（1）御剑（真的很万能，文末附上全家桶）</p>
<p>（2）爬虫（AWVS、Burpsuite等）</p>
<p>（3）搜索引擎（Google、Github等）</p>
<p>（4）wwwscan</p>
<p>（5）BBscan（一位巨佬写的python脚本：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/BBScan">https://github.com/lijiejie/BBScan</a></p>
<p>（6）GSIL（也是一位巨佬写的python脚本：<a target="_blank" rel="noopener" href="https://github.com/FeeiCN/GSIL">https://github.com/FeeiCN/GSIL</a> ——不过这个工具似乎存在问题，我配置不成功</p>
<p>（7）社交平台</p>
</blockquote>
<h3 id="google-hacking">Google hacking</h3>
<blockquote>
<ul>
<li>目录遍历: site:$site intitle:index.of</li>
<li>配置文件泄露: site:$site ext:xml | ext:conf | ext:cnf | ext:reg | ext:inf | ext:rdp | ext:cfg | ext:txt | ext:ora | ext:ini</li>
<li>数据库文件泄露: site:$site ext:sql | ext:dbf | ext:mdb</li>
<li>日志文件泄露: site:$site ext:log</li>
<li>备份和历史文件: site:$site ext:bkf | ext:bkp | ext:bak | ext:old | ext:backup</li>
<li>登录页面: site:$site inurl:login</li>
<li>SQL错误: site:$site intext:“sql syntax near” | intext:“syntax error has occurred” | intext:“incorrect syntax near” | intext:“unexpected end of SQL command” | intext:“Warning: mysql_connect()” | intext:“Warning: mysql_query()” | intext:“Warning: pg_connect()”</li>
<li>公开文件信息: site:$site ext:doc | ext:docx | ext:odt | ext:pdf | ext:rtf | ext:sxw | ext:psw | ext:ppt | ext:pptx | ext:pps | ext:csv</li>
<li>phpinfo(): site:$site ext:php intitle:phpinfo “published by the PHP Group”</li>
<li>搜索粘贴站点: site:pastebin.com | site:paste2.org | site:pastehtml.com | site:slexy.org | site:snipplr.com | site:snipt.net | site:textsnip.com | site:bitpaste.app | site:justpaste.it | site:heypasteit.com | site:hastebin.com | site:dpaste.org | site:dpaste.com | site:codepad.org | site:jsitor.com | site:codepen.io | site:jsfiddle.net | site:dotnetfiddle.net | site:phpfiddle.org | site:ide.geeksforgeeks.org | site:repl.it | site:ideone.com | site:paste.debian.net | site:paste.org | site:paste.org.ru | site:codebeautify.org | site:codeshare.io | site:trello.com $site</li>
<li>搜索Github、Gitlab: site:github.com | site:gitlab.com $site.</li>
<li>在线Google Hacking利用：<a target="_blank" rel="noopener" href="https://tools.zjun.info/googlehacking/">https://tools.zjun.info/googlehacking/</a></li>
</ul>
</blockquote>
<h3 id="针对信息泄露的搜索引擎">针对信息泄露的搜索引擎</h3>
<p><a target="_blank" rel="noopener" href="https://leakix.net/">https://leakix.net/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106183000842.png" alt="image-20240106183000842"></p>
<h3 id="google-hacking-database">Google hacking database</h3>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106183134068.png" alt="image-20240106183134068"></p>
<h3 id="ffuf">ffuf</h3>
<p>项目地址：<a target="_blank" rel="noopener" href="https://github.com/ffuf/ffuf">https://github.com/ffuf/ffuf</a></p>
<pre><code class="hljs shell">ffuf -w /path/to/wordlist -u https://target/FUZZ</code></pre>
<p>字典需要自己添加，在需要fuzz的地方添加“FUZZ”</p>
<h3 id="dirmap">dirmap</h3>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/H4ckForJob/dirmap">https://github.com/H4ckForJob/dirmap</a></li>
</ul>
<p>支持递归扫描、功能将会强于DirBuster、Dirsearch、cansina、御剑</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106192543201.png" alt="image-20240106192543201"></p>
<h3 id="github语法">github语法</h3>
<p>一些语法</p>
<p>参考自：<a target="_blank" rel="noopener" href="https://github.com/obheda12/GitDorker/tree/master/Dorks">https://github.com/obheda12/GitDorker/tree/master/Dorks</a></p>
<p>所有语法txt版</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/obheda12/GitDorker/blob/master/Dorks/alldorksv3">alldorksv3</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/obheda12/GitDorker/blob/master/Dorks/medium_dorks.txt">medium_dorks</a></li>
</ul>
<p>自动化工具：<a target="_blank" rel="noopener" href="https://github.com/damit5/gitdorks_go">https://github.com/damit5/gitdorks_go</a></p>
<h3 id="历史页面">历史页面</h3>
<p>在线网站：<a target="_blank" rel="noopener" href="https://web.archive.org/">https://web.archive.org/</a></p>
<p>wayback会记录网站版本更迭，可以获取到之前版本的网站，可能会找到一些后来删除的敏感资产信息，或者一些漏洞</p>
<p><a target="_blank" rel="noopener" href="http://xn--2010qq-hp7im43i0sozq2bht5e.com">下面是2010年的qq.com</a>！！</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106193040958.png" alt="image-20240106193040958"></p>
<p>在推荐两款强力工具：</p>
<blockquote>
<p>gau：<a target="_blank" rel="noopener" href="https://github.com/lc/gau">https://github.com/lc/gau</a></p>
<p>waybackurls：<a target="_blank" rel="noopener" href="https://github.com/tomnomnom/waybackurls">https://github.com/tomnomnom/waybackurls</a></p>
</blockquote>
<h3 id="网盘信息搜集">网盘信息搜集</h3>
<p>某些安全意识薄弱的人员可能上传资料到一些网盘中，没有加密码或者密码泄露，然后被一些在线云盘抓取收录了，导致信息泄露。</p>
<p>超能搜：<a target="_blank" rel="noopener" href="https://www.chaonengsou.com/">https://www.chaonengsou.com/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106193809722.png" alt="image-20240106193809722"></p>
<p>百度网盘爬虫：<a target="_blank" rel="noopener" href="https://github.com/k1995/BaiduyunSpider">https://github.com/k1995/BaiduyunSpider</a></p>
<h3 id="邮箱信息搜集">邮箱信息搜集</h3>
<p>目前情况来看，通过web打点不一定是最优的方式，可以社工等方式同步进行；因此尽可能多的收集目标的邮箱，然后进行社工钓鱼可能大有突破</p>
<blockquote>
<p>实际过程中，我们可以尽可能的把收集到疑似网络管理员、运维人员、安全部门的人员提取出来，这些人单独写邮件或者不发，因为这些人安全意识相对较高，容易打草惊蛇，我们需要对一些非技术员工安全意识薄弱的人下手，挑软柿子捏。</p>
</blockquote>
<h4 id="寻找目标邮箱入口">寻找目标邮箱入口</h4>
<p>目标为开放的邮服端口或web邮箱入口</p>
<p>拿到目标后，先要先从MX记录域名找到他的真实ip地址（某些目标可能是第三方邮件服务器，这种情况mx记录就没有参考价值了）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106194355586.png" alt="image-20240106194355586"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106194516642.png" alt="image-20240106194516642"></p>
<p>然后针对这个ip地址的C段进行扫描（25、109、110、143、465、995、993端口）</p>
<h4 id="通过子域名">通过子域名</h4>
<p>主要是利用一些子域名收集工具，如：Subdomainbrute、ksubdomain、Oneforall、Sublist3r、TeeMO、LangSrcCurise、Layer挖掘机等</p>
<h4 id="通过搜索引擎">通过搜索引擎</h4>
<p>1、Google Hacking语法</p>
<pre><code class="hljs properties"><span class="hljs-attr">site</span>:<span class="hljs-string">target.com intitle:"Outlook Web App"</span>
<span class="hljs-attr">site</span>:<span class="hljs-string">target.com intitle:"mail"</span>
<span class="hljs-attr">site</span>:<span class="hljs-string">target.com intitle:"邮箱"</span></code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106194628133.png" alt="image-20240106194628133"></p>
<p>2、网络空间搜索引擎</p>
<ul>
<li>Shodan</li>
<li>fofa</li>
<li>zoomeye</li>
</ul>
<pre><code class="hljs properties"><span class="hljs-attr">hostname</span>:<span class="hljs-string">163.com http.title:"邮箱"</span></code></pre>
<h4 id="在线平台搜集">在线平台搜集</h4>
<p>邮箱查找工具：<a target="_blank" rel="noopener" href="https://app.snov.io/">https://app.snov.io/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106195050831.png" alt="image-20240106195050831"></p>
<p><a target="_blank" rel="noopener" href="https://phonebook.cz/">https://phonebook.cz/</a> ——还可以收集域名与url</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106195511614.png" alt="image-20240106195511614"></p>
<p><a target="_blank" rel="noopener" href="https://hunter.io/">https://hunter.io/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106195739725.png" alt="image-20240106195739725"></p>
<p><a target="_blank" rel="noopener" href="http://www.skymem.info/">http://www.skymem.info/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106195806919.png" alt="image-20240106195806919"></p>
<p><a target="_blank" rel="noopener" href="https://www.email-format.com/i/search/">https://www.email-format.com/i/search/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106195855854.png" alt="image-20240106195855854"></p>
<h4 id="工具搜集">工具搜集</h4>
<p><a target="_blank" rel="noopener" href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a> —kali自带</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106201258138.png" alt="image-20240106201258138"></p>
<p>不理解的是，总是查不出来，感觉是api的问题吧。。。</p>
<h4 id="验证邮箱">验证邮箱</h4>
<p>在经过上述的邮箱搜集之后，我们可以对邮箱进行存活性验证，检测目标邮箱是否存在被弃用的情况（离职，职位调动等）。</p>
<p><a target="_blank" rel="noopener" href="http://xn--mailtester-ym34ap2a.com">通过mailtester.com</a> ：<a target="_blank" rel="noopener" href="https://mailtester.com/">https://mailtester.com/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106201711941.png" alt="image-20240106201711941"></p>
<h4 id="邮箱爆破">邮箱爆破</h4>
<p>这种方式的弱口令爆破只适用于目标企业自己的邮件服务器如owa等 像百度腾讯阿里网易等第三方邮箱不优先考虑</p>
<p>SMTP协议爆破：medusa、hydra、SNETCracker、APT34组织 owa爆破工具等…</p>
<p>网页邮箱爆破：burpsuite等…</p>
<h3 id="js信息搜集">JS信息搜集</h3>
<p>在JS中可能会存在大量的敏感信息，包括但不限于：</p>
<ol>
<li>某些服务的接口，可以测试这些接口是否有未授权等</li>
<li>子域名，可能包含有不常见或者子域名收集过程中没收集到的目标</li>
<li>密码、secretKey等敏感数据</li>
</ol>
<h4 id="手工搜集">手工搜集</h4>
<p>可以全局搜索<code>http</code>、<code>"/</code>、这种关键词</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106201922330.png" alt="image-20240106201922330"></p>
<h4 id="利用工具">利用工具</h4>
<h4 id="jsfinder">JSFinder</h4>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Threezh1/JSFinder">https://github.com/Threezh1/JSFinder</a></p>
</blockquote>
<p>JSFinder是一款用作快速在网站的js文件中提取URL，子域名的工具用法参考项目文档，或者<code>-h</code></p>
<pre><code class="hljs scss">python JSFinder<span class="hljs-selector-class">.py</span> -u http://www.jd.com  ---简单爬取</code></pre>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106202216480.png" alt="image-20240106202216480"></p>
<h4 id="linkfinder">LinkFinder</h4>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/GerbenJavado/LinkFinder">https://github.com/GerbenJavado/LinkFinder</a></p>
</blockquote>
<p>这也是一款一直在用的工具，效果杠杠的，可以本地用，也可以集成到Burp插件里面</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106203308734.png" alt="image-20240106203308734"></p>
<h4 id="hae">Hae</h4>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/gh0stkey/HaE">https://github.com/gh0stkey/HaE</a></p>
</blockquote>
<p><strong>HaE</strong>是基于 <code>BurpSuite</code> 插件 <code>JavaAPI</code> 开发的请求高亮标记与信息提取的辅助型插件。基于正则表达式，除了提取敏感信息，也可以提取页面中的链接等</p>
<p>贴个图：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106203624150.png" alt="image-20240106203624150"></p>
<h3 id="社会工程学">社会工程学</h3>
<p>社会工程学收集的信息有很多，包含网络 ID（现用和曾用）、真实姓名、手机号、电子邮箱、出生日期、身份证号、银行卡、支付宝账号、QQ 号、微信号、家庭地址、注册网站（贴吧、微博、人人网等）等信息。</p>
<p>在目标相关网页中可能会存在招聘信息、客服联系等，可以利用招聘或客服聊天的方式进行钓鱼、木马植入等。</p>
<p>搜集到相关的人员信息后可以制作社工字典，有如下在线或本地工具：</p>
<pre><code class="hljs plaintext">bugku密码攻击器：https://www.bugku.com/mima/
白鹿社工字典生成器：https://github.com/z3r023/BaiLu-SED-Tool</code></pre>
<p>还有一些社工机器人：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://t.me/DogeSGK_bot?start=348315174">狗狗免费社工机器人</a></li>
<li><a target="_blank" rel="noopener" href="https://t.me/DATA_007bot?start=1d7b32db6a">DATA007</a></li>
<li><a target="_blank" rel="noopener" href="https://t.me/pingansgk_bot?start=567fbc7aa9">平安社工库</a></li>
<li><a target="_blank" rel="noopener" href="https://t.me/aishegongkubot?start=AISGK_FW5KQHNC">AISGK</a>：数据相对比较全，但是需要推广一定人才能用！</li>
</ul>
<p>社工密码生成：<a target="_blank" rel="noopener" href="https://github.com/zgjx6/SocialEngineeringDictionaryGenerator">https://github.com/zgjx6/SocialEngineeringDictionaryGenerator</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="image-20240106204906648.png" alt="image-20240106204906648"></p>
<h2 id="目标域名邮箱收集">目标域名邮箱收集</h2>
<p>一定要养成收集站点邮箱账号收集的习惯（因为好多官方后台都是用内部邮箱账号登录的，指不定哪天你就得到一个进后台的机会）。</p>
<blockquote>
<p>（1）通过说明文档以及网站页面收集，或者网站发表者以及留言板信息处收集账号</p>
<p>（2）通过 teemo，metago，burpusit，awvs，netspker 或者 google 语法收集</p>
<p>（3）搜索相关 QQ 群收集相关企业员工的社交账号</p>
</blockquote>
<p>用途： 可用来进行爆破或者弱口令登录以及撞裤攻击。</p>
<h1 id="0x04-外网打点基本流程">0x04 外网打点基本流程</h1>
<p>经过以上的学习，接下来跟着文章梳理一遍打点的流程</p>
<h2 id="step-one">Step One</h2>
<h3 id="主域名收集">主域名收集</h3>
<p>先收集目标的各种主域名（包括子公司、app、小程序、公众号等）</p>
<blockquote>
<p>工具：备案反查域名(icp_domans等)、企查查、…</p>
</blockquote>
<h3 id="收集子域名">收集子域名</h3>
<p>配置好api的oneforall 、masscan、fscan等等工具，获得比较全的子域名</p>
<h3 id="获取真实ip与c段">获取真实IP与C段</h3>
<p>对于子域名，获取其真实ip和C段 （C段量大、比较分散的话，可以放到后面再看）</p>
<pre><code class="hljs scss">可能很大一部分ip是CDN，快速过滤掉CDN ip,以及做一些简单的绕过（时间充足的话，对重点域名详细绕过，寻找真实ip)

工具：
Eeyes（快速筛选真实IP并整理为C段,网络条件好的话，准确率挺高的）
fcdn https://github.com/ccc-f/FCDN
https://github.com/mabangde/cdncheck_cn

国外可以使用cdncheck：（可检测CDN、WAF、云，国内基本没啥用）
type ip.txt | cdncheck.exe -resp -cdn (再过滤一遍Eeyes输出的真实ip结果)</code></pre>
<h3 id="获取对应的资产">获取对应的资产</h3>
<p>获取ip和C段信息对应的资产</p>
<pre><code class="hljs scss">通过fofa等快速获取ip和C段信息对应的资产
(相关工具：https://github.com/zhizhuoshuma/Assetstocollect )

再通过fofa语法搜一遍主域对应的资产信息： domain="xxx<span class="hljs-selector-class">.com</span>"

时间充足的话，对ip和C段信息进行全端口扫描，获取更多资产</code></pre>
<h3 id="子域名探活">子域名探活</h3>
<p>对子域名进行探活，获取web资产信息</p>
<pre><code class="hljs scss">httpx 等，可以增加一下常用的端口

探活有时候不太准确，漏掉一些，可以将所有子域前面增加`http://` `https://` 进行一遍识别

探活可以跟指纹识别一起进行</code></pre>
<h3 id="整理资产指纹识别">整理资产，指纹识别</h3>
<p>整合所有web资产，进行指纹识别</p>
<pre><code class="hljs scss">通过子域名获得的web资产 + fofa ip/C段(ip="<span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span>" or ip="<span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span>/<span class="hljs-number">24</span>") + fofa domain="xxx<span class="hljs-selector-class">.com</span>"等等 获得的web资产进行整合

整合后通过 <span class="hljs-built_in">ehole</span>(扩充指纹) 等，进行指纹识别

云溪、wappalyzergo、tidefinger （只能单个url）</code></pre>
<h3 id="web资产漏扫">web资产漏扫</h3>
<p>根据目标的防护情况，选择漏扫工具：</p>
<pre><code class="hljs scss">快速：fscan

完备：
<span class="hljs-number">1</span>、nuclei
	整合POC：
		自带
		整合一些其他的
		爬虫(katana等）+fuzzing-templates（https://github.com/projectdiscovery/fuzzing- templates） or https://github.com/<span class="hljs-number">0</span>xKayala/NucleiFuzzer
            
<span class="hljs-number">2</span>、afrog (<span class="hljs-number">1000</span>个左右poc)
            
<span class="hljs-number">3</span>、爬虫+xray
            
补充：
vscan、sweetbaby</code></pre>
<h3 id="ip和c段的高危端口利用">IP和C段的高危端口利用</h3>
<pre><code class="hljs scss">一些非web端口，如ftp ssh 各种数据库 rdp 之类的

弱口令、历史漏洞</code></pre>
<h3 id="web资产目录扫描">web资产目录扫描</h3>
<pre><code class="hljs scss">dirsearch ，可以先只扫<span class="hljs-number">200</span>，可以在前面就先挂上

备份文件扫描（主要针对一些自建的站）

针对重点资产，手工测试的时候再进行深入扫描</code></pre>
<h3 id="敏感web资产深入挖掘">敏感Web资产，深入挖掘</h3>
<pre><code class="hljs scss">登录/注册/敏感框架、组件、服务等：

<span class="hljs-selector-tag">i</span>)指纹识别和POC可能不够完备，针对一些产品，手工识别并找一些历史漏洞测试
ii)重点关注 反序列化、文件上传、SQL注入 漏洞，详细挖掘一下
iii) 登录点爆破，可以收集目标邮箱和社工字典
iv)根据目录扫描结果，对有东西的站深入看一下
v)有充足时间，可以像挖<span class="hljs-attribute">SRC</span>一样对一些站深入挖掘一下。（urlfiner、js接口、爬虫的敏感链接之类。）

测试时，burp插件安装完备(strut2、shiro、fastjson、log4j2、spring、SQL注入相关等)都打开，
同时，有条件可以挂着xray被动(xray可以只用来测sql注入)

java站基本是strut2和spring 二选一，有时间都打一遍poc，同时要注意log4j2漏洞一定要测一下
（工具：SpringBoot-Scan-<span class="hljs-number">2.03</span>、Spring_All_Reachable、struts2_19<span class="hljs-selector-class">.jar</span>）
(log4j2一般使用burp插件:https://github.com/whwlsfb/Log4j2Scan)

工具：
智能 Web后台密码爆破工具 https://github.com/Fly-Playgroud/Boom 可以批量爆破web后台</code></pre>
<p>小tips：备份文件扫描可以提前</p>
<pre><code class="hljs scss"><span class="hljs-selector-tag">i</span>)对一些自建站点，可以进行备份文件扫描，找到备份文件，审源码

ii)通过google、github、fofa ico/证书/关键字/title="单位名"等，收集更多资产或者泄露信息

iii)对于一些小众产品，可以通过fofa等，找其他人使用的，可能在用低版本或者有备份文件，拿到源码去审
计</code></pre>
<h3 id="app-小程序-公众号">app、小程序、公众号</h3>
<p>对发现的app、小程序、公众号进行进一步的探测，类比web探测进行</p>
<h2 id="step-second">Step Second</h2>
<h3 id="收集目标">收集目标</h3>
<p>上下游公司、供应链、IDC、IDC代理商等信息，重复第一轮的步骤。</p>
<pre><code class="hljs plaintext">用收集到的邮箱再去反查一波，就能找到一部分了，然后去相关备案网站再找一部分，剩下的就是通过爬取相关新闻、超链接、年报，从里面找跟他业务相关的公司</code></pre>
<h1 id="0x05-后记">0x05 后记</h1>
<p>这几天忙得要死来不及学习。今天大概学习完了，回顾之前的学习历程，感觉是有点抽象的，毕竟感觉在纸上谈兵，学的有点没激情，但这却是后面进一步深入的基础，必须啃下来。</p>
<p>经过上述的学习，对渗透测试以及打点流程有了认识，但日后能实施于实践才算成功，只能说任重道远。总的来说对于上述的流程是有认识了，但对于工具和平台等的使用还是有点懵的，被强行喂了一通知识，但却没有好好消化，因此在今后应该多实战熟悉工具的利用，进一步熟悉渗透测试流程（水很深啊~~~）</p>
<p>之后在看一看st3pby师傅给的实战打点文章，看看佬们的骚操作。本篇文章日后肯定也会更新的（毕竟质量有点差）希望不断完善，形成一个优美的信息搜集知识库！</p>
<h1 id="0x06-参考文章">0x06 参考文章</h1>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/7075240551456440333">Web安全渗透测试基本流程</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">d4m1ts 知识库</a></p>
<p><a target="_blank" rel="noopener" href="https://www.wangan.com/p/7fy7fy135d85fec8#DNS%E5%9F%9F%E4%BC%A0%E9%80%81%E5%8F%91%E7%8E%B0%E5%AD%90%E5%9F%9F%E5%90%8D">干货 | 最全Web 渗透测试信息搜集-CheckList</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/database/195169.html">全流程信息收集方法总结</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40748006/article/details/106328924?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=dig%E5%91%BD%E4%BB%A4&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-106328924.142%5Ev99%5Epc_search_result_base4&amp;spm=1018.2226.3001.4187">DNS篇之dig使用详解 </a>  ——很详细</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41982020/article/details/121231166?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170410967216800213037345%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170410967216800213037345&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-121231166-null-null.142%5Ev99%5Epc_search_result_base4&amp;utm_term=dig%E5%91%BD%E4%BB%A4&amp;spm=1018.2226.3001.4187">dig命令的介绍与使用</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/laoxu/1282773">DNS服务系列之一：泛域名解析的安全案例</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hls-code/p/16808977.html">nslookup命令详解：nslookup是一种网络管理命令行工具</a></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">hybcx</div><div class="post-copyright__author_desc">只需热爱, 未来可期！</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/')">渗透测试流程&amp;外网打点</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=渗透测试流程&amp;外网打点&amp;url=http://hybcx.xyz/2023/12/31/shen-tou-ce-shi-wai-wang-da-dian/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hybcx.xyz" target="_blank">hybcx</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>内网渗透<span class="tagsPageCount">3</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/12/27/ssrf-da-redis/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ssrf打redis</div></div></a></div><div class="next-post pull-right"><a href="/2024/01/10/shen-ru-dvwa/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">重温DVWA</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2023/09/05/nei-wang-shen-tou-xue-xi-ji-chu-pian/" title="内网渗透学习-基础知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-09-05</div><div class="title">内网渗透学习-基础知识</div></div></a></div><div><a href="/2023/09/03/nei-wang-shen-tou-xue-xi-windows-xin-xi-sou-ji-pian/" title="内网渗透学习-Windows信息搜集篇-持续更新"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-09-03</div><div class="title">内网渗透学习-Windows信息搜集篇-持续更新</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408162252382.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">hybcx</h1><div class="author-info__desc">只需热爱, 未来可期！</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/hybchenxing" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/1761635300" target="_blank" title="Email"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01 前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">0x02 渗透测试基本流程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#21-%E7%A1%AE%E5%AE%9A%E7%9B%AE%E6%A0%87"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 确定目标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E7%9A%84%E7%A1%AE%E5%AE%9A"><span class="toc-number">2.1.1.</span> <span class="toc-text">范围的确定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E7%9A%84%E7%A1%AE%E5%AE%9A"><span class="toc-number">2.1.2.</span> <span class="toc-text">规则的确定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E7%9A%84%E7%A1%AE%E5%AE%9A"><span class="toc-number">2.1.3.</span> <span class="toc-text">需求的确定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E5%88%86%E6%9E%90%E9%A3%8E%E9%99%A9%E8%8E%B7%E5%BE%97%E6%8E%88%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 分析风险，获得授权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E6%BC%8F%E6%B4%9E%E6%8E%A2%E6%B5%8B%E6%89%8B%E5%8A%A8amp%E8%87%AA%E5%8A%A8"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 漏洞探测（手动&amp;自动）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B%E6%96%B9%E6%B3%95"><span class="toc-number">2.4.1.</span> <span class="toc-text">探测方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A2%E6%B5%8B%E5%86%85%E5%AE%B9"><span class="toc-number">2.4.2.</span> <span class="toc-text">探测内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 漏洞验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-%E4%BF%A1%E6%81%AF%E5%88%86%E6%9E%90"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 信息分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#27-%E5%88%A9%E7%94%A8%E6%BC%8F%E6%B4%9E%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">2.7.</span> <span class="toc-text">2.7 利用漏洞获取数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#28-%E4%BF%A1%E6%81%AF%E6%95%B4%E7%90%86"><span class="toc-number">2.8.</span> <span class="toc-text">2.8 信息整理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#29-%E5%BD%A2%E6%88%90%E6%8A%A5%E5%91%8A"><span class="toc-number">2.9.</span> <span class="toc-text">2.9 形成报告</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">0x03 信息搜集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 信息搜集的分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E6%90%9C%E9%9B%86%E4%BB%80%E4%B9%88%E4%BF%A1%E6%81%AF"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 搜集什么信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-%E7%9B%AE%E6%A0%87%E7%A1%AE%E8%AE%A4"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 目标确认</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E6%B3%A8%E5%86%8C%E4%BF%A1%E6%81%AF%E4%B8%BB%E5%9F%9F%E5%90%8D%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.</span> <span class="toc-text">域名注册信息（主域名查询）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#whois%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">whois查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%E6%A0%B9%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">3.3.1.1.1.</span> <span class="toc-text">方法一：根服务器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%E7%AC%AC%E4%B8%89%E6%96%B9%E6%9C%8D%E5%8A%A1%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.1.2.</span> <span class="toc-text">方法二：第三方服务查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89whois%E5%91%BD%E4%BB%A4"><span class="toc-number">3.3.1.1.3.</span> <span class="toc-text">方法三：whois命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%9B%9B%E4%B8%AD%E6%96%87%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.1.1.4.</span> <span class="toc-text">方法四：中文域名</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dig%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.2.</span> <span class="toc-text">dig查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#icp%E5%A4%87%E6%A1%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.3.</span> <span class="toc-text">ICP备案查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%99%E9%95%BF%E5%B7%A5%E5%85%B7"><span class="toc-number">3.3.1.4.</span> <span class="toc-text">站长工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B1%E7%AB%99%E7%BD%91"><span class="toc-number">3.3.1.5.</span> <span class="toc-text">爱站网</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.6.</span> <span class="toc-text">证书查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dns%E5%85%B1%E4%BA%AB%E8%AE%B0%E5%BD%95%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.1.7.</span> <span class="toc-text">DNS共享记录查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ip%E5%8F%8D%E6%9F%A5"><span class="toc-number">3.3.1.8.</span> <span class="toc-text">IP反查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%82%A1%E6%9D%83%E4%BF%A1%E6%81%AF"><span class="toc-number">3.3.1.9.</span> <span class="toc-text">股权信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hackerone"><span class="toc-number">3.3.1.10.</span> <span class="toc-text">Hackerone</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#google"><span class="toc-number">3.3.1.11.</span> <span class="toc-text">Google</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BD%E5%AE%B6%E4%BC%81%E4%B8%9A%E4%BF%A1%E7%94%A8%E4%BF%A1%E6%81%AF%E5%85%AC%E7%A4%BA%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.3.1.12.</span> <span class="toc-text">国家企业信用信息公示系统</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%9C%9F%E5%AE%9Eip"><span class="toc-number">3.3.2.</span> <span class="toc-text">获取真实IP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%9C%89cdn"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">如何判断是否有CDN</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%E5%A4%9A%E5%9C%B0ping"><span class="toc-number">3.3.2.1.1.</span> <span class="toc-text">方法一：多地ping</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8Cnslookup"><span class="toc-number">3.3.2.1.2.</span> <span class="toc-text">方法二：nslookup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7"><span class="toc-number">3.3.2.1.3.</span> <span class="toc-text">方法三：在线工具</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%95%E8%BF%87cdn"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">绕过CDN</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%8E%86%E5%8F%B2dns%E8%AE%B0%E5%BD%95"><span class="toc-number">3.3.2.2.1.</span> <span class="toc-text">查询历史DNS记录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9B%BD%E5%A4%96%E4%B8%BB%E6%9C%BA%E8%AF%B7%E6%B1%82%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.2.2.2.</span> <span class="toc-text">使用国外主机请求域名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E"><span class="toc-number">3.3.2.2.3.</span> <span class="toc-text">网站信息泄露漏洞</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.2.2.4.</span> <span class="toc-text">查询子域名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%82%AE%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="toc-number">3.3.2.2.5.</span> <span class="toc-text">邮件信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E7%BD%91%E7%AB%99-app-%E5%BA%94%E7%94%A8"><span class="toc-number">3.3.2.2.6.</span> <span class="toc-text">目标网站 APP 应用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.3.</span> <span class="toc-text">子域名查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#subdomainsbrute"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">SubDomainsBrute</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#esd"><span class="toc-number">3.3.3.2.</span> <span class="toc-text">ESD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#layer-%E5%AD%90%E5%9F%9F%E5%90%8D%E6%8C%96%E6%8E%98%E6%9C%BA"><span class="toc-number">3.3.3.3.</span> <span class="toc-text">Layer 子域名挖掘机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#xray"><span class="toc-number">3.3.3.4.</span> <span class="toc-text">Xray</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bypass-firewalls-by-dns-history"><span class="toc-number">3.3.3.5.</span> <span class="toc-text">Bypass-firewalls-by-DNS-history</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#oneforall"><span class="toc-number">3.3.3.6.</span> <span class="toc-text">OneForAll</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%8F%91%E7%8E%B0%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.3.7.</span> <span class="toc-text">搜索引擎发现子域名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E8%81%9A%E5%90%88%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.3.8.</span> <span class="toc-text">第三方聚合服务发现子域名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-ssl-%E8%AF%81%E4%B9%A6"><span class="toc-number">3.3.3.9.</span> <span class="toc-text">通过 SSL 证书</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">3.3.3.10.</span> <span class="toc-text">使用命令行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7%E5%92%8C%E8%84%9A%E6%9C%AC"><span class="toc-number">3.3.3.11.</span> <span class="toc-text">使用工具和脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6%E6%94%B6%E9%9B%86"><span class="toc-number">3.3.3.12.</span> <span class="toc-text">证书收集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%B5%B7%E5%A4%96-dns-%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.3.3.13.</span> <span class="toc-text">通过海外 DNS 查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%8F%98%E6%9B%B4%E7%9A%84%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.3.14.</span> <span class="toc-text">通过变更的域名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-app-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BA%94%E7%94%A8"><span class="toc-number">3.3.3.15.</span> <span class="toc-text">通过 APP 移动端应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-f5-ltm-%E8%A7%A3%E7%A0%81"><span class="toc-number">3.3.3.16.</span> <span class="toc-text">通过 F5 LTM 解码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%85%A8%E7%BD%91%E6%89%AB%E6%8F%8F"><span class="toc-number">3.3.3.17.</span> <span class="toc-text">通过全网扫描</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-virtual-host-%E7%A2%B0%E6%92%9E"><span class="toc-number">3.3.3.18.</span> <span class="toc-text">通过 virtual-host 碰撞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-faviconico-%E5%93%88%E5%B8%8C%E7%89%B9%E5%BE%81"><span class="toc-number">3.3.3.19.</span> <span class="toc-text">通过 favicon.ico 哈希特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E7%BD%91%E9%A1%B5%E6%BA%90%E7%A0%81%E7%89%B9%E5%BE%81%E5%80%BC"><span class="toc-number">3.3.3.20.</span> <span class="toc-text">通过网页源码特征值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-cloudfair-%E5%B7%A5%E5%85%B7"><span class="toc-number">3.3.3.21.</span> <span class="toc-text">使用 CloudFair 工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dns-%E5%9F%9F%E4%BC%A0%E9%80%81%E5%8F%91%E7%8E%B0%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">3.3.3.22.</span> <span class="toc-text">DNS 域传送发现子域名</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ip%E6%AE%B5%E7%9A%84%E6%94%B6%E9%9B%86"><span class="toc-number">3.4.</span> <span class="toc-text">IP段的收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c%E6%AE%B5%E4%B8%8E%E6%97%81%E7%AB%99%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.5.</span> <span class="toc-text">C段与旁站查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap%E6%89%AB%E6%8F%8F"><span class="toc-number">3.5.1.</span> <span class="toc-text">Nmap扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E8%AF%AD%E6%B3%95"><span class="toc-number">3.5.2.</span> <span class="toc-text">搜索引擎语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap%E6%89%AB%E6%8F%8F"><span class="toc-number">3.5.3.</span> <span class="toc-text">nmap扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#httpscan"><span class="toc-number">3.5.4.</span> <span class="toc-text">httpscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bufferfly"><span class="toc-number">3.5.5.</span> <span class="toc-text">bufferfly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cscan"><span class="toc-number">3.5.6.</span> <span class="toc-text">cscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#masscan"><span class="toc-number">3.5.7.</span> <span class="toc-text">masscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fscan"><span class="toc-number">3.5.8.</span> <span class="toc-text">fscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shuize"><span class="toc-number">3.5.9.</span> <span class="toc-text">shuize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#allin"><span class="toc-number">3.5.10.</span> <span class="toc-text">ALLiN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ehole"><span class="toc-number">3.5.11.</span> <span class="toc-text">Ehole</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.6.</span> <span class="toc-text">开放端口探测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.7.</span> <span class="toc-text">网络架构探测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cms%E8%AF%86%E5%88%AB"><span class="toc-number">3.7.1.</span> <span class="toc-text">CMS识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">3.7.2.</span> <span class="toc-text">服务器信息搜集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%86%E5%88%AB"><span class="toc-number">3.7.3.</span> <span class="toc-text">特定关键字识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E6%96%87%E4%BB%B6%E5%8F%8A%E8%B7%AF%E5%BE%84%E8%AF%86%E5%88%AB"><span class="toc-number">3.7.4.</span> <span class="toc-text">特定文件及路径识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%A4%B4%E4%BF%A1%E6%81%AF%E8%AF%86%E5%88%AB"><span class="toc-number">3.7.5.</span> <span class="toc-text">响应头信息识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7"><span class="toc-number">3.7.6.</span> <span class="toc-text">常见脚本工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E8%A7%82%E6%98%9F%E5%B9%B3%E5%8F%B0"><span class="toc-number">3.7.7.</span> <span class="toc-text">数字观星平台</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#waf%E8%AF%86%E5%88%AB"><span class="toc-number">3.7.8.</span> <span class="toc-text">WAF识别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%BA%94%E7%94%A8%E6%94%B6%E9%9B%86"><span class="toc-number">3.8.</span> <span class="toc-text">其他应用收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F"><span class="toc-number">3.8.1.</span> <span class="toc-text">小程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E4%BC%97%E5%8F%B7"><span class="toc-number">3.8.2.</span> <span class="toc-text">公众号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%B4%BB%E5%8F%B7"><span class="toc-number">3.8.3.</span> <span class="toc-text">生活号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app%E6%90%9C%E9%9B%86"><span class="toc-number">3.8.4.</span> <span class="toc-text">APP搜集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pc%E5%BA%94%E7%94%A8"><span class="toc-number">3.8.5.</span> <span class="toc-text">PC应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6-%E6%95%8F%E6%84%9F%E7%9B%AE%E5%BD%95%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.9.</span> <span class="toc-text">敏感文件、敏感目录探测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7"><span class="toc-number">3.9.1.</span> <span class="toc-text">脚本工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#google-hacking"><span class="toc-number">3.9.2.</span> <span class="toc-text">Google hacking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%92%88%E5%AF%B9%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%9A%84%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E"><span class="toc-number">3.9.3.</span> <span class="toc-text">针对信息泄露的搜索引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#google-hacking-database"><span class="toc-number">3.9.4.</span> <span class="toc-text">Google hacking database</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ffuf"><span class="toc-number">3.9.5.</span> <span class="toc-text">ffuf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dirmap"><span class="toc-number">3.9.6.</span> <span class="toc-text">dirmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#github%E8%AF%AD%E6%B3%95"><span class="toc-number">3.9.7.</span> <span class="toc-text">github语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%86%E5%8F%B2%E9%A1%B5%E9%9D%A2"><span class="toc-number">3.9.8.</span> <span class="toc-text">历史页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%9B%98%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">3.9.9.</span> <span class="toc-text">网盘信息搜集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">3.9.10.</span> <span class="toc-text">邮箱信息搜集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BB%E6%89%BE%E7%9B%AE%E6%A0%87%E9%82%AE%E7%AE%B1%E5%85%A5%E5%8F%A3"><span class="toc-number">3.9.10.1.</span> <span class="toc-text">寻找目标邮箱入口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">3.9.10.2.</span> <span class="toc-text">通过子域名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E"><span class="toc-number">3.9.10.3.</span> <span class="toc-text">通过搜索引擎</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E5%B9%B3%E5%8F%B0%E6%90%9C%E9%9B%86"><span class="toc-number">3.9.10.4.</span> <span class="toc-text">在线平台搜集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E6%90%9C%E9%9B%86"><span class="toc-number">3.9.10.5.</span> <span class="toc-text">工具搜集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E9%82%AE%E7%AE%B1"><span class="toc-number">3.9.10.6.</span> <span class="toc-text">验证邮箱</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%82%AE%E7%AE%B1%E7%88%86%E7%A0%B4"><span class="toc-number">3.9.10.7.</span> <span class="toc-text">邮箱爆破</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">3.9.11.</span> <span class="toc-text">JS信息搜集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E5%B7%A5%E6%90%9C%E9%9B%86"><span class="toc-number">3.9.11.1.</span> <span class="toc-text">手工搜集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="toc-number">3.9.11.2.</span> <span class="toc-text">利用工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jsfinder"><span class="toc-number">3.9.11.3.</span> <span class="toc-text">JSFinder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#linkfinder"><span class="toc-number">3.9.11.4.</span> <span class="toc-text">LinkFinder</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hae"><span class="toc-number">3.9.11.5.</span> <span class="toc-text">Hae</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6"><span class="toc-number">3.9.12.</span> <span class="toc-text">社会工程学</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E5%9F%9F%E5%90%8D%E9%82%AE%E7%AE%B1%E6%94%B6%E9%9B%86"><span class="toc-number">3.10.</span> <span class="toc-text">目标域名邮箱收集</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E5%A4%96%E7%BD%91%E6%89%93%E7%82%B9%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">0x04 外网打点基本流程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#step-one"><span class="toc-number">4.1.</span> <span class="toc-text">Step One</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%9F%9F%E5%90%8D%E6%94%B6%E9%9B%86"><span class="toc-number">4.1.1.</span> <span class="toc-text">主域名收集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E9%9B%86%E5%AD%90%E5%9F%9F%E5%90%8D"><span class="toc-number">4.1.2.</span> <span class="toc-text">收集子域名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%9C%9F%E5%AE%9Eip%E4%B8%8Ec%E6%AE%B5"><span class="toc-number">4.1.3.</span> <span class="toc-text">获取真实IP与C段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%AF%B9%E5%BA%94%E7%9A%84%E8%B5%84%E4%BA%A7"><span class="toc-number">4.1.4.</span> <span class="toc-text">获取对应的资产</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E5%9F%9F%E5%90%8D%E6%8E%A2%E6%B4%BB"><span class="toc-number">4.1.5.</span> <span class="toc-text">子域名探活</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E7%90%86%E8%B5%84%E4%BA%A7%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB"><span class="toc-number">4.1.6.</span> <span class="toc-text">整理资产，指纹识别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web%E8%B5%84%E4%BA%A7%E6%BC%8F%E6%89%AB"><span class="toc-number">4.1.7.</span> <span class="toc-text">web资产漏扫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ip%E5%92%8Cc%E6%AE%B5%E7%9A%84%E9%AB%98%E5%8D%B1%E7%AB%AF%E5%8F%A3%E5%88%A9%E7%94%A8"><span class="toc-number">4.1.8.</span> <span class="toc-text">IP和C段的高危端口利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web%E8%B5%84%E4%BA%A7%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F"><span class="toc-number">4.1.9.</span> <span class="toc-text">web资产目录扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%8F%E6%84%9Fweb%E8%B5%84%E4%BA%A7%E6%B7%B1%E5%85%A5%E6%8C%96%E6%8E%98"><span class="toc-number">4.1.10.</span> <span class="toc-text">敏感Web资产，深入挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#app-%E5%B0%8F%E7%A8%8B%E5%BA%8F-%E5%85%AC%E4%BC%97%E5%8F%B7"><span class="toc-number">4.1.11.</span> <span class="toc-text">app、小程序、公众号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#step-second"><span class="toc-number">4.2.</span> <span class="toc-text">Step Second</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E9%9B%86%E7%9B%AE%E6%A0%87"><span class="toc-number">4.2.1.</span> <span class="toc-text">收集目标</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-%E5%90%8E%E8%AE%B0"><span class="toc-number">5.</span> <span class="toc-text">0x05 后记</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">6.</span> <span class="toc-text">0x06 参考文章</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/21/thm-sha-he-gui-bi/" title="THM-沙盒规避">THM-沙盒规避</a><time datetime="2024-08-21T09:41:49.000Z" title="发表于 2024-08-21 17:41:49">2024-08-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/21/thm-fang-huo-qiang/" title="THM-防火墙">THM-防火墙</a><time datetime="2024-08-21T07:07:33.000Z" title="发表于 2024-08-21 15:07:33">2024-08-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/21/thm-wang-luo-an-quan-jie-jue-fang-an/" title="THM-网络安全解决方案">THM-网络安全解决方案</a><time datetime="2024-08-21T01:37:19.000Z" title="发表于 2024-08-21 09:37:19">2024-08-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/20/thm-kao-tu-di-wei-sheng/" title="THM-靠土地为生">THM-靠土地为生</a><time datetime="2024-08-20T10:08:09.000Z" title="发表于 2024-08-20 18:08:09">2024-08-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/20/thm-tao-bi-ri-zhi-ji-lu-he-jian-kong/" title="THM-逃避日志记录和监控">THM-逃避日志记录和监控</a><time datetime="2024-08-20T06:51:56.000Z" title="发表于 2024-08-20 14:51:56">2024-08-20</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="hybcx" target="_blank">hybcx</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">204</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">30</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="http://yansedaima.com/" title="颜色代码表"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/hybchenxing/blog-images/img/202408121908150.svg" alt="颜色代码表"/><span class="back-menu-item-text">颜色代码表</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-box-archive"></use></svg><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shapes"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tags"></use></svg><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-link"></use></svg><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-artstation"></use></svg><span> 朋友圈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-music"></use></svg><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-paper-plane"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shoe-prints1"></use></svg><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CTF%E8%B5%9B%E4%BA%8B/" style="font-size: 0.88rem;">CTF赛事<sup>18</sup></a><a href="/tags/CVE/" style="font-size: 0.88rem;">CVE<sup>15</sup></a><a href="/tags/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">Java反序列化<sup>3</sup></a><a href="/tags/Java%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">Java基础<sup>1</sup></a><a href="/tags/Linux%E6%8F%90%E6%9D%83/" style="font-size: 0.88rem;">Linux提权<sup>2</sup></a><a href="/tags/MISC/" style="font-size: 0.88rem;">MISC<sup>1</sup></a><a href="/tags/Metasploit/" style="font-size: 0.88rem;">Metasploit<sup>3</sup></a><a href="/tags/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.88rem;">PHP代码审计<sup>2</sup></a><a href="/tags/SecBook/" style="font-size: 0.88rem;">SecBook<sup>1</sup></a><a href="/tags/TryHackMe/" style="font-size: 0.88rem;">TryHackMe<sup>42</sup></a><a href="/tags/Windows%E6%8F%90%E6%9D%83/" style="font-size: 0.88rem;">Windows提权<sup>2</sup></a><a href="/tags/reverse%E7%B3%BB%E5%88%97/" style="font-size: 0.88rem;">reverse系列<sup>2</sup></a><a href="/tags/tryhackme/" style="font-size: 0.88rem;">tryhackme<sup>1</sup></a><a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">web渗透<sup>2</sup></a><a href="/tags/web%E7%9F%A5%E8%AF%86%E6%80%BB%E7%BB%93/" style="font-size: 0.88rem;">web知识总结<sup>2</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.88rem;">代码审计<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">内网渗透<sup>3</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E9%9D%B6%E5%9C%BA/" style="font-size: 0.88rem;">内网靶场<sup>2</sup></a><a href="/tags/%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">基本知识<sup>21</sup></a><a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">基础知识<sup>1</sup></a><a href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" style="font-size: 0.88rem;">攻防世界<sup>1</sup></a><a href="/tags/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E5%9C%BA/" style="font-size: 0.88rem;">玄机应急响应靶场<sup>1</sup></a><a href="/tags/%E7%BA%A2%E9%98%9F%E6%B8%97%E9%80%8F/" style="font-size: 0.88rem;">红队渗透<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 hybcx 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '7Sc5uZwcoDwvbgqkpwGKyCpN-gzGzoHsz',
      appKey: 'iEFJUGMm2FY91n9ZG1gdKBSy',
      avatar: 'mp',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script src="https://cdn.cbd.int/blueimp-md5@2.19.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=mp'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://7Sc5uZwc.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": '7Sc5uZwcoDwvbgqkpwGKyCpN-gzGzoHsz',
        "X-LC-Key": 'iEFJUGMm2FY91n9ZG1gdKBSy',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>