<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Thm-Intro to Digital Forensics | hybcx's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - $1 行","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline.css"><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/friends/"><span class="navItemTitle">Friends</span></a></li><li class="navItem"><a class="navBlock" href="/about"><span class="navItemTitle">About</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>Thm-Intro to Digital Forensics</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2023-12-12T11:10:12.330Z" id="date"> 2023-12-12</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-12-12T12:02:36.061Z" id="updated"> 2023-12-12</time></div></span><br><span>文章总字数: <div class="control">2.8k</div></span><br><span>预计阅读时间: <div class="control">10 分钟</div></span></div></div><hr><div id="post-content"><h1>0x01 Task1-数字取证简介</h1>
<p>了解数字取证和相关流程并通过实际示例进行实验。</p>
<p class='item-img' data-src='image-20231212191718197.png'><img src="image-20231212191718197.png" alt="image-20231212191718197"></p>
<p>法证学是应用科学来调查犯罪并确定事实的学科。随着计算机和智能手机等数字系统的使用和普及，一个新的取证学分支诞生了，用于调查相关犯罪：计算机取证，后来演变为数字取证。</p>
<p>考虑以下场景。执法人员到达犯罪现场；然而，该犯罪现场的一部分包括数字设备和媒体。数字设备包括台式电脑、笔记本电脑、数码相机、音乐播放器和智能手机等。数字媒体包括 CD、DVD、USB 闪存驱动器和外部存储设备。出现几个问题：</p>
<ul>
<li>How should the police collect digital evidence, such as smartphones and laptops? What are the procedures to follow if the computer and smartphone are running?<br>
警方应如何收集智能手机和笔记本电脑等数字证据？如果计算机和智能手机正在运行，应遵循哪些步骤？</li>
<li>How to transfer the digital evidence? Are there certain best practices to follow when moving computers, for instance?<br>
数字证据如何传输？例如，在移动计算机时是否需要遵循某些最佳实践？</li>
<li>How to analyze the collected digital evidence? Personal device storage ranges between tens of gigabytes to several terabytes; how can this be analyzed?<br>
如何分析收集到的数字证据？个人设备存储范围从几十GB到几TB；这该如何分析呢？</li>
</ul>
<p class='item-img' data-src='image-20231212191735328.png'><img src="image-20231212191735328.png" alt="image-20231212191735328"></p>
<p>假设上图中这名员工被怀疑，我们可以很快看到调查可能感兴趣的数字设备。除了台式电脑之外，我们还注意到平板电脑、智能手机、数码相机和 USB 闪存。这些设备中的任何一个都可能包含大量有助于调查的信息。将这些作为证据处理需要数字取证。</p>
<p>更正式地说，数字取证是计算机科学的应用，旨在出于法律目的调查数字证据。数字取证用于两种类型的调查：</p>
<ol>
<li><strong>Public-sector investigations</strong> refer to the investigations carried out by government and law enforcement agencies. They would be part of a crime or civil investigation.<br>
公共部门调查是指政府和执法机构进行的调查。他们将成为犯罪或民事调查的一部分。</li>
<li><strong>Private-sector investigations</strong> refer to the investigations carried out by corporate bodies by assigning a private investigator, whether in-house or outsourced. They are triggered by corporate policy violations.<br>
私营部门调查是指法人机构指派私人调查员（无论是内部调查员还是外包调查员）进行的调查。它们是由违反公司政策引发的。</li>
</ol>
<p>无论是调查犯罪还是违反公司政策，部分证据都与数字设备和数字媒体有关。这就是数字取证发挥作用并试图确定发生了什么的地方。如果没有训练有素的数字取证调查员，就不可能正确处理任何数字证据。</p>
<p class='item-img' data-src='image-20231212191751800.png'><img src="image-20231212191751800.png" alt="image-20231212191751800"></p>
<h2 id="问题一："><a href="#问题一：" class="headerlink" title="问题一："></a>问题一：</h2>
<p>由上图我们看到有一个笔记本电脑</p>
<p class='item-img' data-src='image-20231212191803338.png'><img src="image-20231212191803338.png" alt="image-20231212191803338"></p>
<h1>0x02 Task2-数字取证过程</h1>
<p class='item-img' data-src='image-20231212192016318.png'><img src="image-20231212192016318.png" alt="image-20231212192016318"></p>
<p>作为一名数字取证调查员，您会看到与上图所示类似的场景。作为数字取证调查员，您应该做什么？获得适当的法律授权后，基本计划如下：</p>
<ol>
<li>Acquire the evidence: Collect the digital devices such as laptops, storage devices, and digital cameras. (Note that laptops and computers require special handling if they are turned on; however, this is outside the scope of this room.)<br>
获取证据：收集笔记本电脑、存储设备、数码相机等数字设备。 （请注意，笔记本电脑和计算机在打开时需要特殊处理；但是，这超出了本房间的范围。）</li>
<li>Establish a chain of custody: Fill out the related form appropriately (<a target="_blank" rel="noopener" href="https://www.nist.gov/document/sample-chain-custody-formdocx">Sample form</a>). The purpose is to ensure that only the authorized investigators had access to the evidence and no one could have tampered with it.<br>
建立监管链：正确填写相关表格（样本表格）。目的是确保只有经过授权的调查人员才能获取证据，并且任何人都无法篡改证据。</li>
<li>Place the evidence in a secure container: You want to ensure that the evidence does not get damaged. In the case of smartphones, you want to ensure that they cannot access the network, so they don’t get wiped remotely.<br>
将证据放在安全的容器中：您要确保证据不会损坏。对于智能手机，您需要确保它们无法访问网络，这样它们就不会被远程擦除。</li>
<li>Transport the evidence to your digital forensics lab.<br>
将证据传输到您的数字取证实验室。</li>
</ol>
<p>在实验室，过程如下：</p>
<ol>
<li>Retrieve the digital evidence from the secure container.<br>
从安全容器中检索数字证据。</li>
<li>Create a forensic copy of the evidence: The forensic copy requires advanced software to avoid modifying the original data.<br>
创建证据的取证副本：取证副本需要先进的软件以避免修改原始数据。</li>
<li>Return the digital evidence to the secure container: You will be working on the copy. If you damage the copy, you can always create a new one.<br>
将数字证据返回到安全容器：您将处理副本。如果您损坏了副本，您随时可以创建一个新副本。</li>
<li>Start processing the copy on your forensics workstation.<br>
开始在取证工作站上处理副本。</li>
</ol>
<p>上述步骤改编自《计算机取证和调查指南》第 6 版。</p>
<p>更一般地说，根据国防计算机取证实验室前主任 Ken Zatyko 的说法，数字取证包括：</p>
<ul>
<li>适当的搜查授权：如果没有适当的法律授权，调查人员就无法开始搜查。</li>
<li>监管链：这对于随时跟踪谁持有证据是必要的。</li>
<li>用数学验证：使用一种特殊的数学函数（称为哈希函数），我们可以确认文件未被修改。</li>
<li>使用经过验证的工具：数字取证中使用的工具应经过验证，以确保它们正常工作。例如，如果您要创建磁盘映像，您需要确保取证映像与磁盘上的数据相同。</li>
<li>可重复性：只要有适当的技能和工具，数字取证的结果就可以重现。</li>
<li>报告：数字取证调查以一份报告结束，该报告显示与所发现的案件相关的证据。</li>
</ul>
<h2 id="问题二："><a href="#问题二：" class="headerlink" title="问题二："></a>问题二：</h2>
<p>必须随时跟踪谁在处理该案件，以确保证据在法庭上得到采信。有助于建立这一点的文档的名称是什么？</p>
<p>很明显是<strong>监管链</strong></p>
<p class='item-img' data-src='image-20231212192327445.png'><img src="image-20231212192327445.png" alt="image-20231212192327445"></p>
<h1>0x03 Task3-数字取证的实际示例</h1>
<p>我们在数字设备（从智能手机到计算机）上所做的一切都会留下痕迹。让我们看看在后续的调查中如何使用它。</p>
<p>我们的猫加多被绑架了。绑匪已向我们发送了一份 MS Word 文档格式的文件，其中包含他们的请求。为了您的方便，我们已将文档转换为 PDF 格式，并从 MS Word 文件中提取图像。</p>
<p>您可以将附件下载到本地机器进行检查；但是，为了您的方便，我们已将文件添加到 AttackBox 中。要继续操作，请打开 AttackBox 上的终端，然后转到目录 <code>/root/Rooms/introdigitalforensics</code> ，如下所示。在以下终端输出中，我们更改为包含案例文件的目录。</p>
<p class='item-img' data-src='image-20231212192734406.png'><img src="image-20231212192734406.png" alt="image-20231212192734406"></p>
<h3 id="Document-Metadata-文档元数据"><a href="#Document-Metadata-文档元数据" class="headerlink" title="Document-Metadata-文档元数据"></a>Document Metadata 文档元数据</h3>
<p>当您创建文本文件 <code>TXT</code> 时，操作系统会保存一些元数据，例如文件创建日期和上次修改日期。但是，当您使用更高级的编辑器（例如 MS Word）时，许多信息会保留在文件的元数据中。读取文件元数据的方式有多种；您可以在其官方查看器/编辑器中打开它们或使用合适的取证工具。请注意，将文件导出为其他格式（例如 <code>PDF</code> ）将保留原始文档的大部分元数据，具体取决于所使用的 PDF 编写器。</p>
<p>让我们看看我们能从 PDF 文件中了解到什么。我们可以尝试使用程序 <code>pdfinfo</code> 读取元数据。 Pdfinfo 显示与 PDF 文件相关的各种元数据，例如标题、主题、作者、创建者和创建日期。 （AttackBox 已经安装了 <code>pdfinfo</code> ；但是，如果您使用 Kali Linux 并且没有安装 <code>pdfinfo</code> ，则可以使用 <code>sudo apt install poppler-utils</code> 安装它。）考虑以下使用 <code>pdfinfo DOCUMENT.pdf</code> 的示例。</p>
<p class='item-img' data-src='image-20231212192758997.png'><img src="image-20231212192758997.png" alt="image-20231212192758997"></p>
<p>PDF 元数据清楚地表明它是于 2018 年 10 月 10 日使用 MS Word for Office 365 创建的。</p>
<h2 id="问题三："><a href="#问题三：" class="headerlink" title="问题三："></a>问题三：</h2>
<p>使用 <code>pdfinfo</code> 查找所附 PDF 文件的作者。</p>
<p>这里呢我们可以在kali上进行操作，前提是要下载该房间所给的附件，不过也可以直接打开room自带的虚拟机直接操作，这里我用自带的</p>
<p class='item-img' data-src='image-20231212192948555.png'><img src="image-20231212192948555.png" alt="image-20231212192948555"></p>
<p>我们打开终端进入指定目录，如上图，其中包含三个文档，我们需要用pdfinfo命令来查看元数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">pdfinfo ransom-letter.pdf<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20231212193059346.png'><img src="image-20231212193059346.png" alt="image-20231212193059346"></p>
<p>如上图，成功找到文档作者信息</p>
<p class='item-img' data-src='image-20231212193126032.png'><img src="image-20231212193126032.png" alt="image-20231212193126032"></p>
<h3 id="Photo-EXIF-Data-照片-EXIF-数据"><a href="#Photo-EXIF-Data-照片-EXIF-数据" class="headerlink" title="Photo-EXIF-Data-照片-EXIF-数据"></a>Photo EXIF Data 照片 EXIF 数据</h3>
<p>EXIF 代表可交换图像文件格式；它是将元数据保存到图像文件的标准。每当您使用智能手机或数码相机拍照时，图像中都会嵌入大量信息。以下是可以在原始数字图像中找到的元数据的示例：</p>
<ul>
<li>Camera model / Smartphone model<br>
相机型号/智能手机型号</li>
<li>Date and time of image capture<br>
图像捕捉的日期和时间</li>
<li>Photo settings such as focal length, aperture, shutter speed, and ISO settings<br>
照片设置，例如焦距、光圈、快门速度和 ISO 设置</li>
</ul>
<p>由于智能手机配备了 GPS 传感器，因此很有可能找到嵌入在图像中的 GPS 坐标。 GPS坐标，即纬度和经度，通常会显示照片拍摄的地点。</p>
<p>有许多在线和离线工具可以从图像中读取 EXIF 数据。一种命令行工具是 <code>exiftool</code> 。 ExifTool 用于读取和写入各种文件类型（例如 JPEG 图像）中的元数据。 （AttackBox 已经安装了 <code>exiftool</code> ；但是，如果您使用 Kali Linux 并且没有安装 <code>exiftool</code> ，则可以使用 <code>sudo apt install libimage-exiftool-perl</code> 安装它。）在下面的终端窗口中，我们执行 <code>exiftool IMAGE.jpg</code> 来读取该图像中嵌入的所有 EXIF 数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">exiftool letter-image.jpg<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20231212193611755.png'><img src="image-20231212193611755.png" alt="image-20231212193611755"></p>
<p>如上图，我们成功读取到exif数据</p>
<h2 id="问题四："><a href="#问题四：" class="headerlink" title="问题四："></a>问题四：</h2>
<p>如果您使用上述坐标并搜索一张在线地图，您将了解有关该位置的更多信息。在 Microsoft Bing 地图或 Google 地图中搜索 <code>51° 31' 4.00&quot; N, 0° 5' 48.30&quot; W</code> 显示这些坐标表明该图像是在伦敦博物馆附近拍摄的。 （我们仅将 <code>deg</code> 替换为 <code>°</code> 以使搜索正常工作。）我们注意到搜索页面上的坐标已转换为十进制表示形式： <code>51.517776, -0.09675</code> 。</p>
<p class='item-img' data-src='image-20231212194138672.png'><img src="image-20231212194138672.png" alt="image-20231212194138672"></p>
<p>如上图，我们可以找到GPS位置</p>
<p class='item-img' data-src='image-20231212194307903.png'><img src="image-20231212194307903.png" alt="image-20231212194307903"></p>
<p>进入谷歌地图找到位置是伦敦博物馆附近</p>
<p>使用 <code>exiftool</code> 或任何类似工具，尝试查找绑匪在何处获取了附加到文档中的图像。街道的名称是什么？</p>
<p>我们将上图的坐标转换至下列：</p>
<p><code>51°30' 51.90&quot; N, 0°5' 38.73&quot; W</code>–进入谷歌地图搜索</p>
<p class='item-img' data-src='image-20231212200018650.png'><img src="image-20231212200018650.png" alt="image-20231212200018650"></p>
<p>找到街道名称</p>
<p>下图是使用exiftool对doc文档的信息查看，发现相机型号</p>
<p class='item-img' data-src='image-20231212195135609.png'><img src="image-20231212195135609.png" alt="image-20231212195135609"></p>
<p class='item-img' data-src='image-20231212200101740.png'><img src="image-20231212200101740.png" alt="image-20231212200101740"></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/12/12/CTFHub%E7%B3%BB%E5%88%97/">← 下一篇 CTFHub系列</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/12/12/Thm%E7%B3%BB%E5%88%972/">Thm-Web Application Security 上一篇 →</a></div></div></div><div id="comments"><div id="waline"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="文章目录">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">hybcx</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">0x01 Task1-数字取证简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%B8%80%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">问题一：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">0x02 Task2-数字取证过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%BA%8C%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">问题二：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">0x03 Task3-数字取证的实际示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Document-Metadata-%E6%96%87%E6%A1%A3%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">3.0.1.</span> <span class="toc-text">Document Metadata 文档元数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%B8%89%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">问题三：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Photo-EXIF-Data-%E7%85%A7%E7%89%87-EXIF-%E6%95%B0%E6%8D%AE"><span class="toc-number">3.1.1.</span> <span class="toc-text">Photo EXIF Data 照片 EXIF 数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%9B%9B%EF%BC%9A"><span class="toc-number">3.2.</span> <span class="toc-text">问题四：</span></a></li></ol></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script type="module">import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
window.waline = init;
</script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {if (document.querySelector('#waline'))
 waline({
   el: '#waline',
   dark: ':root[theme-mode="dark"]',
   serverURL: 'https://waline-blog-iwqdtxise-hybchenxing.vercel.app',
   path: window.location.pathname,
 });document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>