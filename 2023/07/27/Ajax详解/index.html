<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ajax详解 | hybcx's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - $1 行","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline.css"><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/friends/"><span class="navItemTitle">Friends</span></a></li><li class="navItem"><a class="navBlock" href="/about"><span class="navItemTitle">About</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>Ajax详解</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2023-07-27T09:26:57.088Z" id="date"> 2023-07-27</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-07-27T09:28:01.468Z" id="updated"> 2023-07-27</time></div></span><br><span>文章总字数: <div class="control">1.4k</div></span><br><span>预计阅读时间: <div class="control">5 分钟</div></span></div></div><hr><div id="post-content"><h1>Ajax详解</h1>
<h2 id="0x01-简介"><a href="#0x01-简介" class="headerlink" title="0x01-简介"></a>0x01 简介</h2>
<p>AJAX 全称为 Asynchronous JavaScript And XML，就是异步的 JS 和 XML。AJAX是一种用于创建快速动态网页的技术。通过AJAX可以在浏览器中向服务器发送异步请求，Ajax可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。AJAX不是新的编程语言，而是一种将现有的标准组合在一起使用的新方式。</p>
<h3 id="1-1-什么是同步请求？"><a href="#1-1-什么是同步请求？" class="headerlink" title="1-1-什么是同步请求？"></a>1.1 什么是同步请求？</h3>
<p>同步请求是指当前发出请求后，浏览器什么都不能做，必须得等到请求完成返回数据之后，才会执行后续的代码。相当于生活中的排队，必须等待前一个人完成自己的事物，后一个人才能接着办。也就是说，当JS代码加载到当前AJAX的时候会把页面里所有的代码停止加载，当这个AJAX执行完毕后才会继续运行其他代码。</p>
<h3 id="1-2-什么是异步请求？"><a href="#1-2-什么是异步请求？" class="headerlink" title="1-2-什么是异步请求？"></a>1.2 什么是异步请求？</h3>
<p>异步请求就当发出请求的同时，浏览器可以继续做任何事，Ajax发送请求并不会影响页面的加载与用户的操作，相当于是在两条线上，各走各的，互不影响。一般默认值为true。异步请求可以完全不影响用户的体验效果，无论请求的时间长或者短，用户可以专心的操作页面的其他内容，并不会有等待的感觉。</p>
<h3 id="1-3-XML"><a href="#1-3-XML" class="headerlink" title="1-3-XML"></a>1.3 XML</h3>
<p>XML是一种可扩展标记语言，被设计用来传输和存储数据。XML和 HTML类似，但XML中没有预定义标签，全都是自定义标签，用来表示一些数据。早期 AJAX 携带的数据类型和返回的数据类型为xml形式，这也是 AJAX 名称的由来。</p>
<p>尽管 X 在 Ajax 中代表 XML，但由于JSON的许多优势，比如更加轻量以和作为 Javascript 的一部分，<strong>目前 JSON 的使用比 XML 更加普遍</strong>。</p>
<h3 id="1-4-优缺点"><a href="#1-4-优缺点" class="headerlink" title="1-4-优缺点"></a>1.4 优缺点</h3>
<p>**优点：**可以无需刷新页面而与服务器端进行通信；允许你根据用户事件来更新部分页面内容。<br>
**缺点：**没有浏览历史，不能回退；存在跨域问题；SEO（搜索引擎优化）不友好，因为数据是动态创建的，爬虫是爬不到的。</p>
<h2 id="0x02-ajax请求的基本流程"><a href="#0x02-ajax请求的基本流程" class="headerlink" title="0x02-ajax请求的基本流程"></a>0x02 ajax请求的基本流程</h2>
<p>要完整实现一个AJAX异步调用和局部刷新,通常需要以下几个步骤:</p>
<ol>
<li>创建 XMLHttpRequest 请求对象, 即创建一个异步调用对象。（ new XMLHttpRequest() ）</li>
<li>打开请求地址，指定请求方式**。**（open）</li>
<li>设置响应HTTP请求状态变化的函数.</li>
<li>发送HTTP请求。（send）</li>
<li>监听对应的请求状态的变化。（ readystatechange事件 ）</li>
<li>读取响应数据，使用 JavaScript 和 DOM 实现局部刷新。</li>
</ol>
<h3 id="1-创建请求对象"><a href="#1-创建请求对象" class="headerlink" title="1-创建请求对象"></a>1.创建请求对象</h3>
<p>为了使用 JavaScript 向服务器发送一个 http 请求，你需要一个包含必要函数功能的对象实例。这就是为什么会有 XMLHttpRequest 的原因。这是 <strong>IE</strong> 浏览器的 ActiveX 对象 <strong>XMLHTTP</strong> 的前身。随后 Mozilla，Safari 和<strong>其他浏览器</strong>也都实现了类似的方法，被称为 <strong>XMLHttpRequest</strong>。同时，微软也实现了 XMLHttpRequest 方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">XMLHttpRequest</span>) &#123; <span class="hljs-comment">// Mozilla, Safari, IE7+ ...</span><br>    httpRequest = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">ActiveXObject</span>) &#123; <span class="hljs-comment">// IE 6 及以下</span><br>    httpRequest = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActiveXObject</span>(<span class="hljs-string">&quot;Microsoft.XMLHTTP&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="2-打开请求地址，指定请求方式"><a href="#2-打开请求地址，指定请求方式" class="headerlink" title="2-打开请求地址，指定请求方式"></a><strong>2.打开请求地址，指定请求方式</strong></h3>
<ul>
<li>open() 的第一个参数是 <strong>HTTP 请求方法</strong>，有 GET，POST，HEAD 以及服务器支持的其他方法，方法一定要是大写字母，否则其他一些浏览器（比如 FireFox）可能无法处理这个请求。</li>
<li>第二个参数是你要<strong>发送的 URL</strong>。</li>
<li>第三个参数是可选的，用于<strong>设置请求是否是异步的</strong>。如果设为 true (默认值)，即开启异步，JavaScript 就不会在此语句阻塞，使得用户能在服务器还没有响应的情况下与页面进行交互。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">httpRequest.open(&#x27;GET&#x27;, &#x27;http://www.example.org/some.file&#x27;, true);<br></code></pre></td></tr></table></figure>
<h3 id="3-设置响应HTTP请求状态变化的函数"><a href="#3-设置响应HTTP请求状态变化的函数" class="headerlink" title="3-设置响应HTTP请求状态变化的函数"></a>3.设置响应HTTP请求状态变化的函数</h3>
<p>如果你使用 POST 请求，那就需要设置请求的 MIME 类型，设置请求头。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Content-Type:用于设定请求体中参数的类型<br>httpRequest.setRequestHeader(&#x27;Content-Type&#x27;, &#x27;application/x-www-form-urlencoded&#x27;);<br></code></pre></td></tr></table></figure>
<h3 id="4-发送HTTP请求"><a href="#4-发送HTTP请求" class="headerlink" title="4-发送HTTP请求"></a>4.发送HTTP请求</h3>
<p>send() 方法的参数可以是任何你想发送给服务器的内容，如果是 POST 请求的话，数据将在请求体中发送到服务端，发送数据应该用服务器可以解析的格式，像查询语句。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">httpRequest.send( &quot;name=value&amp;anothername=&quot;+encodeURIComponent(myVar)+&quot;&amp;so=on&quot; );<br></code></pre></td></tr></table></figure>
<p>如果是 GET 请求一般不传输参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">httpRequest.send();<br></code></pre></td></tr></table></figure>
<h3 id="5-监听请求状态的变化"><a href="#5-监听请求状态的变化" class="headerlink" title="5-监听请求状态的变化"></a>5.监听请求状态的变化</h3>
<p>只要 readyState 属性发生变化，就会调用相应的处理函数。这个回调函数会被用户线程所调用。XMLHttpRequest.onreadystatechange 会在 XMLHttpRequest 的readyState 属性发生改变时触发 readystatechange (en-US) 事件的时候被调用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">httpRequest.onreadystatechange = function () &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="6-读取响应数据，并做相应处理"><a href="#6-读取响应数据，并做相应处理" class="headerlink" title="6-读取响应数据，并做相应处理"></a>6.读取响应数据，并做相应处理</h3>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http">httpRequest.onreadystatechange = function () &#123;<br>    //readyState 是请求对象中的一个属性 4表示成功<br>    //status 是 http 状态码<br>     if (httpRequest.readyState == 4 &amp;&amp; /^2\d&#123;2&#125;$/.test(httpRequest.status)) &#123;<br>          console.log(httpRequest.status); //状态码<br>          console.log(httpRequest.statusText); //状态字符串<br>          console.log(httpRequest.getAllResponseHeaders()); //所有响应头<br>          console.log(httpRequest.response); //响应体<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="0x03-取消请求"><a href="#0x03-取消请求" class="headerlink" title="0x03-取消请求"></a>0x03 取消请求</h2>
<p>如果该请求已被发出，XMLHttpRequest.abort() 方法将终止该请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">httpRequest.abort()<br></code></pre></td></tr></table></figure><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/07/29/%E6%B5%85%E6%9E%90XXE%E6%BC%8F%E6%B4%9E/">← 下一篇 浅析xxe漏洞</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/07/27/%E6%B5%85%E6%9E%90%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">浅析反序列化 上一篇 →</a></div></div></div><div id="comments"><div id="waline"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="文章目录">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">hybcx</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Ajax详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%90%8C%E6%AD%A5%E8%AF%B7%E6%B1%82%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 什么是同步请求？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%BB%80%E4%B9%88%E6%98%AF%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82%EF%BC%9F"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 什么是异步请求？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-XML"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 优缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-ajax%E8%AF%B7%E6%B1%82%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">0x02 ajax请求的基本流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E8%AF%B7%E6%B1%82%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.创建请求对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%89%93%E5%BC%80%E8%AF%B7%E6%B1%82%E5%9C%B0%E5%9D%80%EF%BC%8C%E6%8C%87%E5%AE%9A%E8%AF%B7%E6%B1%82%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.打开请求地址，指定请求方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94HTTP%E8%AF%B7%E6%B1%82%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text">3.设置响应HTTP请求状态变化的函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%8F%91%E9%80%81HTTP%E8%AF%B7%E6%B1%82"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.发送HTTP请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%9B%91%E5%90%AC%E8%AF%B7%E6%B1%82%E7%8A%B6%E6%80%81%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">1.2.5.</span> <span class="toc-text">5.监听请求状态的变化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E8%AF%BB%E5%8F%96%E5%93%8D%E5%BA%94%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%B9%B6%E5%81%9A%E7%9B%B8%E5%BA%94%E5%A4%84%E7%90%86"><span class="toc-number">1.2.6.</span> <span class="toc-text">6.读取响应数据，并做相应处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-%E5%8F%96%E6%B6%88%E8%AF%B7%E6%B1%82"><span class="toc-number">1.3.</span> <span class="toc-text">0x03 取消请求</span></a></li></ol></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script type="module">import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
window.waline = init;
</script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {if (document.querySelector('#waline'))
 waline({
   el: '#waline',
   dark: ':root[theme-mode="dark"]',
   serverURL: 'https://waline-blog-iwqdtxise-hybchenxing.vercel.app',
   path: window.location.pathname,
 });document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>